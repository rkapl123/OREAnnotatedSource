<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>OREAnalytics: test/parsensitivityanalysismanual.cpp Source File</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="oreaextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-analytics@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.12</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">parsensitivityanalysismanual.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="parsensitivityanalysismanual_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> Copyright (C) 2016 Quaternion Risk Management Ltd</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"></span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> This file is part of ORE, a free-software/open-source library</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> for transparent pricing and risk analysis - http://opensourcerisk.org</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"></span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> ORE is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> under the terms of the Modified BSD License.  You should have received a</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> copy of the license along with this program.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> The license is also available online at &lt;http://opensourcerisk.org&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"></span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> This program is distributed on the basis that it will form a useful</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> contribution to risk analytics and model standardisation, but WITHOUT</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> FITNESS FOR A PARTICULAR PURPOSE. See the license for more details.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">*/</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="parsensitivityanalysismanual_8hpp.html">parsensitivityanalysismanual.hpp</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="testmarket_8hpp.html">testmarket.hpp</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="testportfolio_8hpp.html">testportfolio.hpp</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;<a class="code" href="observationmode_8hpp.html">orea/engine/observationmode.hpp</a>&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="code" href="orea_2engine_2parsensitivityanalysis_8hpp.html">orea/engine/parsensitivityanalysis.hpp</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="zerotoparcube_8hpp.html">orea/engine/zerotoparcube.hpp</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="deltascenariofactory_8hpp.html">orea/scenario/deltascenariofactory.hpp</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="scenariosimmarket_8hpp.html">orea/scenario/scenariosimmarket.hpp</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2capfloor_8hpp.html">ored/portfolio/builders/capfloor.hpp</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2cdo_8hpp.html">ored/portfolio/builders/cdo.hpp</a>&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2equityoption_8hpp.html">ored/portfolio/builders/equityoption.hpp</a>&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2fxforward_8hpp.html">ored/portfolio/builders/fxforward.hpp</a>&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2fxoption_8hpp.html">ored/portfolio/builders/fxoption.hpp</a>&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2swap_8hpp.html">ored/portfolio/builders/swap.hpp</a>&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/builders_2swaption_8hpp.html">ored/portfolio/builders/swaption.hpp</a>&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/creditdefaultswap_8hpp.html">ored/portfolio/creditdefaultswap.hpp</a>&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/portfolio_8hpp.html">ored/portfolio/portfolio.hpp</a>&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/swap_8hpp.html">ored/portfolio/swap.hpp</a>&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/swaption_8hpp.html">ored/portfolio/swaption.hpp</a>&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/csvreport_8hpp.html">ored/report/csvreport.hpp</a>&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/osutils_8hpp.html">ored/utilities/osutils.hpp</a>&gt;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../ored/to__string_8hpp.html">ored/utilities/to_string.hpp</a>&gt;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &lt;oret/toplevelfixture.hpp&gt;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &lt;ql/time/date.hpp&gt;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;<a class="code" href="oreatoplevelfixture_8hpp.html">test/oreatoplevelfixture.hpp</a>&gt;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="keyword">using namespace </span>std;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="keyword">using namespace </span><a class="code hl_namespaceRef" href="../qle/namespace_quant_lib.html">QuantLib</a>;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_quant_ext.html">QuantExt</a>;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keyword">using namespace </span>boost::unit_test_framework;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceore.html">ore</a>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceore_1_1data.html">ore::data</a>;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceore_1_1analytics.html">ore::analytics</a>;</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>QuantLib::ext::shared_ptr&lt;EngineFactory&gt; registerBuilders(QuantLib::ext::shared_ptr&lt;EngineData&gt; engineData,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>                                                  QuantLib::ext::shared_ptr&lt;Market&gt; market) {</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    QuantLib::ext::shared_ptr&lt;EngineFactory&gt; factory = QuantLib::ext::make_shared&lt;EngineFactory&gt;(engineData, market);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keywordflow">return</span> factory;</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>}</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="keywordtype">void</span> parSensiBumpAnalysis(QuantLib::ext::shared_ptr&lt;Portfolio&gt;&amp; portfolio, QuantLib::ext::shared_ptr&lt;EngineData&gt;&amp; engineData,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>                          QuantLib::ext::shared_ptr&lt;Market&gt;&amp; initMarket, map&lt;string, Real&gt;&amp; baseManualPv, <span class="keywordtype">string</span>&amp; baseCcy,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>                          vector&lt;Handle&lt;Quote&gt;&gt;&amp; parValVecBase, vector&lt;string&gt;&amp; labelVec, Real shiftSize,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>                          <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType, std::map&lt;std::pair&lt;std::string, std::string&gt;, Real&gt;&amp; parDelta,</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                          std::map&lt;std::pair&lt;std::string, std::string&gt;, Real&gt;&amp; zeroDelta, map&lt;string, Real&gt;&amp; basePv) {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    Size tradeCount = portfolio-&gt;size();</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    Real basePvTol = 0.00001;      <span class="comment">// tolerance for base PV after re-bootstrapping</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    Real sensiThold = 0.0001;      <span class="comment">// sensi values below this are ignored</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    Real sensiRelTol = 1.0;        <span class="comment">// relative tolerance on par sensitivities</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    Real sensiAbsTol = 0.2;        <span class="comment">// absolute tolerance on par sensitivities for small values (EUR)</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    Real relAbsTolBoundary = 10.0; <span class="comment">// abs val threshold, below this abs tolerance checked, above this rel tolerance</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    vector&lt;Real&gt; baseValues;</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); ++i) {</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        Handle&lt;Quote&gt; q = parValVecBase[i];</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>        Real baseVal = q-&gt;value();</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>        baseValues.push_back(baseVal);</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>        QuantLib::ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(*q)-&gt;setValue(baseVal);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    }</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    QuantLib::ext::shared_ptr&lt;EngineFactory&gt; manualFactory2 = registerBuilders(engineData, initMarket);</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    portfolio-&gt;reset();</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    portfolio-&gt;build(manualFactory2);</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    BOOST_CHECK_MESSAGE(portfolio-&gt;size() == tradeCount,</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                        <span class="stringliteral">&quot;Some trades not built correctly,&quot;</span> &lt;&lt; portfolio-&gt;size() &lt;&lt; <span class="stringliteral">&quot; vs. &quot;</span> &lt;&lt; tradeCount);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [tradeId, trade] : portfolio-&gt;trades()) {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        Real fx = 1.0;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="keywordflow">if</span> (trade-&gt;npvCurrency() != <span class="stringliteral">&quot;EUR&quot;</span>) {</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>            <span class="keywordtype">string</span> ccyPair = trade-&gt;npvCurrency() + baseCcy;</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>            fx = initMarket-&gt;fxRate(ccyPair)-&gt;value();</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        }</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        BOOST_CHECK_MESSAGE(std::fabs(baseManualPv[tradeId] - (fx * trade-&gt;instrument()-&gt;NPV())) &lt;= basePvTol,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                            <span class="stringliteral">&quot;Equality error for trade &quot;</span> &lt;&lt; tradeId &lt;&lt; <span class="stringliteral">&quot;; got &quot;</span> &lt;&lt; (fx * trade-&gt;instrument()-&gt;NPV())</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                                                        &lt;&lt; <span class="stringliteral">&quot;, but expected &quot;</span> &lt;&lt; baseManualPv[tradeId]);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="comment">// bump each point in sequence and generate new par curve</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); ++i) {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>        <span class="keywordtype">string</span> sensiLabel = labelVec[i];</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>        <span class="comment">// if ((curveType == &quot;CDSVolatility&quot;) || (curveType == &quot;EquityVolatility&quot;)) sensiLabel = sensiLabel + &quot;/ATM&quot;;</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; parValVecBase.size(); ++j) {</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            <span class="keywordflow">if</span> (i == j) {</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                Real newVal = (shiftType == ShiftType::Absolute) ? (baseValues[j] + shiftSize)</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>                                                                 : (baseValues[j] * (1.0 + shiftSize));</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>                QuantLib::ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(*parValVecBase[j])-&gt;setValue(newVal);</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>                QuantLib::ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(*parValVecBase[j])-&gt;setValue(baseValues[j]);</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            }</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>        QuantLib::ext::shared_ptr&lt;EngineFactory&gt; manualFactoryDisc = registerBuilders(engineData, initMarket);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        portfolio-&gt;reset();</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        portfolio-&gt;build(manualFactoryDisc);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        BOOST_CHECK_MESSAGE(portfolio-&gt;size() == tradeCount,</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>                            <span class="stringliteral">&quot;Some trades not built correctly,&quot;</span> &lt;&lt; portfolio-&gt;size() &lt;&lt; <span class="stringliteral">&quot; vs. &quot;</span> &lt;&lt; tradeCount);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> [tradeId, trade] : portfolio-&gt;trades()) {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            Real fx = 1.0;</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            <span class="keywordflow">if</span> (trade-&gt;npvCurrency() != <span class="stringliteral">&quot;EUR&quot;</span>) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                <span class="keywordtype">string</span> ccyPair = trade-&gt;npvCurrency() + baseCcy;</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                fx = initMarket-&gt;fxRate(ccyPair)-&gt;value();</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>            }</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>            Real shiftedNPV = fx * trade-&gt;instrument()-&gt;NPV();</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>            Real anticipatedParDelta = shiftedNPV - baseManualPv[tradeId];</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>            Real computedParDelta = 0.0;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>            <span class="keywordflow">if</span> (parDelta.find(std::make_pair(tradeId, sensiLabel)) != parDelta.end())</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                computedParDelta = parDelta[std::make_pair(tradeId, sensiLabel)];</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            <span class="keywordflow">if</span> ((std::fabs(anticipatedParDelta) &gt; sensiThold) || (std::fabs(computedParDelta) &gt; sensiThold)) {</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;#reportrow,&quot;</span> &lt;&lt; tradeId &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; sensiLabel &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; baseManualPv[tradeId]</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                                                 &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; basePv[tradeId] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; anticipatedParDelta &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                                                 &lt;&lt; computedParDelta &lt;&lt; <span class="stringliteral">&quot;,&quot;</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                                                 &lt;&lt; zeroDelta[std::make_pair(tradeId, sensiLabel)]);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span> </div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                <span class="keywordflow">if</span> ((std::fabs(anticipatedParDelta) &gt; relAbsTolBoundary) &amp;&amp;</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                    (std::fabs(computedParDelta) &gt; relAbsTolBoundary))</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>                    BOOST_CHECK_CLOSE(anticipatedParDelta, computedParDelta, sensiRelTol);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                    BOOST_CHECK(std::fabs(anticipatedParDelta - computedParDelta) &lt; sensiAbsTol);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>            }</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        }</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    }</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="comment">// set back to the base curve</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); ++i) {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        QuantLib::ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(*parValVecBase[i])-&gt;setValue(baseValues[i]);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    }</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    QuantLib::ext::shared_ptr&lt;EngineFactory&gt; manualFactory3 = registerBuilders(engineData, initMarket);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    portfolio-&gt;reset();</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    portfolio-&gt;build(manualFactory3);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    BOOST_CHECK_MESSAGE(portfolio-&gt;size() == tradeCount,</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>                        <span class="stringliteral">&quot;Some trades not built correctly,&quot;</span> &lt;&lt; portfolio-&gt;size() &lt;&lt; <span class="stringliteral">&quot; vs. &quot;</span> &lt;&lt; tradeCount);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> [tradeId, trade] : portfolio-&gt;trades()) {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>        Real fx = 1.0;</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>        <span class="keywordflow">if</span> (trade-&gt;npvCurrency() != <span class="stringliteral">&quot;EUR&quot;</span>) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            <span class="keywordtype">string</span> ccyPair = trade-&gt;npvCurrency() + baseCcy;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            fx = initMarket-&gt;fxRate(ccyPair)-&gt;value();</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>        BOOST_CHECK_MESSAGE(std::fabs(baseManualPv[tradeId] - (fx * trade-&gt;instrument()-&gt;NPV())) &lt;= basePvTol,</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>                            <span class="stringliteral">&quot;Equality error for trade &quot;</span> &lt;&lt; tradeId &lt;&lt; <span class="stringliteral">&quot;; got &quot;</span> &lt;&lt; (fx * trade-&gt;instrument()-&gt;NPV())</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                                                        &lt;&lt; <span class="stringliteral">&quot;, but expected &quot;</span> &lt;&lt; baseManualPv[tradeId]);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>}</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>} <span class="comment">// namespace</span></div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacetestsuite.html">testsuite</a> {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno"><a class="line" href="classtestsuite_1_1_par_sensitivity_analysis_manual_test.html#a42cf0fd677773cdd75e7c048ed01eeb1">  171</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classtestsuite_1_1_par_sensitivity_analysis_manual_test.html#a42cf0fd677773cdd75e7c048ed01eeb1">ParSensitivityAnalysisManualTest::testParSwapBenchmark</a>() {</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Testing swap par sensitivities against manual bump of par curve instruments&quot;</span>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    SavedSettings backup;</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <a class="code hl_enumeration" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ObservationMode::Mode</a> backupMode = ObservationMode::instance().mode();</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <a class="code hl_enumeration" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ObservationMode::Mode</a> om = ObservationMode::Mode::None;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    ObservationMode::instance().setMode(om);</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span> </div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    Date today = Date(14, April, 2016); <span class="comment">// Settings::instance().evaluationDate();</span></div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    Settings::instance().evaluationDate() = today;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Today is &quot;</span> &lt;&lt; today);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// build model</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <span class="keywordtype">string</span> baseCcy = <span class="stringliteral">&quot;EUR&quot;</span>;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    vector&lt;string&gt; ccys;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    ccys.push_back(baseCcy);</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    ccys.push_back(<span class="stringliteral">&quot;GBP&quot;</span>);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    ccys.push_back(<span class="stringliteral">&quot;CHF&quot;</span>);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    ccys.push_back(<span class="stringliteral">&quot;USD&quot;</span>);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    ccys.push_back(<span class="stringliteral">&quot;JPY&quot;</span>);</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="comment">// Init market</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    QuantLib::ext::shared_ptr&lt;Market&gt; initMarket = QuantLib::ext::make_shared&lt;TestMarketParCurves&gt;(today);</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="comment">// build scenario sim market parameters</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>    QuantLib::ext::shared_ptr&lt;ore::analytics::ScenarioSimMarketParameters&gt; simMarketData =</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <a class="code hl_function" href="classtestsuite_1_1_test_configuration_objects.html#ace301b42c3a496e6856fd9cdcc5787b2">TestConfigurationObjects::setupSimMarketData</a>(<span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="comment">// sensitivity config</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    QuantLib::ext::shared_ptr&lt;SensitivityScenarioData&gt; sensiData =</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        <a class="code hl_function" href="classtestsuite_1_1_test_configuration_objects.html#a1783ee5d6a57f475a7f800305381e9f6">TestConfigurationObjects::setupSensitivityScenarioData</a>(<span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="comment">// build porfolio</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    QuantLib::ext::shared_ptr&lt;EngineData&gt; engineData = QuantLib::ext::make_shared&lt;EngineData&gt;();</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    engineData-&gt;model(<span class="stringliteral">&quot;Swap&quot;</span>) = <span class="stringliteral">&quot;DiscountedCashflows&quot;</span>;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    engineData-&gt;engine(<span class="stringliteral">&quot;Swap&quot;</span>) = <span class="stringliteral">&quot;DiscountingSwapEngine&quot;</span>;</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    engineData-&gt;model(<span class="stringliteral">&quot;CrossCurrencySwap&quot;</span>) = <span class="stringliteral">&quot;DiscountedCashflows&quot;</span>;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    engineData-&gt;engine(<span class="stringliteral">&quot;CrossCurrencySwap&quot;</span>) = <span class="stringliteral">&quot;DiscountingCrossCurrencySwapEngine&quot;</span>;</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    engineData-&gt;model(<span class="stringliteral">&quot;EuropeanSwaption&quot;</span>) = <span class="stringliteral">&quot;BlackBachelier&quot;</span>;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    engineData-&gt;engine(<span class="stringliteral">&quot;EuropeanSwaption&quot;</span>) = <span class="stringliteral">&quot;BlackBachelierSwaptionEngine&quot;</span>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    engineData-&gt;model(<span class="stringliteral">&quot;FxForward&quot;</span>) = <span class="stringliteral">&quot;DiscountedCashflows&quot;</span>;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    engineData-&gt;engine(<span class="stringliteral">&quot;FxForward&quot;</span>) = <span class="stringliteral">&quot;DiscountingFxForwardEngine&quot;</span>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    engineData-&gt;model(<span class="stringliteral">&quot;FxOption&quot;</span>) = <span class="stringliteral">&quot;GarmanKohlhagen&quot;</span>;</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    engineData-&gt;engine(<span class="stringliteral">&quot;FxOption&quot;</span>) = <span class="stringliteral">&quot;AnalyticEuropeanEngine&quot;</span>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    engineData-&gt;model(<span class="stringliteral">&quot;CapFloor&quot;</span>) = <span class="stringliteral">&quot;IborCapModel&quot;</span>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    engineData-&gt;engine(<span class="stringliteral">&quot;CapFloor&quot;</span>) = <span class="stringliteral">&quot;IborCapEngine&quot;</span>;</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    engineData-&gt;model(<span class="stringliteral">&quot;CapFlooredIborLeg&quot;</span>) = <span class="stringliteral">&quot;BlackOrBachelier&quot;</span>;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    engineData-&gt;engine(<span class="stringliteral">&quot;CapFlooredIborLeg&quot;</span>) = <span class="stringliteral">&quot;BlackIborCouponPricer&quot;</span>;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    engineData-&gt;model(<span class="stringliteral">&quot;CreditDefaultSwap&quot;</span>) = <span class="stringliteral">&quot;DiscountedCashflows&quot;</span>;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    engineData-&gt;engine(<span class="stringliteral">&quot;CreditDefaultSwap&quot;</span>) = <span class="stringliteral">&quot;MidPointCdsEngine&quot;</span>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    engineData-&gt;model(<span class="stringliteral">&quot;IndexCreditDefaultSwapOption&quot;</span>) = <span class="stringliteral">&quot;Black&quot;</span>;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    engineData-&gt;engine(<span class="stringliteral">&quot;IndexCreditDefaultSwapOption&quot;</span>) = <span class="stringliteral">&quot;BlackIndexCdsOptionEngine&quot;</span>;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    map&lt;string, string&gt; engineParamMap1;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    engineParamMap1[<span class="stringliteral">&quot;Curve&quot;</span>] = <span class="stringliteral">&quot;Underlying&quot;</span>;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    engineData-&gt;engineParameters(<span class="stringliteral">&quot;IndexCreditDefaultSwapOption&quot;</span>) = engineParamMap1;</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span> </div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    engineData-&gt;model(<span class="stringliteral">&quot;IndexCreditDefaultSwap&quot;</span>) = <span class="stringliteral">&quot;DiscountedCashflows&quot;</span>;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    engineData-&gt;engine(<span class="stringliteral">&quot;IndexCreditDefaultSwap&quot;</span>) = <span class="stringliteral">&quot;MidPointIndexCdsEngine&quot;</span>;</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    map&lt;string, string&gt; engineParamMap2;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    engineParamMap2[<span class="stringliteral">&quot;Curve&quot;</span>] = <span class="stringliteral">&quot;Underlying&quot;</span>;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    engineData-&gt;engineParameters(<span class="stringliteral">&quot;IndexCreditDefaultSwap&quot;</span>) = engineParamMap2;</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    engineData-&gt;model(<span class="stringliteral">&quot;CMS&quot;</span>) = <span class="stringliteral">&quot;LinearTSR&quot;</span>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    engineData-&gt;engine(<span class="stringliteral">&quot;CMS&quot;</span>) = <span class="stringliteral">&quot;LinearTSRPricer&quot;</span>;</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    map&lt;string, string&gt; engineparams;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    engineparams[<span class="stringliteral">&quot;MeanReversion&quot;</span>] = <span class="stringliteral">&quot;0.0&quot;</span>;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    engineparams[<span class="stringliteral">&quot;Policy&quot;</span>] = <span class="stringliteral">&quot;RateBound&quot;</span>;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    engineparams[<span class="stringliteral">&quot;LowerRateBoundNormal&quot;</span>] = <span class="stringliteral">&quot;-2.0000&quot;</span>;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    engineparams[<span class="stringliteral">&quot;UpperRateBoundNormal&quot;</span>] = <span class="stringliteral">&quot;2.0000&quot;</span>;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    engineData-&gt;engineParameters(<span class="stringliteral">&quot;CMS&quot;</span>) = engineparams;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    engineData-&gt;model(<span class="stringliteral">&quot;SyntheticCDO&quot;</span>) = <span class="stringliteral">&quot;GaussCopula&quot;</span>;</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    engineData-&gt;engine(<span class="stringliteral">&quot;SyntheticCDO&quot;</span>) = <span class="stringliteral">&quot;Bucketing&quot;</span>;</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    map&lt;string, string&gt; modelParamMap3;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    map&lt;string, string&gt; engineParamMap3;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    modelParamMap3[<span class="stringliteral">&quot;correlation&quot;</span>] = <span class="stringliteral">&quot;0.0&quot;</span>;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    modelParamMap3[<span class="stringliteral">&quot;min&quot;</span>] = <span class="stringliteral">&quot;-5.0&quot;</span>;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    modelParamMap3[<span class="stringliteral">&quot;max&quot;</span>] = <span class="stringliteral">&quot;5.0&quot;</span>;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    modelParamMap3[<span class="stringliteral">&quot;steps&quot;</span>] = <span class="stringliteral">&quot;64&quot;</span>;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    engineParamMap3[<span class="stringliteral">&quot;buckets&quot;</span>] = <span class="stringliteral">&quot;200&quot;</span>;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    engineParamMap3[<span class="stringliteral">&quot;homogeneousPoolWhenJustified&quot;</span>] = <span class="stringliteral">&quot;N&quot;</span>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    engineData-&gt;modelParameters(<span class="stringliteral">&quot;SyntheticCDO&quot;</span>) = modelParamMap3;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    engineData-&gt;engineParameters(<span class="stringliteral">&quot;SyntheticCDO&quot;</span>) = engineParamMap3;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span> </div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    engineData-&gt;model(<span class="stringliteral">&quot;EquityOption&quot;</span>) = <span class="stringliteral">&quot;BlackScholesMerton&quot;</span>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    engineData-&gt;engine(<span class="stringliteral">&quot;EquityOption&quot;</span>) = <span class="stringliteral">&quot;AnalyticEuropeanEngine&quot;</span>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    std::vector&lt;QuantLib::ext::shared_ptr&lt;EngineBuilder&gt;&gt; builders;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="comment">// builders.push_back(QuantLib::ext::make_shared&lt;oreplus::data::MidPointIndexCdsEngineBuilder&gt;());</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="comment">// builders.push_back(QuantLib::ext::make_shared&lt;oreplus::data::BlackIndexCdsOptionEngineBuilder&gt;());</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    builders.push_back(QuantLib::ext::make_shared&lt;ore::data::GaussCopulaBucketingCdoEngineBuilder&gt;());</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span> </div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    QuantLib::ext::shared_ptr&lt;EngineFactory&gt; factory = registerBuilders(engineData, initMarket);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    QuantLib::ext::shared_ptr&lt;Portfolio&gt; portfolio(<span class="keyword">new</span> <a class="code hl_classRef" href="../ored/classore_1_1data_1_1_portfolio.html">Portfolio</a>());</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    QuantLib::ext::shared_ptr&lt;Conventions&gt; conventions = InstrumentConventions::instance().conventions();</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    QuantLib::ext::shared_ptr&lt;IRSwapConvention&gt; eurConv =</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        QuantLib::ext::dynamic_pointer_cast&lt;IRSwapConvention&gt;(conventions-&gt;get(<span class="stringliteral">&quot;EUR-6M-SWAP-CONVENTIONS&quot;</span>));</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="keywordtype">string</span> eurIdx = <span class="stringliteral">&quot;EUR-EURIBOR-6M&quot;</span>;</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    Period eurFloatTenor = initMarket-&gt;iborIndex(eurIdx)-&gt;tenor();</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    QuantLib::ext::shared_ptr&lt;IRSwapConvention&gt; usdConv =</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>        QuantLib::ext::dynamic_pointer_cast&lt;IRSwapConvention&gt;(conventions-&gt;get(<span class="stringliteral">&quot;USD-6M-SWAP-CONVENTIONS&quot;</span>));</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    <span class="keywordtype">string</span> usdIdx = <span class="stringliteral">&quot;USD-LIBOR-6M&quot;</span>;</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    Period usdFloatTenor = initMarket-&gt;iborIndex(usdIdx)-&gt;tenor();</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    QuantLib::ext::shared_ptr&lt;IRSwapConvention&gt; jpyConv =</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>        QuantLib::ext::dynamic_pointer_cast&lt;IRSwapConvention&gt;(conventions-&gt;get(<span class="stringliteral">&quot;JPY-6M-SWAP-CONVENTIONS&quot;</span>));</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="keywordtype">string</span> jpyIdx = <span class="stringliteral">&quot;JPY-LIBOR-6M&quot;</span>;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    Period jpyFloatTenor = initMarket-&gt;iborIndex(jpyIdx)-&gt;tenor();</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    QuantLib::ext::shared_ptr&lt;CrossCcyBasisSwapConvention&gt; chfBasisConv =</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        QuantLib::ext::dynamic_pointer_cast&lt;CrossCcyBasisSwapConvention&gt;(conventions-&gt;get(<span class="stringliteral">&quot;CHF-XCCY-BASIS-CONVENTIONS&quot;</span>));</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    QuantLib::ext::shared_ptr&lt;CdsConvention&gt; cdsConv =</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        QuantLib::ext::dynamic_pointer_cast&lt;CdsConvention&gt;(conventions-&gt;get(<span class="stringliteral">&quot;CDS-STANDARD-CONVENTIONS&quot;</span>));</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keywordtype">string</span> chfIdx = chfBasisConv-&gt;spreadIndexName();</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordtype">string</span> otherIdx = chfBasisConv-&gt;flatIndexName();</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    Period chfFloatTenor = initMarket-&gt;iborIndex(chfIdx)-&gt;tenor();</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    Period otherFloatTenor = initMarket-&gt;iborIndex(otherIdx)-&gt;tenor();</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a54c1b35c30d28826bf94589a5e9d09d6">buildSwap</a>(</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="stringliteral">&quot;1_Swap_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="keyword">true</span>, 10000000.0, 0, 10, 0.02, 0.00,</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(eurConv-&gt;fixedFrequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(eurConv-&gt;fixedDayCounter()),</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(eurFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, eurIdx, eurConv-&gt;fixedCalendar(),</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        initMarket-&gt;iborIndex(eurIdx)-&gt;fixingDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a54c1b35c30d28826bf94589a5e9d09d6">buildSwap</a>(</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>        <span class="stringliteral">&quot;2_Swap_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="keyword">true</span>, 10000000.0, 0, 15, 0.03, 0.00,</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(usdConv-&gt;fixedFrequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(usdConv-&gt;fixedDayCounter()),</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(usdFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, usdIdx, usdConv-&gt;fixedCalendar(),</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        initMarket-&gt;iborIndex(usdIdx)-&gt;fixingDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a34c5d7d98beb7ce810dffd5e338254cf">buildCap</a>(</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>        <span class="stringliteral">&quot;9_Cap_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;Long&quot;</span>, 0.02, 1000000.0, 0, 10, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(eurFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, eurIdx,</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>        eurConv-&gt;fixedCalendar(), initMarket-&gt;iborIndex(eurIdx)-&gt;fixingDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a9d40203e41af32fc4c5302ecd279e555">buildFloor</a>(</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        <span class="stringliteral">&quot;10_Floor_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;Long&quot;</span>, 0.03, 1000000.0, 0, 10, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(usdFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, usdIdx,</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>        usdConv-&gt;fixedCalendar(), initMarket-&gt;iborIndex(usdIdx)-&gt;fixingDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a54c1b35c30d28826bf94589a5e9d09d6">buildSwap</a>(</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>        <span class="stringliteral">&quot;3_Swap_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="keyword">false</span>, 10000000.0, 1, 12, 0.025, 0.00,</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(eurConv-&gt;fixedFrequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(eurConv-&gt;fixedDayCounter()),</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(eurFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, eurIdx, eurConv-&gt;fixedCalendar(),</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>        initMarket-&gt;iborIndex(eurIdx)-&gt;fixingDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#ac2a5b766f72a055ad2c9e5422959dbc2">buildCrossCcyBasisSwap</a>(</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        <span class="stringliteral">&quot;4_XCCY_SWAP&quot;</span>, <span class="stringliteral">&quot;CHF&quot;</span>, 10000000, <span class="stringliteral">&quot;EUR&quot;</span>, 10000000, 0, 15, 0.0000, 0.0000, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(chfFloatTenor),</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        <span class="stringliteral">&quot;A360&quot;</span>, chfIdx, chfBasisConv-&gt;settlementCalendar(), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(otherFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, otherIdx,</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        chfBasisConv-&gt;settlementCalendar(), chfBasisConv-&gt;settlementDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#ac2a5b766f72a055ad2c9e5422959dbc2">buildCrossCcyBasisSwap</a>(</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="stringliteral">&quot;5_XCCY_SWAP_WithPrincipal&quot;</span>, <span class="stringliteral">&quot;CHF&quot;</span>, 10000000, <span class="stringliteral">&quot;EUR&quot;</span>, 10000000, 0, 15, 0.0000, 0.0000,</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(chfFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, chfIdx, chfBasisConv-&gt;settlementCalendar(),</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(otherFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, otherIdx, chfBasisConv-&gt;settlementCalendar(),</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        chfBasisConv-&gt;settlementDays(), <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a54c1b35c30d28826bf94589a5e9d09d6">buildSwap</a>(</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="stringliteral">&quot;6_Swap_JPY&quot;</span>, <span class="stringliteral">&quot;JPY&quot;</span>, <span class="keyword">true</span>, 1000000000.0, 0, 10, 0.005, 0.00,</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(jpyConv-&gt;fixedFrequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(jpyConv-&gt;fixedDayCounter()),</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(jpyFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, jpyIdx, jpyConv-&gt;fixedCalendar(),</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>        initMarket-&gt;iborIndex(jpyIdx)-&gt;fixingDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#ac2a5b766f72a055ad2c9e5422959dbc2">buildCrossCcyBasisSwap</a>(</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="stringliteral">&quot;7_XCCY_SWAP_OffMarket&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, 10000000, <span class="stringliteral">&quot;CHF&quot;</span>, 10500000, 0, 15, 0.0000, 0.0010,</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(chfFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, chfIdx, chfBasisConv-&gt;settlementCalendar(),</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(otherFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, otherIdx, chfBasisConv-&gt;settlementCalendar(),</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        chfBasisConv-&gt;settlementDays(), <span class="keyword">true</span>));</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#ac2a5b766f72a055ad2c9e5422959dbc2">buildCrossCcyBasisSwap</a>(</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        <span class="stringliteral">&quot;8_XCCY_SWAP_RESET&quot;</span>, <span class="stringliteral">&quot;CHF&quot;</span>, 10000000, <span class="stringliteral">&quot;EUR&quot;</span>, 10000000, 0, 15, 0.0000, 0.0000,</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(chfFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, chfIdx, chfBasisConv-&gt;settlementCalendar(),</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(otherFloatTenor), <span class="stringliteral">&quot;A360&quot;</span>, otherIdx, chfBasisConv-&gt;settlementCalendar(),</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>        chfBasisConv-&gt;settlementDays(), <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>));</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(<span class="stringliteral">&quot;9_CDS_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 15, 0.4,</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>                                          0.009, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())),</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>                                          <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        <span class="stringliteral">&quot;9_CDS_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 15, 0.4, 0.009,</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <span class="stringliteral">&quot;10_CDS_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 10, 0.4, 0.001,</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        <span class="stringliteral">&quot;10_CDS_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 10, 0.4, 0.001,</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        <span class="stringliteral">&quot;11_CDS_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 5, 0.4, 0.001,</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(<span class="stringliteral">&quot;11_CDS_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 5, 0.4,</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>                                          0.001, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())),</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>                                          <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(<span class="stringliteral">&quot;12_CDS_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 2, 0.4,</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>                                          0.004, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())),</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>                                          <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>        <span class="stringliteral">&quot;12_CDS_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 2, 0.4, 0.001,</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>        <span class="stringliteral">&quot;13_CDS_USD&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="stringliteral">&quot;dc&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 15, 0.4, 0.001,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">buildCreditDefaultSwap</a>(</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>        <span class="stringliteral">&quot;13_CDS_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="keyword">true</span>, 10000000, 0, 15, 0.4, 0.001,</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(cdsConv-&gt;frequency())), <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(cdsConv-&gt;dayCounter())));</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    vector&lt;string&gt; names = {<span class="stringliteral">&quot;dc&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, <span class="stringliteral">&quot;dc3&quot;</span>};</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    vector&lt;string&gt; indexCcys = {<span class="stringliteral">&quot;USD&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;GBP&quot;</span>};</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    vector&lt;Real&gt; notionals = {3000000, 3000000, 3000000};</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    <span class="comment">// portfolio-&gt;add(buildIndexCdsOption(&quot;14_IndexCDSOption_USD&quot;, &quot;dc&quot;, names, &quot;Long&quot;, &quot;USD&quot;,</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="comment">// indexCcys, true, notionals, notional, 1, 4,</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="comment">//                                                         0.4, 0.001,</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    <span class="comment">//                                                         ore::data::to_string(Period(cdsConv-&gt;frequency())),</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="comment">//                                                        ore::data::to_string(cdsConv-&gt;dayCounter()), &quot;Physical&quot;));</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>    vector&lt;string&gt; names2(1, <span class="stringliteral">&quot;dc2&quot;</span>);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    vector&lt;string&gt; indexCcys2(1, <span class="stringliteral">&quot;EUR&quot;</span>);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    vector&lt;Real&gt; notionals2(1, 10000000.0);</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="comment">// portfolio-&gt;add(buildIndexCdsOption(&quot;15_IndexCDSOption_EUR&quot;, &quot;dc2&quot;, names2, &quot;Long&quot;, &quot;EUR&quot;,</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>    <span class="comment">// indexCcys2, true, notionals2, 10000000.0, 1, 4,</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>    <span class="comment">//                                                       0.4, 0.001,</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="comment">//                                                       ore::data::to_string(Period(cdsConv-&gt;frequency())),</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    <span class="comment">//                                                       ore::data::to_string(cdsConv-&gt;dayCounter()), &quot;Physical&quot;));</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a2ac80e4a53d263f698aa59023f495793">buildSyntheticCDO</a>(<span class="stringliteral">&quot;16_SyntheticCDO_EUR&quot;</span>, <span class="stringliteral">&quot;dc2&quot;</span>, names2, <span class="stringliteral">&quot;Long&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, indexCcys2,</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>                                     <span class="keyword">true</span>, notionals2, 1000000.0, 0, 5, 0.03, 0.01, <span class="stringliteral">&quot;1Y&quot;</span>, <span class="stringliteral">&quot;30/360&quot;</span>));</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span> </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a4d68ff04890ebe5c7caca44a26220e95">buildCmsCapFloor</a>(<span class="stringliteral">&quot;17_CMS_EUR&quot;</span>, <span class="stringliteral">&quot;EUR&quot;</span>, <span class="stringliteral">&quot;EUR-CMS-30Y&quot;</span>, <span class="keyword">true</span>, 2000000, 0, 5, 0.0, 1,</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>                                    0.0, <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(Period(eurConv-&gt;fixedFrequency())),</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>                                    <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(eurConv-&gt;fixedDayCounter())));</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    portfolio-&gt;add(</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        <a class="code hl_function" href="namespacetestsuite.html#a9b18c17163d82e3fcbd2eeaec95a994f">buildEquityOption</a>(<span class="stringliteral">&quot;18_EquityOption_SP5&quot;</span>, <span class="stringliteral">&quot;Long&quot;</span>, <span class="stringliteral">&quot;Call&quot;</span>, 2, <span class="stringliteral">&quot;SP5&quot;</span>, <span class="stringliteral">&quot;USD&quot;</span>, 2147.56, 775));</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#a923774110a26dd77813d14563d295373">buildCPIInflationSwap</a>(<span class="stringliteral">&quot;19_CPIInflationSwap_UKRPI&quot;</span>, <span class="stringliteral">&quot;GBP&quot;</span>, <span class="keyword">true</span>, 100000.0, 0, 10,</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>                                         0.0, <span class="stringliteral">&quot;6M&quot;</span>, <span class="stringliteral">&quot;ACT/ACT&quot;</span>, <span class="stringliteral">&quot;GBP-LIBOR-6M&quot;</span>, <span class="stringliteral">&quot;1Y&quot;</span>, <span class="stringliteral">&quot;ACT/ACT&quot;</span>,</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>                                         <span class="stringliteral">&quot;UKRPI&quot;</span>, 201.0, <span class="stringliteral">&quot;2M&quot;</span>, <span class="keyword">false</span>, 0.005));</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    portfolio-&gt;add(<a class="code hl_function" href="namespacetestsuite.html#ac3993b76e18d799583bfce39846a37e2">buildYYInflationSwap</a>(<span class="stringliteral">&quot;20_YoYInflationSwap_UKRPI&quot;</span>, <span class="stringliteral">&quot;GBP&quot;</span>, <span class="keyword">true</span>, 100000.0, 0, 10,</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>                                        0.0, <span class="stringliteral">&quot;1Y&quot;</span>, <span class="stringliteral">&quot;ACT/ACT&quot;</span>, <span class="stringliteral">&quot;GBP-LIBOR-6M&quot;</span>, <span class="stringliteral">&quot;1Y&quot;</span>, <span class="stringliteral">&quot;ACT/ACT&quot;</span>,</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>                                        <span class="stringliteral">&quot;UKRPI&quot;</span>, <span class="stringliteral">&quot;2M&quot;</span>, 2));</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span> </div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    Size tradeCount = portfolio-&gt;size();</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    portfolio-&gt;build(factory);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    BOOST_CHECK_MESSAGE(portfolio-&gt;size() == tradeCount,</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>                        <span class="stringliteral">&quot;Some trades not built correctly,&quot;</span> &lt;&lt; portfolio-&gt;size() &lt;&lt; <span class="stringliteral">&quot; vs. &quot;</span> &lt;&lt; tradeCount);</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    <span class="comment">// build the sensitivity analysis object</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    QuantLib::ext::shared_ptr&lt;SensitivityAnalysis&gt; zeroAnalysis =</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        QuantLib::ext::make_shared&lt;SensitivityAnalysis&gt;(portfolio, initMarket, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, engineData,</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                                                simMarketData, sensiData,</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>                                                <span class="keyword">false</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">false</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    <a class="code hl_class" href="classore_1_1analytics_1_1_par_sensitivity_analysis.html">ParSensitivityAnalysis</a> parAnalysis(today, simMarketData, *sensiData, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    parAnalysis.<a class="code hl_function" href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#a28915bb1dca6668799c336ea3a953e45">alignPillars</a>();</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    zeroAnalysis-&gt;overrideTenors(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    zeroAnalysis-&gt;generateSensitivities();</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    parAnalysis.<a class="code hl_function" href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#abdae52d1591db2caae3d1ceb4f42fba4">computeParInstrumentSensitivities</a>(zeroAnalysis-&gt;simMarket());</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    QuantLib::ext::shared_ptr&lt;ParSensitivityConverter&gt; parConverter =</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>        QuantLib::ext::make_shared&lt;ParSensitivityConverter&gt;(parAnalysis.<a class="code hl_function" href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#a8092eccb5ce3a742bec7c90e7599fe71">parSensitivities</a>(), parAnalysis.<a class="code hl_function" href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#ab397fee73d59f20038b686d3eeff9af3">shiftSizes</a>());</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    QuantLib::ext::shared_ptr&lt;SensitivityCube&gt; sensiCube = zeroAnalysis-&gt;sensiCube();</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <a class="code hl_class" href="classore_1_1analytics_1_1_zero_to_par_cube.html">ZeroToParCube</a> parCube(sensiCube, parConverter);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span> </div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    std::map&lt;std::pair&lt;std::string, std::string&gt;, Real&gt; parDelta;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    std::map&lt;std::pair&lt;std::string, std::string&gt;, Real&gt; zeroDelta;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    map&lt;string, Real&gt; baseManualPv;</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    map&lt;string, Real&gt; basePv;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; tradeId : portfolio-&gt;ids()) {</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        basePv[tradeId] = sensiCube-&gt;npv(tradeId);</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; f : sensiCube-&gt;factors()) {</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>            <span class="keywordtype">string</span> des = sensiCube-&gt;factorDescription(f);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>            zeroDelta[make_pair(tradeId, des)] = sensiCube-&gt;delta(tradeId, f);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>        }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>        <span class="comment">// Fill the par deltas map</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>        <span class="keyword">auto</span> temp = parCube.<a class="code hl_function" href="classore_1_1analytics_1_1_zero_to_par_cube.html#a6007c0f20ea89d5d2db573b08db43009">parDeltas</a>(tradeId);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; kv : temp) {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>            <span class="keywordtype">string</span> des = sensiCube-&gt;factorDescription(kv.first);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>            parDelta[make_pair(tradeId, des)] = kv.second;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>        }</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    }</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    QuantLib::ext::shared_ptr&lt;EngineFactory&gt; manualFactory = registerBuilders(engineData, initMarket);</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span> </div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    portfolio-&gt;reset();</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    portfolio-&gt;build(manualFactory);</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> [tradeId, trade] : portfolio-&gt;trades()) {</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        Real fx = 1.0;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        <span class="keywordflow">if</span> (trade-&gt;npvCurrency() != <span class="stringliteral">&quot;EUR&quot;</span>) {</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>            <span class="keywordtype">string</span> ccyPair = trade-&gt;npvCurrency() + baseCcy;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>            fx = initMarket-&gt;fxRate(ccyPair)-&gt;value();</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>        }</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>        baseManualPv[tradeId] = fx * trade-&gt;instrument()-&gt;NPV();</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>        Real tradeNotional = fx * trade-&gt;notional();</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        Real simMarketTol =</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>            1.e-5 * tradeNotional; <span class="comment">// tolerance for difference to sim market is 0.1bp upfront (should this be tightened?)</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>        BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Base PV check for trade &quot;</span> &lt;&lt; tradeId &lt;&lt; <span class="stringliteral">&quot;; got &quot;</span> &lt;&lt; baseManualPv[tradeId]</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>                                                      &lt;&lt; <span class="stringliteral">&quot;, expected &quot;</span> &lt;&lt; basePv[tradeId]);</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        BOOST_CHECK_MESSAGE(std::fabs(baseManualPv[tradeId] - basePv[tradeId]) &lt; simMarketTol,</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>                            <span class="stringliteral">&quot;Base PV check error for trade &quot;</span> &lt;&lt; tradeId &lt;&lt; <span class="stringliteral">&quot;; got &quot;</span> &lt;&lt; baseManualPv[tradeId]</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>                                                             &lt;&lt; <span class="stringliteral">&quot;, but expected &quot;</span> &lt;&lt; basePv[tradeId]);</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    QuantLib::ext::shared_ptr&lt;TestMarketParCurves&gt; initParMarket = QuantLib::ext::dynamic_pointer_cast&lt;TestMarketParCurves&gt;(initMarket);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    BOOST_ASSERT(initParMarket);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing discount curve par sensis&quot;</span>);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    <span class="comment">// the discount curve par sensis</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;discountRateHelpersInstMap()) {</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <span class="keywordtype">string</span> ccy = d_it.first;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;discountCurveShiftData()[ccy]-&gt;shiftSize;</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;discountCurveShiftData()[ccy]-&gt;shiftType;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;discountRateHelperTenorsMap().find(ccy)-&gt;second;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;discountRateHelperValuesMap().find(ccy)-&gt;second;</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>            sensiLabels[i] = <span class="stringliteral">&quot;DiscountCurve/&quot;</span> + ccy + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        }</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>                             shiftSize, shiftType, parDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    }</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing index curve par sensis&quot;</span>);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="comment">// the index curve par sensis</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;indexCurveRateHelperInstMap()) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keywordtype">string</span> idxName = d_it.first;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>        BOOST_TEST_MESSAGE(idxName);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keyword">auto</span> itr = zeroAnalysis-&gt;sensitivityData()-&gt;indexCurveShiftData().find(idxName);</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="keywordflow">if</span> (itr == zeroAnalysis-&gt;sensitivityData()-&gt;indexCurveShiftData().end())</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            zeroAnalysis-&gt;sensitivityData()-&gt;indexCurveShiftData()[idxName] =</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>                QuantLib::ext::make_shared&lt;SensitivityScenarioData::CurveShiftData&gt;();</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;indexCurveShiftData()[idxName]-&gt;shiftSize;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;indexCurveShiftData()[idxName]-&gt;shiftType;</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;indexCurveRateHelperTenorsMap().find(idxName)-&gt;second;</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;indexCurveRateHelperValuesMap().find(idxName)-&gt;second;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>            sensiLabels[i] = <span class="stringliteral">&quot;IndexCurve/&quot;</span> + idxName + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>        }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                             shiftSize, shiftType, parDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    }</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing default curve par sensis&quot;</span>);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <span class="comment">// the default curve par sensis</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;defaultRateHelpersInstMap()) {</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = d_it.first;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        <span class="keyword">auto</span> itr = zeroAnalysis-&gt;sensitivityData()-&gt;creditCurveShiftData().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        <span class="keywordflow">if</span> (itr == zeroAnalysis-&gt;sensitivityData()-&gt;creditCurveShiftData().end())</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>            zeroAnalysis-&gt;sensitivityData()-&gt;creditCurveShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>] =</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                QuantLib::ext::make_shared&lt;SensitivityScenarioData::CurveShiftData&gt;();</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;creditCurveShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>]-&gt;shiftSize;</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;creditCurveShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>]-&gt;shiftType;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;defaultRateHelperTenorsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;defaultRateHelperValuesMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>            sensiLabels[i] = <span class="stringliteral">&quot;SurvivalProbability/&quot;</span> + <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        }</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>                             shiftSize, shiftType, parDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>    }</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing cds par sensis&quot;</span>);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <span class="comment">// CDS Vol sensis (compare with zero sensi)</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;cdsVolRateHelperValuesMap()) {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = d_it.first;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;cdsVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftSize;</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;cdsVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftType;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;cdsVolRateHelperTenorsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;cdsVolRateHelperValuesMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            sensiLabels[i] = <span class="stringliteral">&quot;CDSVolatility/&quot;</span> + <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]) + <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>        }</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>                             shiftSize, shiftType, zeroDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    }</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing eqVol curve par sensis&quot;</span>);</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    <span class="comment">// Equity Vol sensis (compare with zero sensi)</span></div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;equityVolRateHelperValuesMap()) {</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = d_it.first;</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;equityVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftSize;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;equityVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftType;</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;equityVolRateHelperTenorsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;equityVolRateHelperValuesMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>            sensiLabels[i] = <span class="stringliteral">&quot;EquityVolatility/&quot;</span> + <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]) + <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        }</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>                             shiftSize, shiftType, zeroDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    }</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing swaption vol par sensis&quot;</span>);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    <span class="comment">// Swaption Vol sensis (compare with zero sensi)</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;swaptionVolRateHelperValuesMap()) {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = d_it.first;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;swaptionVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftSize;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;swaptionVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftType;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;swaptionVolRateHelperTenorsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        vector&lt;Period&gt; swapTenorVec = initParMarket-&gt;swaptionVolRateHelperSwapTenorsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>        vector&lt;Real&gt; strikeSpreadVec = zeroAnalysis-&gt;sensitivityData()-&gt;swaptionVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftStrikes;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;swaptionVolRateHelperValuesMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>        Size j = swapTenorVec.size();</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        Size k = zeroAnalysis-&gt;sensitivityData()-&gt;swaptionVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftStrikes.size();</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span> </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>            Size strike = i % k;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            Size parTenor = i / (j * k);</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>            Size swapTenor = (i - parTenor * j * k - strike) / k;</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>            std::ostringstream o;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            <span class="keywordflow">if</span> (<a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(strikeSpreadVec[strike], 0))</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>                o &lt;&lt; <span class="stringliteral">&quot;SwaptionVolatility/&quot;</span> &lt;&lt; <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; parTenorVec[parTenor] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span></div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>                  &lt;&lt; swapTenorVec[swapTenor] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>            <span class="keywordflow">else</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                o &lt;&lt; <span class="stringliteral">&quot;SwaptionVolatility/&quot;</span> &lt;&lt; <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; parTenorVec[parTenor] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>                  &lt;&lt; swapTenorVec[swapTenor] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; std::setprecision(4) &lt;&lt; strikeSpreadVec[strike];</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>            sensiLabels[i] = o.str();</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        }</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>                             shiftSize, shiftType, zeroDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing base correlation par sensis&quot;</span>);</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <span class="comment">// Base correlations sensis (compare with zero sensi)</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;baseCorrRateHelperValuesMap()) {</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = d_it.first;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;baseCorrelationShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftSize;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;baseCorrelationShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>].shiftType;</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;baseCorrRateHelperTenorsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        vector&lt;string&gt; lossLevelVec = initParMarket-&gt;baseCorrLossLevelsMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;baseCorrRateHelperValuesMap().find(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>)-&gt;second;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        Size j = lossLevelVec.size();</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>            sensiLabels[i] = <span class="stringliteral">&quot;BaseCorrelation/&quot;</span> + <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + lossLevelVec[i % j] + <span class="stringliteral">&quot;/&quot;</span> +</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>                             <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i / j]);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        }</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                             shiftSize, shiftType, zeroDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>    }</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing zero inflation par sensis&quot;</span>);</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    <span class="comment">// Zero Inflation sensis</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;zeroInflationRateHelperInstMap()) {</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>        <span class="keywordtype">string</span> idxName = d_it.first;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;zeroInflationCurveShiftData()[idxName]-&gt;shiftSize;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;zeroInflationCurveShiftData()[idxName]-&gt;shiftType;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;zeroInflationRateHelperTenorsMap().find(idxName)-&gt;second;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;zeroInflationRateHelperValuesMap().find(idxName)-&gt;second;</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>            sensiLabels[i] = <span class="stringliteral">&quot;ZeroInflationCurve/&quot;</span> + idxName + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>        }</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>                             shiftSize, shiftType, parDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;testing yoy inflation par sensis&quot;</span>);</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <span class="comment">// YoY Inflation sensis</span></div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d_it : initParMarket-&gt;yoyInflationRateHelperInstMap()) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>        <span class="keywordtype">string</span> idxName = d_it.first;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>        Real shiftSize = zeroAnalysis-&gt;sensitivityData()-&gt;yoyInflationCurveShiftData()[idxName]-&gt;shiftSize;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        <a class="code hl_enumeration" href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = zeroAnalysis-&gt;sensitivityData()-&gt;yoyInflationCurveShiftData()[idxName]-&gt;shiftType;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>        vector&lt;Period&gt; parTenorVec = initParMarket-&gt;yoyInflationRateHelperTenorsMap().find(idxName)-&gt;second;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>        vector&lt;Handle&lt;Quote&gt;&gt; parValVecBase = initParMarket-&gt;yoyInflationRateHelperValuesMap().find(idxName)-&gt;second;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        vector&lt;string&gt; sensiLabels(parValVecBase.size());</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; parValVecBase.size(); i++) {</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>            sensiLabels[i] = <span class="stringliteral">&quot;YoYInflationCurve/&quot;</span> + idxName + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(i) + <span class="stringliteral">&quot;/&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">to_string</a>(parTenorVec[i]);</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>        }</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>        parSensiBumpAnalysis(portfolio, engineData, initMarket, baseManualPv, baseCcy, parValVecBase, sensiLabels,</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                             shiftSize, shiftType, parDelta, zeroDelta, basePv);</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    }</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    <span class="comment">// end</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    ObservationMode::instance().setMode(backupMode);</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    IndexManager::instance().clearHistories();</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>}</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>BOOST_FIXTURE_TEST_SUITE(OREAnalyticsTestSuite, <a class="code hl_class" href="classore_1_1test_1_1_orea_top_level_fixture.html">ore::test::OreaTopLevelFixture</a>)</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>BOOST_AUTO_TEST_SUITE(ParSensitivityAnalysisManual)</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno"><a class="line" href="namespacetestsuite.html#a227848f4347cd5ecd5cb75afd62bc23d">  631</a></span><a class="code hl_function" href="namespacetestsuite.html#adeaa61629ab1007d92b9c2c7f5b54ed9">BOOST_AUTO_TEST_CASE</a>(ParSwapBenchmarkTest){ </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Testing ParSwapBenchmark&quot;</span>);</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <a class="code hl_function" href="classtestsuite_1_1_par_sensitivity_analysis_manual_test.html#a42cf0fd677773cdd75e7c048ed01eeb1">ParSensitivityAnalysisManualTest::testParSwapBenchmark</a>();</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>}</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span> </div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>BOOST_AUTO_TEST_SUITE_END()</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span> </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>BOOST_AUTO_TEST_SUITE_END()</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>} <span class="comment">// namespace testsuite</span></div>
<div class="ttc" id="abuilders_2capfloor_8hpp_html"><div class="ttname"><a href="../ored/builders_2capfloor_8hpp.html">capfloor.hpp</a></div></div>
<div class="ttc" id="abuilders_2cdo_8hpp_html"><div class="ttname"><a href="../ored/builders_2cdo_8hpp.html">cdo.hpp</a></div></div>
<div class="ttc" id="abuilders_2equityoption_8hpp_html"><div class="ttname"><a href="../ored/builders_2equityoption_8hpp.html">equityoption.hpp</a></div></div>
<div class="ttc" id="abuilders_2fxforward_8hpp_html"><div class="ttname"><a href="../ored/builders_2fxforward_8hpp.html">fxforward.hpp</a></div></div>
<div class="ttc" id="abuilders_2fxoption_8hpp_html"><div class="ttname"><a href="../ored/builders_2fxoption_8hpp.html">fxoption.hpp</a></div></div>
<div class="ttc" id="abuilders_2swap_8hpp_html"><div class="ttname"><a href="../ored/builders_2swap_8hpp.html">swap.hpp</a></div></div>
<div class="ttc" id="abuilders_2swaption_8hpp_html"><div class="ttname"><a href="../ored/builders_2swaption_8hpp.html">swaption.hpp</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_observation_mode_html_a46c8a310cf4c094f8c80e1cb8dc1f911"><div class="ttname"><a href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ore::analytics::ObservationMode::Mode</a></div><div class="ttdeci">Mode</div><div class="ttdoc">Allowable mode mode.</div><div class="ttdef"><b>Definition:</b> <a href="observationmode_8hpp_source.html#l00044">observationmode.hpp:44</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_par_sensitivity_analysis_html"><div class="ttname"><a href="classore_1_1analytics_1_1_par_sensitivity_analysis.html">ore::analytics::ParSensitivityAnalysis</a></div><div class="ttdoc">Par Sensitivity Analysis.</div><div class="ttdef"><b>Definition:</b> <a href="orea_2engine_2parsensitivityanalysis_8hpp_source.html#l00057">parsensitivityanalysis.hpp:57</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_par_sensitivity_analysis_html_a28915bb1dca6668799c336ea3a953e45"><div class="ttname"><a href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#a28915bb1dca6668799c336ea3a953e45">ore::analytics::ParSensitivityAnalysis::alignPillars</a></div><div class="ttdeci">void alignPillars()</div><div class="ttdoc">align pillars in scenario simulation market parameters with those of the par instruments</div><div class="ttdef"><b>Definition:</b> <a href="orea_2engine_2parsensitivityanalysis_8cpp_source.html#l00482">parsensitivityanalysis.cpp:482</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_par_sensitivity_analysis_html_a8092eccb5ce3a742bec7c90e7599fe71"><div class="ttname"><a href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#a8092eccb5ce3a742bec7c90e7599fe71">ore::analytics::ParSensitivityAnalysis::parSensitivities</a></div><div class="ttdeci">const ParContainer &amp; parSensitivities() const</div><div class="ttdoc">Return computed par sensitivities. Empty if they have not been computed yet.</div><div class="ttdef"><b>Definition:</b> <a href="orea_2engine_2parsensitivityanalysis_8hpp_source.html#l00075">parsensitivityanalysis.hpp:75</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_par_sensitivity_analysis_html_ab397fee73d59f20038b686d3eeff9af3"><div class="ttname"><a href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#ab397fee73d59f20038b686d3eeff9af3">ore::analytics::ParSensitivityAnalysis::shiftSizes</a></div><div class="ttdeci">std::map&lt; ore::analytics::RiskFactorKey, std::pair&lt; QuantLib::Real, QuantLib::Real &gt; &gt; shiftSizes() const</div><div class="ttdoc">Return the zero rate and par rate absolute shift size for each risk factor key.</div><div class="ttdef"><b>Definition:</b> <a href="orea_2engine_2parsensitivityanalysis_8hpp_source.html#l00088">parsensitivityanalysis.hpp:88</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_par_sensitivity_analysis_html_abdae52d1591db2caae3d1ceb4f42fba4"><div class="ttname"><a href="classore_1_1analytics_1_1_par_sensitivity_analysis.html#abdae52d1591db2caae3d1ceb4f42fba4">ore::analytics::ParSensitivityAnalysis::computeParInstrumentSensitivities</a></div><div class="ttdeci">void computeParInstrumentSensitivities(const QuantLib::ext::shared_ptr&lt; ore::analytics::ScenarioSimMarket &gt; &amp;simMarket)</div><div class="ttdoc">Compute par instrument sensitivities.</div><div class="ttdef"><b>Definition:</b> <a href="orea_2engine_2parsensitivityanalysis_8cpp_source.html#l00154">parsensitivityanalysis.cpp:154</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_zero_to_par_cube_html"><div class="ttname"><a href="classore_1_1analytics_1_1_zero_to_par_cube.html">ore::analytics::ZeroToParCube</a></div><div class="ttdoc">ZeroToParCube class.</div><div class="ttdef"><b>Definition:</b> <a href="zerotoparcube_8hpp_source.html#l00038">zerotoparcube.hpp:38</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_zero_to_par_cube_html_a6007c0f20ea89d5d2db573b08db43009"><div class="ttname"><a href="classore_1_1analytics_1_1_zero_to_par_cube.html#a6007c0f20ea89d5d2db573b08db43009">ore::analytics::ZeroToParCube::parDeltas</a></div><div class="ttdeci">std::map&lt; ore::analytics::RiskFactorKey, QuantLib::Real &gt; parDeltas(const std::string &amp;tradeId) const</div><div class="ttdoc">Return the non-zero par deltas for the given tradeId.</div><div class="ttdef"><b>Definition:</b> <a href="zerotoparcube_8cpp_source.html#l00120">zerotoparcube.cpp:120</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_html_ab336651e3455fff1764bf576a5785bbd"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">ore::data::Market::defaultConfiguration</a></div><div class="ttdeci">static const string defaultConfiguration</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_portfolio_html"><div class="ttname"><a href="../ored/classore_1_1data_1_1_portfolio.html">ore::data::Portfolio</a></div></div>
<div class="ttc" id="aclassore_1_1test_1_1_orea_top_level_fixture_html"><div class="ttname"><a href="classore_1_1test_1_1_orea_top_level_fixture.html">ore::test::OreaTopLevelFixture</a></div><div class="ttdoc">OREAnalytics Top level fixture.</div><div class="ttdef"><b>Definition:</b> <a href="oreatoplevelfixture_8hpp_source.html#l00035">oreatoplevelfixture.hpp:35</a></div></div>
<div class="ttc" id="aclasstestsuite_1_1_par_sensitivity_analysis_manual_test_html_a42cf0fd677773cdd75e7c048ed01eeb1"><div class="ttname"><a href="classtestsuite_1_1_par_sensitivity_analysis_manual_test.html#a42cf0fd677773cdd75e7c048ed01eeb1">testsuite::ParSensitivityAnalysisManualTest::testParSwapBenchmark</a></div><div class="ttdeci">static void testParSwapBenchmark()</div><div class="ttdoc">Benchmark par conversion against brute-force bump on the par instruments (&quot;None&quot; observation mode)</div><div class="ttdef"><b>Definition:</b> <a href="parsensitivityanalysismanual_8cpp_source.html#l00171">parsensitivityanalysismanual.cpp:171</a></div></div>
<div class="ttc" id="aclasstestsuite_1_1_test_configuration_objects_html_a1783ee5d6a57f475a7f800305381e9f6"><div class="ttname"><a href="classtestsuite_1_1_test_configuration_objects.html#a1783ee5d6a57f475a7f800305381e9f6">testsuite::TestConfigurationObjects::setupSensitivityScenarioData</a></div><div class="ttdeci">static QuantLib::ext::shared_ptr&lt; ore::analytics::SensitivityScenarioData &gt; setupSensitivityScenarioData(bool hasSwapVolCube=false, bool hasYYCapVols=false, bool parConversion=false)</div><div class="ttdoc">SensitivityScenarioData instance.</div><div class="ttdef"><b>Definition:</b> <a href="testmarket_8cpp_source.html#l01358">testmarket.cpp:1358</a></div></div>
<div class="ttc" id="aclasstestsuite_1_1_test_configuration_objects_html_ace301b42c3a496e6856fd9cdcc5787b2"><div class="ttname"><a href="classtestsuite_1_1_test_configuration_objects.html#ace301b42c3a496e6856fd9cdcc5787b2">testsuite::TestConfigurationObjects::setupSimMarketData</a></div><div class="ttdeci">static QuantLib::ext::shared_ptr&lt; ore::analytics::ScenarioSimMarketParameters &gt; setupSimMarketData(bool hasSwapVolCube=false, bool hasYYCapVols=false)</div><div class="ttdoc">ScenarioSimMarketParameters instance.</div><div class="ttdef"><b>Definition:</b> <a href="testmarket_8cpp_source.html#l01246">testmarket.cpp:1246</a></div></div>
<div class="ttc" id="acreditdefaultswap_8hpp_html"><div class="ttname"><a href="../ored/creditdefaultswap_8hpp.html">creditdefaultswap.hpp</a></div></div>
<div class="ttc" id="acsvreport_8hpp_html"><div class="ttname"><a href="../ored/csvreport_8hpp.html">csvreport.hpp</a></div></div>
<div class="ttc" id="adeltascenariofactory_8hpp_html"><div class="ttname"><a href="deltascenariofactory_8hpp.html">deltascenariofactory.hpp</a></div><div class="ttdoc">factory class for cloning a cached scenario</div></div>
<div class="ttc" id="anamespace_quant_ext_html"><div class="ttname"><a href="namespace_quant_ext.html">QuantExt</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_a1cab4fb6a720eff245acb9f3a7a9e7c5"><div class="ttname"><a href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a></div><div class="ttdeci">Filter close_enough(const RandomVariable &amp;x, const RandomVariable &amp;y)</div></div>
<div class="ttc" id="anamespace_quant_lib_html"><div class="ttname"><a href="../qle/namespace_quant_lib.html">QuantLib</a></div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html"><div class="ttname"><a href="namespaceore_1_1analytics.html">ore::analytics</a></div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_ae6645effb55b498ae924e935d438a900"><div class="ttname"><a href="namespaceore_1_1analytics.html#ae6645effb55b498ae924e935d438a900">ore::analytics::ShiftType</a></div><div class="ttdeci">ShiftType</div><div class="ttdef"><b>Definition:</b> <a href="scenario_8hpp_source.html#l00190">scenario.hpp:190</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html"><div class="ttname"><a href="namespaceore_1_1data.html">ore::data</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a86651dfeb5c18ee891f7a4734d8cf455"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a></div><div class="ttdeci">std::string to_string(const LocationInfo &amp;l)</div></div>
<div class="ttc" id="anamespaceore_html"><div class="ttname"><a href="namespaceore.html">ore</a></div></div>
<div class="ttc" id="anamespacetestsuite_html"><div class="ttname"><a href="namespacetestsuite.html">testsuite</a></div><div class="ttdef"><b>Definition:</b> <a href="test_2parsensitivityanalysis_8cpp_source.html#l00535">parsensitivityanalysis.cpp:535</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a13f8a202c5f16ae1c9f362b7d0158c88"><div class="ttname"><a href="namespacetestsuite.html#a13f8a202c5f16ae1c9f362b7d0158c88">testsuite::buildCreditDefaultSwap</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildCreditDefaultSwap(string id, string ccy, string issuerId, string creditCurveId, bool isPayer, Real notional, int start, Size term, Real rate, Real spread, string fixedFreq, string fixedDC)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00389">testportfolio.cpp:389</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a2ac80e4a53d263f698aa59023f495793"><div class="ttname"><a href="namespacetestsuite.html#a2ac80e4a53d263f698aa59023f495793">testsuite::buildSyntheticCDO</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildSyntheticCDO(string id, string name, vector&lt; string &gt; names, string longShort, string ccy, vector&lt; string &gt; ccys, bool isPayer, vector&lt; Real &gt; notionals, Real notional, int start, Size term, Real rate, Real spread, string fixedFreq, string fixedDC)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00426">testportfolio.cpp:426</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a34c5d7d98beb7ce810dffd5e338254cf"><div class="ttname"><a href="namespacetestsuite.html#a34c5d7d98beb7ce810dffd5e338254cf">testsuite::buildCap</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildCap(string id, string ccy, string longShort, Real capRate, Real notional, int start, Size term, string floatFreq, string floatDC, string index, Calendar calendar, Natural spotDays, bool spotStartLag)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00254">testportfolio.cpp:254</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a4d68ff04890ebe5c7caca44a26220e95"><div class="ttname"><a href="namespacetestsuite.html#a4d68ff04890ebe5c7caca44a26220e95">testsuite::buildCmsCapFloor</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildCmsCapFloor(string id, string ccy, string indexId, bool isPayer, Real notional, int start, Size term, Real capRate, Real floorRate, Real spread, string freq, string dc)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00488">testportfolio.cpp:488</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a54c1b35c30d28826bf94589a5e9d09d6"><div class="ttname"><a href="namespacetestsuite.html#a54c1b35c30d28826bf94589a5e9d09d6">testsuite::buildSwap</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildSwap(string id, string ccy, bool isPayer, Real notional, int start, Size term, Real rate, Real spread, string fixedFreq, string fixedDC, string floatFreq, string floatDC, string index, Calendar calendar, Natural spotDays, bool spotStartLag)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00048">testportfolio.cpp:48</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a923774110a26dd77813d14563d295373"><div class="ttname"><a href="namespacetestsuite.html#a923774110a26dd77813d14563d295373">testsuite::buildCPIInflationSwap</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildCPIInflationSwap(string id, string ccy, bool isPayer, Real notional, int start, Size term, Real spread, string floatFreq, string floatDC, string index, string cpiFreq, string cpiDC, string cpiIndex, Real baseRate, string observationLag, bool interpolated, Real cpiRate)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00528">testportfolio.cpp:528</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a9b18c17163d82e3fcbd2eeaec95a994f"><div class="ttname"><a href="namespacetestsuite.html#a9b18c17163d82e3fcbd2eeaec95a994f">testsuite::buildEquityOption</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildEquityOption(string id, string longShort, string putCall, Size expiry, string equityName, string currency, Real strike, Real quantity, Real premium, string premiumCcy, string premiumDate)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00209">testportfolio.cpp:209</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_a9d40203e41af32fc4c5302ecd279e555"><div class="ttname"><a href="namespacetestsuite.html#a9d40203e41af32fc4c5302ecd279e555">testsuite::buildFloor</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildFloor(string id, string ccy, string longShort, Real floorRate, Real notional, int start, Size term, string floatFreq, string floatDC, string index, Calendar calendar, Natural spotDays, bool spotStartLag)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00261">testportfolio.cpp:261</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_ac2a5b766f72a055ad2c9e5422959dbc2"><div class="ttname"><a href="namespacetestsuite.html#ac2a5b766f72a055ad2c9e5422959dbc2">testsuite::buildCrossCcyBasisSwap</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildCrossCcyBasisSwap(string id, string recCcy, Real recNotional, string payCcy, Real payNotional, int start, Size term, Real recLegSpread, Real payLegSpread, string recFreq, string recDC, string recIndex, Calendar recCalendar, string payFreq, string payDC, string payIndex, Calendar payCalendar, Natural spotDays, bool spotStartLag, bool notionalInitialExchange, bool notionalFinalExchange, bool notionalAmortizingExchange, bool isRecLegFXResettable, bool isPayLegFXResettable)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00306">testportfolio.cpp:306</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_ac3993b76e18d799583bfce39846a37e2"><div class="ttname"><a href="namespacetestsuite.html#ac3993b76e18d799583bfce39846a37e2">testsuite::buildYYInflationSwap</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Trade &gt; buildYYInflationSwap(string id, string ccy, bool isPayer, Real notional, int start, Size term, Real spread, string floatFreq, string floatDC, string index, string yyFreq, string yyDC, string yyIndex, string observationLag, Size fixDays)</div><div class="ttdef"><b>Definition:</b> <a href="testportfolio_8cpp_source.html#l00569">testportfolio.cpp:569</a></div></div>
<div class="ttc" id="anamespacetestsuite_html_adeaa61629ab1007d92b9c2c7f5b54ed9"><div class="ttname"><a href="namespacetestsuite.html#adeaa61629ab1007d92b9c2c7f5b54ed9">testsuite::BOOST_AUTO_TEST_CASE</a></div><div class="ttdeci">BOOST_AUTO_TEST_CASE(ZeroShifts1d)</div><div class="ttdef"><b>Definition:</b> <a href="test_2parsensitivityanalysis_8cpp_source.html#l01574">parsensitivityanalysis.cpp:1574</a></div></div>
<div class="ttc" id="aobservationmode_8hpp_html"><div class="ttname"><a href="observationmode_8hpp.html">observationmode.hpp</a></div><div class="ttdoc">Singleton class to hold global Observation Mode.</div></div>
<div class="ttc" id="aorea_2engine_2parsensitivityanalysis_8hpp_html"><div class="ttname"><a href="orea_2engine_2parsensitivityanalysis_8hpp.html">parsensitivityanalysis.hpp</a></div><div class="ttdoc">Perfrom sensitivity analysis for a given portfolio.</div></div>
<div class="ttc" id="aoreatoplevelfixture_8hpp_html"><div class="ttname"><a href="oreatoplevelfixture_8hpp.html">oreatoplevelfixture.hpp</a></div><div class="ttdoc">Fixture that can be used at top level of OREAnalytics test suites.</div></div>
<div class="ttc" id="aosutils_8hpp_html"><div class="ttname"><a href="../ored/osutils_8hpp.html">osutils.hpp</a></div></div>
<div class="ttc" id="aparsensitivityanalysismanual_8hpp_html"><div class="ttname"><a href="parsensitivityanalysismanual_8hpp.html">parsensitivityanalysismanual.hpp</a></div><div class="ttdoc">More par Sensitivity analysis tests.</div></div>
<div class="ttc" id="aportfolio_8hpp_html"><div class="ttname"><a href="../ored/portfolio_8hpp.html">portfolio.hpp</a></div></div>
<div class="ttc" id="ascenariosimmarket_8hpp_html"><div class="ttname"><a href="scenariosimmarket_8hpp.html">scenariosimmarket.hpp</a></div><div class="ttdoc">A Market class that can be updated by Scenarios.</div></div>
<div class="ttc" id="aswap_8hpp_html"><div class="ttname"><a href="../ored/swap_8hpp.html">swap.hpp</a></div></div>
<div class="ttc" id="aswaption_8hpp_html"><div class="ttname"><a href="../ored/swaption_8hpp.html">swaption.hpp</a></div></div>
<div class="ttc" id="atestmarket_8hpp_html"><div class="ttname"><a href="testmarket_8hpp.html">testmarket.hpp</a></div></div>
<div class="ttc" id="atestportfolio_8hpp_html"><div class="ttname"><a href="testportfolio_8hpp.html">testportfolio.hpp</a></div></div>
<div class="ttc" id="ato__string_8hpp_html"><div class="ttname"><a href="../ored/to__string_8hpp.html">to_string.hpp</a></div></div>
<div class="ttc" id="atodaysmarketparameters_8cpp_html_a8ccf841cb59e451791bcb2e1ac4f1edc"><div class="ttname"><a href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a></div><div class="ttdeci">string name</div></div>
<div class="ttc" id="azerotoparcube_8hpp_html"><div class="ttname"><a href="zerotoparcube_8hpp.html">zerotoparcube.hpp</a></div><div class="ttdoc">Class for converting zero sensitivities to par sensitivities.</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
