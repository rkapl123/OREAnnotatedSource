<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>OREAnalytics: SensitivityScenarioGenerator Class Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="oreaextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-analytics@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.11</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceore.html">ore</a></li><li class="navelem"><a class="el" href="namespaceore_1_1analytics.html">analytics</a></li><li class="navelem"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html">SensitivityScenarioGenerator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classore_1_1analytics_1_1_sensitivity_scenario_generator-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SensitivityScenarioGenerator Class Reference<div class="ingroups"><a class="el" href="group__scenario.html">Scenario</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Sensitivity <a class="el" href="classore_1_1analytics_1_1_scenario.html" title="Scenario Base Class.">Scenario</a> Generator.  
 <a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="sensitivityscenariogenerator_8hpp_source.html">orea/scenario/sensitivityscenariogenerator.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for SensitivityScenarioGenerator:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator__inherit__graph.png" border="0" usemap="#a_sensitivity_scenario_generator_inherit__map" alt="Inheritance graph"/></div>
<map name="a_sensitivity_scenario_generator_inherit__map" id="a_sensitivity_scenario_generator_inherit__map">
<area shape="rect" title="Sensitivity Scenario Generator." alt="" coords="5,533,249,1116"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html" title="Shift Scenario Generator." alt="" coords="35,137,219,485"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_generator.html" title="Scenario generator base class." alt="" coords="45,5,209,89"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for SensitivityScenarioGenerator:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator__coll__graph.png" border="0" usemap="#a_sensitivity_scenario_generator_coll__map" alt="Collaboration graph"/></div>
<map name="a_sensitivity_scenario_generator_coll__map" id="a_sensitivity_scenario_generator_coll__map">
<area shape="rect" title="Sensitivity Scenario Generator." alt="" coords="979,1180,1223,1660"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html" title="Shift Scenario Generator." alt="" coords="711,872,895,1103"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_generator.html" title="Scenario generator base class." alt="" coords="1251,711,1415,795"/>
<area shape="rect" title=" " alt="" coords="1439,725,1616,780"/>
<area shape="rect" title=" " alt="" coords="36,725,259,780"/>
<area shape="rect" title=" " alt="" coords="283,725,451,780"/>
<area shape="rect" title=" " alt="" coords="476,718,627,787"/>
<area shape="rect" title=" " alt="" coords="11,469,188,523"/>
<area shape="rect" title=" " alt="" coords="697,476,787,516"/>
<area shape="rect" title=" " alt="" coords="721,718,885,787"/>
<area shape="rect" title=" " alt="" coords="905,95,944,135"/>
<area shape="rect" title=" " alt="" coords="1418,219,1517,259"/>
<area shape="rect" title=" " alt="" coords="667,95,719,135"/>
<area shape="rect" href="classore_1_1analytics_1_1_risk_factor_key.html" title="Data types stored in the scenario class." alt="" coords="1101,197,1236,281"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html" title=" " alt="" coords="812,359,976,633"/>
<area shape="rect" title=" " alt="" coords="776,219,831,259"/>
<area shape="rect" title=" " alt="" coords="1000,461,1143,531"/>
<area shape="rect" title=" " alt="" coords="1289,469,1477,523"/>
<area shape="rect" title=" " alt="" coords="1603,461,1779,531"/>
<area shape="rect" title=" " alt="" coords="1659,95,1737,135"/>
<area shape="rect" title=" " alt="" coords="1057,95,1115,135"/>
<area shape="rect" title=" " alt="" coords="1013,5,1159,45"/>
<area shape="rect" title=" " alt="" coords="1768,95,1807,135"/>
<area shape="rect" title=" " alt="" coords="919,960,1098,1015"/>
<area shape="rect" title=" " alt="" coords="1123,960,1300,1015"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="1341,967,1391,1007"/>
<area shape="rect" title=" " alt="" coords="1868,219,1920,259"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a886fe943969c051d641d90510b1665dd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd">SensitivityScenarioGenerator</a> (const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_data.html">SensitivityScenarioData</a> &gt; &amp;sensitivityData, const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;<a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">baseScenario</a>, const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;simMarketData, const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> &gt; &amp;simMarket, const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_factory.html">ScenarioFactory</a> &gt; &amp;sensiScenarioFactory, const <a class="el" href="classbool.html">bool</a> overrideTenors, const <a class="el" href="classbool.html">bool</a> continueOnError=false, const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;<a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aea8be6aae3d06497816f1e8bf246740b">baseScenarioAbsolute</a>=nullptr)</td></tr>
<tr class="memdesc:a886fe943969c051d641d90510b1665dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd">More...</a><br /></td></tr>
<tr class="separator:a886fe943969c051d641d90510b1665dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ab80961c89d343e730880d25ff0ae87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4ab80961c89d343e730880d25ff0ae87">~SensitivityScenarioGenerator</a> ()</td></tr>
<tr class="memdesc:a4ab80961c89d343e730880d25ff0ae87"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4ab80961c89d343e730880d25ff0ae87">More...</a><br /></td></tr>
<tr class="separator:a4ab80961c89d343e730880d25ff0ae87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e721736dd5d4f03494e1ffb0d68565"><td class="memItemLeft" align="right" valign="top">const std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a31e721736dd5d4f03494e1ffb0d68565">shiftSizes</a> () const</td></tr>
<tr class="separator:a31e721736dd5d4f03494e1ffb0d68565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a012344d58b46624f90a41f4fc2d59e0c"><td class="memItemLeft" align="right" valign="top">const std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a> () const</td></tr>
<tr class="separator:a012344d58b46624f90a41f4fc2d59e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac232e4032b4e461df990869d2eb55727"><td class="memItemLeft" align="right" valign="top">Size&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac232e4032b4e461df990869d2eb55727">numScenarios</a> () const</td></tr>
<tr class="separator:ac232e4032b4e461df990869d2eb55727"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea8be6aae3d06497816f1e8bf246740b"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aea8be6aae3d06497816f1e8bf246740b">baseScenarioAbsolute</a> () const</td></tr>
<tr class="separator:aea8be6aae3d06497816f1e8bf246740b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classore_1_1analytics_1_1_shift_scenario_generator')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html">ShiftScenarioGenerator</a></td></tr>
<tr class="memitem:a48955866ffc8054d19fb7461f15bf2db inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a48955866ffc8054d19fb7461f15bf2db">ShiftScenarioGenerator</a> (const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;<a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">baseScenario</a>, const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;simMarketData, const boost::weak_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> &gt; &amp;simMarket)</td></tr>
<tr class="memdesc:a48955866ffc8054d19fb7461f15bf2db inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a48955866ffc8054d19fb7461f15bf2db">More...</a><br /></td></tr>
<tr class="separator:a48955866ffc8054d19fb7461f15bf2db inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90ccaf61d6d87298ffaaf5d5f4380c18 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a90ccaf61d6d87298ffaaf5d5f4380c18">~ShiftScenarioGenerator</a> ()</td></tr>
<tr class="memdesc:a90ccaf61d6d87298ffaaf5d5f4380c18 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a90ccaf61d6d87298ffaaf5d5f4380c18">More...</a><br /></td></tr>
<tr class="separator:a90ccaf61d6d87298ffaaf5d5f4380c18 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5972fa7887678c0e6720a37807d2507 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#af5972fa7887678c0e6720a37807d2507">next</a> (const Date &amp;d) override</td></tr>
<tr class="memdesc:af5972fa7887678c0e6720a37807d2507 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classore_1_1analytics_1_1_scenario.html" title="Scenario Base Class.">Scenario</a> Generator interface.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#af5972fa7887678c0e6720a37807d2507">More...</a><br /></td></tr>
<tr class="separator:af5972fa7887678c0e6720a37807d2507 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebfcdbbd0fe4efbff10b180be50ca6bc inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aebfcdbbd0fe4efbff10b180be50ca6bc">reset</a> () override</td></tr>
<tr class="memdesc:aebfcdbbd0fe4efbff10b180be50ca6bc inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the generator so calls to <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#af5972fa7887678c0e6720a37807d2507" title="Scenario Generator interface.">next()</a> return the first scenario.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#aebfcdbbd0fe4efbff10b180be50ca6bc">More...</a><br /></td></tr>
<tr class="separator:aebfcdbbd0fe4efbff10b180be50ca6bc inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a7c043ee890f90833344b974888219c inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">Size&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a5a7c043ee890f90833344b974888219c">samples</a> ()</td></tr>
<tr class="memdesc:a5a7c043ee890f90833344b974888219c inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inspectors.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a5a7c043ee890f90833344b974888219c">More...</a><br /></td></tr>
<tr class="separator:a5a7c043ee890f90833344b974888219c inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab66b96dd7578bf2d63edbb94e7a4665e inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">baseScenario</a> ()</td></tr>
<tr class="memdesc:ab66b96dd7578bf2d63edbb94e7a4665e inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the base scenario, i.e. cached initial values of all relevant market points.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">More...</a><br /></td></tr>
<tr class="separator:ab66b96dd7578bf2d63edbb94e7a4665e inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a107005b06fdd51f6c0abeef508953077 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a107005b06fdd51f6c0abeef508953077">scenarios</a> ()</td></tr>
<tr class="memdesc:a107005b06fdd51f6c0abeef508953077 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return vector of sensitivity scenarios, scenario 0 is the base scenario.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a107005b06fdd51f6c0abeef508953077">More...</a><br /></td></tr>
<tr class="separator:a107005b06fdd51f6c0abeef508953077 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75917c987079d2289e13d256b790d41d inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a75917c987079d2289e13d256b790d41d">scenarioDescriptions</a> ()</td></tr>
<tr class="memdesc:a75917c987079d2289e13d256b790d41d inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return vector of scenario descriptions.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a75917c987079d2289e13d256b790d41d">More...</a><br /></td></tr>
<tr class="separator:a75917c987079d2289e13d256b790d41d inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf3b2f59f4626e2f4b820bb453794844 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, std::string &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#adf3b2f59f4626e2f4b820bb453794844">keyToFactor</a> ()</td></tr>
<tr class="separator:adf3b2f59f4626e2f4b820bb453794844 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71d68a6e65cc5bfc7654bc20b15aa130 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const std::map&lt; std::string, <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a71d68a6e65cc5bfc7654bc20b15aa130">factorToKey</a> ()</td></tr>
<tr class="memdesc:a71d68a6e65cc5bfc7654bc20b15aa130 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return revers map of factors to RiskFactorKeys.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a71d68a6e65cc5bfc7654bc20b15aa130">More...</a><br /></td></tr>
<tr class="separator:a71d68a6e65cc5bfc7654bc20b15aa130 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa50d390d6448fb5266f2ab758bb74861 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a> (Size j, Real shiftSize, <a class="el" href="classbool.html">bool</a> up, <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> type, const vector&lt; Time &gt; &amp;shiftTimes, const vector&lt; Real &gt; &amp;values, const vector&lt; Time &gt; &amp;times, vector&lt; Real &gt; &amp;shiftedValues, <a class="el" href="classbool.html">bool</a> initialise)</td></tr>
<tr class="memdesc:aa50d390d6448fb5266f2ab758bb74861 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">More...</a><br /></td></tr>
<tr class="separator:aa50d390d6448fb5266f2ab758bb74861 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba9cac764518358ea7b3c0afa3b6cf66 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aba9cac764518358ea7b3c0afa3b6cf66">applyShift</a> (Size j, Size k, Real shiftSize, <a class="el" href="classbool.html">bool</a> up, <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> type, const vector&lt; Time &gt; &amp;shiftX, const vector&lt; Time &gt; &amp;shiftY, const vector&lt; Time &gt; &amp;dataX, const vector&lt; Time &gt; &amp;dataY, const vector&lt; vector&lt; Real &gt; &gt; &amp;data, vector&lt; vector&lt; Real &gt; &gt; &amp;shiftedData, <a class="el" href="classbool.html">bool</a> initialise)</td></tr>
<tr class="memdesc:aba9cac764518358ea7b3c0afa3b6cf66 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply 2d shift to 2d matrix such as swaption volatilities, public to allow test suite access.  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#aba9cac764518358ea7b3c0afa3b6cf66">More...</a><br /></td></tr>
<tr class="separator:aba9cac764518358ea7b3c0afa3b6cf66 inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2322867105cdbebf8ec28a68ed31e2e inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae2322867105cdbebf8ec28a68ed31e2e">baseScenario</a> () const</td></tr>
<tr class="memdesc:ae2322867105cdbebf8ec28a68ed31e2e inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">return the base scenario  <a href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae2322867105cdbebf8ec28a68ed31e2e">More...</a><br /></td></tr>
<tr class="separator:ae2322867105cdbebf8ec28a68ed31e2e inherit pub_methods_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classore_1_1analytics_1_1_scenario_generator"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classore_1_1analytics_1_1_scenario_generator')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a></td></tr>
<tr class="memitem:a65106dd56b5c29535afa38ebf87e9349 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_generator.html#a65106dd56b5c29535afa38ebf87e9349">~ScenarioGenerator</a> ()</td></tr>
<tr class="memdesc:a65106dd56b5c29535afa38ebf87e9349 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <a href="classore_1_1analytics_1_1_scenario_generator.html#a65106dd56b5c29535afa38ebf87e9349">More...</a><br /></td></tr>
<tr class="separator:a65106dd56b5c29535afa38ebf87e9349 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bc181f341278212cc3202149fd37715 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="memItemLeft" align="right" valign="top">virtual boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_generator.html#a0bc181f341278212cc3202149fd37715">next</a> (const Date &amp;d)=0</td></tr>
<tr class="memdesc:a0bc181f341278212cc3202149fd37715 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the next scenario for the given date.  <a href="classore_1_1analytics_1_1_scenario_generator.html#a0bc181f341278212cc3202149fd37715">More...</a><br /></td></tr>
<tr class="separator:a0bc181f341278212cc3202149fd37715 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20dcbdfbd0ec77afc802522bb7e379c1 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_generator.html#a20dcbdfbd0ec77afc802522bb7e379c1">reset</a> ()=0</td></tr>
<tr class="memdesc:a20dcbdfbd0ec77afc802522bb7e379c1 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the generator so calls to <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html#a0bc181f341278212cc3202149fd37715" title="Return the next scenario for the given date.">next()</a> return the first scenario.  <a href="classore_1_1analytics_1_1_scenario_generator.html#a20dcbdfbd0ec77afc802522bb7e379c1">More...</a><br /></td></tr>
<tr class="separator:a20dcbdfbd0ec77afc802522bb7e379c1 inherit pub_methods_classore_1_1analytics_1_1_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aa62ece5f85b43378ea6ad94a43f74ee4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4">generateScenarios</a> ()</td></tr>
<tr class="separator:aa62ece5f85b43378ea6ad94a43f74ee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a650b13cc30c1c0cb72ab4dbb60c90db1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1">generateYieldCurveScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a650b13cc30c1c0cb72ab4dbb60c90db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c63287e5bf9685a9b0863c941f7f2c1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1">generateDiscountCurveScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a9c63287e5bf9685a9b0863c941f7f2c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba51e2d1738678433fa86a6cc862027"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027">generateIndexCurveScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a3ba51e2d1738678433fa86a6cc862027"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62a903c3bc67c55dcba8ad800019ca2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2">generateFxScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ac62a903c3bc67c55dcba8ad800019ca2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afeedcacdff9b31f492c0a826828b9baf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf">generateEquityScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:afeedcacdff9b31f492c0a826828b9baf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae936b20b7f07f4a58b3c8c563a033b72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72">generateDividendYieldScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ae936b20b7f07f4a58b3c8c563a033b72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f0155590944e309a2706b53ee0b963e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e">generateSwaptionVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a2f0155590944e309a2706b53ee0b963e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9945e729ab6796e7d826f5d1b2fac3c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6">generateYieldVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a9945e729ab6796e7d826f5d1b2fac3c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad782034ca45729d5c04df8b80e2206f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4">generateFxVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ad782034ca45729d5c04df8b80e2206f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b50a26e6b152bbcdaf05d9733016430"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430">generateEquityVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a7b50a26e6b152bbcdaf05d9733016430"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f67d3089b1f5d7d05f72b726bbcb847"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847">generateCapFloorVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a4f67d3089b1f5d7d05f72b726bbcb847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad33b9fbcfde02400f5807edf18326ce8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8">generateSurvivalProbabilityScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ad33b9fbcfde02400f5807edf18326ce8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad9b9dbc48ccb62b71c9bcf0bc1f5db8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8">generateCdsVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:aad9b9dbc48ccb62b71c9bcf0bc1f5db8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ac8a9ece30efe88a9131963f851d176"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176">generateZeroInflationScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a3ac8a9ece30efe88a9131963f851d176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ff246db7c4c67d5d2735e10b9c5d760"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760">generateZeroInflationCapFloorVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a2ff246db7c4c67d5d2735e10b9c5d760"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cb7749581f38e7c3e5eae03657d6d33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33">generateYoYInflationScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a2cb7749581f38e7c3e5eae03657d6d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e5241dfb0b21ac043e2e32a22374f6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6">generateYoYInflationCapFloorVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a16e5241dfb0b21ac043e2e32a22374f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d59ef3dc24cdb6a4306230119a9185b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b">generateBaseCorrelationScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a8d59ef3dc24cdb6a4306230119a9185b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5909315dd0dd00c38ebb9401f016381c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c">generateCommodityCurveScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a5909315dd0dd00c38ebb9401f016381c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8c23507e58896ff857af151365a6015"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015">generateCommodityVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ae8c23507e58896ff857af151365a6015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf3e88184ad3e14d3a3f60fd7300fcfd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd">generateSecuritySpreadScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:aaf3e88184ad3e14d3a3f60fd7300fcfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7514f26c1f3e6e7803bcdb96d81ec6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f">generateCorrelationScenarios</a> (<a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:af7514f26c1f3e6e7803bcdb96d81ec6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa15d0f2e93f0677d51e215ed114e4014"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014">generateGenericYieldVolScenarios</a> (<a class="el" href="classbool.html">bool</a> up, <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a> rfType)</td></tr>
<tr class="separator:aa15d0f2e93f0677d51e215ed114e4014"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad55463e7bc2f60b4eeaae92fc3df57f8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad55463e7bc2f60b4eeaae92fc3df57f8">discountScenarioDescription</a> (string ccy, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ad55463e7bc2f60b4eeaae92fc3df57f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a5d16fda37846aa9f1b09ad69c2790"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a81a5d16fda37846aa9f1b09ad69c2790">indexScenarioDescription</a> (string index, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a81a5d16fda37846aa9f1b09ad69c2790"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4499bf098f760582d4a5726133cd2ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ab4499bf098f760582d4a5726133cd2ff">yieldScenarioDescription</a> (string <a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ab4499bf098f760582d4a5726133cd2ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c013a7ebb2a17fc8ce2404ead5fd52c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4c013a7ebb2a17fc8ce2404ead5fd52c">fxScenarioDescription</a> (string ccypair, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a4c013a7ebb2a17fc8ce2404ead5fd52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abc89e6315b80ada5497ef0d5ecbc1a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6abc89e6315b80ada5497ef0d5ecbc1a">fxVolScenarioDescription</a> (string ccypair, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a6abc89e6315b80ada5497ef0d5ecbc1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1eac93475a1c9d611e854a825e0289b3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1eac93475a1c9d611e854a825e0289b3">equityScenarioDescription</a> (string equity, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a1eac93475a1c9d611e854a825e0289b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b2ddb1824da83ff9e5fae9caecfcfb8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b2ddb1824da83ff9e5fae9caecfcfb8">dividendYieldScenarioDescription</a> (string equity, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a4b2ddb1824da83ff9e5fae9caecfcfb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b4ab69d6e0663a291f9cc36f355ec90"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6b4ab69d6e0663a291f9cc36f355ec90">equityVolScenarioDescription</a> (string equity, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a6b4ab69d6e0663a291f9cc36f355ec90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3513311b19a4679bf8bee7312e236312"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312">swaptionVolScenarioDescription</a> (string ccy, Size expiryBucket, Size termBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a3513311b19a4679bf8bee7312e236312"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4695dabbff06995b81dc873adbf6bd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd">yieldVolScenarioDescription</a> (string securityId, Size expiryBucket, Size termBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:adf4695dabbff06995b81dc873adbf6bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9363e3e8d8df9640bbeab55c93fffa9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9363e3e8d8df9640bbeab55c93fffa9d">capFloorVolScenarioDescription</a> (string ccy, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up, <a class="el" href="classbool.html">bool</a> isAtm)</td></tr>
<tr class="separator:a9363e3e8d8df9640bbeab55c93fffa9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e729008d28bc0a85fa73aac49db28ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1e729008d28bc0a85fa73aac49db28ff">survivalProbabilityScenarioDescription</a> (string <a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a1e729008d28bc0a85fa73aac49db28ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacbfc6ab59a6c85e622ab858b4eee24c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aacbfc6ab59a6c85e622ab858b4eee24c">CdsVolScenarioDescription</a> (string <a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:aacbfc6ab59a6c85e622ab858b4eee24c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840da6725f71e6ae7db519d84cb3d275"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a840da6725f71e6ae7db519d84cb3d275">zeroInflationScenarioDescription</a> (string index, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a840da6725f71e6ae7db519d84cb3d275"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9aa2a7ef0eb4646aa00597b6bb71bc4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad9aa2a7ef0eb4646aa00597b6bb71bc4">yoyInflationScenarioDescription</a> (string index, Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:ad9aa2a7ef0eb4646aa00597b6bb71bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87cb703bf265164cef649e6d455772a0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a87cb703bf265164cef649e6d455772a0">zeroInflationCapFloorVolScenarioDescription</a> (string <a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a87cb703bf265164cef649e6d455772a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52659907f53c9543366619e3154411d4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a52659907f53c9543366619e3154411d4">yoyInflationCapFloorVolScenarioDescription</a> (string <a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a52659907f53c9543366619e3154411d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad7ae91ef2d71d973dce2f1fd66d56c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6ad7ae91ef2d71d973dce2f1fd66d56c">baseCorrelationScenarioDescription</a> (string indexName, Size lossLevelBucket, Size termBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a6ad7ae91ef2d71d973dce2f1fd66d56c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c90a4563e88cf2b66058371685c7b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a36c90a4563e88cf2b66058371685c7b6">commodityCurveScenarioDescription</a> (const std::string &amp;commodityName, QuantLib::Size bucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a36c90a4563e88cf2b66058371685c7b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03fe6e79109200285178c3e85cc98acd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a03fe6e79109200285178c3e85cc98acd">commodityVolScenarioDescription</a> (const std::string &amp;commodityName, QuantLib::Size expiryBucket, QuantLib::Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a03fe6e79109200285178c3e85cc98acd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5894bae3460d65e021318164a4f480d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5894bae3460d65e021318164a4f480d6">securitySpreadScenarioDescription</a> (string bond, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a5894bae3460d65e021318164a4f480d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05852fc1e9a1d15cbe24af1003430ea3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a05852fc1e9a1d15cbe24af1003430ea3">correlationScenarioDescription</a> (string pair, Size expiryBucket, Size strikeBucket, <a class="el" href="classbool.html">bool</a> up)</td></tr>
<tr class="separator:a05852fc1e9a1d15cbe24af1003430ea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a28bf093d350571841a46bfd01c2ed79b"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_data.html">SensitivityScenarioData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a></td></tr>
<tr class="separator:a28bf093d350571841a46bfd01c2ed79b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf24308523669dc57ad15492c900a27c"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_factory.html">ScenarioFactory</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a></td></tr>
<tr class="separator:adf24308523669dc57ad15492c900a27c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc775bc68d5c2a673f8a454972be6387"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a></td></tr>
<tr class="separator:abc775bc68d5c2a673f8a454972be6387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dd077c2c46a5babc0511ba2648e2321"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a></td></tr>
<tr class="separator:a3dd077c2c46a5babc0511ba2648e2321"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b3e16a7e9154afd40dc67d7c1109f60"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a></td></tr>
<tr class="memdesc:a5b3e16a7e9154afd40dc67d7c1109f60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the shift sizes for each risk factor key.  <a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">More...</a><br /></td></tr>
<tr class="separator:a5b3e16a7e9154afd40dc67d7c1109f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e36c7dd5c6dff3b7bcfeac0e350ff5"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a></td></tr>
<tr class="memdesc:a59e36c7dd5c6dff3b7bcfeac0e350ff5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Holds the base valuesfor each risk factor key.  <a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">More...</a><br /></td></tr>
<tr class="separator:a59e36c7dd5c6dff3b7bcfeac0e350ff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4544f478033671c1fd68173f115187"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a></td></tr>
<tr class="separator:a4b4544f478033671c1fd68173f115187"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_types_classore_1_1analytics_1_1_shift_scenario_generator"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classore_1_1analytics_1_1_shift_scenario_generator')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html">ShiftScenarioGenerator</a></td></tr>
<tr class="memitem:ae6645effb55b498ae924e935d438a900 inherit pub_types_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> { <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900ab51ca26c6c89cfc9bec338f7a0d3e0c8">Absolute</a>
, <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900a2ca9469819fb0fb61ff98e914a7ccca0">Relative</a>
 }</td></tr>
<tr class="separator:ae6645effb55b498ae924e935d438a900 inherit pub_types_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html">ShiftScenarioGenerator</a></td></tr>
<tr class="memitem:a8a42206bfb9d57d14fb8a25d841692ce inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a></td></tr>
<tr class="separator:a8a42206bfb9d57d14fb8a25d841692ce inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fa1c3e52dd2282a94cb8df118e517dc inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a></td></tr>
<tr class="separator:a9fa1c3e52dd2282a94cb8df118e517dc inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a162cfc221721116690ade22a8da732f2 inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">const boost::weak_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a></td></tr>
<tr class="separator:a162cfc221721116690ade22a8da732f2 inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a630f885f7ed1c6d2ba55e098a810531c inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">std::vector&lt; boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a></td></tr>
<tr class="separator:a630f885f7ed1c6d2ba55e098a810531c inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d14f45b152e5b6ee3b8711c6be79764 inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">Size&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a6d14f45b152e5b6ee3b8711c6be79764">counter_</a></td></tr>
<tr class="separator:a6d14f45b152e5b6ee3b8711c6be79764 inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd85b6f8f58d6c5cf6f3ab6c040a41f inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">ScenarioDescription</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a></td></tr>
<tr class="separator:a0bd85b6f8f58d6c5cf6f3ab6c040a41f inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a550b32664adc23116670df03e4b4ebce inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a550b32664adc23116670df03e4b4ebce">keyToFactor_</a></td></tr>
<tr class="separator:a550b32664adc23116670df03e4b4ebce inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae283c71e6d637d6e3e1dedd3d3245b73 inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memItemLeft" align="right" valign="top">std::map&lt; std::string, <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae283c71e6d637d6e3e1dedd3d3245b73">factorToKey_</a></td></tr>
<tr class="separator:ae283c71e6d637d6e3e1dedd3d3245b73 inherit pro_attribs_classore_1_1analytics_1_1_shift_scenario_generator"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Sensitivity <a class="el" href="classore_1_1analytics_1_1_scenario.html" title="Scenario Base Class.">Scenario</a> Generator. </p>
<p >This class builds a vector of sensitivity scenarios based on instructions in <a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_data.html" title="Description of sensitivity shift scenarios.">SensitivityScenarioData</a> and <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html" title="ScenarioSimMarket description.">ScenarioSimMarketParameters</a> objects passed.</p>
<p >The <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html" title="ScenarioSimMarket description.">ScenarioSimMarketParameters</a> object determines the scope and structure of a "simulation" market (currencies, currency pairs, curve tenor points, vol matrix expiries and terms/strikes etc) to which sensitivity scenarios are applied in order to compute their NPV impact.</p>
<p >The <a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_data.html" title="Description of sensitivity shift scenarios.">SensitivityScenarioData</a> object determines the structure of shift curves (shift tenor points can differ from the simulation market's tenor points), as well as type (relative/absolute) and size of shifts applied.</p>
<p >The generator then produces comprehensive scenarios that can be applied to the simulation market, i.e. covering all quotes in the simulation market, possibly filled with "base" scenario values.</p>
<p >Both UP and DOWN shifts are generated in order to facilitate delta and gamma calculation.</p>
<p >The generator currently covers the IR/FX asset class, with shifts for the following term structure types:</p><ul>
<li>FX spot rates</li>
<li>FX ATM volatilities</li>
<li>Discount curve zero rates</li>
<li>Index curve zero rates</li>
<li>Yield curve zero rates</li>
<li>Swaption ATM volatility matrices</li>
<li>Yield volatility matrices</li>
<li>Cap/Floor volatility matrices (by expiry and strike)</li>
</ul>
<p >For Credit the generator covers shifts to the following termstructure types:</p><ul>
<li>Default curve integrated hazard rates.</li>
</ul>
<p >To apply shifts to the integrated hazard rates let:</p><ul>
<li>S(t) be the survival probability at time t</li>
<li>&amp;lambda(t) be the "instantaneous" hazard rate at time t</li>
<li>&amp;Lambda(t) be the averaged hazard rate at time t</li>
</ul>
<p >The relationship between these three can be expressed as:  </p><p class="formulaDsp">
\[
  S(t) = e^{-&amp;Lambda(t) t}
\]
</p>
  <p class="formulaDsp">
\[
  &amp;Lambda(t) = \frac{ \int_{0}^t  &amp;lambda(t) du}{t}
\]
</p>
<p >The survival probability quotes from the scenarioSimMarket default curves are then converted as follows:  </p><p class="formulaDsp">
\[
  &amp;Lambda(t) = - \frac{ ln( S(t) )}{t}
\]
</p>
<p >Note:</p><ul>
<li>For yield curves, the class generates sensitivities in the Zero rate domain only. Conversion into par rate sensitivities has to be implemented as a postprocessor step.</li>
<li>Likewise, Cap/Floor volatility sensitivities are computed in the optionlet domain. Conversion into par (flat cap/floor) volatility sensis has to be implemented as a postprocessor step.</li>
</ul>
<p >If sensitivityData_-&gt;generateSpreadScenarios() = true spread scenarios will be generated for supported risk factor types. </p>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00102">102</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a886fe943969c051d641d90510b1665dd" name="a886fe943969c051d641d90510b1665dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886fe943969c051d641d90510b1665dd">&#9670;&#160;</a></span>SensitivityScenarioGenerator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html">SensitivityScenarioGenerator</a> </td>
          <td>(</td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_data.html">SensitivityScenarioData</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sensitivityData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>baseScenario</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>simMarketData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>simMarket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_factory.html">ScenarioFactory</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>sensiScenarioFactory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>overrideTenors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>continueOnError</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>baseScenarioAbsolute</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00042">42</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>    : <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a48955866ffc8054d19fb7461f15bf2db">ShiftScenarioGenerator</a>(<a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">baseScenario</a>, simMarketData, simMarket), <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>(sensitivityData), </div>
<div class="line"><span class="lineno">   49</span>      <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>(sensiScenarioFactory), <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a>(overrideTenors), <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>(continueOnError),</div>
<div class="line"><span class="lineno">   50</span>      <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aea8be6aae3d06497816f1e8bf246740b">baseScenarioAbsolute</a> == <span class="keyword">nullptr</span> ? <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">baseScenario</a> : <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aea8be6aae3d06497816f1e8bf246740b">baseScenarioAbsolute</a>) {</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>, <span class="stringliteral">&quot;SensitivityScenarioGenerator: sensitivityData is null&quot;</span>);</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4">generateScenarios</a>();</div>
<div class="line"><span class="lineno">   55</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a28bf093d350571841a46bfd01c2ed79b"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">ore::analytics::SensitivityScenarioGenerator::sensitivityData_</a></div><div class="ttdeci">boost::shared_ptr&lt; SensitivityScenarioData &gt; sensitivityData_</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00190">sensitivityscenariogenerator.hpp:190</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a3dd077c2c46a5babc0511ba2648e2321"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">ore::analytics::SensitivityScenarioGenerator::continueOnError_</a></div><div class="ttdeci">const bool continueOnError_</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00192">sensitivityscenariogenerator.hpp:192</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a4b4544f478033671c1fd68173f115187"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">ore::analytics::SensitivityScenarioGenerator::baseScenarioAbsolute_</a></div><div class="ttdeci">boost::shared_ptr&lt; Scenario &gt; baseScenarioAbsolute_</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00199">sensitivityscenariogenerator.hpp:199</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_aa62ece5f85b43378ea6ad94a43f74ee4"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4">ore::analytics::SensitivityScenarioGenerator::generateScenarios</a></div><div class="ttdeci">void generateScenarios()</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00082">sensitivityscenariogenerator.cpp:82</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_abc775bc68d5c2a673f8a454972be6387"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">ore::analytics::SensitivityScenarioGenerator::overrideTenors_</a></div><div class="ttdeci">const bool overrideTenors_</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00192">sensitivityscenariogenerator.hpp:192</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_adf24308523669dc57ad15492c900a27c"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">ore::analytics::SensitivityScenarioGenerator::sensiScenarioFactory_</a></div><div class="ttdeci">boost::shared_ptr&lt; ScenarioFactory &gt; sensiScenarioFactory_</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00191">sensitivityscenariogenerator.hpp:191</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_aea8be6aae3d06497816f1e8bf246740b"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aea8be6aae3d06497816f1e8bf246740b">ore::analytics::SensitivityScenarioGenerator::baseScenarioAbsolute</a></div><div class="ttdeci">boost::shared_ptr&lt; Scenario &gt; baseScenarioAbsolute() const</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00130">sensitivityscenariogenerator.hpp:130</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a48955866ffc8054d19fb7461f15bf2db"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a48955866ffc8054d19fb7461f15bf2db">ore::analytics::ShiftScenarioGenerator::ShiftScenarioGenerator</a></div><div class="ttdeci">ShiftScenarioGenerator(const boost::shared_ptr&lt; Scenario &gt; &amp;baseScenario, const boost::shared_ptr&lt; ScenarioSimMarketParameters &gt; &amp;simMarketData, const boost::weak_ptr&lt; ScenarioSimMarket &gt; &amp;simMarket)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2shiftscenariogenerator_8cpp_source.html#l00130">shiftscenariogenerator.cpp:130</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_ab66b96dd7578bf2d63edbb94e7a4665e"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#ab66b96dd7578bf2d63edbb94e7a4665e">ore::analytics::ShiftScenarioGenerator::baseScenario</a></div><div class="ttdeci">const boost::shared_ptr&lt; Scenario &gt; &amp; baseScenario()</div><div class="ttdoc">Return the base scenario, i.e. cached initial values of all relevant market points.</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00108">shiftscenariogenerator.hpp:108</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a886fe943969c051d641d90510b1665dd_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a886fe943969c051d641d90510b1665dd_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a886fe943969c051d641d90510b1665dd_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a886fe943969c051d641d90510b1665dd_cgraph">
<area shape="rect" title="Constructor." alt="" coords="5,849,195,874"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,849,373,874"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="1075,689,1122,714"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="1282,1110,1385,1135"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b" title=" " alt="" coords="708,639,931,665"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="1063,738,1135,763"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847" title=" " alt="" coords="719,754,920,779"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8" title=" " alt="" coords="733,590,905,615"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c" title=" " alt="" coords="705,803,933,829"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015" title=" " alt="" coords="712,439,927,465"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f" title=" " alt="" coords="723,489,915,514"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1" title=" " alt="" coords="713,1263,926,1289"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72" title=" " alt="" coords="716,1214,923,1239"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf" title=" " alt="" coords="736,390,903,415"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430" title=" " alt="" coords="726,1017,913,1042"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2" title=" " alt="" coords="747,341,892,366"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4" title=" " alt="" coords="737,1066,901,1091"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027" title=" " alt="" coords="723,1165,916,1190"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd" title=" " alt="" coords="710,291,929,317"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8" title=" " alt="" coords="731,1363,907,1403"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e" title=" " alt="" coords="438,1305,641,1330"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1" title=" " alt="" coords="724,1115,915,1141"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6" title=" " alt="" coords="450,1354,629,1379"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6" title=" " alt="" coords="723,689,916,729"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33" title=" " alt="" coords="720,902,919,927"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760" title=" " alt="" coords="737,952,901,992"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176" title=" " alt="" coords="720,853,919,878"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html#aaf7f2ac6726a834eb907975a177bb1ed" title=" " alt="" coords="438,1455,641,1510"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html#a15994db51fc48298a94001e57d54305b" title="Inspectors." alt="" coords="421,1535,657,1575"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="1006,1009,1191,1049"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6ad7ae91ef2d71d973dce2f1fd66d56c" title=" " alt="" coords="985,475,1213,501"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="1001,861,1196,886"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="1011,959,1186,985"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="1264,959,1403,985"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9363e3e8d8df9640bbeab55c93fffa9d" title=" " alt="" coords="995,590,1202,615"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aacbfc6ab59a6c85e622ab858b4eee24c" title=" " alt="" coords="1009,426,1189,451"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a36c90a4563e88cf2b66058371685c7b6" title=" " alt="" coords="981,639,1216,665"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c" title=" " alt="" coords="1053,213,1144,238"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a03fe6e79109200285178c3e85cc98acd" title=" " alt="" coords="988,262,1209,287"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a05852fc1e9a1d15cbe24af1003430ea3" title=" " alt="" coords="999,377,1198,402"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec" title=" " alt="" coords="1018,312,1179,352"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad55463e7bc2f60b4eeaae92fc3df57f8" title=" " alt="" coords="1005,1486,1192,1511"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="1045,1385,1152,1410"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b2ddb1824da83ff9e5fae9caecfcfb8" title=" " alt="" coords="992,1335,1205,1361"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1eac93475a1c9d611e854a825e0289b3" title=" " alt="" coords="1012,163,1185,189"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6b4ab69d6e0663a291f9cc36f355ec90" title=" " alt="" coords="1003,1138,1195,1163"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4c013a7ebb2a17fc8ce2404ead5fd52c" title=" " alt="" coords="1025,114,1173,139"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6abc89e6315b80ada5497ef0d5ecbc1a" title=" " alt="" coords="1015,1187,1182,1213"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a81a5d16fda37846aa9f1b09ad69c2790" title=" " alt="" coords="1014,1286,1183,1311"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5894bae3460d65e021318164a4f480d6" title=" " alt="" coords="986,65,1211,90"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14" title=" " alt="" coords="1017,1683,1181,1709"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1e729008d28bc0a85fa73aac49db28ff" title=" " alt="" coords="1011,1733,1186,1773"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014" title=" " alt="" coords="708,1313,931,1338"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093" title=" " alt="" coords="1037,1634,1160,1659"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312" title=" " alt="" coords="995,1535,1203,1561"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd" title=" " alt="" coords="1007,1585,1191,1610"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ab4499bf098f760582d4a5726133cd2ff" title=" " alt="" coords="1016,1237,1181,1262"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a52659907f53c9543366619e3154411d4" title=" " alt="" coords="994,525,1203,565"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad9aa2a7ef0eb4646aa00597b6bb71bc4" title=" " alt="" coords="997,910,1200,935"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a87cb703bf265164cef649e6d455772a0" title=" " alt="" coords="1017,1073,1180,1113"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a840da6725f71e6ae7db519d84cb3d275" title=" " alt="" coords="995,787,1202,813"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html#ad10e153af32bbb25fa2688594806200d" title=" " alt="" coords="718,1455,921,1510"/>
</map>
</div>

</div>
</div>
<a id="a4ab80961c89d343e730880d25ff0ae87" name="a4ab80961c89d343e730880d25ff0ae87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ab80961c89d343e730880d25ff0ae87">&#9670;&#160;</a></span>~SensitivityScenarioGenerator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html">SensitivityScenarioGenerator</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default destructor. </p>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00113">113</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  113</span>{};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a31e721736dd5d4f03494e1ffb0d68565" name="a31e721736dd5d4f03494e1ffb0d68565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e721736dd5d4f03494e1ffb0d68565">&#9670;&#160;</a></span>shiftSizes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real &gt; &amp; shiftSizes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Return the map of absolute shift sizes by risk factor key for this generator</p>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000006">Warning:</a></b></dt><dd>Where there are tenor specific shifts the shift size is only meaningful if the tenors in the sensitivity configuration line up with the tenors in the simulation market configuration. If this is not the case, an absolute shift size of <code>Null&lt;Real&gt;()</code> is added for the given risk factor key </dd></dl>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00123">123</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  123</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>; }</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a5b3e16a7e9154afd40dc67d7c1109f60"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">ore::analytics::SensitivityScenarioGenerator::shiftSizes_</a></div><div class="ttdeci">std::map&lt; RiskFactorKey, QuantLib::Real &gt; shiftSizes_</div><div class="ttdoc">Holds the shift sizes for each risk factor key.</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00195">sensitivityscenariogenerator.hpp:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a012344d58b46624f90a41f4fc2d59e0c" name="a012344d58b46624f90a41f4fc2d59e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a012344d58b46624f90a41f4fc2d59e0c">&#9670;&#160;</a></span>baseValues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real &gt; &amp; baseValues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Similarly, reeturn the base values for each risk factor </p>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00126">126</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  126</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>; }</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a59e36c7dd5c6dff3b7bcfeac0e350ff5"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">ore::analytics::SensitivityScenarioGenerator::baseValues_</a></div><div class="ttdeci">std::map&lt; RiskFactorKey, QuantLib::Real &gt; baseValues_</div><div class="ttdoc">Holds the base valuesfor each risk factor key.</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00197">sensitivityscenariogenerator.hpp:197</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a012344d58b46624f90a41f4fc2d59e0c_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a012344d58b46624f90a41f4fc2d59e0c_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a012344d58b46624f90a41f4fc2d59e0c_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a012344d58b46624f90a41f4fc2d59e0c_icgraph">
<area shape="rect" title=" " alt="" coords="684,5,775,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015" title=" " alt="" coords="421,5,636,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ac232e4032b4e461df990869d2eb55727" name="ac232e4032b4e461df990869d2eb55727"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac232e4032b4e461df990869d2eb55727">&#9670;&#160;</a></span>numScenarios()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Size numScenarios </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00128">128</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size(); }</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a630f885f7ed1c6d2ba55e098a810531c"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">ore::analytics::ShiftScenarioGenerator::scenarios_</a></div><div class="ttdeci">std::vector&lt; boost::shared_ptr&lt; Scenario &gt; &gt; scenarios_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00188">shiftscenariogenerator.hpp:188</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aea8be6aae3d06497816f1e8bf246740b" name="aea8be6aae3d06497816f1e8bf246740b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea8be6aae3d06497816f1e8bf246740b">&#9670;&#160;</a></span>baseScenarioAbsolute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; baseScenarioAbsolute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00130">130</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  130</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa62ece5f85b43378ea6ad94a43f74ee4" name="aa62ece5f85b43378ea6ad94a43f74ee4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa62ece5f85b43378ea6ad94a43f74ee4">&#9670;&#160;</a></span>generateScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateScenarios </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00082">82</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>                                                     {</div>
<div class="line"><span class="lineno">   83</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().empty() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma(),</div>
<div class="line"><span class="lineno">   86</span>               <span class="stringliteral">&quot;SensitivityScenarioGenerator::generateScenarios(): if gamma computation is disabled, the cross gamma &quot;</span></div>
<div class="line"><span class="lineno">   87</span>               <span class="stringliteral">&quot;filter must be empty&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1">generateDiscountCurveScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::DiscountCurve))</div>
<div class="line"><span class="lineno">   91</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1">generateDiscountCurveScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027">generateIndexCurveScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::IndexCurve))</div>
<div class="line"><span class="lineno">   95</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027">generateIndexCurveScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1">generateYieldCurveScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::YieldCurve))</div>
<div class="line"><span class="lineno">   99</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1">generateYieldCurveScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateFxSpots()) {</div>
<div class="line"><span class="lineno">  102</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2">generateFxScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  103</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::FXSpot))</div>
<div class="line"><span class="lineno">  104</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2">generateFxScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  105</span>    }</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf">generateEquityScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::EquitySpot))</div>
<div class="line"><span class="lineno">  109</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf">generateEquityScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateDividendYield()) {</div>
<div class="line"><span class="lineno">  112</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72">generateDividendYieldScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  113</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::DividendYield))</div>
<div class="line"><span class="lineno">  114</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72">generateDividendYieldScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  115</span>    }</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176">generateZeroInflationScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::ZeroInflationCurve))</div>
<div class="line"><span class="lineno">  119</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176">generateZeroInflationScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33">generateYoYInflationScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::YoYInflationCurve))</div>
<div class="line"><span class="lineno">  123</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33">generateYoYInflationScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateYoYInflationCapFloorVols()) {</div>
<div class="line"><span class="lineno">  126</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6">generateYoYInflationCapFloorVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::YoYInflationCapFloorVolatility))</div>
<div class="line"><span class="lineno">  128</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6">generateYoYInflationCapFloorVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  129</span>    }</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateZeroInflationCapFloorVols()) {</div>
<div class="line"><span class="lineno">  132</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760">generateZeroInflationCapFloorVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() ||</div>
<div class="line"><span class="lineno">  134</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::ZeroInflationCapFloorVolatility))</div>
<div class="line"><span class="lineno">  135</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760">generateZeroInflationCapFloorVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  136</span>    }</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateFXVols()) {</div>
<div class="line"><span class="lineno">  139</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4">generateFxVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  140</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::FXVolatility))</div>
<div class="line"><span class="lineno">  141</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4">generateFxVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  142</span>    }</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateEquityVols()) {</div>
<div class="line"><span class="lineno">  145</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430">generateEquityVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::EquityVolatility))</div>
<div class="line"><span class="lineno">  147</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430">generateEquityVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  148</span>    }</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateSwapVols()) {</div>
<div class="line"><span class="lineno">  151</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e">generateSwaptionVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::SwaptionVolatility))</div>
<div class="line"><span class="lineno">  153</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e">generateSwaptionVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  154</span>    }</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateYieldVols()) {</div>
<div class="line"><span class="lineno">  157</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6">generateYieldVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  158</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::YieldVolatility))</div>
<div class="line"><span class="lineno">  159</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6">generateYieldVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateCapFloorVols()) {</div>
<div class="line"><span class="lineno">  163</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847">generateCapFloorVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::OptionletVolatility))</div>
<div class="line"><span class="lineno">  165</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847">generateCapFloorVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  166</span>    }</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateSurvivalProbabilities()) {</div>
<div class="line"><span class="lineno">  169</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8">generateSurvivalProbabilityScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::SurvivalProbability))</div>
<div class="line"><span class="lineno">  171</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8">generateSurvivalProbabilityScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  172</span>    }</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateCdsVols()) {</div>
<div class="line"><span class="lineno">  175</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8">generateCdsVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::CDSVolatility))</div>
<div class="line"><span class="lineno">  177</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8">generateCdsVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  178</span>    }</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateBaseCorrelations()) {</div>
<div class="line"><span class="lineno">  181</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b">generateBaseCorrelationScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  182</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::BaseCorrelation))</div>
<div class="line"><span class="lineno">  183</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b">generateBaseCorrelationScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  184</span>    }</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityCurveSimulate()) {</div>
<div class="line"><span class="lineno">  187</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c">generateCommodityCurveScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::CommodityCurve))</div>
<div class="line"><span class="lineno">  189</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c">generateCommodityCurveScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  190</span>    }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityVolSimulate()) {</div>
<div class="line"><span class="lineno">  193</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015">generateCommodityVolScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::CommodityVolatility))</div>
<div class="line"><span class="lineno">  195</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015">generateCommodityVolScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  196</span>    }</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;securitySpreadsSimulate()) {</div>
<div class="line"><span class="lineno">  199</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd">generateSecuritySpreadScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::SecuritySpread))</div>
<div class="line"><span class="lineno">  201</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd">generateSecuritySpreadScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateCorrelations()) {</div>
<div class="line"><span class="lineno">  205</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f">generateCorrelationScenarios</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  206</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;computeGamma() || <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;twoSidedDelta(RFType::Correlation))</div>
<div class="line"><span class="lineno">  207</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f">generateCorrelationScenarios</a>(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  208</span>    }</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    <span class="comment">// fill keyToFactor and factorToKey maps from scenario descriptions</span></div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Fill maps linking factors with RiskFactorKeys&quot;</span>);</div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a550b32664adc23116670df03e4b4ebce">keyToFactor_</a>.clear();</div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae283c71e6d637d6e3e1dedd3d3245b73">factorToKey_</a>.clear();</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  216</span>        RiskFactorKey key = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>[i].key1();</div>
<div class="line"><span class="lineno">  217</span>        <span class="keywordtype">string</span> factor = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>[i].factor1();</div>
<div class="line"><span class="lineno">  218</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a550b32664adc23116670df03e4b4ebce">keyToFactor_</a>[key] = factor;</div>
<div class="line"><span class="lineno">  219</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae283c71e6d637d6e3e1dedd3d3245b73">factorToKey_</a>[factor] = key;</div>
<div class="line"><span class="lineno">  220</span>        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;KeyToFactor map: &quot;</span> &lt;&lt; key &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; factor);</div>
<div class="line"><span class="lineno">  221</span>    }</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="comment">// add simultaneous up-moves in two risk factors for cross gamma calculation</span></div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  226</span>        ScenarioDescription iDesc = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>[i];</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">if</span> (iDesc.type() != ScenarioDescription::Type::Up)</div>
<div class="line"><span class="lineno">  228</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordtype">string</span> iKeyName = iDesc.keyName1();</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>        <span class="comment">// check if iKey matches filter</span></div>
<div class="line"><span class="lineno">  232</span>        <span class="keywordflow">if</span> (find_if(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().begin(), <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().end(),</div>
<div class="line"><span class="lineno">  233</span>                    findFactor(iKeyName)) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().end())</div>
<div class="line"><span class="lineno">  234</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>        <span class="keywordflow">for</span> (Size j = i + 1; j &lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size(); ++j) {</div>
<div class="line"><span class="lineno">  237</span>            ScenarioDescription jDesc = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>[j];</div>
<div class="line"><span class="lineno">  238</span>            <span class="keywordflow">if</span> (jDesc.type() != ScenarioDescription::Type::Up)</div>
<div class="line"><span class="lineno">  239</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  240</span>            <span class="keywordtype">string</span> jKeyName = jDesc.keyName1();</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>            <span class="comment">// check if jKey matches filter</span></div>
<div class="line"><span class="lineno">  243</span>            <span class="keywordflow">if</span> (find_if(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().begin(), <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().end(),</div>
<div class="line"><span class="lineno">  244</span>                        findPair(iKeyName, jKeyName)) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;crossGammaFilter().end())</div>
<div class="line"><span class="lineno">  245</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>            <span class="comment">// build cross scenario</span></div>
<div class="line"><span class="lineno">  248</span>            boost::shared_ptr&lt;Scenario&gt; crossScenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; k : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;keys()) {</div>
<div class="line"><span class="lineno">  251</span>                Real v1 = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>[i]-&gt;get(k);</div>
<div class="line"><span class="lineno">  252</span>                Real v2 = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>[j]-&gt;get(k);</div>
<div class="line"><span class="lineno">  253</span>                Real b = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;get(k);</div>
<div class="line"><span class="lineno">  254</span>                <span class="keywordflow">if</span> (!<a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(v1, b) || !<a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(v2, b))</div>
<div class="line"><span class="lineno">  255</span>                    <span class="comment">// this is correct for both absolute and relative shifts</span></div>
<div class="line"><span class="lineno">  256</span>                    crossScenario-&gt;add(k, v1 + v2 - b);</div>
<div class="line"><span class="lineno">  257</span>            }</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(ScenarioDescription(iDesc, jDesc));</div>
<div class="line"><span class="lineno">  260</span>            crossScenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  261</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(crossScenario);</div>
<div class="line"><span class="lineno">  262</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; crossScenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno">  263</span>        }</div>
<div class="line"><span class="lineno">  264</span>    }</div>
<div class="line"><span class="lineno">  265</span> </div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;sensitivity scenario generator initialised&quot;</span>);</div>
<div class="line"><span class="lineno">  267</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a16e5241dfb0b21ac043e2e32a22374f6"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6">ore::analytics::SensitivityScenarioGenerator::generateYoYInflationCapFloorVolScenarios</a></div><div class="ttdeci">void generateYoYInflationCapFloorVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01747">sensitivityscenariogenerator.cpp:1747</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a2cb7749581f38e7c3e5eae03657d6d33"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33">ore::analytics::SensitivityScenarioGenerator::generateYoYInflationScenarios</a></div><div class="ttdeci">void generateYoYInflationScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01650">sensitivityscenariogenerator.cpp:1650</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a2f0155590944e309a2706b53ee0b963e"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e">ore::analytics::SensitivityScenarioGenerator::generateSwaptionVolScenarios</a></div><div class="ttdeci">void generateSwaptionVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01215">sensitivityscenariogenerator.cpp:1215</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a2ff246db7c4c67d5d2735e10b9c5d760"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760">ore::analytics::SensitivityScenarioGenerator::generateZeroInflationCapFloorVolScenarios</a></div><div class="ttdeci">void generateZeroInflationCapFloorVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01853">sensitivityscenariogenerator.cpp:1853</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a3ac8a9ece30efe88a9131963f851d176"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176">ore::analytics::SensitivityScenarioGenerator::generateZeroInflationScenarios</a></div><div class="ttdeci">void generateZeroInflationScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01557">sensitivityscenariogenerator.cpp:1557</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a3ba51e2d1738678433fa86a6cc862027"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027">ore::analytics::SensitivityScenarioGenerator::generateIndexCurveScenarios</a></div><div class="ttdeci">void generateIndexCurveScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00511">sensitivityscenariogenerator.cpp:511</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a4f67d3089b1f5d7d05f72b726bbcb847"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847">ore::analytics::SensitivityScenarioGenerator::generateCapFloorVolScenarios</a></div><div class="ttdeci">void generateCapFloorVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01241">sensitivityscenariogenerator.cpp:1241</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a5909315dd0dd00c38ebb9401f016381c"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c">ore::analytics::SensitivityScenarioGenerator::generateCommodityCurveScenarios</a></div><div class="ttdeci">void generateCommodityCurveScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02074">sensitivityscenariogenerator.cpp:2074</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a650b13cc30c1c0cb72ab4dbb60c90db1"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1">ore::analytics::SensitivityScenarioGenerator::generateYieldCurveScenarios</a></div><div class="ttdeci">void generateYieldCurveScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00608">sensitivityscenariogenerator.cpp:608</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a7b50a26e6b152bbcdaf05d9733016430"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430">ore::analytics::SensitivityScenarioGenerator::generateEquityVolScenarios</a></div><div class="ttdeci">void generateEquityVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00908">sensitivityscenariogenerator.cpp:908</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a8d59ef3dc24cdb6a4306230119a9185b"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b">ore::analytics::SensitivityScenarioGenerator::generateBaseCorrelationScenarios</a></div><div class="ttdeci">void generateBaseCorrelationScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01959">sensitivityscenariogenerator.cpp:1959</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a9945e729ab6796e7d826f5d1b2fac3c6"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6">ore::analytics::SensitivityScenarioGenerator::generateYieldVolScenarios</a></div><div class="ttdeci">void generateYieldVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01228">sensitivityscenariogenerator.cpp:1228</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a9c63287e5bf9685a9b0863c941f7f2c1"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1">ore::analytics::SensitivityScenarioGenerator::generateDiscountCurveScenarios</a></div><div class="ttdeci">void generateDiscountCurveScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00411">sensitivityscenariogenerator.cpp:411</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_aad9b9dbc48ccb62b71c9bcf0bc1f5db8"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8">ore::analytics::SensitivityScenarioGenerator::generateCdsVolScenarios</a></div><div class="ttdeci">void generateCdsVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01466">sensitivityscenariogenerator.cpp:1466</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_aaf3e88184ad3e14d3a3f60fd7300fcfd"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd">ore::analytics::SensitivityScenarioGenerator::generateSecuritySpreadScenarios</a></div><div class="ttdeci">void generateSecuritySpreadScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02390">sensitivityscenariogenerator.cpp:2390</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ac62a903c3bc67c55dcba8ad800019ca2"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2">ore::analytics::SensitivityScenarioGenerator::generateFxScenarios</a></div><div class="ttdeci">void generateFxScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00286">sensitivityscenariogenerator.cpp:286</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ad33b9fbcfde02400f5807edf18326ce8"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8">ore::analytics::SensitivityScenarioGenerator::generateSurvivalProbabilityScenarios</a></div><div class="ttdeci">void generateSurvivalProbabilityScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01362">sensitivityscenariogenerator.cpp:1362</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ad782034ca45729d5c04df8b80e2206f4"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4">ore::analytics::SensitivityScenarioGenerator::generateFxVolScenarios</a></div><div class="ttdeci">void generateFxVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00797">sensitivityscenariogenerator.cpp:797</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ae8c23507e58896ff857af151365a6015"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015">ore::analytics::SensitivityScenarioGenerator::generateCommodityVolScenarios</a></div><div class="ttdeci">void generateCommodityVolScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02169">sensitivityscenariogenerator.cpp:2169</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ae936b20b7f07f4a58b3c8c563a033b72"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72">ore::analytics::SensitivityScenarioGenerator::generateDividendYieldScenarios</a></div><div class="ttdeci">void generateDividendYieldScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00702">sensitivityscenariogenerator.cpp:702</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_af7514f26c1f3e6e7803bcdb96d81ec6f"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f">ore::analytics::SensitivityScenarioGenerator::generateCorrelationScenarios</a></div><div class="ttdeci">void generateCorrelationScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02275">sensitivityscenariogenerator.cpp:2275</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_afeedcacdff9b31f492c0a826828b9baf"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf">ore::analytics::SensitivityScenarioGenerator::generateEquityScenarios</a></div><div class="ttdeci">void generateEquityScenarios(bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00350">sensitivityscenariogenerator.cpp:350</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a0bd85b6f8f58d6c5cf6f3ab6c040a41f"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">ore::analytics::ShiftScenarioGenerator::scenarioDescriptions_</a></div><div class="ttdeci">std::vector&lt; ScenarioDescription &gt; scenarioDescriptions_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00190">shiftscenariogenerator.hpp:190</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a550b32664adc23116670df03e4b4ebce"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a550b32664adc23116670df03e4b4ebce">ore::analytics::ShiftScenarioGenerator::keyToFactor_</a></div><div class="ttdeci">std::map&lt; RiskFactorKey, std::string &gt; keyToFactor_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00192">shiftscenariogenerator.hpp:192</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a8a42206bfb9d57d14fb8a25d841692ce"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">ore::analytics::ShiftScenarioGenerator::baseScenario_</a></div><div class="ttdeci">const boost::shared_ptr&lt; Scenario &gt; baseScenario_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00185">shiftscenariogenerator.hpp:185</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a9fa1c3e52dd2282a94cb8df118e517dc"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">ore::analytics::ShiftScenarioGenerator::simMarketData_</a></div><div class="ttdeci">const boost::shared_ptr&lt; ScenarioSimMarketParameters &gt; simMarketData_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00186">shiftscenariogenerator.hpp:186</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_ae283c71e6d637d6e3e1dedd3d3245b73"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae283c71e6d637d6e3e1dedd3d3245b73">ore::analytics::ShiftScenarioGenerator::factorToKey_</a></div><div class="ttdeci">std::map&lt; std::string, RiskFactorKey &gt; factorToKey_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00194">shiftscenariogenerator.hpp:194</a></div></div>
<div class="ttc" id="agroup__utilities_html_ga1b8cd9a976247da6df232ad48d4af190"><div class="ttname"><a href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a></div><div class="ttdeci">std::string to_string(const QuantLib::Date &amp;date)</div></div>
<div class="ttc" id="alog_8hpp_html_a158e0f085ddedfe5c8ed069986039f50"><div class="ttname"><a href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a></div><div class="ttdeci">#define LOG(text)</div></div>
<div class="ttc" id="alog_8hpp_html_a34c7c8cde9b91d2eee82d7b9a0b66fd5"><div class="ttname"><a href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a></div><div class="ttdeci">#define DLOG(text)</div></div>
<div class="ttc" id="anamespace_quant_ext_html_a1cab4fb6a720eff245acb9f3a7a9e7c5"><div class="ttname"><a href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a></div><div class="ttdeci">Filter close_enough(const RandomVariable &amp;x, const RandomVariable &amp;y)</div></div>
<div class="ttc" id="atest_2scenarioshiftcalculator_8cpp_html_a652b8805d9b88185e25574d4820660c4"><div class="ttname"><a href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a></div><div class="ttdeci">Date asof(14, Jun, 2018)</div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_cgraph">
<area shape="rect" title=" " alt="" coords="5,849,136,874"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="838,689,885,714"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="1045,1110,1147,1135"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b" title=" " alt="" coords="471,639,693,665"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="825,738,897,763"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847" title=" " alt="" coords="481,754,683,779"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8" title=" " alt="" coords="496,590,668,615"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c" title=" " alt="" coords="468,803,696,829"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015" title=" " alt="" coords="475,439,689,465"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f" title=" " alt="" coords="486,489,678,514"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1" title=" " alt="" coords="475,1263,689,1289"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72" title=" " alt="" coords="479,1214,685,1239"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf" title=" " alt="" coords="499,390,665,415"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430" title=" " alt="" coords="489,1017,675,1042"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2" title=" " alt="" coords="509,341,655,366"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4" title=" " alt="" coords="500,1066,664,1091"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027" title=" " alt="" coords="485,1165,679,1190"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd" title=" " alt="" coords="473,291,691,317"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8" title=" " alt="" coords="494,1363,670,1403"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e" title=" " alt="" coords="201,1305,403,1330"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1" title=" " alt="" coords="487,1115,677,1141"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6" title=" " alt="" coords="213,1354,391,1379"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6" title=" " alt="" coords="485,689,679,729"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33" title=" " alt="" coords="483,902,681,927"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760" title=" " alt="" coords="500,952,664,992"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176" title=" " alt="" coords="483,853,681,878"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html#aaf7f2ac6726a834eb907975a177bb1ed" title=" " alt="" coords="201,1455,403,1510"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html#a15994db51fc48298a94001e57d54305b" title="Inspectors." alt="" coords="184,1535,420,1575"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="769,1009,954,1049"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6ad7ae91ef2d71d973dce2f1fd66d56c" title=" " alt="" coords="747,475,975,501"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="764,861,959,886"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="774,959,949,985"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="1027,959,1165,985"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9363e3e8d8df9640bbeab55c93fffa9d" title=" " alt="" coords="758,590,965,615"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aacbfc6ab59a6c85e622ab858b4eee24c" title=" " alt="" coords="771,426,951,451"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a36c90a4563e88cf2b66058371685c7b6" title=" " alt="" coords="744,639,979,665"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c" title=" " alt="" coords="816,213,907,238"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a03fe6e79109200285178c3e85cc98acd" title=" " alt="" coords="751,262,972,287"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a05852fc1e9a1d15cbe24af1003430ea3" title=" " alt="" coords="762,377,961,402"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec" title=" " alt="" coords="781,312,942,352"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad55463e7bc2f60b4eeaae92fc3df57f8" title=" " alt="" coords="768,1486,955,1511"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="808,1385,915,1410"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b2ddb1824da83ff9e5fae9caecfcfb8" title=" " alt="" coords="755,1335,968,1361"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1eac93475a1c9d611e854a825e0289b3" title=" " alt="" coords="775,163,948,189"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6b4ab69d6e0663a291f9cc36f355ec90" title=" " alt="" coords="765,1138,957,1163"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4c013a7ebb2a17fc8ce2404ead5fd52c" title=" " alt="" coords="787,114,935,139"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6abc89e6315b80ada5497ef0d5ecbc1a" title=" " alt="" coords="778,1187,945,1213"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a81a5d16fda37846aa9f1b09ad69c2790" title=" " alt="" coords="777,1286,946,1311"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5894bae3460d65e021318164a4f480d6" title=" " alt="" coords="749,65,974,90"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14" title=" " alt="" coords="779,1683,943,1709"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1e729008d28bc0a85fa73aac49db28ff" title=" " alt="" coords="774,1733,949,1773"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014" title=" " alt="" coords="471,1313,693,1338"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093" title=" " alt="" coords="800,1634,923,1659"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312" title=" " alt="" coords="757,1535,965,1561"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd" title=" " alt="" coords="769,1585,953,1610"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ab4499bf098f760582d4a5726133cd2ff" title=" " alt="" coords="779,1237,944,1262"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a52659907f53c9543366619e3154411d4" title=" " alt="" coords="757,525,966,565"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad9aa2a7ef0eb4646aa00597b6bb71bc4" title=" " alt="" coords="760,910,963,935"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a87cb703bf265164cef649e6d455772a0" title=" " alt="" coords="780,1073,943,1113"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a840da6725f71e6ae7db519d84cb3d275" title=" " alt="" coords="758,787,965,813"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html#ad10e153af32bbb25fa2688594806200d" title=" " alt="" coords="481,1455,683,1510"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa62ece5f85b43378ea6ad94a43f74ee4_icgraph">
<area shape="rect" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a650b13cc30c1c0cb72ab4dbb60c90db1" name="a650b13cc30c1c0cb72ab4dbb60c90db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a650b13cc30c1c0cb72ab4dbb60c90db1">&#9670;&#160;</a></span>generateYieldCurveScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateYieldCurveScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00608">608</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  608</span>                                                                      {</div>
<div class="line"><span class="lineno">  609</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  610</span>    <span class="comment">// We can choose to shift fewer yield curves than listed in the market</span></div>
<div class="line"><span class="lineno">  611</span>    <span class="comment">// Log an ALERT if some yield curves in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno">  612</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_yc : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveNames()) {</div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldCurveShiftData().find(sim_yc) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldCurveShiftData().end()) {</div>
<div class="line"><span class="lineno">  614</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Yield Curve &quot;</span> &lt;&lt; sim_yc &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  615</span>        }</div>
<div class="line"><span class="lineno">  616</span>    }</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> y : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldCurveShiftData()) {</div>
<div class="line"><span class="lineno">  619</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = y.first;</div>
<div class="line"><span class="lineno">  620</span>        Size n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(name).size();</div>
<div class="line"><span class="lineno">  621</span>        <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno">  622</span>        std::vector&lt;Real&gt; zeros(n_ten);</div>
<div class="line"><span class="lineno">  623</span>        std::vector&lt;Real&gt; times(n_ten);</div>
<div class="line"><span class="lineno">  624</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno">  625</span>        std::vector&lt;Real&gt; shiftedZeros(n_ten);</div>
<div class="line"><span class="lineno">  626</span>        SensitivityScenarioData::CurveShiftData data = *y.second;</div>
<div class="line"><span class="lineno">  627</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  628</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno">  629</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  630</span>            <span class="keywordflow">if</span>(<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno">  631</span>                dc = s-&gt;yieldCurve(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  632</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  633</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno">  634</span>            }</div>
<div class="line"><span class="lineno">  635</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno">  636</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for yield curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno">  637</span>        }</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>        Real quote = 0.0;</div>
<div class="line"><span class="lineno">  640</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  641</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno">  642</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(name)[j];</div>
<div class="line"><span class="lineno">  643</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno">  644</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738">RiskFactorKey::KeyType::YieldCurve</a>, name, j);</div>
<div class="line"><span class="lineno">  645</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, quote, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  646</span>            zeros[j] = -std::log(quote) / times[j];</div>
<div class="line"><span class="lineno">  647</span>        }</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno">  649</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>        <span class="keyword">const</span> std::vector&lt;Period&gt;&amp; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasYieldCurveTenors(name)</div>
<div class="line"><span class="lineno">  652</span>                                                     ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(name)</div>
<div class="line"><span class="lineno">  653</span>                                                     : data.shiftTenors;</div>
<div class="line"><span class="lineno">  654</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;Yield Curve &quot;</span> + name, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  655</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno">  657</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno">  658</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno">  659</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Discount shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno">  662</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  667</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ab4499bf098f760582d4a5726133cd2ff">yieldScenarioDescription</a>(name, j, up));</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>            <span class="comment">// apply zero rate shift at tenor point j</span></div>
<div class="line"><span class="lineno">  670</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, zeros, times, shiftedZeros, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>            <span class="comment">// store shifted discount curve in the scenario</span></div>
<div class="line"><span class="lineno">  673</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno">  674</span>                Real shiftedDiscount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-shiftedZeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  675</span>                RiskFactorKey key(RFType::YieldCurve, name, k);</div>
<div class="line"><span class="lineno">  676</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno">  677</span>                    Real discount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-zeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  678</span>                    scenario-&gt;add(key, shiftedDiscount / discount);</div>
<div class="line"><span class="lineno">  679</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  680</span>                    scenario-&gt;add(key, shiftedDiscount);</div>
<div class="line"><span class="lineno">  681</span>                }</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno">  684</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno">  685</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedZeros[k] - zeros[k];</div>
<div class="line"><span class="lineno">  686</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = zeros[k];</div>
<div class="line"><span class="lineno">  687</span>                }</div>
<div class="line"><span class="lineno">  688</span>            }</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  691</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno">  694</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  695</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno">  698</span>    }</div>
<div class="line"><span class="lineno">  699</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Yield curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  700</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738">ore::analytics::RiskFactorKey::KeyType::YieldCurve</a></div><div class="ttdeci">@ YieldCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ab4499bf098f760582d4a5726133cd2ff"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ab4499bf098f760582d4a5726133cd2ff">ore::analytics::SensitivityScenarioGenerator::yieldScenarioDescription</a></div><div class="ttdeci">ScenarioDescription yieldScenarioDescription(string name, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02526">sensitivityscenariogenerator.cpp:2526</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_a162cfc221721116690ade22a8da732f2"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">ore::analytics::ShiftScenarioGenerator::simMarket_</a></div><div class="ttdeci">const boost::weak_ptr&lt; ScenarioSimMarket &gt; simMarket_</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00187">shiftscenariogenerator.hpp:187</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_aa50d390d6448fb5266f2ab758bb74861"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">ore::analytics::ShiftScenarioGenerator::applyShift</a></div><div class="ttdeci">void applyShift(Size j, Real shiftSize, bool up, ShiftType type, const vector&lt; Time &gt; &amp;shiftTimes, const vector&lt; Real &gt; &amp;values, const vector&lt; Time &gt; &amp;times, vector&lt; Real &gt; &amp;shiftedValues, bool initialise)</div><div class="ttdoc">Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access.</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_shift_scenario_generator_html_ae6645effb55b498ae924e935d438a900"><div class="ttname"><a href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ore::analytics::ShiftScenarioGenerator::ShiftType</a></div><div class="ttdeci">ShiftType</div><div class="ttdef"><b>Definition:</b> <a href="shiftscenariogenerator_8hpp_source.html#l00045">shiftscenariogenerator.hpp:45</a></div></div>
<div class="ttc" id="alog_8hpp_html_a9622ca943201e814041f051b7a10b3ea"><div class="ttname"><a href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a></div><div class="ttdeci">#define WLOG(text)</div></div>
<div class="ttc" id="anamespace_quant_ext_html_a11171c842d01ffacc4ec522e398070a9"><div class="ttname"><a href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">QuantExt::exp</a></div><div class="ttdeci">RandomVariable exp(RandomVariable x)</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a2984ae998c17c67c5e374b3896e6f44e"><div class="ttname"><a href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">ore::analytics::vectorEqual</a></div><div class="ttdeci">bool vectorEqual(const vector&lt; Real &gt; &amp;v_1, const vector&lt; Real &gt; &amp;v_2)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l00078">sensitivityscenariogenerator.cpp:78</a></div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a5cceb12d217bac14eeda59d5f774f7c1"><div class="ttname"><a href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">ore::analytics::parseShiftType</a></div><div class="ttdeci">ShiftScenarioGenerator::ShiftType parseShiftType(const std::string &amp;s)</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2shiftscenariogenerator_8cpp_source.html#l00145">shiftscenariogenerator.cpp:145</a></div></div>
<div class="ttc" id="atodaysmarketparameters_8cpp_html_a8ccf841cb59e451791bcb2e1ac4f1edc"><div class="ttname"><a href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a></div><div class="ttdeci">string name</div></div>
</div><!-- fragment --><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_cgraph">
<area shape="rect" title=" " alt="" coords="5,193,196,218"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="249,5,434,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="318,70,365,95"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="288,119,395,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="244,193,439,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="305,242,377,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="254,291,429,317"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ab4499bf098f760582d4a5726133cd2ff" title=" " alt="" coords="259,341,424,366"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="487,291,625,317"/>
</map>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a650b13cc30c1c0cb72ab4dbb60c90db1_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,612,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a9c63287e5bf9685a9b0863c941f7f2c1" name="a9c63287e5bf9685a9b0863c941f7f2c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c63287e5bf9685a9b0863c941f7f2c1">&#9670;&#160;</a></span>generateDiscountCurveScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateDiscountCurveScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00411">411</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  411</span>                                                                         {</div>
<div class="line"><span class="lineno">  412</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  413</span>    <span class="comment">// Log an ALERT if some currencies in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_ccy : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;ccys()) {</div>
<div class="line"><span class="lineno">  415</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;discountCurveShiftData().find(sim_ccy) ==</div>
<div class="line"><span class="lineno">  416</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;discountCurveShiftData().end()) {</div>
<div class="line"><span class="lineno">  417</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Currency &quot;</span> &lt;&lt; sim_ccy &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  418</span>        }</div>
<div class="line"><span class="lineno">  419</span>    }</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;discountCurveShiftData()) {</div>
<div class="line"><span class="lineno">  422</span>        <span class="keywordtype">string</span> ccy = c.first;</div>
<div class="line"><span class="lineno">  423</span>        Size n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(ccy).size();</div>
<div class="line"><span class="lineno">  424</span>        <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno">  425</span>        std::vector&lt;Real&gt; zeros(n_ten);</div>
<div class="line"><span class="lineno">  426</span>        std::vector&lt;Real&gt; times(n_ten);</div>
<div class="line"><span class="lineno">  427</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno">  428</span>        std::vector&lt;Real&gt; shiftedZeros(n_ten);</div>
<div class="line"><span class="lineno">  429</span>        SensitivityScenarioData::CurveShiftData data = *c.second;</div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  431</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  433</span>            <span class="keywordflow">if</span>(<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno">  434</span>                dc = s-&gt;discountCurve(ccy)-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  435</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  436</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno">  437</span>            }</div>
<div class="line"><span class="lineno">  438</span>        } <span class="keywordflow">catch</span>(<span class="keyword">const</span> std::exception&amp;)  {</div>
<div class="line"><span class="lineno">  439</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for discount curve &quot;</span> &lt;&lt; ccy &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno">  440</span>        }</div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>        Real quote = 0.0;</div>
<div class="line"><span class="lineno">  443</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno">  445</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(ccy)[j];</div>
<div class="line"><span class="lineno">  446</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313">RiskFactorKey::KeyType::DiscountCurve</a>, ccy, j);</div>
<div class="line"><span class="lineno">  449</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, quote, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  450</span>            zeros[j] = -std::log(quote) / times[j];</div>
<div class="line"><span class="lineno">  451</span>        }</div>
<div class="line"><span class="lineno">  452</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno">  453</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>        std::vector&lt;Period&gt; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasYieldCurveTenors(ccy)</div>
<div class="line"><span class="lineno">  456</span>                                              ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(ccy)</div>
<div class="line"><span class="lineno">  457</span>                                              : data.shiftTenors;</div>
<div class="line"><span class="lineno">  458</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;Discount Curve &quot;</span> + ccy, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  459</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno">  460</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno">  461</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno">  462</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno">  463</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Discount shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  471</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad55463e7bc2f60b4eeaae92fc3df57f8">discountScenarioDescription</a>(ccy, j, up));</div>
<div class="line"><span class="lineno">  472</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;generate discount curve scenario, ccy &quot;</span> &lt;&lt; ccy &lt;&lt; <span class="stringliteral">&quot;, bucket &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, up &quot;</span> &lt;&lt; up &lt;&lt; <span class="stringliteral">&quot;, desc &quot;</span></div>
<div class="line"><span class="lineno">  473</span>                                                          &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back());</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>            <span class="comment">// apply zero rate shift at tenor point j</span></div>
<div class="line"><span class="lineno">  476</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, zeros, times, shiftedZeros, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>            <span class="comment">// store shifted discount curve in the scenario</span></div>
<div class="line"><span class="lineno">  479</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno">  480</span>                RiskFactorKey key(RFType::DiscountCurve, ccy, k);</div>
<div class="line"><span class="lineno">  481</span>                <span class="comment">// FIXME why do we have that here, but not in generateIndexCurveScenarios?</span></div>
<div class="line"><span class="lineno">  482</span>                <span class="keywordflow">if</span> (!<a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(shiftedZeros[k], zeros[k])) {</div>
<div class="line"><span class="lineno">  483</span>                    Real shiftedDiscount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-shiftedZeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  484</span>                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno">  485</span>                        Real discount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-zeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  486</span>                        scenario-&gt;add(key, shiftedDiscount / discount);</div>
<div class="line"><span class="lineno">  487</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  488</span>                        scenario-&gt;add(key, shiftedDiscount);</div>
<div class="line"><span class="lineno">  489</span>                    }</div>
<div class="line"><span class="lineno">  490</span>                }</div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno">  493</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno">  494</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedZeros[k] - zeros[k];</div>
<div class="line"><span class="lineno">  495</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = zeros[k];</div>
<div class="line"><span class="lineno">  496</span>                }</div>
<div class="line"><span class="lineno">  497</span>            }</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  500</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno">  503</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  504</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno">  507</span>    }</div>
<div class="line"><span class="lineno">  508</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Discount curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  509</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313">ore::analytics::RiskFactorKey::KeyType::DiscountCurve</a></div><div class="ttdeci">@ DiscountCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ad55463e7bc2f60b4eeaae92fc3df57f8"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad55463e7bc2f60b4eeaae92fc3df57f8">ore::analytics::SensitivityScenarioGenerator::discountScenarioDescription</a></div><div class="ttdeci">ScenarioDescription discountScenarioDescription(string ccy, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02484">sensitivityscenariogenerator.cpp:2484</a></div></div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_cgraph">
<area shape="rect" title=" " alt="" coords="5,194,219,219"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="271,5,457,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="341,70,387,95"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="313,119,415,145"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad55463e7bc2f60b4eeaae92fc3df57f8" title=" " alt="" coords="271,169,457,194"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="311,218,417,243"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="267,291,461,317"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="328,341,400,366"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="277,390,451,415"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="509,390,648,415"/>
</map>
</div>
<div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9c63287e5bf9685a9b0863c941f7f2c1_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,635,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a3ba51e2d1738678433fa86a6cc862027" name="a3ba51e2d1738678433fa86a6cc862027"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ba51e2d1738678433fa86a6cc862027">&#9670;&#160;</a></span>generateIndexCurveScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateIndexCurveScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00511">511</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  511</span>                                                                      {</div>
<div class="line"><span class="lineno">  512</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_idx : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;indices()) {</div>
<div class="line"><span class="lineno">  515</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;indexCurveShiftData().find(sim_idx) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;indexCurveShiftData().end()) {</div>
<div class="line"><span class="lineno">  516</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Index &quot;</span> &lt;&lt; sim_idx &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  517</span>        }</div>
<div class="line"><span class="lineno">  518</span>    }</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> idx : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;indexCurveShiftData()) {</div>
<div class="line"><span class="lineno">  521</span>        <span class="keywordtype">string</span> indexName = idx.first;</div>
<div class="line"><span class="lineno">  522</span>        Size n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(indexName).size();</div>
<div class="line"><span class="lineno">  523</span>        <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno">  524</span>        std::vector&lt;Real&gt; zeros(n_ten);</div>
<div class="line"><span class="lineno">  525</span>        std::vector&lt;Real&gt; times(n_ten);</div>
<div class="line"><span class="lineno">  526</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno">  527</span>        std::vector&lt;Real&gt; shiftedZeros(n_ten);</div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span>        SensitivityScenarioData::CurveShiftData data = *idx.second;</div>
<div class="line"><span class="lineno">  530</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  534</span>            <span class="keywordflow">if</span>(<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno">  535</span>                dc = s-&gt;iborIndex(indexName)-&gt;forwardingTermStructure()-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  536</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  537</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno">  538</span>            }</div>
<div class="line"><span class="lineno">  539</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno">  540</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for index &quot;</span> &lt;&lt; indexName &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno">  541</span>        }</div>
<div class="line"><span class="lineno">  542</span>        </div>
<div class="line"><span class="lineno">  543</span>        Real quote = 0.0;</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno">  546</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(indexName)[j];</div>
<div class="line"><span class="lineno">  547</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno">  548</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614">RiskFactorKey::KeyType::IndexCurve</a>, indexName, j);</div>
<div class="line"><span class="lineno">  549</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, quote, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  550</span>            zeros[j] = -std::log(quote) / times[j];</div>
<div class="line"><span class="lineno">  551</span>        }</div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno">  553</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>        std::vector&lt;Period&gt; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasYieldCurveTenors(indexName)</div>
<div class="line"><span class="lineno">  556</span>                                              ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldCurveTenors(indexName)</div>
<div class="line"><span class="lineno">  557</span>                                              : data.shiftTenors;</div>
<div class="line"><span class="lineno">  558</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;Index Curve &quot;</span> + indexName, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  559</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno">  560</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno">  561</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno">  562</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno">  563</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Index shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno">  566</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  571</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a81a5d16fda37846aa9f1b09ad69c2790">indexScenarioDescription</a>(indexName, j, up));</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>            <span class="comment">// apply zero rate shift at tenor point j</span></div>
<div class="line"><span class="lineno">  574</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, zeros, times, shiftedZeros, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>            <span class="comment">// store shifted discount curve for this index in the scenario</span></div>
<div class="line"><span class="lineno">  577</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno">  578</span>                RiskFactorKey key(RFType::IndexCurve, indexName, k);</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>                Real shiftedDiscount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-shiftedZeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  581</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno">  582</span>                    Real discount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-zeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  583</span>                    scenario-&gt;add(key, shiftedDiscount / discount);</div>
<div class="line"><span class="lineno">  584</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  585</span>                    scenario-&gt;add(key, shiftedDiscount);</div>
<div class="line"><span class="lineno">  586</span>                }</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno">  589</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno">  590</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedZeros[k] - zeros[k];</div>
<div class="line"><span class="lineno">  591</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = zeros[k];</div>
<div class="line"><span class="lineno">  592</span>                }</div>
<div class="line"><span class="lineno">  593</span>            }</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  596</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno">  599</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  600</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno">  601</span>                                           &lt;&lt; <span class="stringliteral">&quot; created for indexName &quot;</span> &lt;&lt; indexName);</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno">  604</span>    }</div>
<div class="line"><span class="lineno">  605</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Index curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  606</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614">ore::analytics::RiskFactorKey::KeyType::IndexCurve</a></div><div class="ttdeci">@ IndexCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a81a5d16fda37846aa9f1b09ad69c2790"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a81a5d16fda37846aa9f1b09ad69c2790">ore::analytics::SensitivityScenarioGenerator::indexScenarioDescription</a></div><div class="ttdeci">ScenarioDescription indexScenarioDescription(string index, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02505">sensitivityscenariogenerator.cpp:2505</a></div></div>
</div><!-- fragment --><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_cgraph">
<area shape="rect" title=" " alt="" coords="5,169,199,194"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="251,5,437,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="321,70,367,95"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="291,119,397,145"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a81a5d16fda37846aa9f1b09ad69c2790" title=" " alt="" coords="259,169,429,194"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="247,242,441,267"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="308,291,380,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="257,341,431,366"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="489,341,628,366"/>
</map>
</div>
<div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ba51e2d1738678433fa86a6cc862027_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,615,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ac62a903c3bc67c55dcba8ad800019ca2" name="ac62a903c3bc67c55dcba8ad800019ca2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac62a903c3bc67c55dcba8ad800019ca2">&#9670;&#160;</a></span>generateFxScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateFxScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00286">286</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  286</span>                                                              {</div>
<div class="line"><span class="lineno">  287</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  288</span>    <span class="comment">// We can choose to shift fewer FX risk factors than listed in the market</span></div>
<div class="line"><span class="lineno">  289</span>    <span class="comment">// Is this too strict?</span></div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">// - implemented to avoid cases where input cross FX rates are not consistent</span></div>
<div class="line"><span class="lineno">  291</span>    <span class="comment">// - Consider an example (baseCcy = EUR) of a GBPUSD FX trade - two separate routes to pricing</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="comment">// - (a) call GBPUSD FX rate from sim market</span></div>
<div class="line"><span class="lineno">  293</span>    <span class="comment">// - (b) call GBPEUR and EURUSD FX rates, manually join them to obtain GBPUSD</span></div>
<div class="line"><span class="lineno">  294</span>    <span class="comment">// - now, if GBPUSD is an explicit risk factor in sim market, consider what happens</span></div>
<div class="line"><span class="lineno">  295</span>    <span class="comment">// - if we bump GBPUSD value and leave other FX rates unchanged (for e.g. a sensitivity analysis)</span></div>
<div class="line"><span class="lineno">  296</span>    <span class="comment">// - (a) the value of the trade changes</span></div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// - (b) the value of the GBPUSD trade stays the same</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">// - in light of the above we restrict the universe of FX pairs that we support here for the time being</span></div>
<div class="line"><span class="lineno">  299</span>    <span class="keywordtype">string</span> baseCcy = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;baseCcy();</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sensi_fx : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxShiftData()) {</div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordtype">string</span> foreign = sensi_fx.first.substr(0, 3);</div>
<div class="line"><span class="lineno">  302</span>        <span class="keywordtype">string</span> domestic = sensi_fx.first.substr(3);</div>
<div class="line"><span class="lineno">  303</span>        QL_REQUIRE((domestic == baseCcy) || (foreign == baseCcy),</div>
<div class="line"><span class="lineno">  304</span>                   <span class="stringliteral">&quot;SensitivityScenarioGenerator does not support cross FX pairs(&quot;</span></div>
<div class="line"><span class="lineno">  305</span>                       &lt;&lt; sensi_fx.first &lt;&lt; <span class="stringliteral">&quot;, but base currency is &quot;</span> &lt;&lt; baseCcy &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  306</span>    }</div>
<div class="line"><span class="lineno">  307</span>    <span class="comment">// Log an ALERT if some currencies in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_fx : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxCcyPairs()) {</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxShiftData().find(sim_fx) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxShiftData().end()) {</div>
<div class="line"><span class="lineno">  310</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;FX pair &quot;</span> &lt;&lt; sim_fx &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  311</span>        }</div>
<div class="line"><span class="lineno">  312</span>    }</div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sensi_fx : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxShiftData()) {</div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordtype">string</span> ccypair = sensi_fx.first; <span class="comment">// foreign + domestic;</span></div>
<div class="line"><span class="lineno">  315</span>        SensitivityScenarioData::SpotShiftData data = sensi_fx.second;</div>
<div class="line"><span class="lineno">  316</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> type = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  317</span>        Real size = up ? data.shiftSize : -1.0 * data.shiftSize;</div>
<div class="line"><span class="lineno">  318</span>        <span class="comment">// QL_REQUIRE(type == SensitivityScenarioGenerator::ShiftType::Relative, &quot;FX scenario type must be relative&quot;);</span></div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordtype">bool</span> relShift = (type == SensitivityScenarioGenerator::ShiftType::Relative);</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>        Real rate;</div>
<div class="line"><span class="lineno">  322</span>        RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3">RiskFactorKey::KeyType::FXSpot</a>, ccypair);</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">if</span> (!tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, rate, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>))</div>
<div class="line"><span class="lineno">  324</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>        boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4c013a7ebb2a17fc8ce2404ead5fd52c">fxScenarioDescription</a>(ccypair, up));</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>        Real newRate = relShift ? rate * (1.0 + size) : (rate + size);</div>
<div class="line"><span class="lineno">  331</span>        <span class="comment">// Real newRate = up ? rate * (1.0 + data.shiftSize) : rate * (1.0 - data.shiftSize);</span></div>
<div class="line"><span class="lineno">  332</span>        scenario-&gt;add(key, newRate);</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>        <span class="comment">// Store absolute shift size</span></div>
<div class="line"><span class="lineno">  335</span>        <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno">  336</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = newRate - rate;</div>
<div class="line"><span class="lineno">  337</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = rate;</div>
<div class="line"><span class="lineno">  338</span>        }</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>        <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  341</span>        scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  344</span>        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno">  345</span>                                       &lt;&lt; <span class="stringliteral">&quot; created: &quot;</span> &lt;&lt; newRate);</div>
<div class="line"><span class="lineno">  346</span>    }</div>
<div class="line"><span class="lineno">  347</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;FX scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  348</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3">ore::analytics::RiskFactorKey::KeyType::FXSpot</a></div><div class="ttdeci">@ FXSpot</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a4c013a7ebb2a17fc8ce2404ead5fd52c"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4c013a7ebb2a17fc8ce2404ead5fd52c">ore::analytics::SensitivityScenarioGenerator::fxScenarioDescription</a></div><div class="ttdeci">ScenarioDescription fxScenarioDescription(string ccypair, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02433">sensitivityscenariogenerator.cpp:2433</a></div></div>
</div><!-- fragment --><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,151,117"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="273,5,319,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4c013a7ebb2a17fc8ce2404ead5fd52c" title=" " alt="" coords="222,55,370,80"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="199,128,393,153"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="260,177,332,203"/>
</map>
</div>
<div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ac62a903c3bc67c55dcba8ad800019ca2_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,567,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="afeedcacdff9b31f492c0a826828b9baf" name="afeedcacdff9b31f492c0a826828b9baf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afeedcacdff9b31f492c0a826828b9baf">&#9670;&#160;</a></span>generateEquityScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateEquityScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00350">350</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  350</span>                                                                  {</div>
<div class="line"><span class="lineno">  351</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">// Log an ALERT if some equities in simmarket are excluded from the sensitivities list</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_equity : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityNames()) {</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityShiftData().find(sim_equity) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityShiftData().end()) {</div>
<div class="line"><span class="lineno">  356</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Equity &quot;</span> &lt;&lt; sim_equity &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  357</span>        }</div>
<div class="line"><span class="lineno">  358</span>    }</div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityShiftData()) {</div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordtype">string</span> equity = e.first;</div>
<div class="line"><span class="lineno">  361</span>        SensitivityScenarioData::SpotShiftData data = e.second;</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> type = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  363</span>        Real size = up ? data.shiftSize : -1.0 * data.shiftSize;</div>
<div class="line"><span class="lineno">  364</span>        <span class="keywordtype">bool</span> relShift = (type == SensitivityScenarioGenerator::ShiftType::Relative);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>        Real rate;</div>
<div class="line"><span class="lineno">  367</span>        RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad">RiskFactorKey::KeyType::EquitySpot</a>, equity);</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">if</span> (!tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, rate, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>))</div>
<div class="line"><span class="lineno">  369</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>        boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1eac93475a1c9d611e854a825e0289b3">equityScenarioDescription</a>(equity, up));</div>
<div class="line"><span class="lineno">  374</span>        Real newRate = relShift ? rate * (1.0 + size) : (rate + size);</div>
<div class="line"><span class="lineno">  375</span>        <span class="comment">// Real newRate = up ? rate * (1.0 + data.shiftSize) : rate * (1.0 - data.shiftSize);</span></div>
<div class="line"><span class="lineno">  376</span>        scenario-&gt;add(key, newRate);</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>        <span class="comment">// Store absolute shift size</span></div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno">  380</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = newRate - rate;</div>
<div class="line"><span class="lineno">  381</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = rate;</div>
<div class="line"><span class="lineno">  382</span>        }</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>        <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  385</span>        scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  388</span>        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno">  389</span>                                       &lt;&lt; <span class="stringliteral">&quot; created: &quot;</span> &lt;&lt; newRate);</div>
<div class="line"><span class="lineno">  390</span>    }</div>
<div class="line"><span class="lineno">  391</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Equity scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  392</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad">ore::analytics::RiskFactorKey::KeyType::EquitySpot</a></div><div class="ttdeci">@ EquitySpot</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a1eac93475a1c9d611e854a825e0289b3"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1eac93475a1c9d611e854a825e0289b3">ore::analytics::SensitivityScenarioGenerator::equityScenarioDescription</a></div><div class="ttdeci">ScenarioDescription equityScenarioDescription(string equity, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02447">sensitivityscenariogenerator.cpp:2447</a></div></div>
</div><!-- fragment --><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,172,117"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="294,5,341,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1eac93475a1c9d611e854a825e0289b3" title=" " alt="" coords="231,55,404,80"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="220,128,415,153"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="281,177,353,203"/>
</map>
</div>
<div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_afeedcacdff9b31f492c0a826828b9baf_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,588,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ae936b20b7f07f4a58b3c8c563a033b72" name="ae936b20b7f07f4a58b3c8c563a033b72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae936b20b7f07f4a58b3c8c563a033b72">&#9670;&#160;</a></span>generateDividendYieldScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateDividendYieldScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00702">702</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  702</span>                                                                         {</div>
<div class="line"><span class="lineno">  703</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>    <span class="comment">// We can choose to shift fewer yield curves than listed in the market</span></div>
<div class="line"><span class="lineno">  706</span>    <span class="comment">// Log an ALERT if some yield curves in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno">  707</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityNames()) {</div>
<div class="line"><span class="lineno">  708</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;dividendYieldShiftData().find(sim) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;dividendYieldShiftData().end()) {</div>
<div class="line"><span class="lineno">  709</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Equity &quot;</span> &lt;&lt; sim &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in dividend yield sensitivity analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  710</span>        }</div>
<div class="line"><span class="lineno">  711</span>    }</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;dividendYieldShiftData()) {</div>
<div class="line"><span class="lineno">  714</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = d.first;</div>
<div class="line"><span class="lineno">  715</span>        Size n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityDividendTenors(name).size();</div>
<div class="line"><span class="lineno">  716</span>        <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno">  717</span>        std::vector&lt;Real&gt; zeros(n_ten);</div>
<div class="line"><span class="lineno">  718</span>        std::vector&lt;Real&gt; times(n_ten);</div>
<div class="line"><span class="lineno">  719</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno">  720</span>        std::vector&lt;Real&gt; shiftedZeros(n_ten);</div>
<div class="line"><span class="lineno">  721</span>        SensitivityScenarioData::CurveShiftData data = *d.second;</div>
<div class="line"><span class="lineno">  722</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  723</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno">  724</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  725</span>            <span class="keywordflow">if</span>(<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno">  726</span>                dc = s-&gt;equityDividendCurve(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  727</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  728</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno">  729</span>            }</div>
<div class="line"><span class="lineno">  730</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno">  731</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for dividend yield curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno">  732</span>        }</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>        Real quote = 0.0;</div>
<div class="line"><span class="lineno">  735</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno">  737</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityDividendTenors(name)[j];</div>
<div class="line"><span class="lineno">  738</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno">  739</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438">RiskFactorKey::KeyType::DividendYield</a>, name, j);</div>
<div class="line"><span class="lineno">  740</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, quote, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  741</span>            zeros[j] = -std::log(quote) / times[j];</div>
<div class="line"><span class="lineno">  742</span>        }</div>
<div class="line"><span class="lineno">  743</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno">  744</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>        <span class="keyword">const</span> std::vector&lt;Period&gt;&amp; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasEquityDividendTenors(name)</div>
<div class="line"><span class="lineno">  747</span>                                                     ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityDividendTenors(name)</div>
<div class="line"><span class="lineno">  748</span>                                                     : data.shiftTenors;</div>
<div class="line"><span class="lineno">  749</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;Dividend Yield &quot;</span> + name, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  750</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno">  751</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno">  752</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno">  753</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno">  754</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Discount shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  762</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b2ddb1824da83ff9e5fae9caecfcfb8">dividendYieldScenarioDescription</a>(name, j, up));</div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span>            <span class="comment">// apply zero rate shift at tenor point j</span></div>
<div class="line"><span class="lineno">  765</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, zeros, times, shiftedZeros, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>            <span class="comment">// store shifted discount curve in the scenario</span></div>
<div class="line"><span class="lineno">  768</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno">  769</span>                Real shiftedDiscount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-shiftedZeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  770</span>                RiskFactorKey key(RFType::DividendYield, name, k);</div>
<div class="line"><span class="lineno">  771</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno">  772</span>                    Real discount = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-zeros[k] * times[k]);</div>
<div class="line"><span class="lineno">  773</span>                    scenario-&gt;add(key, shiftedDiscount / discount);</div>
<div class="line"><span class="lineno">  774</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  775</span>                    scenario-&gt;add(key, shiftedDiscount);</div>
<div class="line"><span class="lineno">  776</span>                }</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno">  779</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno">  780</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedZeros[k] - zeros[k];</div>
<div class="line"><span class="lineno">  781</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = zeros[k];</div>
<div class="line"><span class="lineno">  782</span>                }</div>
<div class="line"><span class="lineno">  783</span>            }</div>
<div class="line"><span class="lineno">  784</span> </div>
<div class="line"><span class="lineno">  785</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  786</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno">  789</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  790</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno">  793</span>    }</div>
<div class="line"><span class="lineno">  794</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Dividend yield curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  795</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438">ore::analytics::RiskFactorKey::KeyType::DividendYield</a></div><div class="ttdeci">@ DividendYield</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a4b2ddb1824da83ff9e5fae9caecfcfb8"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b2ddb1824da83ff9e5fae9caecfcfb8">ore::analytics::SensitivityScenarioGenerator::dividendYieldScenarioDescription</a></div><div class="ttdeci">ScenarioDescription dividendYieldScenarioDescription(string equity, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02462">sensitivityscenariogenerator.cpp:2462</a></div></div>
</div><!-- fragment --><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_cgraph">
<area shape="rect" title=" " alt="" coords="5,169,212,194"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="274,5,459,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="343,70,390,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b2ddb1824da83ff9e5fae9caecfcfb8" title=" " alt="" coords="260,119,473,145"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="313,169,420,194"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="269,242,464,267"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="331,291,403,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="279,341,454,366"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="521,341,660,366"/>
</map>
</div>
<div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae936b20b7f07f4a58b3c8c563a033b72_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,628,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a2f0155590944e309a2706b53ee0b963e" name="a2f0155590944e309a2706b53ee0b963e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f0155590944e309a2706b53ee0b963e">&#9670;&#160;</a></span>generateSwaptionVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateSwaptionVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01215">1215</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1215</span>                                                                       {</div>
<div class="line"><span class="lineno"> 1216</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;starting swapVol sgen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1217</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1218</span>    <span class="comment">// Log an ALERT if some swaption currencies in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1219</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_key : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;swapVolKeys()) {</div>
<div class="line"><span class="lineno"> 1220</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;swaptionVolShiftData().find(sim_key) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;swaptionVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1221</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Swaption key &quot;</span> &lt;&lt; sim_key &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1222</span>        }</div>
<div class="line"><span class="lineno"> 1223</span>    }</div>
<div class="line"><span class="lineno"> 1224</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014">generateGenericYieldVolScenarios</a>(up, RFType::SwaptionVolatility);</div>
<div class="line"><span class="lineno"> 1225</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Swaption vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1226</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_aa15d0f2e93f0677d51e215ed114e4014"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014">ore::analytics::SensitivityScenarioGenerator::generateGenericYieldVolScenarios</a></div><div class="ttdeci">void generateGenericYieldVolScenarios(bool up, RiskFactorKey::KeyType rfType)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l01023">sensitivityscenariogenerator.cpp:1023</a></div></div>
</div><!-- fragment --><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_cgraph">
<area shape="rect" title=" " alt="" coords="5,218,208,243"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014" title=" " alt="" coords="256,218,479,243"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="538,5,723,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="607,70,654,95"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093" title=" " alt="" coords="569,119,692,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="533,193,728,218"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312" title=" " alt="" coords="527,242,735,267"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="595,291,667,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="543,341,718,366"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd" title=" " alt="" coords="539,390,723,415"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="801,242,903,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="783,341,921,366"/>
</map>
</div>
<div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2f0155590944e309a2706b53ee0b963e_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,624,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a9945e729ab6796e7d826f5d1b2fac3c6" name="a9945e729ab6796e7d826f5d1b2fac3c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9945e729ab6796e7d826f5d1b2fac3c6">&#9670;&#160;</a></span>generateYieldVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateYieldVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01228">1228</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1228</span>                                                                    {</div>
<div class="line"><span class="lineno"> 1229</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;starting yieldVol sgen&quot;</span>);</div>
<div class="line"><span class="lineno"> 1230</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1231</span>    <span class="comment">// Log an ALERT if some bond securityId in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1232</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_securityId : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldVolNames()) {</div>
<div class="line"><span class="lineno"> 1233</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldVolShiftData().find(sim_securityId) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1234</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Bond securityId &quot;</span> &lt;&lt; sim_securityId &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1235</span>        }</div>
<div class="line"><span class="lineno"> 1236</span>    }</div>
<div class="line"><span class="lineno"> 1237</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014">generateGenericYieldVolScenarios</a>(up, RFType::YieldVolatility);</div>
<div class="line"><span class="lineno"> 1238</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Yield vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1239</span>}</div>
</div><!-- fragment --><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_cgraph">
<area shape="rect" title=" " alt="" coords="5,218,184,243"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014" title=" " alt="" coords="232,218,455,243"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="514,5,699,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="583,70,630,95"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093" title=" " alt="" coords="545,119,668,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="509,193,704,218"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312" title=" " alt="" coords="503,242,711,267"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="571,291,643,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="519,341,694,366"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd" title=" " alt="" coords="515,390,699,415"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="777,242,879,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="759,341,897,366"/>
</map>
</div>
<div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9945e729ab6796e7d826f5d1b2fac3c6_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,600,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ad782034ca45729d5c04df8b80e2206f4" name="ad782034ca45729d5c04df8b80e2206f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad782034ca45729d5c04df8b80e2206f4">&#9670;&#160;</a></span>generateFxVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateFxVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00797">797</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  797</span>                                                                 {</div>
<div class="line"><span class="lineno">  798</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  799</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno">  800</span>    <span class="comment">// Log an ALERT if some FX vol pairs in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno">  801</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_fx : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolCcyPairs()) {</div>
<div class="line"><span class="lineno">  802</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxVolShiftData().find(sim_fx) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxVolShiftData().end()) {</div>
<div class="line"><span class="lineno">  803</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;FX pair &quot;</span> &lt;&lt; sim_fx &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  804</span>        }</div>
<div class="line"><span class="lineno">  805</span>    }</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxVolShiftData()) {</div>
<div class="line"><span class="lineno">  808</span>        <span class="keywordtype">string</span> ccyPair = f.first;</div>
<div class="line"><span class="lineno">  809</span>        QL_REQUIRE(ccyPair.length() == 6, <span class="stringliteral">&quot;invalid ccy pair length&quot;</span>);</div>
<div class="line"><span class="lineno">  810</span>        </div>
<div class="line"><span class="lineno">  811</span>        Size n_fxvol_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolExpiries(ccyPair).size();</div>
<div class="line"><span class="lineno">  812</span>        std::vector&lt;Real&gt; times(n_fxvol_exp);</div>
<div class="line"><span class="lineno">  813</span>        Size n_fxvol_strikes;</div>
<div class="line"><span class="lineno">  814</span>        vector&lt;Real&gt; vol_strikes;</div>
<div class="line"><span class="lineno">  815</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolIsSurface(ccyPair)) {</div>
<div class="line"><span class="lineno">  816</span>            vol_strikes = {0.0};</div>
<div class="line"><span class="lineno">  817</span>            n_fxvol_strikes = 1;</div>
<div class="line"><span class="lineno">  818</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxUseMoneyness(ccyPair)) {</div>
<div class="line"><span class="lineno">  819</span>            n_fxvol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolMoneyness(ccyPair).size();</div>
<div class="line"><span class="lineno">  820</span>            vol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolMoneyness(ccyPair);</div>
<div class="line"><span class="lineno">  821</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  822</span>            n_fxvol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolStdDevs(ccyPair).size();</div>
<div class="line"><span class="lineno">  823</span>            vol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolStdDevs(ccyPair);</div>
<div class="line"><span class="lineno">  824</span>        }</div>
<div class="line"><span class="lineno">  825</span>        vector&lt;vector&lt;Real&gt;&gt; values(n_fxvol_exp, vector&lt;Real&gt;(n_fxvol_strikes, 0.0));</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno">  828</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedValues(n_fxvol_exp, vector&lt;Real&gt;(n_fxvol_strikes, 0.0));</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>        SensitivityScenarioData::VolShiftData data = f.second;</div>
<div class="line"><span class="lineno">  831</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  832</span>        std::vector&lt;Period&gt; shiftTenors = data.shiftExpiries;</div>
<div class="line"><span class="lineno">  833</span>        std::vector&lt;Real&gt; shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno">  834</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno">  835</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno">  836</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;FX vol shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno">  839</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  840</span>            <span class="keywordflow">if</span>(<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno">  841</span>                dc = s-&gt;fxVol(ccyPair)-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  842</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  843</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno">  844</span>            }</div>
<div class="line"><span class="lineno">  845</span>        } <span class="keywordflow">catch</span>(<span class="keyword">const</span> std::exception&amp;)  {</div>
<div class="line"><span class="lineno">  846</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for fx vol surface &quot;</span> &lt;&lt; ccyPair &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno">  847</span>        }</div>
<div class="line"><span class="lineno">  848</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  849</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_fxvol_exp; ++j) {</div>
<div class="line"><span class="lineno">  850</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;fxVolExpiries(ccyPair)[j];</div>
<div class="line"><span class="lineno">  851</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno">  852</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_fxvol_strikes; k++) {</div>
<div class="line"><span class="lineno">  853</span>                Size idx = k * n_fxvol_exp + j;</div>
<div class="line"><span class="lineno">  854</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942">RiskFactorKey::KeyType::FXVolatility</a>, ccyPair, idx);</div>
<div class="line"><span class="lineno">  855</span>                valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, values[j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  856</span>            }</div>
<div class="line"><span class="lineno">  857</span>        }</div>
<div class="line"><span class="lineno">  858</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno">  859</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno">  862</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno">  865</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes) &amp;&amp; (<a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(vol_strikes, shiftStrikes) ||</div>
<div class="line"><span class="lineno">  866</span>                                                                 (vol_strikes.size() == 1 &amp;&amp; shiftStrikes.size() == 1));</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  869</span>            <span class="keywordflow">for</span> (Size strikeBucket = 0; strikeBucket &lt; shiftStrikes.size(); ++strikeBucket) {</div>
<div class="line"><span class="lineno">  870</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6abc89e6315b80ada5497ef0d5ecbc1a">fxVolScenarioDescription</a>(ccyPair, j, strikeBucket, up));</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, strikeBucket, shiftSize, up, shiftType, shiftTimes, shiftStrikes, times, vol_strikes,</div>
<div class="line"><span class="lineno">  875</span>                           values, shiftedValues, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>                <span class="keywordflow">for</span> (Size k = 0; k &lt; n_fxvol_strikes; ++k) {</div>
<div class="line"><span class="lineno">  878</span>                    <span class="keywordflow">for</span> (Size l = 0; l &lt; n_fxvol_exp; ++l) {</div>
<div class="line"><span class="lineno">  879</span>                        Size idx = k * n_fxvol_exp + l;</div>
<div class="line"><span class="lineno">  880</span>                        RiskFactorKey key(RFType::FXVolatility, ccyPair, idx);</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno">  883</span>                            scenario-&gt;add(key, shiftedValues[l][k] - values[l][k]);</div>
<div class="line"><span class="lineno">  884</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  885</span>                            scenario-&gt;add(key, shiftedValues[l][k]);</div>
<div class="line"><span class="lineno">  886</span>                        }</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno">  889</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == l &amp;&amp; strikeBucket == k) {</div>
<div class="line"><span class="lineno">  890</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedValues[l][k] - values[l][k];</div>
<div class="line"><span class="lineno">  891</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = values[l][k];</div>
<div class="line"><span class="lineno">  892</span>                        }</div>
<div class="line"><span class="lineno">  893</span>                    }</div>
<div class="line"><span class="lineno">  894</span>                }</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno">  897</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno">  900</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno">  901</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno">  902</span>            }</div>
<div class="line"><span class="lineno">  903</span>        }</div>
<div class="line"><span class="lineno">  904</span>    }</div>
<div class="line"><span class="lineno">  905</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;FX vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno">  906</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942">ore::analytics::RiskFactorKey::KeyType::FXVolatility</a></div><div class="ttdeci">@ FXVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a6abc89e6315b80ada5497ef0d5ecbc1a"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6abc89e6315b80ada5497ef0d5ecbc1a">ore::analytics::SensitivityScenarioGenerator::fxVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription fxVolScenarioDescription(string ccypair, Size expiryBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02547">sensitivityscenariogenerator.cpp:2547</a></div></div>
</div><!-- fragment --><div id="dynsection-22" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-22-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-22-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-22-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,169,182"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="222,5,407,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="291,70,338,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6abc89e6315b80ada5497ef0d5ecbc1a" title=" " alt="" coords="231,119,398,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="217,193,412,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="279,242,351,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="227,291,402,317"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="478,119,581,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="460,291,599,317"/>
</map>
</div>
<div id="dynsection-23" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-23-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-23-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-23-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad782034ca45729d5c04df8b80e2206f4_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,585,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a7b50a26e6b152bbcdaf05d9733016430" name="a7b50a26e6b152bbcdaf05d9733016430"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b50a26e6b152bbcdaf05d9733016430">&#9670;&#160;</a></span>generateEquityVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateEquityVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l00908">908</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  908</span>                                                                     {</div>
<div class="line"><span class="lineno">  909</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno">  910</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno">  911</span>    <span class="comment">// Log an ALERT if an Equity in simmarket are excluded from the simulation list</span></div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_equity : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolNames()) {</div>
<div class="line"><span class="lineno">  913</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityVolShiftData().find(sim_equity) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityVolShiftData().end()) {</div>
<div class="line"><span class="lineno">  914</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Equity &quot;</span> &lt;&lt; sim_equity &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno">  915</span>        }</div>
<div class="line"><span class="lineno">  916</span>    }</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityVolShiftData()) {</div>
<div class="line"><span class="lineno">  919</span>        <span class="keywordtype">string</span> equity = e.first;</div>
<div class="line"><span class="lineno">  920</span>        SensitivityScenarioData::VolShiftData data = e.second;</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>        Size n_eqvol_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolExpiries(equity).size();</div>
<div class="line"><span class="lineno">  923</span>        Size n_eqvol_strikes;</div>
<div class="line"><span class="lineno">  924</span>        vector&lt;Real&gt; vol_strikes;</div>
<div class="line"><span class="lineno">  925</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolIsSurface(equity)) {</div>
<div class="line"><span class="lineno">  926</span>            vol_strikes = {0.0};</div>
<div class="line"><span class="lineno">  927</span>            n_eqvol_strikes = 1;</div>
<div class="line"><span class="lineno">  928</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityUseMoneyness(equity)) {</div>
<div class="line"><span class="lineno">  929</span>            vol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolMoneyness(equity);</div>
<div class="line"><span class="lineno">  930</span>            n_eqvol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolMoneyness(equity).size();</div>
<div class="line"><span class="lineno">  931</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  932</span>            vol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolStandardDevs(equity);</div>
<div class="line"><span class="lineno">  933</span>            n_eqvol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolStandardDevs(equity).size();</div>
<div class="line"><span class="lineno">  934</span>        }</div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span>        <span class="comment">// [strike] x [expiry]</span></div>
<div class="line"><span class="lineno">  937</span>        vector&lt;vector&lt;Real&gt;&gt; values(n_eqvol_strikes, vector&lt;Real&gt;(n_eqvol_exp, 0.0));</div>
<div class="line"><span class="lineno">  938</span>        vector&lt;Real&gt; times(n_eqvol_exp);</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>        <span class="comment">// buffer for shifted vols</span></div>
<div class="line"><span class="lineno">  941</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedValues(n_eqvol_strikes, vector&lt;Real&gt;(n_eqvol_exp, 0.0));</div>
<div class="line"><span class="lineno">  942</span> </div>
<div class="line"><span class="lineno">  943</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno">  944</span>        vector&lt;Period&gt; shiftTenors = data.shiftExpiries;</div>
<div class="line"><span class="lineno">  945</span>        std::vector&lt;Real&gt; shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno">  946</span>        vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno">  947</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno">  948</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Equity vol shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno">  949</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno">  950</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  951</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno">  952</span>                dc = s-&gt;equityVol(equity)-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  953</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  954</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno">  955</span>            }</div>
<div class="line"><span class="lineno">  956</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno">  957</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for equity vol surface &quot;</span> &lt;&lt; equity</div>
<div class="line"><span class="lineno">  958</span>                                                                                          &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno">  959</span>        }</div>
<div class="line"><span class="lineno">  960</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  961</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_eqvol_exp; ++j) {</div>
<div class="line"><span class="lineno">  962</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;equityVolExpiries(equity)[j];</div>
<div class="line"><span class="lineno">  963</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno">  964</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_eqvol_strikes; k++) {</div>
<div class="line"><span class="lineno">  965</span>                Size idx = k * n_eqvol_exp + j;</div>
<div class="line"><span class="lineno">  966</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b">RiskFactorKey::KeyType::EquityVolatility</a>, equity, idx);</div>
<div class="line"><span class="lineno">  967</span>                valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, values[k][j], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno">  968</span>            }</div>
<div class="line"><span class="lineno">  969</span>        }</div>
<div class="line"><span class="lineno">  970</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno">  971</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  974</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno">  975</span>        }</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno">  978</span>        <span class="comment">// Will only work currently if simulation market has a single strike</span></div>
<div class="line"><span class="lineno">  979</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno">  980</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(vol_strikes, shiftStrikes);</div>
<div class="line"><span class="lineno">  981</span> </div>
<div class="line"><span class="lineno">  982</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  983</span>            <span class="keywordflow">for</span> (Size strikeBucket = 0; strikeBucket &lt; shiftStrikes.size(); ++strikeBucket) {</div>
<div class="line"><span class="lineno">  984</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6b4ab69d6e0663a291f9cc36f355ec90">equityVolScenarioDescription</a>(equity, j, strikeBucket, up));</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(strikeBucket, j, shiftSize, up, shiftType, shiftStrikes, shiftTimes, vol_strikes, times,</div>
<div class="line"><span class="lineno">  989</span>                           values, shiftedValues, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>                <span class="comment">// update the scenario</span></div>
<div class="line"><span class="lineno">  992</span>                <span class="keywordflow">for</span> (Size k = 0; k &lt; n_eqvol_strikes; ++k) {</div>
<div class="line"><span class="lineno">  993</span>                    <span class="keywordflow">for</span> (Size l = 0; l &lt; n_eqvol_exp; l++) {</div>
<div class="line"><span class="lineno">  994</span>                        Size idx = k * n_eqvol_exp + l;</div>
<div class="line"><span class="lineno">  995</span>                        RiskFactorKey key(RFType::EquityVolatility, equity, idx);</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno">  998</span>                            scenario-&gt;add(key, shiftedValues[k][l] - values[k][l]);</div>
<div class="line"><span class="lineno">  999</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1000</span>                            scenario-&gt;add(key, shiftedValues[k][l]);</div>
<div class="line"><span class="lineno"> 1001</span>                        }</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1004</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == l &amp;&amp; k == strikeBucket) {</div>
<div class="line"><span class="lineno"> 1005</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedValues[k][l] - values[k][l];</div>
<div class="line"><span class="lineno"> 1006</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = values[k][l];</div>
<div class="line"><span class="lineno"> 1007</span>                        }</div>
<div class="line"><span class="lineno"> 1008</span>                    }</div>
<div class="line"><span class="lineno"> 1009</span>                }</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1012</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1013</span> </div>
<div class="line"><span class="lineno"> 1014</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1015</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1016</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 1017</span>            }</div>
<div class="line"><span class="lineno"> 1018</span>        }</div>
<div class="line"><span class="lineno"> 1019</span>    }</div>
<div class="line"><span class="lineno"> 1020</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Equity vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1021</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b">ore::analytics::RiskFactorKey::KeyType::EquityVolatility</a></div><div class="ttdeci">@ EquityVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a6b4ab69d6e0663a291f9cc36f355ec90"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6b4ab69d6e0663a291f9cc36f355ec90">ore::analytics::SensitivityScenarioGenerator::equityVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription equityVolScenarioDescription(string equity, Size expiryBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02575">sensitivityscenariogenerator.cpp:2575</a></div></div>
</div><!-- fragment --><div id="dynsection-24" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-24-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-24-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-24-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,192,182"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="245,5,430,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="314,70,361,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6b4ab69d6e0663a291f9cc36f355ec90" title=" " alt="" coords="241,119,433,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="240,193,435,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="301,242,373,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="250,291,425,317"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="501,119,603,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="483,291,621,317"/>
</map>
</div>
<div id="dynsection-25" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-25-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-25-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-25-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a7b50a26e6b152bbcdaf05d9733016430_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,608,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a4f67d3089b1f5d7d05f72b726bbcb847" name="a4f67d3089b1f5d7d05f72b726bbcb847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f67d3089b1f5d7d05f72b726bbcb847">&#9670;&#160;</a></span>generateCapFloorVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateCapFloorVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01241">1241</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1241</span>                                                                       {</div>
<div class="line"><span class="lineno"> 1242</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1243</span> </div>
<div class="line"><span class="lineno"> 1244</span>    <span class="comment">// Log an ALERT if some cap currencies in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1245</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_cap : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;capFloorVolKeys()) {</div>
<div class="line"><span class="lineno"> 1246</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;capFloorVolShiftData().find(sim_cap) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;capFloorVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1247</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;CapFloor key &quot;</span> &lt;&lt; sim_cap &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1248</span>        }</div>
<div class="line"><span class="lineno"> 1249</span>    }</div>
<div class="line"><span class="lineno"> 1250</span> </div>
<div class="line"><span class="lineno"> 1251</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;capFloorVolShiftData()) {</div>
<div class="line"><span class="lineno"> 1252</span>        std::string key = c.first;</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>        vector&lt;Real&gt; volStrikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;capFloorVolStrikes(key);</div>
<div class="line"><span class="lineno"> 1255</span>        <span class="comment">// Strikes may be empty which indicates that the optionlet structure in the simulation market is an ATM curve</span></div>
<div class="line"><span class="lineno"> 1256</span>        <span class="keywordflow">if</span> (volStrikes.empty()) {</div>
<div class="line"><span class="lineno"> 1257</span>            volStrikes = {0.0};</div>
<div class="line"><span class="lineno"> 1258</span>        }</div>
<div class="line"><span class="lineno"> 1259</span>        Size n_cfvol_strikes = volStrikes.size();</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>        Size n_cfvol_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;capFloorVolExpiries(key).size();</div>
<div class="line"><span class="lineno"> 1262</span>        SensitivityScenarioData::CapFloorVolShiftData data = *c.second;</div>
<div class="line"><span class="lineno"> 1263</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1264</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1265</span>        vector&lt;vector&lt;Real&gt;&gt; volData(n_cfvol_exp, vector&lt;Real&gt;(n_cfvol_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 1266</span>        vector&lt;Real&gt; volExpiryTimes(n_cfvol_exp, 0.0);</div>
<div class="line"><span class="lineno"> 1267</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedVolData(n_cfvol_exp, vector&lt;Real&gt;(n_cfvol_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>        std::vector&lt;Period&gt; expiries = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasCapFloorVolExpiries(key)</div>
<div class="line"><span class="lineno"> 1270</span>                                           ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;capFloorVolExpiries(key)</div>
<div class="line"><span class="lineno"> 1271</span>                                           : data.shiftExpiries;</div>
<div class="line"><span class="lineno"> 1272</span>        QL_REQUIRE(expiries.size() == data.shiftExpiries.size(), <span class="stringliteral">&quot;mismatch between effective shift expiries (&quot;</span></div>
<div class="line"><span class="lineno"> 1273</span>                                                                     &lt;&lt; expiries.size() &lt;&lt; <span class="stringliteral">&quot;) and shift tenors (&quot;</span></div>
<div class="line"><span class="lineno"> 1274</span>                                                                     &lt;&lt; data.shiftExpiries.size());</div>
<div class="line"><span class="lineno"> 1275</span>        vector&lt;Real&gt; shiftExpiryTimes(expiries.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1276</span>        vector&lt;Real&gt; shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno"> 1277</span>        <span class="comment">// Has an ATM shift been configured?</span></div>
<div class="line"><span class="lineno"> 1278</span>        <span class="keywordtype">bool</span> sensiIsAtm = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1279</span>        <span class="keywordflow">if</span> (shiftStrikes.size() == 1 &amp;&amp; shiftStrikes[0] == 0.0 &amp;&amp; data.isRelative) {</div>
<div class="line"><span class="lineno"> 1280</span>            sensiIsAtm = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1281</span>        }</div>
<div class="line"><span class="lineno"> 1282</span> </div>
<div class="line"><span class="lineno"> 1283</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1284</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1285</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1286</span>                dc = s-&gt;capFloorVol(key)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1287</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1288</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1289</span>            }</div>
<div class="line"><span class="lineno"> 1290</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1291</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for cap/floor vol surface &quot;</span> &lt;&lt; key &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1292</span>        }</div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>        <span class="comment">// cache original vol data</span></div>
<div class="line"><span class="lineno"> 1295</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_cfvol_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1296</span>            Date expiry = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;capFloorVolExpiries(key)[j];</div>
<div class="line"><span class="lineno"> 1297</span>            volExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, expiry);</div>
<div class="line"><span class="lineno"> 1298</span>        }</div>
<div class="line"><span class="lineno"> 1299</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1300</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_cfvol_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1301</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_cfvol_strikes; ++k) {</div>
<div class="line"><span class="lineno"> 1302</span>                Size idx = j * n_cfvol_strikes + k;</div>
<div class="line"><span class="lineno"> 1303</span>                valid = valid &amp;&amp;</div>
<div class="line"><span class="lineno"> 1304</span>                        tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>,</div>
<div class="line"><span class="lineno"> 1305</span>                                                RiskFactorKey(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab">RiskFactorKey::KeyType::OptionletVolatility</a>, key, idx),</div>
<div class="line"><span class="lineno"> 1306</span>                                                volData[j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1307</span>            }</div>
<div class="line"><span class="lineno"> 1308</span>        }</div>
<div class="line"><span class="lineno"> 1309</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1310</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1311</span> </div>
<div class="line"><span class="lineno"> 1312</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 1313</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 1314</span>            shiftExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + expiries[j]);</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 1317</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volExpiryTimes, shiftExpiryTimes);</div>
<div class="line"><span class="lineno"> 1318</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volStrikes, shiftStrikes);</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>        <span class="comment">// loop over shift expiries and terms</span></div>
<div class="line"><span class="lineno"> 1321</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1322</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; shiftStrikes.size(); ++k) {</div>
<div class="line"><span class="lineno"> 1323</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1324</span> </div>
<div class="line"><span class="lineno"> 1325</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9363e3e8d8df9640bbeab55c93fffa9d">capFloorVolScenarioDescription</a>(key, j, k, up, sensiIsAtm));</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, k, shiftSize, up, shiftType, shiftExpiryTimes, shiftStrikes, volExpiryTimes, volStrikes,</div>
<div class="line"><span class="lineno"> 1328</span>                           volData, shiftedVolData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1329</span> </div>
<div class="line"><span class="lineno"> 1330</span>                <span class="comment">// add shifted vol data to the scenario</span></div>
<div class="line"><span class="lineno"> 1331</span>                <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_cfvol_exp; ++jj) {</div>
<div class="line"><span class="lineno"> 1332</span>                    <span class="keywordflow">for</span> (Size kk = 0; kk &lt; n_cfvol_strikes; ++kk) {</div>
<div class="line"><span class="lineno"> 1333</span>                        Size idx = jj * n_cfvol_strikes + kk;</div>
<div class="line"><span class="lineno"> 1334</span>                        RiskFactorKey rfkey(RFType::OptionletVolatility, key, idx);</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1337</span>                            scenario-&gt;add(rfkey, shiftedVolData[jj][kk] - volData[jj][kk]);</div>
<div class="line"><span class="lineno"> 1338</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1339</span>                            scenario-&gt;add(rfkey, shiftedVolData[jj][kk]);</div>
<div class="line"><span class="lineno"> 1340</span>                        }</div>
<div class="line"><span class="lineno"> 1341</span> </div>
<div class="line"><span class="lineno"> 1342</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1343</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj &amp;&amp; k == kk) {</div>
<div class="line"><span class="lineno"> 1344</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[rfkey] = shiftedVolData[jj][kk] - volData[jj][kk];</div>
<div class="line"><span class="lineno"> 1345</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[rfkey] = volData[jj][kk];</div>
<div class="line"><span class="lineno"> 1346</span>                        }</div>
<div class="line"><span class="lineno"> 1347</span>                    }</div>
<div class="line"><span class="lineno"> 1348</span>                }</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1351</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1352</span> </div>
<div class="line"><span class="lineno"> 1353</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1354</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1355</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 1356</span>            }</div>
<div class="line"><span class="lineno"> 1357</span>        }</div>
<div class="line"><span class="lineno"> 1358</span>    }</div>
<div class="line"><span class="lineno"> 1359</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Optionlet vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1360</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab">ore::analytics::RiskFactorKey::KeyType::OptionletVolatility</a></div><div class="ttdeci">@ OptionletVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a9363e3e8d8df9640bbeab55c93fffa9d"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9363e3e8d8df9640bbeab55c93fffa9d">ore::analytics::SensitivityScenarioGenerator::capFloorVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription capFloorVolScenarioDescription(string ccy, Size expiryBucket, Size strikeBucket, bool up, bool isAtm)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02659">sensitivityscenariogenerator.cpp:2659</a></div></div>
</div><!-- fragment --><div id="dynsection-26" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-26-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-26-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-26-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,207,182"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="265,5,451,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="335,70,381,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9363e3e8d8df9640bbeab55c93fffa9d" title=" " alt="" coords="255,119,461,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="261,193,455,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="322,242,394,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="271,291,445,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="509,291,648,317"/>
</map>
</div>
<div id="dynsection-27" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-27-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-27-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-27-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4f67d3089b1f5d7d05f72b726bbcb847_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,623,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ad33b9fbcfde02400f5807edf18326ce8" name="ad33b9fbcfde02400f5807edf18326ce8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad33b9fbcfde02400f5807edf18326ce8">&#9670;&#160;</a></span>generateSurvivalProbabilityScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateSurvivalProbabilityScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01362">1362</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1362</span>                                                                               {</div>
<div class="line"><span class="lineno"> 1363</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1364</span>    <span class="comment">// We can choose to shift fewer credit curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1365</span>    <span class="comment">// Log an ALERT if some names in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1366</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_name : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;defaultNames()) {</div>
<div class="line"><span class="lineno"> 1367</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;creditCurveShiftData().find(sim_name) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;creditCurveShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1368</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Credit Name &quot;</span> &lt;&lt; sim_name &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1369</span>        }</div>
<div class="line"><span class="lineno"> 1370</span>    }</div>
<div class="line"><span class="lineno"> 1371</span>    Size n_ten;</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>    <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno"> 1374</span>    std::vector&lt;Real&gt; times;</div>
<div class="line"><span class="lineno"> 1375</span> </div>
<div class="line"><span class="lineno"> 1376</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;creditCurveShiftData()) {</div>
<div class="line"><span class="lineno"> 1377</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = c.first;</div>
<div class="line"><span class="lineno"> 1378</span>        n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;defaultTenors(name).size();</div>
<div class="line"><span class="lineno"> 1379</span>        std::vector&lt;Real&gt; hazardRates(n_ten); <span class="comment">// integrated hazard rates</span></div>
<div class="line"><span class="lineno"> 1380</span>        times.clear();</div>
<div class="line"><span class="lineno"> 1381</span>        times.resize(n_ten);</div>
<div class="line"><span class="lineno"> 1382</span>        <span class="comment">// buffer for shifted survival prob curves</span></div>
<div class="line"><span class="lineno"> 1383</span>        std::vector&lt;Real&gt; shiftedHazardRates(n_ten);</div>
<div class="line"><span class="lineno"> 1384</span>        SensitivityScenarioData::CurveShiftData data = *c.second;</div>
<div class="line"><span class="lineno"> 1385</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1386</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1387</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1388</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1389</span>                dc = s-&gt;defaultCurve(name)-&gt;curve()-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1390</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1391</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1392</span>            }</div>
<div class="line"><span class="lineno"> 1393</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1394</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for default curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1395</span>        }</div>
<div class="line"><span class="lineno"> 1396</span>        Calendar <a class="code hl_variableRef" href="../ored/utilities_8cpp.html#a78752433f4fe4a459158fefc086335e5">calendar</a> = <a class="code hl_functionRef" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14">parseCalendar</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;defaultCurveCalendar(name));</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>        Real prob = 0.0;</div>
<div class="line"><span class="lineno"> 1399</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1400</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno"> 1401</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;defaultTenors(name)[j];</div>
<div class="line"><span class="lineno"> 1402</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno"> 1403</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb">RiskFactorKey::KeyType::SurvivalProbability</a>, name, j);</div>
<div class="line"><span class="lineno"> 1404</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, prob, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1405</span>        <span class="comment">// ensure we have a valid value, if prob = 0 we need to avoid nan to generate valid scenarios</span></div>
<div class="line"><span class="lineno"> 1406</span>            hazardRates[j] = -std::log(std::max(prob, 1E-8)) / times[j];</div>
<div class="line"><span class="lineno"> 1407</span>        }</div>
<div class="line"><span class="lineno"> 1408</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1409</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>        std::vector&lt;Period&gt; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasDefaultTenors(name)</div>
<div class="line"><span class="lineno"> 1412</span>                                              ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;defaultTenors(name)</div>
<div class="line"><span class="lineno"> 1413</span>                                              : data.shiftTenors;</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;Default Curve &quot;</span> + name, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno"> 1418</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno"> 1419</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno"> 1420</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1421</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Discount shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno"> 1422</span> </div>
<div class="line"><span class="lineno"> 1423</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 1424</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno"> 1425</span> </div>
<div class="line"><span class="lineno"> 1426</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1429</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1e729008d28bc0a85fa73aac49db28ff">survivalProbabilityScenarioDescription</a>(name, j, up));</div>
<div class="line"><span class="lineno"> 1430</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;generate survival probability scenario, name &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, bucket &quot;</span> &lt;&lt; j &lt;&lt; <span class="stringliteral">&quot;, up &quot;</span> &lt;&lt; up</div>
<div class="line"><span class="lineno"> 1431</span>                                                                &lt;&lt; <span class="stringliteral">&quot;, desc &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back());</div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>            <span class="comment">// apply averaged hazard rate shift at tenor point j</span></div>
<div class="line"><span class="lineno"> 1434</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, hazardRates, times, shiftedHazardRates, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1435</span> </div>
<div class="line"><span class="lineno"> 1436</span>            <span class="comment">// store shifted survival Prob in the scenario</span></div>
<div class="line"><span class="lineno"> 1437</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno"> 1438</span>                RiskFactorKey key(RFType::SurvivalProbability, name, k);</div>
<div class="line"><span class="lineno"> 1439</span>                Real shiftedProb = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-shiftedHazardRates[k] * times[k]);</div>
<div class="line"><span class="lineno"> 1440</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1441</span>                    Real prob = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(-hazardRates[k] * times[k]);</div>
<div class="line"><span class="lineno"> 1442</span>                    scenario-&gt;add(key, shiftedProb / prob);</div>
<div class="line"><span class="lineno"> 1443</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1444</span>                    scenario-&gt;add(key, shiftedProb);</div>
<div class="line"><span class="lineno"> 1445</span>                }</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1448</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; k == j) {</div>
<div class="line"><span class="lineno"> 1449</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedHazardRates[k] - hazardRates[k];</div>
<div class="line"><span class="lineno"> 1450</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = hazardRates[k];</div>
<div class="line"><span class="lineno"> 1451</span>                }</div>
<div class="line"><span class="lineno"> 1452</span>            }</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1455</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1458</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1459</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 1460</span> </div>
<div class="line"><span class="lineno"> 1461</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno"> 1462</span>    }</div>
<div class="line"><span class="lineno"> 1463</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Discount curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1464</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb">ore::analytics::RiskFactorKey::KeyType::SurvivalProbability</a></div><div class="ttdeci">@ SurvivalProbability</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a1e729008d28bc0a85fa73aac49db28ff"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1e729008d28bc0a85fa73aac49db28ff">ore::analytics::SensitivityScenarioGenerator::survivalProbabilityScenarioDescription</a></div><div class="ttdeci">ScenarioDescription survivalProbabilityScenarioDescription(string name, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02687">sensitivityscenariogenerator.cpp:2687</a></div></div>
<div class="ttc" id="agroup__utilities_html_ga0f72d6fcccae10a674bdcd5095200f14"><div class="ttname"><a href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14">ore::data::parseCalendar</a></div><div class="ttdeci">Calendar parseCalendar(const string &amp;s)</div></div>
<div class="ttc" id="autilities_8cpp_html_a78752433f4fe4a459158fefc086335e5"><div class="ttname"><a href="../ored/utilities_8cpp.html#a78752433f4fe4a459158fefc086335e5">calendar</a></div><div class="ttdeci">Calendar calendar</div></div>
</div><!-- fragment --><div id="dynsection-28" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-28-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-28-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-28-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_cgraph">
<area shape="rect" title=" " alt="" coords="5,199,181,239"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="234,5,419,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="303,70,350,95"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9" title=" " alt="" coords="273,119,380,145"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14" title=" " alt="" coords="245,169,409,194"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="229,242,424,267"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a1e729008d28bc0a85fa73aac49db28ff" title=" " alt="" coords="239,292,414,332"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="291,357,363,382"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="239,406,414,431"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="472,406,611,431"/>
</map>
</div>
<div id="dynsection-29" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-29-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-29-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-29-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad33b9fbcfde02400f5807edf18326ce8_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,597,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,13,373,38"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,13,195,38"/>
</map>
</div>

</div>
</div>
<a id="aad9b9dbc48ccb62b71c9bcf0bc1f5db8" name="aad9b9dbc48ccb62b71c9bcf0bc1f5db8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad9b9dbc48ccb62b71c9bcf0bc1f5db8">&#9670;&#160;</a></span>generateCdsVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateCdsVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01466">1466</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1466</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1467</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1468</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1469</span>    <span class="comment">// Log an ALERT if some swaption currencies in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_name : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;cdsVolNames()) {</div>
<div class="line"><span class="lineno"> 1471</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;cdsVolShiftData().find(sim_name) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;cdsVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1472</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;CDS name &quot;</span> &lt;&lt; sim_name &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1473</span>        }</div>
<div class="line"><span class="lineno"> 1474</span>    }</div>
<div class="line"><span class="lineno"> 1475</span> </div>
<div class="line"><span class="lineno"> 1476</span>    Size n_cdsvol_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;cdsVolExpiries().size();</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span>    vector&lt;Real&gt; volData(n_cdsvol_exp, 0.0);</div>
<div class="line"><span class="lineno"> 1479</span>    vector&lt;Real&gt; volExpiryTimes(n_cdsvol_exp, 0.0);</div>
<div class="line"><span class="lineno"> 1480</span>    vector&lt;Real&gt; shiftedVolData(n_cdsvol_exp, 0.0);</div>
<div class="line"><span class="lineno"> 1481</span> </div>
<div class="line"><span class="lineno"> 1482</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;cdsVolShiftData()) {</div>
<div class="line"><span class="lineno"> 1483</span>        std::string <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = c.first;</div>
<div class="line"><span class="lineno"> 1484</span>        SensitivityScenarioData::CdsVolShiftData data = c.second;</div>
<div class="line"><span class="lineno"> 1485</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1486</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>        vector&lt;Time&gt; shiftExpiryTimes(data.shiftExpiries.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1491</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1492</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1493</span>                dc = s-&gt;cdsVol(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1494</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1495</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1496</span>            }</div>
<div class="line"><span class="lineno"> 1497</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1498</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for cds vol surface &quot;</span> &lt;&lt; name</div>
<div class="line"><span class="lineno"> 1499</span>                                                                                       &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1500</span>        }</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>        <span class="comment">// cache original vol data</span></div>
<div class="line"><span class="lineno"> 1503</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_cdsvol_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1504</span>            Date expiry = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;cdsVolExpiries()[j];</div>
<div class="line"><span class="lineno"> 1505</span>            volExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, expiry);</div>
<div class="line"><span class="lineno"> 1506</span>        }</div>
<div class="line"><span class="lineno"> 1507</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1508</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_cdsvol_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1509</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9">RiskFactorKey::KeyType::CDSVolatility</a>, name, j);</div>
<div class="line"><span class="lineno"> 1510</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, volData[j], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1511</span>        }</div>
<div class="line"><span class="lineno"> 1512</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1513</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 1516</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 1517</span>            shiftExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + data.shiftExpiries[j]);</div>
<div class="line"><span class="lineno"> 1518</span> </div>
<div class="line"><span class="lineno"> 1519</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 1520</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volExpiryTimes, shiftExpiryTimes);</div>
<div class="line"><span class="lineno"> 1521</span> </div>
<div class="line"><span class="lineno"> 1522</span>        <span class="comment">// loop over shift expiries and terms</span></div>
<div class="line"><span class="lineno"> 1523</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1524</span>            Size strikeBucket = 0; <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 1525</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aacbfc6ab59a6c85e622ab858b4eee24c">CdsVolScenarioDescription</a>(name, j, strikeBucket, up));</div>
<div class="line"><span class="lineno"> 1528</span> </div>
<div class="line"><span class="lineno"> 1529</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftExpiryTimes, volData, volExpiryTimes, shiftedVolData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1530</span>            <span class="comment">// add shifted vol data to the scenario</span></div>
<div class="line"><span class="lineno"> 1531</span>            <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_cdsvol_exp; ++jj) {</div>
<div class="line"><span class="lineno"> 1532</span>                RiskFactorKey key(RFType::CDSVolatility, name, jj);</div>
<div class="line"><span class="lineno"> 1533</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1534</span>                    scenario-&gt;add(key, shiftedVolData[jj] - volData[jj]);</div>
<div class="line"><span class="lineno"> 1535</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1536</span>                    scenario-&gt;add(key, shiftedVolData[jj]);</div>
<div class="line"><span class="lineno"> 1537</span>                }</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1540</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj) {</div>
<div class="line"><span class="lineno"> 1541</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedVolData[jj] - volData[jj];</div>
<div class="line"><span class="lineno"> 1542</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = volData[jj];</div>
<div class="line"><span class="lineno"> 1543</span>                }</div>
<div class="line"><span class="lineno"> 1544</span>            }</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1547</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1550</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1551</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 1552</span>        }</div>
<div class="line"><span class="lineno"> 1553</span>    }</div>
<div class="line"><span class="lineno"> 1554</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;CDS vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1555</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9">ore::analytics::RiskFactorKey::KeyType::CDSVolatility</a></div><div class="ttdeci">@ CDSVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_aacbfc6ab59a6c85e622ab858b4eee24c"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aacbfc6ab59a6c85e622ab858b4eee24c">ore::analytics::SensitivityScenarioGenerator::CdsVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription CdsVolScenarioDescription(string name, Size expiryBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02708">sensitivityscenariogenerator.cpp:2708</a></div></div>
</div><!-- fragment --><div id="dynsection-30" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-30-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-30-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-30-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,177,182"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="230,5,415,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="299,70,346,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aacbfc6ab59a6c85e622ab858b4eee24c" title=" " alt="" coords="233,119,413,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="225,193,420,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="287,242,359,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="235,291,410,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="468,291,607,317"/>
</map>
</div>
<div id="dynsection-31" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-31-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-31-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-31-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aad9b9dbc48ccb62b71c9bcf0bc1f5db8_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,593,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a3ac8a9ece30efe88a9131963f851d176" name="a3ac8a9ece30efe88a9131963f851d176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ac8a9ece30efe88a9131963f851d176">&#9670;&#160;</a></span>generateZeroInflationScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateZeroInflationScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01557">1557</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1557</span>                                                                         {</div>
<div class="line"><span class="lineno"> 1558</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1559</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1560</span>    <span class="comment">// Log an ALERT if some ibor indices in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1561</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_idx : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationIndices()) {</div>
<div class="line"><span class="lineno"> 1562</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCurveShiftData().find(sim_idx) ==</div>
<div class="line"><span class="lineno"> 1563</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCurveShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1564</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Zero Inflation Index &quot;</span> &lt;&lt; sim_idx &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1565</span>        }</div>
<div class="line"><span class="lineno"> 1566</span>    }</div>
<div class="line"><span class="lineno"> 1567</span> </div>
<div class="line"><span class="lineno"> 1568</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> z : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCurveShiftData()) {</div>
<div class="line"><span class="lineno"> 1569</span>        <span class="keywordtype">string</span> indexName = z.first;</div>
<div class="line"><span class="lineno"> 1570</span>        Size n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationTenors(indexName).size();</div>
<div class="line"><span class="lineno"> 1571</span>        <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno"> 1572</span>        std::vector&lt;Real&gt; zeros(n_ten);</div>
<div class="line"><span class="lineno"> 1573</span>        std::vector&lt;Real&gt; times(n_ten);</div>
<div class="line"><span class="lineno"> 1574</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno"> 1575</span>        std::vector&lt;Real&gt; shiftedZeros(n_ten);</div>
<div class="line"><span class="lineno"> 1576</span>        SensitivityScenarioData::CurveShiftData data = *z.second;</div>
<div class="line"><span class="lineno"> 1577</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1578</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1579</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1580</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1581</span>                dc = s-&gt;zeroInflationIndex(indexName)-&gt;zeroInflationTermStructure()-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1582</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1583</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1584</span>            }</div>
<div class="line"><span class="lineno"> 1585</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1586</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for zero inflation index &quot;</span> &lt;&lt; indexName</div>
<div class="line"><span class="lineno"> 1587</span>                                                                                            &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1588</span>        }</div>
<div class="line"><span class="lineno"> 1589</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1590</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno"> 1591</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationTenors(indexName)[j];</div>
<div class="line"><span class="lineno"> 1592</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023">RiskFactorKey::KeyType::ZeroInflationCurve</a>, indexName, j);</div>
<div class="line"><span class="lineno"> 1593</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, zeros[j], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1594</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno"> 1595</span>        }</div>
<div class="line"><span class="lineno"> 1596</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1597</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1598</span> </div>
<div class="line"><span class="lineno"> 1599</span>        std::vector&lt;Period&gt; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasZeroInflationTenors(indexName)</div>
<div class="line"><span class="lineno"> 1600</span>                                              ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationTenors(indexName)</div>
<div class="line"><span class="lineno"> 1601</span>                                              : data.shiftTenors;</div>
<div class="line"><span class="lineno"> 1602</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;Zero Inflation &quot;</span> + indexName, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1603</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno"> 1604</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno"> 1605</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno"> 1606</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1607</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;Zero Inflation Index shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno"> 1608</span> </div>
<div class="line"><span class="lineno"> 1609</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 1610</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno"> 1611</span> </div>
<div class="line"><span class="lineno"> 1612</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1613</span> </div>
<div class="line"><span class="lineno"> 1614</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a840da6725f71e6ae7db519d84cb3d275">zeroInflationScenarioDescription</a>(indexName, j, up));</div>
<div class="line"><span class="lineno"> 1617</span> </div>
<div class="line"><span class="lineno"> 1618</span>            <span class="comment">// apply zero rate shift at tenor point j</span></div>
<div class="line"><span class="lineno"> 1619</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, zeros, times, shiftedZeros, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>            <span class="comment">// store shifted discount curve for this index in the scenario</span></div>
<div class="line"><span class="lineno"> 1622</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno"> 1623</span>                RiskFactorKey key(RFType::ZeroInflationCurve, indexName, k);</div>
<div class="line"><span class="lineno"> 1624</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1625</span>                    scenario-&gt;add(key, shiftedZeros[k] - zeros[k]);</div>
<div class="line"><span class="lineno"> 1626</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1627</span>                    scenario-&gt;add(key, shiftedZeros[k]);</div>
<div class="line"><span class="lineno"> 1628</span>                }</div>
<div class="line"><span class="lineno"> 1629</span> </div>
<div class="line"><span class="lineno"> 1630</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1631</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno"> 1632</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedZeros[k] - zeros[k];</div>
<div class="line"><span class="lineno"> 1633</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = zeros[k];</div>
<div class="line"><span class="lineno"> 1634</span>                }</div>
<div class="line"><span class="lineno"> 1635</span>            }</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1638</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1639</span> </div>
<div class="line"><span class="lineno"> 1640</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1641</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1642</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno"> 1643</span>                                           &lt;&lt; <span class="stringliteral">&quot; created for indexName &quot;</span> &lt;&lt; indexName);</div>
<div class="line"><span class="lineno"> 1644</span> </div>
<div class="line"><span class="lineno"> 1645</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno"> 1646</span>    }</div>
<div class="line"><span class="lineno"> 1647</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Zero Inflation Index curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1648</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023">ore::analytics::RiskFactorKey::KeyType::ZeroInflationCurve</a></div><div class="ttdeci">@ ZeroInflationCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a840da6725f71e6ae7db519d84cb3d275"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a840da6725f71e6ae7db519d84cb3d275">ore::analytics::SensitivityScenarioGenerator::zeroInflationScenarioDescription</a></div><div class="ttdeci">ScenarioDescription zeroInflationScenarioDescription(string index, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02731">sensitivityscenariogenerator.cpp:2731</a></div></div>
</div><!-- fragment --><div id="dynsection-32" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-32-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-32-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-32-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_cgraph">
<area shape="rect" title=" " alt="" coords="5,169,204,194"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="263,5,448,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="332,70,379,95"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="258,143,453,169"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="319,193,391,218"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="268,242,443,267"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a840da6725f71e6ae7db519d84cb3d275" title=" " alt="" coords="252,291,459,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="507,242,645,267"/>
</map>
</div>
<div id="dynsection-33" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-33-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-33-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-33-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3ac8a9ece30efe88a9131963f851d176_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,620,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a2ff246db7c4c67d5d2735e10b9c5d760" name="a2ff246db7c4c67d5d2735e10b9c5d760"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ff246db7c4c67d5d2735e10b9c5d760">&#9670;&#160;</a></span>generateZeroInflationCapFloorVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateZeroInflationCapFloorVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01853">1853</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1853</span>                                                                                    {</div>
<div class="line"><span class="lineno"> 1854</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1855</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_zci : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationCapFloorVolNames()) {</div>
<div class="line"><span class="lineno"> 1856</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCapFloorVolShiftData().find(sim_zci) ==</div>
<div class="line"><span class="lineno"> 1857</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCapFloorVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1858</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Inflation index &quot;</span> &lt;&lt; sim_zci &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1859</span>        }</div>
<div class="line"><span class="lineno"> 1860</span>    }</div>
<div class="line"><span class="lineno"> 1861</span> </div>
<div class="line"><span class="lineno"> 1862</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCapFloorVolShiftData()) {</div>
<div class="line"><span class="lineno"> 1863</span>        std::string <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = c.first;</div>
<div class="line"><span class="lineno"> 1864</span>        Size n_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationCapFloorVolStrikes(name).size();</div>
<div class="line"><span class="lineno"> 1865</span>        Size n_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationCapFloorVolExpiries(name).size();</div>
<div class="line"><span class="lineno"> 1866</span>        vector&lt;Real&gt; volStrikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationCapFloorVolStrikes(name);</div>
<div class="line"><span class="lineno"> 1867</span>        SensitivityScenarioData::VolShiftData data = *c.second;</div>
<div class="line"><span class="lineno"> 1868</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1869</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1870</span>        vector&lt;vector&lt;Real&gt;&gt; volData(n_exp, vector&lt;Real&gt;(n_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 1871</span>        vector&lt;Real&gt; volExpiryTimes(n_exp, 0.0);</div>
<div class="line"><span class="lineno"> 1872</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedVolData(n_exp, vector&lt;Real&gt;(n_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 1873</span> </div>
<div class="line"><span class="lineno"> 1874</span>        std::vector&lt;Period&gt; expiries = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasZeroInflationCapFloorVolExpiries(name)</div>
<div class="line"><span class="lineno"> 1875</span>                                           ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationCapFloorVolExpiries(name)</div>
<div class="line"><span class="lineno"> 1876</span>                                           : data.shiftExpiries;</div>
<div class="line"><span class="lineno"> 1877</span>        QL_REQUIRE(expiries.size() == data.shiftExpiries.size(), <span class="stringliteral">&quot;mismatch between effective shift expiries (&quot;</span></div>
<div class="line"><span class="lineno"> 1878</span>                                                                     &lt;&lt; expiries.size() &lt;&lt; <span class="stringliteral">&quot;) and shift tenors (&quot;</span></div>
<div class="line"><span class="lineno"> 1879</span>                                                                     &lt;&lt; data.shiftExpiries.size());</div>
<div class="line"><span class="lineno"> 1880</span>        vector&lt;Real&gt; shiftExpiryTimes(expiries.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1881</span>        vector&lt;Real&gt; shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno"> 1882</span> </div>
<div class="line"><span class="lineno"> 1883</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1884</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1885</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1886</span>                dc = s-&gt;cpiInflationCapFloorVolatilitySurface(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1887</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1888</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1889</span>            }</div>
<div class="line"><span class="lineno"> 1890</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1891</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for cpi cap/floor vol surface &quot;</span></div>
<div class="line"><span class="lineno"> 1892</span>                 &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1893</span>        }</div>
<div class="line"><span class="lineno"> 1894</span> </div>
<div class="line"><span class="lineno"> 1895</span>        <span class="comment">// cache original vol data</span></div>
<div class="line"><span class="lineno"> 1896</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1897</span>            Date expiry = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;zeroInflationCapFloorVolExpiries(name)[j];</div>
<div class="line"><span class="lineno"> 1898</span>            volExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, expiry);</div>
<div class="line"><span class="lineno"> 1899</span>        }</div>
<div class="line"><span class="lineno"> 1900</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1901</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1902</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_strikes; ++k) {</div>
<div class="line"><span class="lineno"> 1903</span>                Size idx = j * n_strikes + k;</div>
<div class="line"><span class="lineno"> 1904</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2">RiskFactorKey::KeyType::ZeroInflationCapFloorVolatility</a>, name, idx);</div>
<div class="line"><span class="lineno"> 1905</span>                valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, volData[j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1906</span>            }</div>
<div class="line"><span class="lineno"> 1907</span>        }</div>
<div class="line"><span class="lineno"> 1908</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1909</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1910</span> </div>
<div class="line"><span class="lineno"> 1911</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 1912</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 1913</span>            shiftExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + expiries[j]);</div>
<div class="line"><span class="lineno"> 1914</span> </div>
<div class="line"><span class="lineno"> 1915</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volExpiryTimes, shiftExpiryTimes);</div>
<div class="line"><span class="lineno"> 1916</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volStrikes, shiftStrikes);</div>
<div class="line"><span class="lineno"> 1917</span> </div>
<div class="line"><span class="lineno"> 1918</span>        <span class="comment">// loop over shift expiries and terms</span></div>
<div class="line"><span class="lineno"> 1919</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1920</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; shiftStrikes.size(); ++k) {</div>
<div class="line"><span class="lineno"> 1921</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1922</span> </div>
<div class="line"><span class="lineno"> 1923</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a87cb703bf265164cef649e6d455772a0">zeroInflationCapFloorVolScenarioDescription</a>(name, j, k, up));</div>
<div class="line"><span class="lineno"> 1924</span> </div>
<div class="line"><span class="lineno"> 1925</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, k, shiftSize, up, shiftType, shiftExpiryTimes, shiftStrikes, volExpiryTimes, volStrikes,</div>
<div class="line"><span class="lineno"> 1926</span>                           volData, shiftedVolData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1927</span> </div>
<div class="line"><span class="lineno"> 1928</span>                <span class="comment">// add shifted vol data to the scenario</span></div>
<div class="line"><span class="lineno"> 1929</span>                <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_exp; ++jj) {</div>
<div class="line"><span class="lineno"> 1930</span>                    <span class="keywordflow">for</span> (Size kk = 0; kk &lt; n_strikes; ++kk) {</div>
<div class="line"><span class="lineno"> 1931</span>                        Size idx = jj * n_strikes + kk;</div>
<div class="line"><span class="lineno"> 1932</span>                        RiskFactorKey key(RFType::ZeroInflationCapFloorVolatility, name, idx);</div>
<div class="line"><span class="lineno"> 1933</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1934</span>                            scenario-&gt;add(key, shiftedVolData[jj][kk] - volData[jj][kk]);</div>
<div class="line"><span class="lineno"> 1935</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1936</span>                            scenario-&gt;add(key, shiftedVolData[jj][kk]);</div>
<div class="line"><span class="lineno"> 1937</span>                        }</div>
<div class="line"><span class="lineno"> 1938</span> </div>
<div class="line"><span class="lineno"> 1939</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1940</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj &amp;&amp; k == kk) {</div>
<div class="line"><span class="lineno"> 1941</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedVolData[jj][kk] - volData[jj][kk];</div>
<div class="line"><span class="lineno"> 1942</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = volData[jj][kk];</div>
<div class="line"><span class="lineno"> 1943</span>                        }</div>
<div class="line"><span class="lineno"> 1944</span>                    }</div>
<div class="line"><span class="lineno"> 1945</span>                }</div>
<div class="line"><span class="lineno"> 1946</span> </div>
<div class="line"><span class="lineno"> 1947</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1948</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1951</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1952</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 1953</span>            }</div>
<div class="line"><span class="lineno"> 1954</span>        }</div>
<div class="line"><span class="lineno"> 1955</span>    }</div>
<div class="line"><span class="lineno"> 1956</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Zero inflation cap/floor vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1957</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2">ore::analytics::RiskFactorKey::KeyType::ZeroInflationCapFloorVolatility</a></div><div class="ttdeci">@ ZeroInflationCapFloorVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a87cb703bf265164cef649e6d455772a0"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a87cb703bf265164cef649e6d455772a0">ore::analytics::SensitivityScenarioGenerator::zeroInflationCapFloorVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription zeroInflationCapFloorVolScenarioDescription(string name, Size expiryBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02801">sensitivityscenariogenerator.cpp:2801</a></div></div>
</div><!-- fragment --><div id="dynsection-34" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-34-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-34-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-34-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_cgraph">
<area shape="rect" title=" " alt="" coords="5,161,169,201"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="222,5,407,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="291,70,338,95"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="217,143,412,169"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="279,193,351,218"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="227,242,402,267"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a87cb703bf265164cef649e6d455772a0" title=" " alt="" coords="233,292,396,332"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="460,242,599,267"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="478,299,581,325"/>
</map>
</div>
<div id="dynsection-35" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-35-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-35-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-35-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2ff246db7c4c67d5d2735e10b9c5d760_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,585,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,13,373,38"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,13,195,38"/>
</map>
</div>

</div>
</div>
<a id="a2cb7749581f38e7c3e5eae03657d6d33" name="a2cb7749581f38e7c3e5eae03657d6d33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cb7749581f38e7c3e5eae03657d6d33">&#9670;&#160;</a></span>generateYoYInflationScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateYoYInflationScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01650">1650</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1650</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1651</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1654</span>    std::vector&lt;string&gt; yoyInfIndexNames;</div>
<div class="line"><span class="lineno"> 1655</span>    <span class="comment">// Log an ALERT if some ibor indices in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1656</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_idx : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationIndices()) {</div>
<div class="line"><span class="lineno"> 1657</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData().find(sim_idx) ==</div>
<div class="line"><span class="lineno"> 1658</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1659</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;YoY Inflation Index &quot;</span> &lt;&lt; sim_idx &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1660</span>        }</div>
<div class="line"><span class="lineno"> 1661</span>    }</div>
<div class="line"><span class="lineno"> 1662</span> </div>
<div class="line"><span class="lineno"> 1663</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> y : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData()) {</div>
<div class="line"><span class="lineno"> 1664</span>        <span class="keywordtype">string</span> indexName = y.first;</div>
<div class="line"><span class="lineno"> 1665</span>        Size n_ten = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationTenors(indexName).size();</div>
<div class="line"><span class="lineno"> 1666</span>        <span class="comment">// original curves&#39; buffer</span></div>
<div class="line"><span class="lineno"> 1667</span>        std::vector&lt;Real&gt; yoys(n_ten);</div>
<div class="line"><span class="lineno"> 1668</span>        std::vector&lt;Real&gt; times(n_ten);</div>
<div class="line"><span class="lineno"> 1669</span>        <span class="comment">// buffer for shifted zero curves</span></div>
<div class="line"><span class="lineno"> 1670</span>        std::vector&lt;Real&gt; shiftedYoys(n_ten);</div>
<div class="line"><span class="lineno"> 1671</span>        <span class="keyword">auto</span> itr = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData().find(indexName);</div>
<div class="line"><span class="lineno"> 1672</span>        QL_REQUIRE(itr != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 1673</span>                   <span class="stringliteral">&quot;yoyinflation CurveShiftData not found for &quot;</span> &lt;&lt; indexName);</div>
<div class="line"><span class="lineno"> 1674</span>        SensitivityScenarioData::CurveShiftData data = *y.second;</div>
<div class="line"><span class="lineno"> 1675</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1676</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1677</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1678</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1679</span>                dc = s-&gt;yoyInflationIndex(indexName)-&gt;yoyInflationTermStructure()-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1680</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1681</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1682</span>            }</div>
<div class="line"><span class="lineno"> 1683</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1684</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for yoy inflation index &quot;</span> &lt;&lt; indexName &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1685</span>        }</div>
<div class="line"><span class="lineno"> 1686</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1687</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_ten; ++j) {</div>
<div class="line"><span class="lineno"> 1688</span>            Date d = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationTenors(indexName)[j];</div>
<div class="line"><span class="lineno"> 1689</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401">RiskFactorKey::KeyType::YoYInflationCurve</a>, indexName, j);</div>
<div class="line"><span class="lineno"> 1690</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, yoys[j], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1691</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, d);</div>
<div class="line"><span class="lineno"> 1692</span>        }</div>
<div class="line"><span class="lineno"> 1693</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1694</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1695</span> </div>
<div class="line"><span class="lineno"> 1696</span>        std::vector&lt;Period&gt; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasYoyInflationTenors(indexName)</div>
<div class="line"><span class="lineno"> 1697</span>                                              ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationTenors(indexName)</div>
<div class="line"><span class="lineno"> 1698</span>                                              : data.shiftTenors;</div>
<div class="line"><span class="lineno"> 1699</span>        checkShiftTenors(shiftTenors, data.shiftTenors, <span class="stringliteral">&quot;YoY Inflation &quot;</span> + indexName, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1700</span>        std::vector&lt;Time&gt; shiftTimes(shiftTenors.size());</div>
<div class="line"><span class="lineno"> 1701</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j)</div>
<div class="line"><span class="lineno"> 1702</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + shiftTenors[j]);</div>
<div class="line"><span class="lineno"> 1703</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1704</span>        QL_REQUIRE(shiftTenors.size() &gt; 0, <span class="stringliteral">&quot;YoY Inflation Index shift tenors not specified&quot;</span>);</div>
<div class="line"><span class="lineno"> 1705</span> </div>
<div class="line"><span class="lineno"> 1706</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 1707</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad9aa2a7ef0eb4646aa00597b6bb71bc4">yoyInflationScenarioDescription</a>(indexName, j, up));</div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>            <span class="comment">// apply zero rate shift at tenor point j</span></div>
<div class="line"><span class="lineno"> 1716</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, yoys, times, shiftedYoys, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>            <span class="comment">// store shifted discount curve for this index in the scenario</span></div>
<div class="line"><span class="lineno"> 1719</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_ten; ++k) {</div>
<div class="line"><span class="lineno"> 1720</span>                RiskFactorKey key(RFType::YoYInflationCurve, indexName, k);</div>
<div class="line"><span class="lineno"> 1721</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1722</span>                    scenario-&gt;add(key, shiftedYoys[k] - yoys[k]);</div>
<div class="line"><span class="lineno"> 1723</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1724</span>                    scenario-&gt;add(key, shiftedYoys[k]);</div>
<div class="line"><span class="lineno"> 1725</span>                }</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1728</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno"> 1729</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedYoys[k] - yoys[k];</div>
<div class="line"><span class="lineno"> 1730</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = yoys[k];</div>
<div class="line"><span class="lineno"> 1731</span>                }</div>
<div class="line"><span class="lineno"> 1732</span>            }</div>
<div class="line"><span class="lineno"> 1733</span> </div>
<div class="line"><span class="lineno"> 1734</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1735</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1736</span> </div>
<div class="line"><span class="lineno"> 1737</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1738</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1739</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno"> 1740</span>                                           &lt;&lt; <span class="stringliteral">&quot; created for indexName &quot;</span> &lt;&lt; indexName);</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>        } <span class="comment">// end of shift curve tenors</span></div>
<div class="line"><span class="lineno"> 1743</span>    }</div>
<div class="line"><span class="lineno"> 1744</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;YoY Inflation Index curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1745</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401">ore::analytics::RiskFactorKey::KeyType::YoYInflationCurve</a></div><div class="ttdeci">@ YoYInflationCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_ad9aa2a7ef0eb4646aa00597b6bb71bc4"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad9aa2a7ef0eb4646aa00597b6bb71bc4">ore::analytics::SensitivityScenarioGenerator::yoyInflationScenarioDescription</a></div><div class="ttdeci">ScenarioDescription yoyInflationScenarioDescription(string index, Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02753">sensitivityscenariogenerator.cpp:2753</a></div></div>
</div><!-- fragment --><div id="dynsection-36" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-36-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-36-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-36-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_cgraph">
<area shape="rect" title=" " alt="" coords="5,169,204,194"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="261,5,446,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="330,70,377,95"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="256,143,451,169"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="317,193,389,218"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="266,242,441,267"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad9aa2a7ef0eb4646aa00597b6bb71bc4" title=" " alt="" coords="252,291,455,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="503,242,641,267"/>
</map>
</div>
<div id="dynsection-37" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-37-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-37-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-37-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a2cb7749581f38e7c3e5eae03657d6d33_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,620,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a16e5241dfb0b21ac043e2e32a22374f6" name="a16e5241dfb0b21ac043e2e32a22374f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e5241dfb0b21ac043e2e32a22374f6">&#9670;&#160;</a></span>generateYoYInflationCapFloorVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateYoYInflationCapFloorVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01747">1747</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1747</span>                                                                                   {</div>
<div class="line"><span class="lineno"> 1748</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1749</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_yoy : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationCapFloorVolNames()) {</div>
<div class="line"><span class="lineno"> 1750</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCapFloorVolShiftData().find(sim_yoy) ==</div>
<div class="line"><span class="lineno"> 1751</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCapFloorVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1752</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Inflation index &quot;</span> &lt;&lt; sim_yoy &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1753</span>        }</div>
<div class="line"><span class="lineno"> 1754</span>    }</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCapFloorVolShiftData()) {</div>
<div class="line"><span class="lineno"> 1757</span>        std::string <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = c.first;</div>
<div class="line"><span class="lineno"> 1758</span>        Size n_yoyvol_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationCapFloorVolStrikes(name).size();</div>
<div class="line"><span class="lineno"> 1759</span>        vector&lt;Real&gt; volStrikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationCapFloorVolStrikes(name);</div>
<div class="line"><span class="lineno"> 1760</span>        Size n_yoyvol_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationCapFloorVolExpiries(name).size();</div>
<div class="line"><span class="lineno"> 1761</span>        SensitivityScenarioData::VolShiftData data = *c.second;</div>
<div class="line"><span class="lineno"> 1762</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1763</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1764</span>        vector&lt;vector&lt;Real&gt;&gt; volData(n_yoyvol_exp, vector&lt;Real&gt;(n_yoyvol_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 1765</span>        vector&lt;Real&gt; volExpiryTimes(n_yoyvol_exp, 0.0);</div>
<div class="line"><span class="lineno"> 1766</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedVolData(n_yoyvol_exp, vector&lt;Real&gt;(n_yoyvol_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 1767</span> </div>
<div class="line"><span class="lineno"> 1768</span>        std::vector&lt;Period&gt; expiries = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;hasYoYInflationCapFloorVolExpiries(name)</div>
<div class="line"><span class="lineno"> 1769</span>                                           ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationCapFloorVolExpiries(name)</div>
<div class="line"><span class="lineno"> 1770</span>                                           : data.shiftExpiries;</div>
<div class="line"><span class="lineno"> 1771</span>        QL_REQUIRE(expiries.size() == data.shiftExpiries.size(), <span class="stringliteral">&quot;mismatch between effective shift expiries (&quot;</span></div>
<div class="line"><span class="lineno"> 1772</span>                                                                     &lt;&lt; expiries.size() &lt;&lt; <span class="stringliteral">&quot;) and shift tenors (&quot;</span></div>
<div class="line"><span class="lineno"> 1773</span>                                                                     &lt;&lt; data.shiftExpiries.size());</div>
<div class="line"><span class="lineno"> 1774</span>        vector&lt;Real&gt; shiftExpiryTimes(expiries.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1775</span>        vector&lt;Real&gt; shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno"> 1776</span> </div>
<div class="line"><span class="lineno"> 1777</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1778</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1779</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1780</span>                dc = s-&gt;yoyCapFloorVol(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1781</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1782</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1783</span>            }</div>
<div class="line"><span class="lineno"> 1784</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1785</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for yoy cap/floor vol surface &quot;</span></div>
<div class="line"><span class="lineno"> 1786</span>                 &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1787</span>        }</div>
<div class="line"><span class="lineno"> 1788</span> </div>
<div class="line"><span class="lineno"> 1789</span>        <span class="comment">// cache original vol data</span></div>
<div class="line"><span class="lineno"> 1790</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_yoyvol_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1791</span>            Date expiry = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yoyInflationCapFloorVolExpiries(name)[j];</div>
<div class="line"><span class="lineno"> 1792</span>            volExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, expiry);</div>
<div class="line"><span class="lineno"> 1793</span>        }</div>
<div class="line"><span class="lineno"> 1794</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1795</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_yoyvol_exp; ++j) {</div>
<div class="line"><span class="lineno"> 1796</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_yoyvol_strikes; ++k) {</div>
<div class="line"><span class="lineno"> 1797</span>                Size idx = j * n_yoyvol_strikes + k;</div>
<div class="line"><span class="lineno"> 1798</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00">RiskFactorKey::KeyType::YoYInflationCapFloorVolatility</a>, name, idx);</div>
<div class="line"><span class="lineno"> 1799</span>                valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, volData[j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1800</span>            }</div>
<div class="line"><span class="lineno"> 1801</span>        }</div>
<div class="line"><span class="lineno"> 1802</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1803</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1804</span> </div>
<div class="line"><span class="lineno"> 1805</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 1806</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 1807</span>            shiftExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + expiries[j]);</div>
<div class="line"><span class="lineno"> 1808</span> </div>
<div class="line"><span class="lineno"> 1809</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volExpiryTimes, shiftExpiryTimes);</div>
<div class="line"><span class="lineno"> 1810</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volStrikes, shiftStrikes);</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span>        <span class="comment">// loop over shift expiries and terms</span></div>
<div class="line"><span class="lineno"> 1813</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1814</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; shiftStrikes.size(); ++k) {</div>
<div class="line"><span class="lineno"> 1815</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1816</span> </div>
<div class="line"><span class="lineno"> 1817</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a52659907f53c9543366619e3154411d4">yoyInflationCapFloorVolScenarioDescription</a>(name, j, k, up));</div>
<div class="line"><span class="lineno"> 1818</span> </div>
<div class="line"><span class="lineno"> 1819</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, k, shiftSize, up, shiftType, shiftExpiryTimes, shiftStrikes, volExpiryTimes, volStrikes,</div>
<div class="line"><span class="lineno"> 1820</span>                           volData, shiftedVolData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1821</span> </div>
<div class="line"><span class="lineno"> 1822</span>                <span class="comment">// add shifted vol data to the scenario</span></div>
<div class="line"><span class="lineno"> 1823</span>                <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_yoyvol_exp; ++jj) {</div>
<div class="line"><span class="lineno"> 1824</span>                    <span class="keywordflow">for</span> (Size kk = 0; kk &lt; n_yoyvol_strikes; ++kk) {</div>
<div class="line"><span class="lineno"> 1825</span>                        Size idx = jj * n_yoyvol_strikes + kk;</div>
<div class="line"><span class="lineno"> 1826</span>                        RiskFactorKey key(RFType::YoYInflationCapFloorVolatility, name, idx);</div>
<div class="line"><span class="lineno"> 1827</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1828</span>                            scenario-&gt;add(key, shiftedVolData[jj][kk] - volData[jj][kk]);</div>
<div class="line"><span class="lineno"> 1829</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1830</span>                            scenario-&gt;add(key, shiftedVolData[jj][kk]);</div>
<div class="line"><span class="lineno"> 1831</span>                        }</div>
<div class="line"><span class="lineno"> 1832</span> </div>
<div class="line"><span class="lineno"> 1833</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1834</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj &amp;&amp; k == kk) {</div>
<div class="line"><span class="lineno"> 1835</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedVolData[jj][kk] - volData[jj][kk];</div>
<div class="line"><span class="lineno"> 1836</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = volData[jj][kk];</div>
<div class="line"><span class="lineno"> 1837</span>                        }</div>
<div class="line"><span class="lineno"> 1838</span>                    }</div>
<div class="line"><span class="lineno"> 1839</span>                }</div>
<div class="line"><span class="lineno"> 1840</span> </div>
<div class="line"><span class="lineno"> 1841</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1842</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1843</span> </div>
<div class="line"><span class="lineno"> 1844</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1845</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1846</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 1847</span>            }</div>
<div class="line"><span class="lineno"> 1848</span>        }</div>
<div class="line"><span class="lineno"> 1849</span>    }</div>
<div class="line"><span class="lineno"> 1850</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;YoY inflation optionlet vol scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 1851</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00">ore::analytics::RiskFactorKey::KeyType::YoYInflationCapFloorVolatility</a></div><div class="ttdeci">@ YoYInflationCapFloorVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a52659907f53c9543366619e3154411d4"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a52659907f53c9543366619e3154411d4">ore::analytics::SensitivityScenarioGenerator::yoyInflationCapFloorVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription yoyInflationCapFloorVolScenarioDescription(string name, Size expiryBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02775">sensitivityscenariogenerator.cpp:2775</a></div></div>
</div><!-- fragment --><div id="dynsection-38" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-38-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-38-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-38-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_cgraph">
<area shape="rect" title=" " alt="" coords="5,161,199,201"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="259,5,444,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="328,70,375,95"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="254,143,449,169"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="315,193,387,218"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="264,242,439,267"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a52659907f53c9543366619e3154411d4" title=" " alt="" coords="247,292,456,332"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="504,242,643,267"/>
</map>
</div>
<div id="dynsection-39" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-39-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-39-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-39-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a16e5241dfb0b21ac043e2e32a22374f6_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,615,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,13,373,38"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,13,195,38"/>
</map>
</div>

</div>
</div>
<a id="a8d59ef3dc24cdb6a4306230119a9185b" name="a8d59ef3dc24cdb6a4306230119a9185b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d59ef3dc24cdb6a4306230119a9185b">&#9670;&#160;</a></span>generateBaseCorrelationScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateBaseCorrelationScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01959">1959</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1959</span>                                                                           {</div>
<div class="line"><span class="lineno"> 1960</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1961</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 1962</span>    <span class="comment">// Log an ALERT if some names in simmarket are excluded from the list</span></div>
<div class="line"><span class="lineno"> 1963</span>   <span class="keywordflow">for</span> (<span class="keyword">auto</span> name : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;baseCorrelationNames()) {</div>
<div class="line"><span class="lineno"> 1964</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;baseCorrelationShiftData().find(name) ==</div>
<div class="line"><span class="lineno"> 1965</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;baseCorrelationShiftData().end()) {</div>
<div class="line"><span class="lineno"> 1966</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Base Correlation &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 1967</span>        }</div>
<div class="line"><span class="lineno"> 1968</span>    }</div>
<div class="line"><span class="lineno"> 1969</span> </div>
<div class="line"><span class="lineno"> 1970</span>    Size n_bc_terms = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;baseCorrelationTerms().size();</div>
<div class="line"><span class="lineno"> 1971</span>    Size n_bc_levels = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;baseCorrelationDetachmentPoints().size();</div>
<div class="line"><span class="lineno"> 1972</span> </div>
<div class="line"><span class="lineno"> 1973</span>    vector&lt;vector&lt;Real&gt;&gt; bcData(n_bc_levels, vector&lt;Real&gt;(n_bc_terms, 0.0));</div>
<div class="line"><span class="lineno"> 1974</span>    vector&lt;vector&lt;Real&gt;&gt; shiftedBcData(n_bc_levels, vector&lt;Real&gt;(n_bc_levels, 0.0));</div>
<div class="line"><span class="lineno"> 1975</span>    vector&lt;Real&gt; termTimes(n_bc_terms, 0.0);</div>
<div class="line"><span class="lineno"> 1976</span>    vector&lt;Real&gt; levels = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;baseCorrelationDetachmentPoints();</div>
<div class="line"><span class="lineno"> 1977</span> </div>
<div class="line"><span class="lineno"> 1978</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> b : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;baseCorrelationShiftData()) {</div>
<div class="line"><span class="lineno"> 1979</span>        std::string <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = b.first;</div>
<div class="line"><span class="lineno"> 1980</span>        SensitivityScenarioData::BaseCorrelationShiftData data = b.second;</div>
<div class="line"><span class="lineno"> 1981</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1982</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1983</span> </div>
<div class="line"><span class="lineno"> 1984</span>        vector&lt;Real&gt; shiftLevels = data.shiftLossLevels;</div>
<div class="line"><span class="lineno"> 1985</span>        vector&lt;Real&gt; shiftTermTimes(data.shiftTerms.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 1988</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1989</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1990</span>                dc = s-&gt;baseCorrelation(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1991</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1992</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1993</span>            }</div>
<div class="line"><span class="lineno"> 1994</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1995</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for base correlation structure &quot;</span></div>
<div class="line"><span class="lineno"> 1996</span>                 &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1997</span>        }</div>
<div class="line"><span class="lineno"> 1998</span> </div>
<div class="line"><span class="lineno"> 1999</span>        <span class="comment">// cache original base correlation data</span></div>
<div class="line"><span class="lineno"> 2000</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_bc_terms; ++j) {</div>
<div class="line"><span class="lineno"> 2001</span>            Date term = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;baseCorrelationTerms()[j];</div>
<div class="line"><span class="lineno"> 2002</span>            termTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, term);</div>
<div class="line"><span class="lineno"> 2003</span>        }</div>
<div class="line"><span class="lineno"> 2004</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2005</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_bc_levels; ++j) {</div>
<div class="line"><span class="lineno"> 2006</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_bc_terms; ++k) {</div>
<div class="line"><span class="lineno"> 2007</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba">RiskFactorKey::KeyType::BaseCorrelation</a>, name, j);</div>
<div class="line"><span class="lineno"> 2008</span>                valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, bcData[j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 2009</span>            }</div>
<div class="line"><span class="lineno"> 2010</span>        }</div>
<div class="line"><span class="lineno"> 2011</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 2012</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2013</span> </div>
<div class="line"><span class="lineno"> 2014</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 2015</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTermTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 2016</span>            shiftTermTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + data.shiftTerms[j]);</div>
<div class="line"><span class="lineno"> 2017</span> </div>
<div class="line"><span class="lineno"> 2018</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 2019</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(termTimes, shiftTermTimes);</div>
<div class="line"><span class="lineno"> 2020</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(levels, shiftLevels);</div>
<div class="line"><span class="lineno"> 2021</span> </div>
<div class="line"><span class="lineno"> 2022</span>        <span class="comment">// loop over shift levels and terms</span></div>
<div class="line"><span class="lineno"> 2023</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftLevels.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2024</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; shiftTermTimes.size(); ++k) {</div>
<div class="line"><span class="lineno"> 2025</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6ad7ae91ef2d71d973dce2f1fd66d56c">baseCorrelationScenarioDescription</a>(name, j, k, up));</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, k, shiftSize, up, shiftType, shiftLevels, shiftTermTimes, levels, termTimes, bcData,</div>
<div class="line"><span class="lineno"> 2030</span>                           shiftedBcData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2031</span> </div>
<div class="line"><span class="lineno"> 2032</span>                <span class="comment">// add shifted vol data to the scenario</span></div>
<div class="line"><span class="lineno"> 2033</span>                <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_bc_levels; ++jj) {</div>
<div class="line"><span class="lineno"> 2034</span>                    <span class="keywordflow">for</span> (Size kk = 0; kk &lt; n_bc_terms; ++kk) {</div>
<div class="line"><span class="lineno"> 2035</span>                        Size idx = jj * n_bc_terms + kk;</div>
<div class="line"><span class="lineno"> 2036</span>                        <span class="keywordflow">if</span> (shiftedBcData[jj][kk] &lt; 0.0) {</div>
<div class="line"><span class="lineno"> 2037</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;invalid shifted base correlation &quot;</span> &lt;&lt; shiftedBcData[jj][kk] &lt;&lt; <span class="stringliteral">&quot; at lossLevelIndex &quot;</span></div>
<div class="line"><span class="lineno"> 2038</span>                                                                     &lt;&lt; jj &lt;&lt; <span class="stringliteral">&quot; and termIndex &quot;</span> &lt;&lt; kk</div>
<div class="line"><span class="lineno"> 2039</span>                                                                     &lt;&lt; <span class="stringliteral">&quot; set to zero&quot;</span>);</div>
<div class="line"><span class="lineno"> 2040</span>                            shiftedBcData[jj][kk] = 0.0;</div>
<div class="line"><span class="lineno"> 2041</span>                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shiftedBcData[jj][kk] &gt; 1.0) {</div>
<div class="line"><span class="lineno"> 2042</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;invalid shifted base correlation &quot;</span> &lt;&lt; shiftedBcData[jj][kk] &lt;&lt; <span class="stringliteral">&quot; at lossLevelIndex &quot;</span></div>
<div class="line"><span class="lineno"> 2043</span>                                                                     &lt;&lt; jj &lt;&lt; <span class="stringliteral">&quot; and termIndex &quot;</span> &lt;&lt; kk</div>
<div class="line"><span class="lineno"> 2044</span>                                                                     &lt;&lt; <span class="stringliteral">&quot; set to 1 - epsilon&quot;</span>);</div>
<div class="line"><span class="lineno"> 2045</span>                            shiftedBcData[jj][kk] = 1.0 - QL_EPSILON;</div>
<div class="line"><span class="lineno"> 2046</span>                        }</div>
<div class="line"><span class="lineno"> 2047</span> </div>
<div class="line"><span class="lineno"> 2048</span>                        RiskFactorKey key(RFType::BaseCorrelation, name, idx);</div>
<div class="line"><span class="lineno"> 2049</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 2050</span>                            scenario-&gt;add(key, shiftedBcData[jj][kk] - bcData[jj][kk]);</div>
<div class="line"><span class="lineno"> 2051</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2052</span>                            scenario-&gt;add(key, shiftedBcData[jj][kk]);</div>
<div class="line"><span class="lineno"> 2053</span>                        }</div>
<div class="line"><span class="lineno"> 2054</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 2055</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj &amp;&amp; k == kk) {</div>
<div class="line"><span class="lineno"> 2056</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedBcData[jj][kk] - bcData[jj][kk];</div>
<div class="line"><span class="lineno"> 2057</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = bcData[jj][kk];</div>
<div class="line"><span class="lineno"> 2058</span>                        }</div>
<div class="line"><span class="lineno"> 2059</span>                    }</div>
<div class="line"><span class="lineno"> 2060</span>                }</div>
<div class="line"><span class="lineno"> 2061</span> </div>
<div class="line"><span class="lineno"> 2062</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 2063</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 2064</span> </div>
<div class="line"><span class="lineno"> 2065</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 2066</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 2067</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 2068</span>            }</div>
<div class="line"><span class="lineno"> 2069</span>        }</div>
<div class="line"><span class="lineno"> 2070</span>    }</div>
<div class="line"><span class="lineno"> 2071</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Base correlation scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2072</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba">ore::analytics::RiskFactorKey::KeyType::BaseCorrelation</a></div><div class="ttdeci">@ BaseCorrelation</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a6ad7ae91ef2d71d973dce2f1fd66d56c"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6ad7ae91ef2d71d973dce2f1fd66d56c">ore::analytics::SensitivityScenarioGenerator::baseCorrelationScenarioDescription</a></div><div class="ttdeci">ScenarioDescription baseCorrelationScenarioDescription(string indexName, Size lossLevelBucket, Size termBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02830">sensitivityscenariogenerator.cpp:2830</a></div></div>
<div class="ttc" id="alog_8hpp_html_a35cb05f674d9e764ca12cff351b064f2"><div class="ttname"><a href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a></div><div class="ttdeci">#define ALOG(text)</div></div>
</div><!-- fragment --><div id="dynsection-40" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-40-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-40-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-40-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,228,182"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="297,5,483,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="367,70,413,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a6ad7ae91ef2d71d973dce2f1fd66d56c" title=" " alt="" coords="276,119,504,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="293,193,487,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="354,242,426,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="303,291,477,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="552,291,691,317"/>
</map>
</div>
<div id="dynsection-41" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-41-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-41-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-41-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a8d59ef3dc24cdb6a4306230119a9185b_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,644,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a5909315dd0dd00c38ebb9401f016381c" name="a5909315dd0dd00c38ebb9401f016381c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5909315dd0dd00c38ebb9401f016381c">&#9670;&#160;</a></span>generateCommodityCurveScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateCommodityCurveScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02074">2074</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2074</span>                                                                          {</div>
<div class="line"><span class="lineno"> 2075</span> </div>
<div class="line"><span class="lineno"> 2076</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 2077</span> </div>
<div class="line"><span class="lineno"> 2078</span>    <span class="comment">// Log an ALERT if some commodity curves in simulation market are not in the list</span></div>
<div class="line"><span class="lineno"> 2079</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityNames()) {</div>
<div class="line"><span class="lineno"> 2080</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityCurveShiftData().find(name) ==</div>
<div class="line"><span class="lineno"> 2081</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityCurveShiftData().end()) {</div>
<div class="line"><span class="lineno"> 2082</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;Commodity &quot;</span> &lt;&lt; name</div>
<div class="line"><span class="lineno"> 2083</span>                              &lt;&lt; <span class="stringliteral">&quot; in simulation market is not &quot;</span></div>
<div class="line"><span class="lineno"> 2084</span>                                 <span class="stringliteral">&quot;included in commodity sensitivity analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 2085</span>        }</div>
<div class="line"><span class="lineno"> 2086</span>    }</div>
<div class="line"><span class="lineno"> 2087</span> </div>
<div class="line"><span class="lineno"> 2088</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityCurveShiftData()) {</div>
<div class="line"><span class="lineno"> 2089</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = c.first;</div>
<div class="line"><span class="lineno"> 2090</span>        <span class="comment">// Tenors for this name in simulation market</span></div>
<div class="line"><span class="lineno"> 2091</span>        vector&lt;Period&gt; simMarketTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityCurveTenors(name);</div>
<div class="line"><span class="lineno"> 2092</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 2093</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2094</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 2095</span>                dc = s-&gt;commodityPriceCurve(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2096</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2097</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2098</span>            }</div>
<div class="line"><span class="lineno"> 2099</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 2100</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for commodity price curve &quot;</span> &lt;&lt; name</div>
<div class="line"><span class="lineno"> 2101</span>                                                                                             &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 2102</span>        }</div>
<div class="line"><span class="lineno"> 2103</span> </div>
<div class="line"><span class="lineno"> 2104</span>        vector&lt;Real&gt; times(simMarketTenors.size());</div>
<div class="line"><span class="lineno"> 2105</span>        vector&lt;Real&gt; basePrices(times.size());</div>
<div class="line"><span class="lineno"> 2106</span>        vector&lt;Real&gt; shiftedPrices(times.size());</div>
<div class="line"><span class="lineno"> 2107</span> </div>
<div class="line"><span class="lineno"> 2108</span>        <span class="comment">// Get the base prices for this name from the base scenario</span></div>
<div class="line"><span class="lineno"> 2109</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2110</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; times.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2111</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + simMarketTenors[j]);</div>
<div class="line"><span class="lineno"> 2112</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88">RiskFactorKey::KeyType::CommodityCurve</a>, name, j);</div>
<div class="line"><span class="lineno"> 2113</span>            valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, basePrices[j], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 2114</span>        }</div>
<div class="line"><span class="lineno"> 2115</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 2116</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2117</span> </div>
<div class="line"><span class="lineno"> 2118</span>        <span class="comment">// Get the sensitivity data for this name</span></div>
<div class="line"><span class="lineno"> 2119</span>        SensitivityScenarioData::CurveShiftData data = *c.second;</div>
<div class="line"><span class="lineno"> 2120</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 2121</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 2122</span> </div>
<div class="line"><span class="lineno"> 2123</span>        <span class="comment">// Get the times at which we want to apply the shifts</span></div>
<div class="line"><span class="lineno"> 2124</span>        QL_REQUIRE(!data.shiftTenors.empty(), <span class="stringliteral">&quot;Commodity curve shift tenors have not been given&quot;</span>);</div>
<div class="line"><span class="lineno"> 2125</span>        vector&lt;Time&gt; shiftTimes(data.shiftTenors.size());</div>
<div class="line"><span class="lineno"> 2126</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; data.shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2127</span>            shiftTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + data.shiftTenors[j]);</div>
<div class="line"><span class="lineno"> 2128</span>        }</div>
<div class="line"><span class="lineno"> 2129</span> </div>
<div class="line"><span class="lineno"> 2130</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 2131</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno"> 2132</span> </div>
<div class="line"><span class="lineno"> 2133</span>        <span class="comment">// Generate the scenarios for each shift</span></div>
<div class="line"><span class="lineno"> 2134</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; data.shiftTenors.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>            boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 2137</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a36c90a4563e88cf2b66058371685c7b6">commodityCurveScenarioDescription</a>(name, j, up));</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>            <span class="comment">// Apply shift at tenor point j</span></div>
<div class="line"><span class="lineno"> 2140</span>            <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, shiftSize, up, shiftType, shiftTimes, basePrices, times, shiftedPrices, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span>            <span class="comment">// store shifted commodity price curve in the scenario</span></div>
<div class="line"><span class="lineno"> 2143</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; times.size(); ++k) {</div>
<div class="line"><span class="lineno"> 2144</span>                RiskFactorKey key(RFType::CommodityCurve, name, k);</div>
<div class="line"><span class="lineno"> 2145</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 2146</span>                    scenario-&gt;add(key, shiftedPrices[k] - basePrices[k]);</div>
<div class="line"><span class="lineno"> 2147</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2148</span>                    scenario-&gt;add(key, shiftedPrices[k]);</div>
<div class="line"><span class="lineno"> 2149</span>                }</div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span>                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 2152</span>                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == k) {</div>
<div class="line"><span class="lineno"> 2153</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedPrices[k] - basePrices[k];</div>
<div class="line"><span class="lineno"> 2154</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = basePrices[k];</div>
<div class="line"><span class="lineno"> 2155</span>                }</div>
<div class="line"><span class="lineno"> 2156</span>            }</div>
<div class="line"><span class="lineno"> 2157</span> </div>
<div class="line"><span class="lineno"> 2158</span>            <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 2159</span>            scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 2160</span> </div>
<div class="line"><span class="lineno"> 2161</span>            <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 2162</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 2163</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 2164</span>        }</div>
<div class="line"><span class="lineno"> 2165</span>    }</div>
<div class="line"><span class="lineno"> 2166</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Commodity curve scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2167</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88">ore::analytics::RiskFactorKey::KeyType::CommodityCurve</a></div><div class="ttdeci">@ CommodityCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a36c90a4563e88cf2b66058371685c7b6"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a36c90a4563e88cf2b66058371685c7b6">ore::analytics::SensitivityScenarioGenerator::commodityCurveScenarioDescription</a></div><div class="ttdeci">ScenarioDescription commodityCurveScenarioDescription(const std::string &amp;commodityName, QuantLib::Size bucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02856">sensitivityscenariogenerator.cpp:2856</a></div></div>
</div><!-- fragment --><div id="dynsection-42" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-42-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-42-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-42-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_cgraph">
<area shape="rect" title=" " alt="" coords="5,157,233,182"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="306,5,491,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="375,70,422,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a36c90a4563e88cf2b66058371685c7b6" title=" " alt="" coords="281,119,516,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="301,193,496,218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="363,242,435,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="311,291,486,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="564,291,703,317"/>
</map>
</div>
<div id="dynsection-43" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-43-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-43-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-43-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5909315dd0dd00c38ebb9401f016381c_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,649,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ae8c23507e58896ff857af151365a6015" name="ae8c23507e58896ff857af151365a6015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8c23507e58896ff857af151365a6015">&#9670;&#160;</a></span>generateCommodityVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateCommodityVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02169">2169</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2169</span>                                                                        {</div>
<div class="line"><span class="lineno"> 2170</span> </div>
<div class="line"><span class="lineno"> 2171</span>    <span class="comment">// Log an ALERT if some commodity vol names in simulation market are not in the list</span></div>
<div class="line"><span class="lineno"> 2172</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityVolNames()) {</div>
<div class="line"><span class="lineno"> 2173</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityVolShiftData().find(name) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityVolShiftData().end()) {</div>
<div class="line"><span class="lineno"> 2174</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;Commodity volatility &quot;</span> &lt;&lt; name</div>
<div class="line"><span class="lineno"> 2175</span>                                         &lt;&lt; <span class="stringliteral">&quot; in simulation market is not &quot;</span></div>
<div class="line"><span class="lineno"> 2176</span>                                            <span class="stringliteral">&quot;included in commodity sensitivity analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 2177</span>        }</div>
<div class="line"><span class="lineno"> 2178</span>    }</div>
<div class="line"><span class="lineno"> 2179</span> </div>
<div class="line"><span class="lineno"> 2180</span>    <span class="comment">// Loop over each commodity and create volatility scenario</span></div>
<div class="line"><span class="lineno"> 2181</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 2182</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityVolShiftData()) {</div>
<div class="line"><span class="lineno"> 2183</span>        <span class="keywordtype">string</span> <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a> = c.first;</div>
<div class="line"><span class="lineno"> 2184</span>        <span class="comment">// Simulation market data for the current name</span></div>
<div class="line"><span class="lineno"> 2185</span>        <span class="keyword">const</span> vector&lt;Period&gt;&amp; expiries = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityVolExpiries(name);</div>
<div class="line"><span class="lineno"> 2186</span>        <span class="keyword">const</span> vector&lt;Real&gt;&amp; moneyness = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;commodityVolMoneyness(name);</div>
<div class="line"><span class="lineno"> 2187</span>        QL_REQUIRE(!expiries.empty(), <span class="stringliteral">&quot;Sim market commodity volatility expiries have not been specified for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2188</span>        QL_REQUIRE(!moneyness.empty(), <span class="stringliteral">&quot;Sim market commodity volatility moneyness has not been specified for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2189</span>        <span class="comment">// Store base scenario volatilities, strike x expiry</span></div>
<div class="line"><span class="lineno"> 2190</span>        vector&lt;vector&lt;Real&gt;&gt; <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>(moneyness.size(), vector&lt;Real&gt;(expiries.size()));</div>
<div class="line"><span class="lineno"> 2191</span>        <span class="comment">// Time to each expiry</span></div>
<div class="line"><span class="lineno"> 2192</span>        vector&lt;Time&gt; times(expiries.size());</div>
<div class="line"><span class="lineno"> 2193</span>        <span class="comment">// Store shifted scenario volatilities</span></div>
<div class="line"><span class="lineno"> 2194</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedValues = <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>;</div>
<div class="line"><span class="lineno"> 2195</span> </div>
<div class="line"><span class="lineno"> 2196</span>        SensitivityScenarioData::VolShiftData sd = c.second;</div>
<div class="line"><span class="lineno"> 2197</span>        QL_REQUIRE(!sd.shiftExpiries.empty(), <span class="stringliteral">&quot;commodity volatility shift tenors must be specified&quot;</span>);</div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(sd.shiftType);</div>
<div class="line"><span class="lineno"> 2200</span>        vector&lt;Time&gt; shiftTimes(sd.shiftExpiries.size());</div>
<div class="line"><span class="lineno"> 2201</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 2202</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2203</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 2204</span>                dc = s-&gt;commodityVolatility(name)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2205</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2206</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2207</span>            }</div>
<div class="line"><span class="lineno"> 2208</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 2209</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for commodity vol surface &quot;</span> &lt;&lt; name</div>
<div class="line"><span class="lineno"> 2210</span>                                                                                             &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 2211</span>        }</div>
<div class="line"><span class="lineno"> 2212</span> </div>
<div class="line"><span class="lineno"> 2213</span>        <span class="comment">// Get the base scenario volatility values</span></div>
<div class="line"><span class="lineno"> 2214</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2215</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; expiries.size(); j++) {</div>
<div class="line"><span class="lineno"> 2216</span>            times[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + expiries[j]);</div>
<div class="line"><span class="lineno"> 2217</span>            <span class="keywordflow">for</span> (Size i = 0; i &lt; moneyness.size(); i++) {</div>
<div class="line"><span class="lineno"> 2218</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807">RiskFactorKey::KeyType::CommodityVolatility</a>, name, i * expiries.size() + j);</div>
<div class="line"><span class="lineno"> 2219</span>                valid =</div>
<div class="line"><span class="lineno"> 2220</span>                    valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>[i][j], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 2221</span>            }</div>
<div class="line"><span class="lineno"> 2222</span>        }</div>
<div class="line"><span class="lineno"> 2223</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 2224</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2225</span> </div>
<div class="line"><span class="lineno"> 2226</span>        <span class="comment">// Store the shift expiry times</span></div>
<div class="line"><span class="lineno"> 2227</span>        <span class="keywordflow">for</span> (Size sj = 0; sj &lt; sd.shiftExpiries.size(); ++sj) {</div>
<div class="line"><span class="lineno"> 2228</span>            shiftTimes[sj] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + sd.shiftExpiries[sj]);</div>
<div class="line"><span class="lineno"> 2229</span>        }</div>
<div class="line"><span class="lineno"> 2230</span> </div>
<div class="line"><span class="lineno"> 2231</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 2232</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(times, shiftTimes);</div>
<div class="line"><span class="lineno"> 2233</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(moneyness, sd.shiftStrikes);</div>
<div class="line"><span class="lineno"> 2234</span> </div>
<div class="line"><span class="lineno"> 2235</span>        <span class="comment">// Loop and apply scenarios</span></div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordflow">for</span> (Size sj = 0; sj &lt; sd.shiftExpiries.size(); ++sj) {</div>
<div class="line"><span class="lineno"> 2237</span>            <span class="keywordflow">for</span> (Size si = 0; si &lt; sd.shiftStrikes.size(); ++si) {</div>
<div class="line"><span class="lineno"> 2238</span> </div>
<div class="line"><span class="lineno"> 2239</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 2240</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a03fe6e79109200285178c3e85cc98acd">commodityVolScenarioDescription</a>(name, sj, si, up));</div>
<div class="line"><span class="lineno"> 2241</span> </div>
<div class="line"><span class="lineno"> 2242</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(si, sj, sd.shiftSize, up, shiftType, sd.shiftStrikes, shiftTimes, moneyness, times,</div>
<div class="line"><span class="lineno"> 2243</span>                           <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>, shiftedValues, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2244</span> </div>
<div class="line"><span class="lineno"> 2245</span>                Size counter = 0;</div>
<div class="line"><span class="lineno"> 2246</span>                <span class="keywordflow">for</span> (Size i = 0; i &lt; moneyness.size(); i++) {</div>
<div class="line"><span class="lineno"> 2247</span>                    <span class="keywordflow">for</span> (Size j = 0; j &lt; expiries.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2248</span>                        RiskFactorKey key(RFType::CommodityVolatility, name, counter++);</div>
<div class="line"><span class="lineno"> 2249</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 2250</span>                            scenario-&gt;add(key, shiftedValues[i][j] - <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>[i][j]);</div>
<div class="line"><span class="lineno"> 2251</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2252</span>                            scenario-&gt;add(key, shiftedValues[i][j]);</div>
<div class="line"><span class="lineno"> 2253</span>                        }</div>
<div class="line"><span class="lineno"> 2254</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 2255</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; si == i &amp;&amp; sj == j) {</div>
<div class="line"><span class="lineno"> 2256</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedValues[i][j] - <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>[i][j];</div>
<div class="line"><span class="lineno"> 2257</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">baseValues</a>[i][j];</div>
<div class="line"><span class="lineno"> 2258</span>                        }</div>
<div class="line"><span class="lineno"> 2259</span>                    }</div>
<div class="line"><span class="lineno"> 2260</span>                }</div>
<div class="line"><span class="lineno"> 2261</span> </div>
<div class="line"><span class="lineno"> 2262</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 2263</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 2264</span> </div>
<div class="line"><span class="lineno"> 2265</span>                <span class="comment">// Add the final scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 2266</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 2267</span> </div>
<div class="line"><span class="lineno"> 2268</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 2269</span>            }</div>
<div class="line"><span class="lineno"> 2270</span>        }</div>
<div class="line"><span class="lineno"> 2271</span>    }</div>
<div class="line"><span class="lineno"> 2272</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Commodity volatility scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2273</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807">ore::analytics::RiskFactorKey::KeyType::CommodityVolatility</a></div><div class="ttdeci">@ CommodityVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a012344d58b46624f90a41f4fc2d59e0c"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c">ore::analytics::SensitivityScenarioGenerator::baseValues</a></div><div class="ttdeci">const std::map&lt; RiskFactorKey, QuantLib::Real &gt; &amp; baseValues() const</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8hpp_source.html#l00126">sensitivityscenariogenerator.hpp:126</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a03fe6e79109200285178c3e85cc98acd"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a03fe6e79109200285178c3e85cc98acd">ore::analytics::SensitivityScenarioGenerator::commodityVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription commodityVolScenarioDescription(const std::string &amp;commodityName, QuantLib::Size expiryBucket, QuantLib::Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02877">sensitivityscenariogenerator.cpp:2877</a></div></div>
</div><!-- fragment --><div id="dynsection-44" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-44-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-44-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-44-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_cgraph">
<area shape="rect" title=" " alt="" coords="5,169,220,194"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="286,5,471,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="355,70,402,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a012344d58b46624f90a41f4fc2d59e0c" title=" " alt="" coords="333,119,424,145"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a03fe6e79109200285178c3e85cc98acd" title=" " alt="" coords="268,169,489,194"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="281,242,476,267"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="343,291,415,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="291,341,466,366"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="555,169,658,194"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="537,341,676,366"/>
</map>
</div>
<div id="dynsection-45" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-45-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-45-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-45-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ae8c23507e58896ff857af151365a6015_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,636,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="aaf3e88184ad3e14d3a3f60fd7300fcfd" name="aaf3e88184ad3e14d3a3f60fd7300fcfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf3e88184ad3e14d3a3f60fd7300fcfd">&#9670;&#160;</a></span>generateSecuritySpreadScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateSecuritySpreadScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02390">2390</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2390</span>                                                                          {</div>
<div class="line"><span class="lineno"> 2391</span>    <span class="comment">// We can choose to shift fewer discount curves than listed in the market</span></div>
<div class="line"><span class="lineno"> 2392</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 2393</span>    <span class="comment">// Log an ALERT if some equities in simmarket are excluded from the sensitivities list</span></div>
<div class="line"><span class="lineno"> 2394</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_security : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;securities()) {</div>
<div class="line"><span class="lineno"> 2395</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;securityShiftData().find(sim_security) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;securityShiftData().end()) {</div>
<div class="line"><span class="lineno"> 2396</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Security &quot;</span> &lt;&lt; sim_security &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 2397</span>        }</div>
<div class="line"><span class="lineno"> 2398</span>    }</div>
<div class="line"><span class="lineno"> 2399</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;securityShiftData()) {</div>
<div class="line"><span class="lineno"> 2400</span>        <span class="keywordtype">string</span> bond = s.first;</div>
<div class="line"><span class="lineno"> 2401</span>        SensitivityScenarioData::SpotShiftData data = s.second;</div>
<div class="line"><span class="lineno"> 2402</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> type = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 2403</span>        Real size = up ? data.shiftSize : -1.0 * data.shiftSize;</div>
<div class="line"><span class="lineno"> 2404</span>        <span class="keywordtype">bool</span> relShift = (type == SensitivityScenarioGenerator::ShiftType::Relative);</div>
<div class="line"><span class="lineno"> 2405</span> </div>
<div class="line"><span class="lineno"> 2406</span>        boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span>        RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23">RiskFactorKey::KeyType::SecuritySpread</a>, bond);</div>
<div class="line"><span class="lineno"> 2409</span>        Real base_spread;</div>
<div class="line"><span class="lineno"> 2410</span>        <span class="keywordflow">if</span> (!tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, base_spread, <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>))</div>
<div class="line"><span class="lineno"> 2411</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2412</span>        Real newSpread = relShift ? base_spread * (1.0 + size) : (base_spread + size);</div>
<div class="line"><span class="lineno"> 2413</span>        <span class="comment">// Real newRate = up ? rate * (1.0 + data.shiftSize) : rate * (1.0 - data.shiftSize);</span></div>
<div class="line"><span class="lineno"> 2414</span>        scenario-&gt;add(key, newSpread);</div>
<div class="line"><span class="lineno"> 2415</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5894bae3460d65e021318164a4f480d6">securitySpreadScenarioDescription</a>(bond, up));</div>
<div class="line"><span class="lineno"> 2416</span> </div>
<div class="line"><span class="lineno"> 2417</span>        <span class="comment">// Store absolute shift size</span></div>
<div class="line"><span class="lineno"> 2418</span>        <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2419</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = newSpread - base_spread;</div>
<div class="line"><span class="lineno"> 2420</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = base_spread;</div>
<div class="line"><span class="lineno"> 2421</span>        }</div>
<div class="line"><span class="lineno"> 2422</span> </div>
<div class="line"><span class="lineno"> 2423</span>        <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 2424</span>        scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 2425</span> </div>
<div class="line"><span class="lineno"> 2426</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 2427</span>        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno"> 2428</span>                                       &lt;&lt; <span class="stringliteral">&quot; created: &quot;</span> &lt;&lt; newSpread);</div>
<div class="line"><span class="lineno"> 2429</span>    }</div>
<div class="line"><span class="lineno"> 2430</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Security scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2431</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23">ore::analytics::RiskFactorKey::KeyType::SecuritySpread</a></div><div class="ttdeci">@ SecuritySpread</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a5894bae3460d65e021318164a4f480d6"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5894bae3460d65e021318164a4f480d6">ore::analytics::SensitivityScenarioGenerator::securitySpreadScenarioDescription</a></div><div class="ttdeci">ScenarioDescription securitySpreadScenarioDescription(string bond, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02934">sensitivityscenariogenerator.cpp:2934</a></div></div>
</div><!-- fragment --><div id="dynsection-46" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-46-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-46-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-46-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_cgraph">
<area shape="rect" title=" " alt="" coords="5,104,224,129"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="361,5,408,31"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="287,79,482,104"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5894bae3460d65e021318164a4f480d6" title=" " alt="" coords="272,128,497,153"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="349,177,421,203"/>
</map>
</div>
<div id="dynsection-47" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-47-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-47-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-47-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aaf3e88184ad3e14d3a3f60fd7300fcfd_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,640,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="af7514f26c1f3e6e7803bcdb96d81ec6f" name="af7514f26c1f3e6e7803bcdb96d81ec6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7514f26c1f3e6e7803bcdb96d81ec6f">&#9670;&#160;</a></span>generateCorrelationScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateCorrelationScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02275">2275</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2275</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2276</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 2277</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> sim_cap : <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;correlationPairs()) {</div>
<div class="line"><span class="lineno"> 2278</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;correlationShiftData().find(sim_cap) == <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;correlationShiftData().end()) {</div>
<div class="line"><span class="lineno"> 2279</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Correlation &quot;</span> &lt;&lt; sim_cap &lt;&lt; <span class="stringliteral">&quot; in simmarket is not included in sensitivities analysis&quot;</span>);</div>
<div class="line"><span class="lineno"> 2280</span>        }</div>
<div class="line"><span class="lineno"> 2281</span>    }</div>
<div class="line"><span class="lineno"> 2282</span> </div>
<div class="line"><span class="lineno"> 2283</span>    Size n_c_strikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;correlationStrikes().size();</div>
<div class="line"><span class="lineno"> 2284</span>    vector&lt;Real&gt; corrStrikes = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;correlationStrikes();</div>
<div class="line"><span class="lineno"> 2285</span> </div>
<div class="line"><span class="lineno"> 2286</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;correlationShiftData()) {</div>
<div class="line"><span class="lineno"> 2287</span>        std::string label = c.first;</div>
<div class="line"><span class="lineno"> 2288</span>        std::vector&lt;std::string&gt; tokens = <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec">ore::data::getCorrelationTokens</a>(label);</div>
<div class="line"><span class="lineno"> 2289</span>        std::pair&lt;string, string&gt; pair(tokens[0], tokens[1]);</div>
<div class="line"><span class="lineno"> 2290</span>        Size n_c_exp = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;correlationExpiries().size();</div>
<div class="line"><span class="lineno"> 2291</span>        SensitivityScenarioData::VolShiftData data = c.second;</div>
<div class="line"><span class="lineno"> 2292</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 2293</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 2294</span>        vector&lt;vector&lt;Real&gt;&gt; corrData(n_c_exp, vector&lt;Real&gt;(n_c_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 2295</span>        vector&lt;Real&gt; corrExpiryTimes(n_c_exp, 0.0);</div>
<div class="line"><span class="lineno"> 2296</span>        vector&lt;vector&lt;Real&gt;&gt; shiftedCorrData(n_c_exp, vector&lt;Real&gt;(n_c_strikes, 0.0));</div>
<div class="line"><span class="lineno"> 2297</span> </div>
<div class="line"><span class="lineno"> 2298</span>        std::vector&lt;Period&gt; expiries = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#abc775bc68d5c2a673f8a454972be6387">overrideTenors_</a> ? <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;correlationExpiries() : data.shiftExpiries;</div>
<div class="line"><span class="lineno"> 2299</span>        QL_REQUIRE(expiries.size() == data.shiftExpiries.size(), <span class="stringliteral">&quot;mismatch between effective shift expiries (&quot;</span></div>
<div class="line"><span class="lineno"> 2300</span>                                                                     &lt;&lt; expiries.size() &lt;&lt; <span class="stringliteral">&quot;) and shift tenors (&quot;</span></div>
<div class="line"><span class="lineno"> 2301</span>                                                                     &lt;&lt; data.shiftExpiries.size());</div>
<div class="line"><span class="lineno"> 2302</span>        vector&lt;Real&gt; shiftExpiryTimes(expiries.size(), 0.0);</div>
<div class="line"><span class="lineno"> 2303</span>        vector&lt;Real&gt; shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno"> 2304</span> </div>
<div class="line"><span class="lineno"> 2305</span>        DayCounter dc = Actual365Fixed();</div>
<div class="line"><span class="lineno"> 2306</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2307</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 2308</span>                dc = s-&gt;correlationCurve(pair.first, pair.second)-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2309</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2310</span>                QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2311</span>            }</div>
<div class="line"><span class="lineno"> 2312</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 2313</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for correlation curve &quot;</span></div>
<div class="line"><span class="lineno"> 2314</span>                 &lt;&lt; pair.first &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; pair.second &lt;&lt; <span class="stringliteral">&quot;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 2315</span>        }</div>
<div class="line"><span class="lineno"> 2316</span> </div>
<div class="line"><span class="lineno"> 2317</span>        <span class="comment">// cache original vol data</span></div>
<div class="line"><span class="lineno"> 2318</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_c_exp; ++j) {</div>
<div class="line"><span class="lineno"> 2319</span>            Date expiry = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;correlationExpiries()[j];</div>
<div class="line"><span class="lineno"> 2320</span>            corrExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, expiry);</div>
<div class="line"><span class="lineno"> 2321</span>        }</div>
<div class="line"><span class="lineno"> 2322</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2323</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_c_exp; ++j) {</div>
<div class="line"><span class="lineno"> 2324</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_c_strikes; ++k) {</div>
<div class="line"><span class="lineno"> 2325</span>                Size idx = j * n_c_strikes + k;</div>
<div class="line"><span class="lineno"> 2326</span>                RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">RiskFactorKey::KeyType::Correlation</a>, label, idx);</div>
<div class="line"><span class="lineno"> 2327</span>                valid = valid &amp;&amp; tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, corrData[j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 2328</span>            }</div>
<div class="line"><span class="lineno"> 2329</span>        }</div>
<div class="line"><span class="lineno"> 2330</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 2331</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2332</span> </div>
<div class="line"><span class="lineno"> 2333</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 2334</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 2335</span>            shiftExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + expiries[j]);</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 2338</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(corrExpiryTimes, shiftExpiryTimes);</div>
<div class="line"><span class="lineno"> 2339</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(corrStrikes, shiftStrikes);</div>
<div class="line"><span class="lineno"> 2340</span> </div>
<div class="line"><span class="lineno"> 2341</span>        <span class="comment">// loop over shift expiries and terms</span></div>
<div class="line"><span class="lineno"> 2342</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2343</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; shiftStrikes.size(); ++k) {</div>
<div class="line"><span class="lineno"> 2344</span>                boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 2345</span> </div>
<div class="line"><span class="lineno"> 2346</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(<a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a05852fc1e9a1d15cbe24af1003430ea3">correlationScenarioDescription</a>(label, j, k, up));</div>
<div class="line"><span class="lineno"> 2347</span> </div>
<div class="line"><span class="lineno"> 2348</span>                <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, k, shiftSize, up, shiftType, shiftExpiryTimes, shiftStrikes, corrExpiryTimes, corrStrikes,</div>
<div class="line"><span class="lineno"> 2349</span>                           corrData, shiftedCorrData, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2350</span> </div>
<div class="line"><span class="lineno"> 2351</span>                <span class="comment">// add shifted vol data to the scenario</span></div>
<div class="line"><span class="lineno"> 2352</span>                <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_c_exp; ++jj) {</div>
<div class="line"><span class="lineno"> 2353</span>                    <span class="keywordflow">for</span> (Size kk = 0; kk &lt; n_c_strikes; ++kk) {</div>
<div class="line"><span class="lineno"> 2354</span>                        Size idx = jj * n_c_strikes + kk;</div>
<div class="line"><span class="lineno"> 2355</span>                        RiskFactorKey key(RFType::Correlation, label, idx);</div>
<div class="line"><span class="lineno"> 2356</span> </div>
<div class="line"><span class="lineno"> 2357</span>                        <span class="keywordflow">if</span> (shiftedCorrData[jj][kk] &gt; 1) {</div>
<div class="line"><span class="lineno"> 2358</span>                            shiftedCorrData[jj][kk] = 1;</div>
<div class="line"><span class="lineno"> 2359</span>                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (shiftedCorrData[jj][kk] &lt; -1) {</div>
<div class="line"><span class="lineno"> 2360</span>                            shiftedCorrData[jj][kk] = -1;</div>
<div class="line"><span class="lineno"> 2361</span>                        }</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 2364</span>                            scenario-&gt;add(key, shiftedCorrData[jj][kk] - corrData[jj][kk]);</div>
<div class="line"><span class="lineno"> 2365</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2366</span>                            scenario-&gt;add(key, shiftedCorrData[jj][kk]);</div>
<div class="line"><span class="lineno"> 2367</span>                        }</div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(jj &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; kk &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; shiftedCorrData[jj][kk] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; corrData[jj][kk]);</div>
<div class="line"><span class="lineno"> 2370</span>                        <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 2371</span>                        <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj &amp;&amp; k == kk) {</div>
<div class="line"><span class="lineno"> 2372</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedCorrData[jj][kk] - corrData[jj][kk];</div>
<div class="line"><span class="lineno"> 2373</span>                            <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = corrData[jj][kk];</div>
<div class="line"><span class="lineno"> 2374</span>                        }</div>
<div class="line"><span class="lineno"> 2375</span>                    }</div>
<div class="line"><span class="lineno"> 2376</span>                }</div>
<div class="line"><span class="lineno"> 2377</span> </div>
<div class="line"><span class="lineno"> 2378</span>                <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 2379</span>                scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 2380</span> </div>
<div class="line"><span class="lineno"> 2381</span>                <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 2382</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 2383</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label() &lt;&lt; <span class="stringliteral">&quot; created&quot;</span>);</div>
<div class="line"><span class="lineno"> 2384</span>            }</div>
<div class="line"><span class="lineno"> 2385</span>        }</div>
<div class="line"><span class="lineno"> 2386</span>    }</div>
<div class="line"><span class="lineno"> 2387</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Correlation scenarios done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2388</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">ore::analytics::RiskFactorKey::KeyType::Correlation</a></div><div class="ttdeci">@ Correlation</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a05852fc1e9a1d15cbe24af1003430ea3"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a05852fc1e9a1d15cbe24af1003430ea3">ore::analytics::SensitivityScenarioGenerator::correlationScenarioDescription</a></div><div class="ttdeci">ScenarioDescription correlationScenarioDescription(string pair, Size expiryBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02905">sensitivityscenariogenerator.cpp:2905</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a03690cad98f577e0a0992609f64704ec"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec">ore::data::getCorrelationTokens</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getCorrelationTokens(const std::string &amp;name)</div></div>
</div><!-- fragment --><div id="dynsection-48" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-48-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-48-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-48-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_cgraph">
<area shape="rect" title=" " alt="" coords="5,177,197,202"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="252,5,437,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="321,70,368,95"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a05852fc1e9a1d15cbe24af1003430ea3" title=" " alt="" coords="245,119,444,145"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec" title=" " alt="" coords="264,169,425,209"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="247,258,442,283"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="309,307,381,333"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="257,357,432,382"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="510,119,613,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="492,357,631,382"/>
</map>
</div>
<div id="dynsection-49" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-49-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-49-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-49-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_af7514f26c1f3e6e7803bcdb96d81ec6f_icgraph">
<area shape="rect" title=" " alt="" coords="421,5,613,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="aa15d0f2e93f0677d51e215ed114e4014" name="aa15d0f2e93f0677d51e215ed114e4014"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa15d0f2e93f0677d51e215ed114e4014">&#9670;&#160;</a></span>generateGenericYieldVolScenarios()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void generateGenericYieldVolScenarios </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a>&#160;</td>
          <td class="paramname"><em>rfType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l01023">1023</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1023</span>                                                                                                        {</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span>    Date <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a8a42206bfb9d57d14fb8a25d841692ce">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>    <span class="comment">// set parameters for swaption resp. yield vol scenarios</span></div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordtype">bool</span> atmOnly;</div>
<div class="line"><span class="lineno"> 1030</span>    map&lt;string, SensitivityScenarioData::GenericYieldVolShiftData&gt; shiftData;</div>
<div class="line"><span class="lineno"> 1031</span>    function&lt;Size(<span class="keywordtype">string</span>)&gt; get_n_term;</div>
<div class="line"><span class="lineno"> 1032</span>    function&lt;Size(<span class="keywordtype">string</span>)&gt; get_n_expiry;</div>
<div class="line"><span class="lineno"> 1033</span>    function&lt;vector&lt;Real&gt;(<span class="keywordtype">string</span>)&gt; getVolStrikes;</div>
<div class="line"><span class="lineno"> 1034</span>    function&lt;vector&lt;Period&gt;(<span class="keywordtype">string</span>)&gt; getVolExpiries;</div>
<div class="line"><span class="lineno"> 1035</span>    function&lt;vector&lt;Period&gt;(<span class="keywordtype">string</span>)&gt; getVolTerms;</div>
<div class="line"><span class="lineno"> 1036</span>    function&lt;string(<span class="keywordtype">string</span>)&gt; getDayCounter;</div>
<div class="line"><span class="lineno"> 1037</span>    function&lt;ScenarioDescription(<span class="keywordtype">string</span>, Size, Size, Size, <span class="keywordtype">bool</span>)&gt; getScenarioDescription;</div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>    <span class="keywordflow">if</span> (rfType == RFType::SwaptionVolatility) {</div>
<div class="line"><span class="lineno"> 1040</span>        atmOnly = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;simulateSwapVolATMOnly();</div>
<div class="line"><span class="lineno"> 1041</span>        shiftData = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;swaptionVolShiftData();</div>
<div class="line"><span class="lineno"> 1042</span>        get_n_term = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;swapVolTerms(k).size(); };</div>
<div class="line"><span class="lineno"> 1043</span>        get_n_expiry = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;swapVolExpiries(k).size(); };</div>
<div class="line"><span class="lineno"> 1044</span>        getVolStrikes = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;swapVolStrikeSpreads(k); };</div>
<div class="line"><span class="lineno"> 1045</span>        getVolExpiries = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;swapVolExpiries(k); };</div>
<div class="line"><span class="lineno"> 1046</span>        getVolTerms = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;swapVolTerms(k); };</div>
<div class="line"><span class="lineno"> 1047</span>        getDayCounter = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) {</div>
<div class="line"><span class="lineno"> 1048</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1049</span>                <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1050</span>                    <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(s-&gt;swaptionVol(k)-&gt;dayCounter());</div>
<div class="line"><span class="lineno"> 1051</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1052</span>                    QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1053</span>                }</div>
<div class="line"><span class="lineno"> 1054</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1055</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for swaption vol &#39;&quot;</span> &lt;&lt; k</div>
<div class="line"><span class="lineno"> 1056</span>                                                                                         &lt;&lt; <span class="stringliteral">&quot;&#39;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1057</span>                <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;A365F&quot;</span>);</div>
<div class="line"><span class="lineno"> 1058</span>            }</div>
<div class="line"><span class="lineno"> 1059</span>        };</div>
<div class="line"><span class="lineno"> 1060</span>        getScenarioDescription = [<span class="keyword">this</span>](<span class="keywordtype">string</span> q, Size n, Size m, Size k, <span class="keywordtype">bool</span> up) {</div>
<div class="line"><span class="lineno"> 1061</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312">swaptionVolScenarioDescription</a>(q, n, m, k, up);</div>
<div class="line"><span class="lineno"> 1062</span>        };</div>
<div class="line"><span class="lineno"> 1063</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rfType == RFType::YieldVolatility) {</div>
<div class="line"><span class="lineno"> 1064</span>        atmOnly = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1065</span>        shiftData = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldVolShiftData();</div>
<div class="line"><span class="lineno"> 1066</span>        get_n_term = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldVolTerms().size(); };</div>
<div class="line"><span class="lineno"> 1067</span>        get_n_expiry = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldVolExpiries().size(); };</div>
<div class="line"><span class="lineno"> 1068</span>        getVolStrikes = [](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> vector&lt;Real&gt;({0.0}); };</div>
<div class="line"><span class="lineno"> 1069</span>        getVolExpiries = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldVolExpiries(); };</div>
<div class="line"><span class="lineno"> 1070</span>        getVolTerms = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) { <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a9fa1c3e52dd2282a94cb8df118e517dc">simMarketData_</a>-&gt;yieldVolTerms(); };</div>
<div class="line"><span class="lineno"> 1071</span>        getDayCounter = [<span class="keyword">this</span>](<span class="keyword">const</span> <span class="keywordtype">string</span>&amp; k) {</div>
<div class="line"><span class="lineno"> 1072</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1073</span>                <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a162cfc221721116690ade22a8da732f2">simMarket_</a>.lock()) {</div>
<div class="line"><span class="lineno"> 1074</span>                    <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(s-&gt;yieldVol(k)-&gt;dayCounter());</div>
<div class="line"><span class="lineno"> 1075</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1076</span>                    QL_FAIL(<span class="stringliteral">&quot;Internal error: could not lock simMarket. Contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1077</span>                }</div>
<div class="line"><span class="lineno"> 1078</span>            } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp;) {</div>
<div class="line"><span class="lineno"> 1079</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Day counter lookup in simulation market failed for swaption vol &#39;&quot;</span> &lt;&lt; k</div>
<div class="line"><span class="lineno"> 1080</span>                                                                                         &lt;&lt; <span class="stringliteral">&quot;&#39;, using default A365&quot;</span>);</div>
<div class="line"><span class="lineno"> 1081</span>                <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;A365F&quot;</span>);</div>
<div class="line"><span class="lineno"> 1082</span>            }</div>
<div class="line"><span class="lineno"> 1083</span>        };</div>
<div class="line"><span class="lineno"> 1084</span>        getScenarioDescription = [<span class="keyword">this</span>](<span class="keywordtype">string</span> q, Size n, Size m, Size k, <span class="keywordtype">bool</span> up) {</div>
<div class="line"><span class="lineno"> 1085</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd">yieldVolScenarioDescription</a>(q, n, m, up);</div>
<div class="line"><span class="lineno"> 1086</span>        };</div>
<div class="line"><span class="lineno"> 1087</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1088</span>        QL_FAIL(<span class="stringliteral">&quot;SensitivityScenarioGenerator::generateGenericYieldVolScenarios: risk factor type &quot;</span> &lt;&lt; rfType</div>
<div class="line"><span class="lineno"> 1089</span>                                                                                                    &lt;&lt; <span class="stringliteral">&quot; not handled.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1090</span>    }</div>
<div class="line"><span class="lineno"> 1091</span> </div>
<div class="line"><span class="lineno"> 1092</span>    <span class="comment">// generate scenarios</span></div>
<div class="line"><span class="lineno"> 1093</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : shiftData) {</div>
<div class="line"><span class="lineno"> 1094</span>        std::string qualifier = s.first;</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>        Size n_term = get_n_term(qualifier);</div>
<div class="line"><span class="lineno"> 1097</span>        Size n_expiry = get_n_expiry(qualifier);</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>        vector&lt;Real&gt; volExpiryTimes(n_expiry, 0.0);</div>
<div class="line"><span class="lineno"> 1100</span>        vector&lt;Real&gt; volTermTimes(n_term, 0.0);</div>
<div class="line"><span class="lineno"> 1101</span>        Size n_strike = getVolStrikes(qualifier).size();</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>        vector&lt;vector&lt;vector&lt;Real&gt;&gt;&gt; volData(n_strike, vector&lt;vector&lt;Real&gt;&gt;(n_expiry, vector&lt;Real&gt;(n_term, 0.0)));</div>
<div class="line"><span class="lineno"> 1104</span>        vector&lt;vector&lt;vector&lt;Real&gt;&gt;&gt; shiftedVolData = volData;</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>        SensitivityScenarioData::GenericYieldVolShiftData data = s.second;</div>
<div class="line"><span class="lineno"> 1107</span>        <a class="code hl_enumeration" href="classore_1_1analytics_1_1_shift_scenario_generator.html#ae6645effb55b498ae924e935d438a900">ShiftType</a> shiftType = <a class="code hl_function" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1">parseShiftType</a>(data.shiftType);</div>
<div class="line"><span class="lineno"> 1108</span>        Real shiftSize = data.shiftSize;</div>
<div class="line"><span class="lineno"> 1109</span> </div>
<div class="line"><span class="lineno"> 1110</span>        vector&lt;Real&gt; shiftExpiryTimes(data.shiftExpiries.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1111</span>        vector&lt;Real&gt; shiftTermTimes(data.shiftTerms.size(), 0.0);</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>        vector&lt;Real&gt; shiftStrikes;</div>
<div class="line"><span class="lineno"> 1114</span>        <span class="keywordflow">if</span> (!atmOnly) {</div>
<div class="line"><span class="lineno"> 1115</span>            shiftStrikes = data.shiftStrikes;</div>
<div class="line"><span class="lineno"> 1116</span>            QL_REQUIRE(data.shiftStrikes.size() == n_strike,</div>
<div class="line"><span class="lineno"> 1117</span>                       <span class="stringliteral">&quot;number of simulated strikes must equal number of sensitivity strikes&quot;</span>);</div>
<div class="line"><span class="lineno"> 1118</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1119</span>            shiftStrikes = {0.0};</div>
<div class="line"><span class="lineno"> 1120</span>        }</div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>        DayCounter dc = <a class="code hl_functionRef" href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093">parseDayCounter</a>(getDayCounter(qualifier));</div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span>        <span class="comment">// cache original vol data</span></div>
<div class="line"><span class="lineno"> 1125</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_expiry; ++j) {</div>
<div class="line"><span class="lineno"> 1126</span>            Date expiry = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + getVolExpiries(qualifier)[j];</div>
<div class="line"><span class="lineno"> 1127</span>            volExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, expiry);</div>
<div class="line"><span class="lineno"> 1128</span>        }</div>
<div class="line"><span class="lineno"> 1129</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_term; ++j) {</div>
<div class="line"><span class="lineno"> 1130</span>            Date term = <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + getVolTerms(qualifier)[j];</div>
<div class="line"><span class="lineno"> 1131</span>            volTermTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, term);</div>
<div class="line"><span class="lineno"> 1132</span>        }</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>        <span class="keywordtype">bool</span> valid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1135</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; n_expiry; ++j) {</div>
<div class="line"><span class="lineno"> 1136</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; n_term; ++k) {</div>
<div class="line"><span class="lineno"> 1137</span>                <span class="keywordflow">for</span> (Size l = 0; l &lt; n_strike; ++l) {</div>
<div class="line"><span class="lineno"> 1138</span>                    Size idx = j * n_term * n_strike + k * n_strike + l;</div>
<div class="line"><span class="lineno"> 1139</span>                    RiskFactorKey key(rfType, qualifier, idx);</div>
<div class="line"><span class="lineno"> 1140</span>                    valid = valid &amp;&amp;</div>
<div class="line"><span class="lineno"> 1141</span>                            tryGetBaseScenarioValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4b4544f478033671c1fd68173f115187">baseScenarioAbsolute_</a>, key, volData[l][j][k], <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3dd077c2c46a5babc0511ba2648e2321">continueOnError_</a>);</div>
<div class="line"><span class="lineno"> 1142</span>                }</div>
<div class="line"><span class="lineno"> 1143</span>            }</div>
<div class="line"><span class="lineno"> 1144</span>        }</div>
<div class="line"><span class="lineno"> 1145</span>        <span class="keywordflow">if</span> (!valid)</div>
<div class="line"><span class="lineno"> 1146</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>        <span class="comment">// cache tenor times</span></div>
<div class="line"><span class="lineno"> 1149</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 1150</span>            shiftExpiryTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + data.shiftExpiries[j]);</div>
<div class="line"><span class="lineno"> 1151</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftTermTimes.size(); ++j)</div>
<div class="line"><span class="lineno"> 1152</span>            shiftTermTimes[j] = dc.yearFraction(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>, <a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a> + data.shiftTerms[j]);</div>
<div class="line"><span class="lineno"> 1153</span> </div>
<div class="line"><span class="lineno"> 1154</span>        <span class="comment">// Can we store a valid shift size?</span></div>
<div class="line"><span class="lineno"> 1155</span>        <span class="keywordtype">bool</span> validShiftSize = <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volExpiryTimes, shiftExpiryTimes);</div>
<div class="line"><span class="lineno"> 1156</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(volTermTimes, shiftTermTimes);</div>
<div class="line"><span class="lineno"> 1157</span>        validShiftSize = validShiftSize &amp;&amp; <a class="code hl_function" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e">vectorEqual</a>(getVolStrikes(qualifier), shiftStrikes);</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>        <span class="comment">// loop over shift expiries, terms and strikes</span></div>
<div class="line"><span class="lineno"> 1160</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; shiftExpiryTimes.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1161</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; shiftTermTimes.size(); ++k) {</div>
<div class="line"><span class="lineno"> 1162</span>                <span class="keywordflow">for</span> (Size l = 0; l &lt; shiftStrikes.size(); ++l) {</div>
<div class="line"><span class="lineno"> 1163</span>                    Size strikeBucket = l;</div>
<div class="line"><span class="lineno"> 1164</span>                    boost::shared_ptr&lt;Scenario&gt; scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf24308523669dc57ad15492c900a27c">sensiScenarioFactory_</a>-&gt;buildScenario(<a class="code hl_function" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4">asof</a>);</div>
<div class="line"><span class="lineno"> 1165</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.push_back(getScenarioDescription(qualifier, j, k, strikeBucket, up));</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>                    <span class="comment">// if simulating atm only we shift all strikes otherwise we shift each strike individually</span></div>
<div class="line"><span class="lineno"> 1168</span>                    Size loopStart = atmOnly ? 0 : l;</div>
<div class="line"><span class="lineno"> 1169</span>                    Size loopEnd = atmOnly ? n_strike : loopStart + 1;</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Generic Yield vol looping over &quot;</span> &lt;&lt; loopStart &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; loopEnd &lt;&lt; <span class="stringliteral">&quot; for strike &quot;</span></div>
<div class="line"><span class="lineno"> 1172</span>                                                           &lt;&lt; shiftStrikes[l]);</div>
<div class="line"><span class="lineno"> 1173</span>                    <span class="keywordflow">for</span> (Size ll = loopStart; ll &lt; loopEnd; ++ll) {</div>
<div class="line"><span class="lineno"> 1174</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861">applyShift</a>(j, k, shiftSize, up, shiftType, shiftExpiryTimes, shiftTermTimes, volExpiryTimes,</div>
<div class="line"><span class="lineno"> 1175</span>                                   volTermTimes, volData[ll], shiftedVolData[ll], <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1176</span>                    }</div>
<div class="line"><span class="lineno"> 1177</span> </div>
<div class="line"><span class="lineno"> 1178</span>                    <span class="keywordflow">for</span> (Size jj = 0; jj &lt; n_expiry; ++jj) {</div>
<div class="line"><span class="lineno"> 1179</span>                        <span class="keywordflow">for</span> (Size kk = 0; kk &lt; n_term; ++kk) {</div>
<div class="line"><span class="lineno"> 1180</span>                            <span class="keywordflow">for</span> (Size ll = 0; ll &lt; n_strike; ++ll) {</div>
<div class="line"><span class="lineno"> 1181</span> </div>
<div class="line"><span class="lineno"> 1182</span>                                Size idx = jj * n_term * n_strike + kk * n_strike + ll;</div>
<div class="line"><span class="lineno"> 1183</span>                                RiskFactorKey key(rfType, qualifier, idx);</div>
<div class="line"><span class="lineno"> 1184</span> </div>
<div class="line"><span class="lineno"> 1185</span>                                <span class="keywordflow">if</span> (ll &gt;= loopStart &amp;&amp; ll &lt; loopEnd) {</div>
<div class="line"><span class="lineno"> 1186</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;useSpreadedTermStructures()) {</div>
<div class="line"><span class="lineno"> 1187</span>                                        scenario-&gt;add(key, shiftedVolData[ll][jj][kk] - volData[ll][jj][kk]);</div>
<div class="line"><span class="lineno"> 1188</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1189</span>                                        scenario-&gt;add(key, shiftedVolData[ll][jj][kk]);</div>
<div class="line"><span class="lineno"> 1190</span>                                    }</div>
<div class="line"><span class="lineno"> 1191</span>                                }</div>
<div class="line"><span class="lineno"> 1192</span> </div>
<div class="line"><span class="lineno"> 1193</span>                                <span class="comment">// Possibly store valid shift size</span></div>
<div class="line"><span class="lineno"> 1194</span>                                <span class="keywordflow">if</span> (validShiftSize &amp;&amp; up &amp;&amp; j == jj &amp;&amp; k == kk &amp;&amp; l == ll) {</div>
<div class="line"><span class="lineno"> 1195</span>                                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = shiftedVolData[ll][jj][kk] - volData[ll][jj][kk];</div>
<div class="line"><span class="lineno"> 1196</span>                                    <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = volData[ll][jj][kk];</div>
<div class="line"><span class="lineno"> 1197</span>                                }</div>
<div class="line"><span class="lineno"> 1198</span>                            }</div>
<div class="line"><span class="lineno"> 1199</span>                        }</div>
<div class="line"><span class="lineno"> 1200</span>                    }</div>
<div class="line"><span class="lineno"> 1201</span> </div>
<div class="line"><span class="lineno"> 1202</span>                    <span class="comment">// Give the scenario a label</span></div>
<div class="line"><span class="lineno"> 1203</span>                    scenario-&gt;label(<a class="code hl_functionRef" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190">to_string</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a0bd85b6f8f58d6c5cf6f3ab6c040a41f">scenarioDescriptions_</a>.back()));</div>
<div class="line"><span class="lineno"> 1204</span> </div>
<div class="line"><span class="lineno"> 1205</span>                    <span class="comment">// add this scenario to the scenario vector</span></div>
<div class="line"><span class="lineno"> 1206</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.push_back(scenario);</div>
<div class="line"><span class="lineno"> 1207</span>                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Sensitivity scenario # &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_shift_scenario_generator.html#a630f885f7ed1c6d2ba55e098a810531c">scenarios_</a>.size() &lt;&lt; <span class="stringliteral">&quot;, label &quot;</span> &lt;&lt; scenario-&gt;label()</div>
<div class="line"><span class="lineno"> 1208</span>                                                   &lt;&lt; <span class="stringliteral">&quot; created for generic yield vol &quot;</span> &lt;&lt; qualifier);</div>
<div class="line"><span class="lineno"> 1209</span>                }</div>
<div class="line"><span class="lineno"> 1210</span>            }</div>
<div class="line"><span class="lineno"> 1211</span>        }</div>
<div class="line"><span class="lineno"> 1212</span>    }</div>
<div class="line"><span class="lineno"> 1213</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_a3513311b19a4679bf8bee7312e236312"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312">ore::analytics::SensitivityScenarioGenerator::swaptionVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription swaptionVolScenarioDescription(string ccy, Size expiryBucket, Size termBucket, Size strikeBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02603">sensitivityscenariogenerator.cpp:2603</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_html_adf4695dabbff06995b81dc873adbf6bd"><div class="ttname"><a href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd">ore::analytics::SensitivityScenarioGenerator::yieldVolScenarioDescription</a></div><div class="ttdeci">ScenarioDescription yieldVolScenarioDescription(string securityId, Size expiryBucket, Size termBucket, bool up)</div><div class="ttdef"><b>Definition:</b> <a href="sensitivityscenariogenerator_8cpp_source.html#l02634">sensitivityscenariogenerator.cpp:2634</a></div></div>
<div class="ttc" id="agroup__utilities_html_gaefb008d0de256c79140545d9c7549093"><div class="ttname"><a href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093">parseDayCounter</a></div><div class="ttdeci">DayCounter parseDayCounter(const string &amp;s)</div></div>
</div><!-- fragment --><div id="dynsection-50" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-50-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-50-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-50-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_cgraph">
<area shape="rect" title=" " alt="" coords="5,218,228,243"/>
<area shape="rect" href="classore_1_1analytics_1_1_shift_scenario_generator.html#aa50d390d6448fb5266f2ab758bb74861" title="Apply 1d triangular shift to 1d data such as yield curves, public to allow test suite access." alt="" coords="287,5,473,45"/>
<area shape="rect" href="test_2scenarioshiftcalculator_8cpp.html#a652b8805d9b88185e25574d4820660c4" title=" " alt="" coords="357,70,403,95"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#gaefb008d0de256c79140545d9c7549093" title=" " alt="" coords="319,119,441,145"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a5cceb12d217bac14eeda59d5f774f7c1" title=" " alt="" coords="283,193,477,218"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3513311b19a4679bf8bee7312e236312" title=" " alt="" coords="276,242,484,267"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga1b8cd9a976247da6df232ad48d4af190" title=" " alt="" coords="344,291,416,317"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a2984ae998c17c67c5e374b3896e6f44e" title=" " alt="" coords="293,341,467,366"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#adf4695dabbff06995b81dc873adbf6bd" title=" " alt="" coords="288,390,472,415"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="550,242,653,267"/>
<area shape="rect" href="namespaceore_1_1analytics.html#a1d01daebcd210546f1784785760fb64e" title=" " alt="" coords="532,341,671,366"/>
</map>
</div>
<div id="dynsection-51" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-51-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-51-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-51-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aa15d0f2e93f0677d51e215ed114e4014_icgraph">
<area shape="rect" title=" " alt="" coords="672,31,895,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e" title=" " alt="" coords="421,5,624,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6" title=" " alt="" coords="433,55,612,80"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,31,373,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,31,195,56"/>
</map>
</div>

</div>
</div>
<a id="ad55463e7bc2f60b4eeaae92fc3df57f8" name="ad55463e7bc2f60b4eeaae92fc3df57f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad55463e7bc2f60b4eeaae92fc3df57f8">&#9670;&#160;</a></span>discountScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> discountScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ccy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02484">2484</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2484</span>                                                                                          {</div>
<div class="line"><span class="lineno"> 2485</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;discountCurveShiftData().find(ccy) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;discountCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 2486</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; ccy &lt;&lt; <span class="stringliteral">&quot; not found in discount shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2487</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;discountCurveShiftData()[ccy]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2488</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2489</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313">RiskFactorKey::KeyType::DiscountCurve</a>, ccy, bucket);</div>
<div class="line"><span class="lineno"> 2490</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2491</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;discountCurveShiftData()[ccy]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2492</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2493</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2494</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2495</span> </div>
<div class="line"><span class="lineno"> 2496</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2497</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2498</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2499</span>    }</div>
<div class="line"><span class="lineno"> 2500</span> </div>
<div class="line"><span class="lineno"> 2501</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2502</span>}</div>
</div><!-- fragment --><div id="dynsection-52" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-52-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-52-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-52-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ad55463e7bc2f60b4eeaae92fc3df57f8_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad55463e7bc2f60b4eeaae92fc3df57f8_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad55463e7bc2f60b4eeaae92fc3df57f8_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad55463e7bc2f60b4eeaae92fc3df57f8_icgraph">
<area shape="rect" title=" " alt="" coords="683,5,869,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9c63287e5bf9685a9b0863c941f7f2c1" title=" " alt="" coords="421,5,635,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a81a5d16fda37846aa9f1b09ad69c2790" name="a81a5d16fda37846aa9f1b09ad69c2790"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a5d16fda37846aa9f1b09ad69c2790">&#9670;&#160;</a></span>indexScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> indexScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02505">2505</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2505</span>                                                                                         {</div>
<div class="line"><span class="lineno"> 2506</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;indexCurveShiftData().find(index) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;indexCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 2507</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; not found in index shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2508</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;indexCurveShiftData()[index]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2509</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2510</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614">RiskFactorKey::KeyType::IndexCurve</a>, index, bucket);</div>
<div class="line"><span class="lineno"> 2511</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2512</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;indexCurveShiftData()[index]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2513</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2514</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2515</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2516</span> </div>
<div class="line"><span class="lineno"> 2517</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2518</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2519</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2520</span>    }</div>
<div class="line"><span class="lineno"> 2521</span> </div>
<div class="line"><span class="lineno"> 2522</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2523</span>}</div>
</div><!-- fragment --><div id="dynsection-53" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-53-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-53-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-53-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a81a5d16fda37846aa9f1b09ad69c2790_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a81a5d16fda37846aa9f1b09ad69c2790_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a81a5d16fda37846aa9f1b09ad69c2790_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a81a5d16fda37846aa9f1b09ad69c2790_icgraph">
<area shape="rect" title=" " alt="" coords="663,5,832,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ba51e2d1738678433fa86a6cc862027" title=" " alt="" coords="421,5,615,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ab4499bf098f760582d4a5726133cd2ff" name="ab4499bf098f760582d4a5726133cd2ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4499bf098f760582d4a5726133cd2ff">&#9670;&#160;</a></span>yieldScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> yieldScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02526">2526</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2526</span>                                                                                        {</div>
<div class="line"><span class="lineno"> 2527</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldCurveShiftData().find(name) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 2528</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not found in index shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2529</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;yieldCurveShiftData()[name]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2530</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2531</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738">RiskFactorKey::KeyType::YieldCurve</a>, name, bucket);</div>
<div class="line"><span class="lineno"> 2532</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2533</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldCurveShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2534</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2535</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2536</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2537</span> </div>
<div class="line"><span class="lineno"> 2538</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2539</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2540</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2541</span>    }</div>
<div class="line"><span class="lineno"> 2542</span> </div>
<div class="line"><span class="lineno"> 2543</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2544</span>}</div>
</div><!-- fragment --><div id="dynsection-54" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-54-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-54-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-54-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ab4499bf098f760582d4a5726133cd2ff_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ab4499bf098f760582d4a5726133cd2ff_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ab4499bf098f760582d4a5726133cd2ff_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ab4499bf098f760582d4a5726133cd2ff_icgraph">
<area shape="rect" title=" " alt="" coords="660,5,825,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a650b13cc30c1c0cb72ab4dbb60c90db1" title=" " alt="" coords="421,5,612,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a4c013a7ebb2a17fc8ce2404ead5fd52c" name="a4c013a7ebb2a17fc8ce2404ead5fd52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c013a7ebb2a17fc8ce2404ead5fd52c">&#9670;&#160;</a></span>fxScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> fxScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ccypair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02433">2433</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2434</span>                                                                                                               {</div>
<div class="line"><span class="lineno"> 2435</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3">RiskFactorKey::KeyType::FXSpot</a>, ccypair);</div>
<div class="line"><span class="lineno"> 2436</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2437</span>    ScenarioDescription desc(type, key, <span class="stringliteral">&quot;spot&quot;</span>);</div>
<div class="line"><span class="lineno"> 2438</span> </div>
<div class="line"><span class="lineno"> 2439</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2440</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2441</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2442</span>    }</div>
<div class="line"><span class="lineno"> 2443</span> </div>
<div class="line"><span class="lineno"> 2444</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2445</span>}</div>
</div><!-- fragment --><div id="dynsection-55" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-55-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-55-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-55-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a4c013a7ebb2a17fc8ce2404ead5fd52c_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4c013a7ebb2a17fc8ce2404ead5fd52c_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4c013a7ebb2a17fc8ce2404ead5fd52c_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4c013a7ebb2a17fc8ce2404ead5fd52c_icgraph">
<area shape="rect" title=" " alt="" coords="615,5,763,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ac62a903c3bc67c55dcba8ad800019ca2" title=" " alt="" coords="421,5,567,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a6abc89e6315b80ada5497ef0d5ecbc1a" name="a6abc89e6315b80ada5497ef0d5ecbc1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6abc89e6315b80ada5497ef0d5ecbc1a">&#9670;&#160;</a></span>fxVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> fxVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ccypair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02547">2547</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2547</span>                                                                                                                    {</div>
<div class="line"><span class="lineno"> 2548</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxVolShiftData().find(ccypair) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2549</span>               <span class="stringliteral">&quot;currency pair &quot;</span> &lt;&lt; ccypair &lt;&lt; <span class="stringliteral">&quot; not found in fx vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2550</span>    SensitivityScenarioData::VolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;fxVolShiftData()[ccypair];</div>
<div class="line"><span class="lineno"> 2551</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2552</span>    Size index = strikeBucket * data.shiftExpiries.size() + expiryBucket;</div>
<div class="line"><span class="lineno"> 2553</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942">RiskFactorKey::KeyType::FXVolatility</a>, ccypair, index);</div>
<div class="line"><span class="lineno"> 2554</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2555</span>    <span class="keywordflow">if</span> (data.shiftStrikes.size() == 0 ||</div>
<div class="line"><span class="lineno"> 2556</span>        <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(data.shiftStrikes[strikeBucket], 0)) { <span class="comment">// shiftStrikes defaults to {0.00}</span></div>
<div class="line"><span class="lineno"> 2557</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2558</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2559</span>        QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2560</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2561</span>    }</div>
<div class="line"><span class="lineno"> 2562</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2563</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2564</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2565</span> </div>
<div class="line"><span class="lineno"> 2566</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2567</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2568</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2569</span>    }</div>
<div class="line"><span class="lineno"> 2570</span> </div>
<div class="line"><span class="lineno"> 2571</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2572</span>}</div>
</div><!-- fragment --><div id="dynsection-56" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-56-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-56-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-56-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,172,31"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="220,5,323,31"/>
</map>
</div>
<div id="dynsection-57" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-57-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-57-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-57-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6abc89e6315b80ada5497ef0d5ecbc1a_icgraph">
<area shape="rect" title=" " alt="" coords="633,5,800,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad782034ca45729d5c04df8b80e2206f4" title=" " alt="" coords="421,5,585,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a1eac93475a1c9d611e854a825e0289b3" name="a1eac93475a1c9d611e854a825e0289b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1eac93475a1c9d611e854a825e0289b3">&#9670;&#160;</a></span>equityScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> equityScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>equity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02447">2447</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2448</span>                                                                                                                   {</div>
<div class="line"><span class="lineno"> 2449</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad">RiskFactorKey::KeyType::EquitySpot</a>, equity);</div>
<div class="line"><span class="lineno"> 2450</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2451</span>    ScenarioDescription desc(type, key, <span class="stringliteral">&quot;spot&quot;</span>);</div>
<div class="line"><span class="lineno"> 2452</span> </div>
<div class="line"><span class="lineno"> 2453</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2454</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2455</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2456</span>    }</div>
<div class="line"><span class="lineno"> 2457</span> </div>
<div class="line"><span class="lineno"> 2458</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2459</span>}</div>
</div><!-- fragment --><div id="dynsection-58" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-58-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-58-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-58-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a1eac93475a1c9d611e854a825e0289b3_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a1eac93475a1c9d611e854a825e0289b3_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a1eac93475a1c9d611e854a825e0289b3_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a1eac93475a1c9d611e854a825e0289b3_icgraph">
<area shape="rect" title=" " alt="" coords="636,5,809,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#afeedcacdff9b31f492c0a826828b9baf" title=" " alt="" coords="421,5,588,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a4b2ddb1824da83ff9e5fae9caecfcfb8" name="a4b2ddb1824da83ff9e5fae9caecfcfb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b2ddb1824da83ff9e5fae9caecfcfb8">&#9670;&#160;</a></span>dividendYieldScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> dividendYieldScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>equity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02462">2462</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2462</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 2463</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;dividendYieldShiftData().find(name) !=</div>
<div class="line"><span class="lineno"> 2464</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;dividendYieldShiftData().end(),</div>
<div class="line"><span class="lineno"> 2465</span>               <span class="stringliteral">&quot;equity &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not found in dividend yield shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2466</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;dividendYieldShiftData()[name]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2467</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2468</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438">RiskFactorKey::KeyType::DividendYield</a>, name, bucket);</div>
<div class="line"><span class="lineno"> 2469</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2470</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;dividendYieldShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2471</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2472</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2473</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2474</span> </div>
<div class="line"><span class="lineno"> 2475</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2476</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2477</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2478</span>    }</div>
<div class="line"><span class="lineno"> 2479</span> </div>
<div class="line"><span class="lineno"> 2480</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2481</span>}</div>
</div><!-- fragment --><div id="dynsection-59" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-59-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-59-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-59-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a4b2ddb1824da83ff9e5fae9caecfcfb8_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4b2ddb1824da83ff9e5fae9caecfcfb8_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4b2ddb1824da83ff9e5fae9caecfcfb8_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a4b2ddb1824da83ff9e5fae9caecfcfb8_icgraph">
<area shape="rect" title=" " alt="" coords="676,5,889,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae936b20b7f07f4a58b3c8c563a033b72" title=" " alt="" coords="421,5,628,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a6b4ab69d6e0663a291f9cc36f355ec90" name="a6b4ab69d6e0663a291f9cc36f355ec90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b4ab69d6e0663a291f9cc36f355ec90">&#9670;&#160;</a></span>equityVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> equityVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>equity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02575">2575</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2576</span>                                                                    {</div>
<div class="line"><span class="lineno"> 2577</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityVolShiftData().find(equity) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2578</span>               <span class="stringliteral">&quot;currency pair &quot;</span> &lt;&lt; equity &lt;&lt; <span class="stringliteral">&quot; not found in fx vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2579</span>    SensitivityScenarioData::VolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;equityVolShiftData()[equity];</div>
<div class="line"><span class="lineno"> 2580</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2581</span>    Size index = strikeBucket * data.shiftExpiries.size() + expiryBucket;</div>
<div class="line"><span class="lineno"> 2582</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b">RiskFactorKey::KeyType::EquityVolatility</a>, equity, index);</div>
<div class="line"><span class="lineno"> 2583</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2584</span>    <span class="keywordflow">if</span> (data.shiftStrikes.size() == 0 || <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(data.shiftStrikes[strikeBucket], 0)) {</div>
<div class="line"><span class="lineno"> 2585</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2586</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2587</span>        QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2588</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2589</span>    }</div>
<div class="line"><span class="lineno"> 2590</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2591</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2592</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2595</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2596</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2597</span>    }</div>
<div class="line"><span class="lineno"> 2598</span> </div>
<div class="line"><span class="lineno"> 2599</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2600</span>}</div>
</div><!-- fragment --><div id="dynsection-60" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-60-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-60-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-60-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,197,31"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="245,5,348,31"/>
</map>
</div>
<div id="dynsection-61" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-61-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-61-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-61-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6b4ab69d6e0663a291f9cc36f355ec90_icgraph">
<area shape="rect" title=" " alt="" coords="656,5,848,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a7b50a26e6b152bbcdaf05d9733016430" title=" " alt="" coords="421,5,608,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a3513311b19a4679bf8bee7312e236312" name="a3513311b19a4679bf8bee7312e236312"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3513311b19a4679bf8bee7312e236312">&#9670;&#160;</a></span>swaptionVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> swaptionVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ccy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>termBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02603">2603</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2604</span>                                                                                         {</div>
<div class="line"><span class="lineno"> 2605</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;swaptionVolShiftData().find(ccy) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;swaptionVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2606</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; ccy &lt;&lt; <span class="stringliteral">&quot; not found in swaption vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2607</span>    SensitivityScenarioData::GenericYieldVolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;swaptionVolShiftData()[ccy];</div>
<div class="line"><span class="lineno"> 2608</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2609</span>    QL_REQUIRE(termBucket &lt; data.shiftTerms.size(), <span class="stringliteral">&quot;term bucket &quot;</span> &lt;&lt; termBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2610</span>    QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2611</span>    Size index = expiryBucket * data.shiftStrikes.size() * data.shiftTerms.size() +</div>
<div class="line"><span class="lineno"> 2612</span>                 termBucket * data.shiftStrikes.size() + strikeBucket;</div>
<div class="line"><span class="lineno"> 2613</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">RiskFactorKey::KeyType::SwaptionVolatility</a>, ccy, index);</div>
<div class="line"><span class="lineno"> 2614</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2615</span>    <span class="keywordflow">if</span> (data.shiftStrikes.size() == 0 || <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(data.shiftStrikes[strikeBucket], 0)) {</div>
<div class="line"><span class="lineno"> 2616</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftTerms[termBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2617</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2618</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftTerms[termBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line"><span class="lineno"> 2619</span>          &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2620</span>    }</div>
<div class="line"><span class="lineno"> 2621</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2622</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2623</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2624</span> </div>
<div class="line"><span class="lineno"> 2625</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2626</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2627</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2628</span>    }</div>
<div class="line"><span class="lineno"> 2629</span> </div>
<div class="line"><span class="lineno"> 2630</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2631</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">ore::analytics::RiskFactorKey::KeyType::SwaptionVolatility</a></div><div class="ttdeci">@ SwaptionVolatility</div></div>
</div><!-- fragment --><div id="dynsection-62" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-62-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-62-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-62-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,213,31"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="261,5,364,31"/>
</map>
</div>
<div id="dynsection-63" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-63-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-63-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-63-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a3513311b19a4679bf8bee7312e236312_icgraph">
<area shape="rect" title=" " alt="" coords="943,31,1151,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014" title=" " alt="" coords="672,31,895,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e" title=" " alt="" coords="421,5,624,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6" title=" " alt="" coords="433,55,612,80"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,31,373,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,31,195,56"/>
</map>
</div>

</div>
</div>
<a id="adf4695dabbff06995b81dc873adbf6bd" name="adf4695dabbff06995b81dc873adbf6bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4695dabbff06995b81dc873adbf6bd">&#9670;&#160;</a></span>yieldVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> yieldVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>securityId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>termBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02634">2634</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2635</span>                                                                   {</div>
<div class="line"><span class="lineno"> 2636</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldVolShiftData().find(securityId) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2637</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; securityId &lt;&lt; <span class="stringliteral">&quot; not found in yield vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2638</span>    SensitivityScenarioData::GenericYieldVolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yieldVolShiftData()[securityId];</div>
<div class="line"><span class="lineno"> 2639</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2640</span>    QL_REQUIRE(termBucket &lt; data.shiftTerms.size(), <span class="stringliteral">&quot;term bucket &quot;</span> &lt;&lt; termBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2641</span>    Size index =</div>
<div class="line"><span class="lineno"> 2642</span>        expiryBucket * data.shiftStrikes.size() * data.shiftTerms.size() + termBucket * data.shiftStrikes.size();</div>
<div class="line"><span class="lineno"> 2643</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b69e07aebb6ce88afa81cdc54f1b345">RiskFactorKey::KeyType::YieldVolatility</a>, securityId, index);</div>
<div class="line"><span class="lineno"> 2644</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2645</span>    o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftTerms[termBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2646</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2647</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2648</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2649</span> </div>
<div class="line"><span class="lineno"> 2650</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2651</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2652</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2653</span>    }</div>
<div class="line"><span class="lineno"> 2654</span> </div>
<div class="line"><span class="lineno"> 2655</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2656</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca8b69e07aebb6ce88afa81cdc54f1b345"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b69e07aebb6ce88afa81cdc54f1b345">ore::analytics::RiskFactorKey::KeyType::YieldVolatility</a></div><div class="ttdeci">@ YieldVolatility</div></div>
</div><!-- fragment --><div id="dynsection-64" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-64-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-64-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-64-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_adf4695dabbff06995b81dc873adbf6bd_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_adf4695dabbff06995b81dc873adbf6bd_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_adf4695dabbff06995b81dc873adbf6bd_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_adf4695dabbff06995b81dc873adbf6bd_icgraph">
<area shape="rect" title=" " alt="" coords="943,31,1127,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa15d0f2e93f0677d51e215ed114e4014" title=" " alt="" coords="672,31,895,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2f0155590944e309a2706b53ee0b963e" title=" " alt="" coords="421,5,624,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a9945e729ab6796e7d826f5d1b2fac3c6" title=" " alt="" coords="433,55,612,80"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,31,373,56"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,31,195,56"/>
</map>
</div>

</div>
</div>
<a id="a9363e3e8d8df9640bbeab55c93fffa9d" name="a9363e3e8d8df9640bbeab55c93fffa9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9363e3e8d8df9640bbeab55c93fffa9d">&#9670;&#160;</a></span>capFloorVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> capFloorVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ccy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>isAtm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02659">2659</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2660</span>                                                                         {</div>
<div class="line"><span class="lineno"> 2661</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;capFloorVolShiftData().find(ccy) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;capFloorVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2662</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; ccy &lt;&lt; <span class="stringliteral">&quot; not found in cap/floor vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2663</span>    SensitivityScenarioData::CapFloorVolShiftData data = *<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;capFloorVolShiftData()[ccy];</div>
<div class="line"><span class="lineno"> 2664</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2665</span>    QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2666</span>    Size index = expiryBucket * data.shiftStrikes.size() + strikeBucket;</div>
<div class="line"><span class="lineno"> 2667</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab">RiskFactorKey::KeyType::OptionletVolatility</a>, ccy, index);</div>
<div class="line"><span class="lineno"> 2668</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2669</span>    o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><span class="lineno"> 2670</span>    <span class="keywordflow">if</span> (isAtm) {</div>
<div class="line"><span class="lineno"> 2671</span>        o &lt;&lt; <span class="stringliteral">&quot;ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2672</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2673</span>        o &lt;&lt; std::setprecision(4) &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2674</span>    }</div>
<div class="line"><span class="lineno"> 2675</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2676</span>    ScenarioDescription desc(type, key, o.str());</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2679</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2680</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2681</span>    }</div>
<div class="line"><span class="lineno"> 2682</span> </div>
<div class="line"><span class="lineno"> 2683</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2684</span>}</div>
</div><!-- fragment --><div id="dynsection-65" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-65-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-65-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-65-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a9363e3e8d8df9640bbeab55c93fffa9d_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9363e3e8d8df9640bbeab55c93fffa9d_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9363e3e8d8df9640bbeab55c93fffa9d_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a9363e3e8d8df9640bbeab55c93fffa9d_icgraph">
<area shape="rect" title=" " alt="" coords="671,5,877,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a4f67d3089b1f5d7d05f72b726bbcb847" title=" " alt="" coords="421,5,623,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a1e729008d28bc0a85fa73aac49db28ff" name="a1e729008d28bc0a85fa73aac49db28ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e729008d28bc0a85fa73aac49db28ff">&#9670;&#160;</a></span>survivalProbabilityScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> survivalProbabilityScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02687">2687</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2687</span>                                                                                                      {</div>
<div class="line"><span class="lineno"> 2688</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;creditCurveShiftData().find(name) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;creditCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 2689</span>               <span class="stringliteral">&quot;Name &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not found in credit shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2690</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;creditCurveShiftData()[name]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2691</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2692</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb">RiskFactorKey::KeyType::SurvivalProbability</a>, name, bucket);</div>
<div class="line"><span class="lineno"> 2693</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2694</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;creditCurveShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2696</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2697</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2698</span> </div>
<div class="line"><span class="lineno"> 2699</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2700</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2701</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2702</span>    }</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2705</span>}</div>
</div><!-- fragment --><div id="dynsection-66" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-66-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-66-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-66-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a1e729008d28bc0a85fa73aac49db28ff_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a1e729008d28bc0a85fa73aac49db28ff_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a1e729008d28bc0a85fa73aac49db28ff_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a1e729008d28bc0a85fa73aac49db28ff_icgraph">
<area shape="rect" title=" " alt="" coords="645,5,820,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ad33b9fbcfde02400f5807edf18326ce8" title=" " alt="" coords="421,5,597,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,13,373,38"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,13,195,38"/>
</map>
</div>

</div>
</div>
<a id="aacbfc6ab59a6c85e622ab858b4eee24c" name="aacbfc6ab59a6c85e622ab858b4eee24c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacbfc6ab59a6c85e622ab858b4eee24c">&#9670;&#160;</a></span>CdsVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> CdsVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02708">2708</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2708</span>                                                                                                                  {</div>
<div class="line"><span class="lineno"> 2709</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;cdsVolShiftData().find(name) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;cdsVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2710</span>               <span class="stringliteral">&quot;name &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not found in swaption name shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2711</span>    SensitivityScenarioData::CdsVolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;cdsVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>];</div>
<div class="line"><span class="lineno"> 2712</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2713</span>    Size index = strikeBucket * data.shiftExpiries.size() + expiryBucket;</div>
<div class="line"><span class="lineno"> 2714</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9">RiskFactorKey::KeyType::CDSVolatility</a>, name, index);</div>
<div class="line"><span class="lineno"> 2715</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2716</span>    o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span></div>
<div class="line"><span class="lineno"> 2717</span>      &lt;&lt; <span class="stringliteral">&quot;ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2718</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2719</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2720</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2721</span> </div>
<div class="line"><span class="lineno"> 2722</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2723</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2724</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2725</span>    }</div>
<div class="line"><span class="lineno"> 2726</span> </div>
<div class="line"><span class="lineno"> 2727</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2728</span>}</div>
</div><!-- fragment --><div id="dynsection-67" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-67-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-67-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-67-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_aacbfc6ab59a6c85e622ab858b4eee24c_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aacbfc6ab59a6c85e622ab858b4eee24c_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aacbfc6ab59a6c85e622ab858b4eee24c_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_aacbfc6ab59a6c85e622ab858b4eee24c_icgraph">
<area shape="rect" title=" " alt="" coords="641,5,821,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aad9b9dbc48ccb62b71c9bcf0bc1f5db8" title=" " alt="" coords="421,5,593,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a840da6725f71e6ae7db519d84cb3d275" name="a840da6725f71e6ae7db519d84cb3d275"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840da6725f71e6ae7db519d84cb3d275">&#9670;&#160;</a></span>zeroInflationScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> zeroInflationScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02731">2731</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2731</span>                                                                                                 {</div>
<div class="line"><span class="lineno"> 2732</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCurveShiftData().find(index) !=</div>
<div class="line"><span class="lineno"> 2733</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 2734</span>               <span class="stringliteral">&quot;inflation index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; not found in zero inflation index shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2735</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;zeroInflationCurveShiftData()[index]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2736</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2737</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023">RiskFactorKey::KeyType::ZeroInflationCurve</a>, index, bucket);</div>
<div class="line"><span class="lineno"> 2738</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2739</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCurveShiftData()[index]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2740</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2741</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2742</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2743</span> </div>
<div class="line"><span class="lineno"> 2744</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2745</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2746</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2747</span>    }</div>
<div class="line"><span class="lineno"> 2748</span> </div>
<div class="line"><span class="lineno"> 2749</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2750</span>}</div>
</div><!-- fragment --><div id="dynsection-68" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-68-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-68-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-68-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a840da6725f71e6ae7db519d84cb3d275_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a840da6725f71e6ae7db519d84cb3d275_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a840da6725f71e6ae7db519d84cb3d275_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a840da6725f71e6ae7db519d84cb3d275_icgraph">
<area shape="rect" title=" " alt="" coords="668,5,875,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a3ac8a9ece30efe88a9131963f851d176" title=" " alt="" coords="421,5,620,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="ad9aa2a7ef0eb4646aa00597b6bb71bc4" name="ad9aa2a7ef0eb4646aa00597b6bb71bc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9aa2a7ef0eb4646aa00597b6bb71bc4">&#9670;&#160;</a></span>yoyInflationScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> yoyInflationScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02753">2753</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2753</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 2754</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData().find(index) !=</div>
<div class="line"><span class="lineno"> 2755</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData().end(),</div>
<div class="line"><span class="lineno"> 2756</span>               <span class="stringliteral">&quot;yoy inflation index &quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot; not found in zero inflation index shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2757</span>    QL_REQUIRE(bucket &lt; sensitivityData_-&gt;yoyInflationCurveShiftData()[index]-&gt;shiftTenors.size(),</div>
<div class="line"><span class="lineno"> 2758</span>               <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2759</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401">RiskFactorKey::KeyType::YoYInflationCurve</a>, index, bucket);</div>
<div class="line"><span class="lineno"> 2760</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2761</span>    o &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCurveShiftData()[index]-&gt;shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2762</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2763</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2764</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2765</span> </div>
<div class="line"><span class="lineno"> 2766</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2767</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2768</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2769</span>    }</div>
<div class="line"><span class="lineno"> 2770</span> </div>
<div class="line"><span class="lineno"> 2771</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2772</span>}</div>
</div><!-- fragment --><div id="dynsection-69" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-69-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-69-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-69-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_ad9aa2a7ef0eb4646aa00597b6bb71bc4_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad9aa2a7ef0eb4646aa00597b6bb71bc4_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad9aa2a7ef0eb4646aa00597b6bb71bc4_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_ad9aa2a7ef0eb4646aa00597b6bb71bc4_icgraph">
<area shape="rect" title=" " alt="" coords="668,5,871,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2cb7749581f38e7c3e5eae03657d6d33" title=" " alt="" coords="421,5,620,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a87cb703bf265164cef649e6d455772a0" name="a87cb703bf265164cef649e6d455772a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87cb703bf265164cef649e6d455772a0">&#9670;&#160;</a></span>zeroInflationCapFloorVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> zeroInflationCapFloorVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02801">2801</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2802</span>                                                                                                      {</div>
<div class="line"><span class="lineno"> 2803</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCapFloorVolShiftData().find(name) !=</div>
<div class="line"><span class="lineno"> 2804</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCapFloorVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2805</span>               <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not found in zero inflation cap/floor vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2806</span>    SensitivityScenarioData::VolShiftData data = *<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;zeroInflationCapFloorVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>];</div>
<div class="line"><span class="lineno"> 2807</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2808</span>    QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2809</span>    Size index = expiryBucket * data.shiftStrikes.size() + strikeBucket;</div>
<div class="line"><span class="lineno"> 2810</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2">RiskFactorKey::KeyType::ZeroInflationCapFloorVolatility</a>, name, index);</div>
<div class="line"><span class="lineno"> 2811</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2812</span>    <span class="keywordflow">if</span> (data.shiftStrikes.size() == 0 || <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(data.shiftStrikes[strikeBucket], 0)) {</div>
<div class="line"><span class="lineno"> 2813</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2814</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2815</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; std::setprecision(4) &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2816</span>    }</div>
<div class="line"><span class="lineno"> 2817</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2818</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2819</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2820</span> </div>
<div class="line"><span class="lineno"> 2821</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2822</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2823</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2824</span>    }</div>
<div class="line"><span class="lineno"> 2825</span> </div>
<div class="line"><span class="lineno"> 2826</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2827</span>}</div>
</div><!-- fragment --><div id="dynsection-70" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-70-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-70-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-70-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,168,45"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="216,13,319,38"/>
</map>
</div>
<div id="dynsection-71" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-71-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-71-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-71-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a87cb703bf265164cef649e6d455772a0_icgraph">
<area shape="rect" title=" " alt="" coords="633,5,796,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a2ff246db7c4c67d5d2735e10b9c5d760" title=" " alt="" coords="421,5,585,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,13,373,38"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,13,195,38"/>
</map>
</div>

</div>
</div>
<a id="a52659907f53c9543366619e3154411d4" name="a52659907f53c9543366619e3154411d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52659907f53c9543366619e3154411d4">&#9670;&#160;</a></span>yoyInflationCapFloorVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> yoyInflationCapFloorVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02775">2775</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2776</span>                                                                                                     {</div>
<div class="line"><span class="lineno"> 2777</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCapFloorVolShiftData().find(name) !=</div>
<div class="line"><span class="lineno"> 2778</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCapFloorVolShiftData().end(),</div>
<div class="line"><span class="lineno"> 2779</span>               <span class="stringliteral">&quot;index &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not found in yoy cap/floor vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2780</span>    SensitivityScenarioData::CapFloorVolShiftData data = *<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;yoyInflationCapFloorVolShiftData()[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>];</div>
<div class="line"><span class="lineno"> 2781</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2782</span>    QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2783</span>    Size index = expiryBucket * data.shiftStrikes.size() + strikeBucket;</div>
<div class="line"><span class="lineno"> 2784</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00">RiskFactorKey::KeyType::YoYInflationCapFloorVolatility</a>, name, index);</div>
<div class="line"><span class="lineno"> 2785</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2786</span>    <span class="comment">// Currently CapFloorVolShiftData must have a collection of absolute strikes for yoy inflation cap/floor vols</span></div>
<div class="line"><span class="lineno"> 2787</span>    o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; std::setprecision(4) &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2788</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2789</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2790</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2791</span> </div>
<div class="line"><span class="lineno"> 2792</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2793</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2794</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2795</span>    }</div>
<div class="line"><span class="lineno"> 2796</span> </div>
<div class="line"><span class="lineno"> 2797</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2798</span>}</div>
</div><!-- fragment --><div id="dynsection-72" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-72-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-72-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-72-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a52659907f53c9543366619e3154411d4_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a52659907f53c9543366619e3154411d4_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a52659907f53c9543366619e3154411d4_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a52659907f53c9543366619e3154411d4_icgraph">
<area shape="rect" title=" " alt="" coords="663,5,872,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a16e5241dfb0b21ac043e2e32a22374f6" title=" " alt="" coords="421,5,615,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,13,373,38"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,13,195,38"/>
</map>
</div>

</div>
</div>
<a id="a6ad7ae91ef2d71d973dce2f1fd66d56c" name="a6ad7ae91ef2d71d973dce2f1fd66d56c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ad7ae91ef2d71d973dce2f1fd66d56c">&#9670;&#160;</a></span>baseCorrelationScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> baseCorrelationScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>indexName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>lossLevelBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>termBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02830">2830</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2831</span>                                                                                           {</div>
<div class="line"><span class="lineno"> 2832</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;baseCorrelationShiftData().find(indexName) !=</div>
<div class="line"><span class="lineno"> 2833</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;baseCorrelationShiftData().end(),</div>
<div class="line"><span class="lineno"> 2834</span>               <span class="stringliteral">&quot;name &quot;</span> &lt;&lt; indexName &lt;&lt; <span class="stringliteral">&quot; not found in base correlation shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2835</span>    SensitivityScenarioData::BaseCorrelationShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;baseCorrelationShiftData()[indexName];</div>
<div class="line"><span class="lineno"> 2836</span>    QL_REQUIRE(termBucket &lt; data.shiftTerms.size(), <span class="stringliteral">&quot;term bucket &quot;</span> &lt;&lt; termBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2837</span>    QL_REQUIRE(lossLevelBucket &lt; data.shiftLossLevels.size(),</div>
<div class="line"><span class="lineno"> 2838</span>               <span class="stringliteral">&quot;loss level bucket &quot;</span> &lt;&lt; lossLevelBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2839</span>    Size index = lossLevelBucket * data.shiftTerms.size() + termBucket;</div>
<div class="line"><span class="lineno"> 2840</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba">RiskFactorKey::KeyType::BaseCorrelation</a>, indexName, index);</div>
<div class="line"><span class="lineno"> 2841</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2842</span>    o &lt;&lt; data.shiftLossLevels[lossLevelBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftTerms[termBucket];</div>
<div class="line"><span class="lineno"> 2843</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2844</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2845</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2846</span> </div>
<div class="line"><span class="lineno"> 2847</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2848</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2849</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2850</span>    }</div>
<div class="line"><span class="lineno"> 2851</span> </div>
<div class="line"><span class="lineno"> 2852</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2853</span>}</div>
</div><!-- fragment --><div id="dynsection-73" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-73-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-73-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-73-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a6ad7ae91ef2d71d973dce2f1fd66d56c_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6ad7ae91ef2d71d973dce2f1fd66d56c_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6ad7ae91ef2d71d973dce2f1fd66d56c_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a6ad7ae91ef2d71d973dce2f1fd66d56c_icgraph">
<area shape="rect" title=" " alt="" coords="692,5,920,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a8d59ef3dc24cdb6a4306230119a9185b" title=" " alt="" coords="421,5,644,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a36c90a4563e88cf2b66058371685c7b6" name="a36c90a4563e88cf2b66058371685c7b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c90a4563e88cf2b66058371685c7b6">&#9670;&#160;</a></span>commodityCurveScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> commodityCurveScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>commodityName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Size&#160;</td>
          <td class="paramname"><em>bucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02856">2856</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2856</span>                                                                                                                 {</div>
<div class="line"><span class="lineno"> 2857</span> </div>
<div class="line"><span class="lineno"> 2858</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityCurveShiftData().count(commodityName) &gt; 0,</div>
<div class="line"><span class="lineno"> 2859</span>               <span class="stringliteral">&quot;Name &quot;</span> &lt;&lt; commodityName &lt;&lt; <span class="stringliteral">&quot; not found in commodity curve shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2860</span>    vector&lt;Period&gt;&amp; shiftTenors = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityCurveShiftData()[commodityName]-&gt;shiftTenors;</div>
<div class="line"><span class="lineno"> 2861</span>    QL_REQUIRE(bucket &lt; shiftTenors.size(), <span class="stringliteral">&quot;bucket &quot;</span> &lt;&lt; bucket &lt;&lt; <span class="stringliteral">&quot; out of commodity curve bucket range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2862</span> </div>
<div class="line"><span class="lineno"> 2863</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88">RiskFactorKey::KeyType::CommodityCurve</a>, commodityName, bucket);</div>
<div class="line"><span class="lineno"> 2864</span>    ostringstream oss;</div>
<div class="line"><span class="lineno"> 2865</span>    oss &lt;&lt; shiftTenors[bucket];</div>
<div class="line"><span class="lineno"> 2866</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2867</span> </div>
<div class="line"><span class="lineno"> 2868</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2869</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2870</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2871</span>    }</div>
<div class="line"><span class="lineno"> 2872</span> </div>
<div class="line"><span class="lineno"> 2873</span>    <span class="keywordflow">return</span> ScenarioDescription(type, key, oss.str());</div>
<div class="line"><span class="lineno"> 2874</span>}</div>
</div><!-- fragment --><div id="dynsection-74" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-74-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-74-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-74-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a36c90a4563e88cf2b66058371685c7b6_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a36c90a4563e88cf2b66058371685c7b6_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a36c90a4563e88cf2b66058371685c7b6_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a36c90a4563e88cf2b66058371685c7b6_icgraph">
<area shape="rect" title=" " alt="" coords="697,5,932,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5909315dd0dd00c38ebb9401f016381c" title=" " alt="" coords="421,5,649,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a03fe6e79109200285178c3e85cc98acd" name="a03fe6e79109200285178c3e85cc98acd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03fe6e79109200285178c3e85cc98acd">&#9670;&#160;</a></span>commodityVolScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> commodityVolScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>commodityName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02877">2877</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2878</span>                                                                                          {</div>
<div class="line"><span class="lineno"> 2879</span> </div>
<div class="line"><span class="lineno"> 2880</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityVolShiftData().count(commodityName) &gt; 0,</div>
<div class="line"><span class="lineno"> 2881</span>               <span class="stringliteral">&quot;commodity &quot;</span> &lt;&lt; commodityName &lt;&lt; <span class="stringliteral">&quot; not found in commodity vol shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2882</span> </div>
<div class="line"><span class="lineno"> 2883</span>    SensitivityScenarioData::VolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;commodityVolShiftData()[commodityName];</div>
<div class="line"><span class="lineno"> 2884</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2885</span>    Size index = strikeBucket * data.shiftExpiries.size() + expiryBucket;</div>
<div class="line"><span class="lineno"> 2886</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807">RiskFactorKey::KeyType::CommodityVolatility</a>, commodityName, index);</div>
<div class="line"><span class="lineno"> 2887</span>    ostringstream o;</div>
<div class="line"><span class="lineno"> 2888</span>    <span class="keywordflow">if</span> (data.shiftStrikes.size() == 0 || <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(data.shiftStrikes[strikeBucket], 1.0)) {</div>
<div class="line"><span class="lineno"> 2889</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2890</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2891</span>        QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2892</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2893</span>    }</div>
<div class="line"><span class="lineno"> 2894</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2895</span> </div>
<div class="line"><span class="lineno"> 2896</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2897</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2898</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2899</span>    }</div>
<div class="line"><span class="lineno"> 2900</span> </div>
<div class="line"><span class="lineno"> 2901</span>    <span class="keywordflow">return</span> ScenarioDescription(type, key, o.str());</div>
<div class="line"><span class="lineno"> 2902</span>}</div>
</div><!-- fragment --><div id="dynsection-75" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-75-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-75-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-75-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,227,31"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="275,5,377,31"/>
</map>
</div>
<div id="dynsection-76" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-76-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-76-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-76-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a03fe6e79109200285178c3e85cc98acd_icgraph">
<area shape="rect" title=" " alt="" coords="684,5,905,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#ae8c23507e58896ff857af151365a6015" title=" " alt="" coords="421,5,636,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a5894bae3460d65e021318164a4f480d6" name="a5894bae3460d65e021318164a4f480d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5894bae3460d65e021318164a4f480d6">&#9670;&#160;</a></span>securitySpreadScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> securitySpreadScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>bond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02934">2934</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2934</span>                                                                                    {</div>
<div class="line"><span class="lineno"> 2935</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23">RiskFactorKey::KeyType::SecuritySpread</a>, bond);</div>
<div class="line"><span class="lineno"> 2936</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2937</span>    ScenarioDescription desc(type, key, <span class="stringliteral">&quot;spread&quot;</span>);</div>
<div class="line"><span class="lineno"> 2938</span> </div>
<div class="line"><span class="lineno"> 2939</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2940</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2941</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2942</span>    }</div>
<div class="line"><span class="lineno"> 2943</span> </div>
<div class="line"><span class="lineno"> 2944</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2945</span>}</div>
</div><!-- fragment --><div id="dynsection-77" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-77-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-77-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-77-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a5894bae3460d65e021318164a4f480d6_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5894bae3460d65e021318164a4f480d6_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5894bae3460d65e021318164a4f480d6_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a5894bae3460d65e021318164a4f480d6_icgraph">
<area shape="rect" title=" " alt="" coords="688,5,913,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aaf3e88184ad3e14d3a3f60fd7300fcfd" title=" " alt="" coords="421,5,640,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<a id="a05852fc1e9a1d15cbe24af1003430ea3" name="a05852fc1e9a1d15cbe24af1003430ea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05852fc1e9a1d15cbe24af1003430ea3">&#9670;&#160;</a></span>correlationScenarioDescription()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_shift_scenario_generator_1_1_scenario_description.html">SensitivityScenarioGenerator::ScenarioDescription</a> correlationScenarioDescription </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>pair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>expiryBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>strikeBucket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>up</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8cpp_source.html#l02905">2905</a> of file <a class="el" href="sensitivityscenariogenerator_8cpp_source.html">sensitivityscenariogenerator.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2906</span>                                                                      {</div>
<div class="line"><span class="lineno"> 2907</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;correlationShiftData().find(pair) != <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;correlationShiftData().end(),</div>
<div class="line"><span class="lineno"> 2908</span>               <span class="stringliteral">&quot;pair &quot;</span> &lt;&lt; pair &lt;&lt; <span class="stringliteral">&quot; not found in correlation shift data&quot;</span>);</div>
<div class="line"><span class="lineno"> 2909</span>    SensitivityScenarioData::VolShiftData data = <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a28bf093d350571841a46bfd01c2ed79b">sensitivityData_</a>-&gt;correlationShiftData()[pair];</div>
<div class="line"><span class="lineno"> 2910</span>    QL_REQUIRE(expiryBucket &lt; data.shiftExpiries.size(), <span class="stringliteral">&quot;expiry bucket &quot;</span> &lt;&lt; expiryBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2911</span>    QL_REQUIRE(strikeBucket &lt; data.shiftStrikes.size(), <span class="stringliteral">&quot;strike bucket &quot;</span> &lt;&lt; strikeBucket &lt;&lt; <span class="stringliteral">&quot; out of range&quot;</span>);</div>
<div class="line"><span class="lineno"> 2912</span>    <span class="comment">// Size index = strikeBucket * data.shiftExpiries.size() + expiryBucket;</span></div>
<div class="line"><span class="lineno"> 2913</span>    Size index = expiryBucket * data.shiftStrikes.size() + strikeBucket;</div>
<div class="line"><span class="lineno"> 2914</span>    RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">RiskFactorKey::KeyType::Correlation</a>, pair, index);</div>
<div class="line"><span class="lineno"> 2915</span>    std::ostringstream o;</div>
<div class="line"><span class="lineno"> 2916</span>    <span class="keywordflow">if</span> (data.shiftStrikes.size() == 0 || <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(data.shiftStrikes[strikeBucket], 0)) {</div>
<div class="line"><span class="lineno"> 2917</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/ATM&quot;</span>;</div>
<div class="line"><span class="lineno"> 2918</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2919</span>        o &lt;&lt; data.shiftExpiries[expiryBucket] &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; std::setprecision(4) &lt;&lt; data.shiftStrikes[strikeBucket];</div>
<div class="line"><span class="lineno"> 2920</span>    }</div>
<div class="line"><span class="lineno"> 2921</span>    <span class="keywordtype">string</span> text = o.str();</div>
<div class="line"><span class="lineno"> 2922</span>    ScenarioDescription::Type type = up ? ScenarioDescription::Type::Up : ScenarioDescription::Type::Down;</div>
<div class="line"><span class="lineno"> 2923</span>    ScenarioDescription desc(type, key, text);</div>
<div class="line"><span class="lineno"> 2924</span> </div>
<div class="line"><span class="lineno"> 2925</span>    <span class="keywordflow">if</span> (up) {</div>
<div class="line"><span class="lineno"> 2926</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a5b3e16a7e9154afd40dc67d7c1109f60">shiftSizes_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2927</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a59e36c7dd5c6dff3b7bcfeac0e350ff5">baseValues_</a>[key] = 0.0;</div>
<div class="line"><span class="lineno"> 2928</span>    }</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span>    <span class="keywordflow">return</span> desc;</div>
<div class="line"><span class="lineno"> 2931</span>}</div>
</div><!-- fragment --><div id="dynsection-78" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-78-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-78-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-78-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_cgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,204,31"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="252,5,355,31"/>
</map>
</div>
<div id="dynsection-79" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-79-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-79-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-79-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_icgraph" id="aclassore_1_1analytics_1_1_sensitivity_scenario_generator_a05852fc1e9a1d15cbe24af1003430ea3_icgraph">
<area shape="rect" title=" " alt="" coords="661,5,860,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#af7514f26c1f3e6e7803bcdb96d81ec6f" title=" " alt="" coords="421,5,613,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#aa62ece5f85b43378ea6ad94a43f74ee4" title=" " alt="" coords="243,5,373,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html#a886fe943969c051d641d90510b1665dd" title="Constructor." alt="" coords="5,5,195,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a28bf093d350571841a46bfd01c2ed79b" name="a28bf093d350571841a46bfd01c2ed79b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28bf093d350571841a46bfd01c2ed79b">&#9670;&#160;</a></span>sensitivityData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_data.html">SensitivityScenarioData</a>&gt; sensitivityData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00190">190</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
<a id="adf24308523669dc57ad15492c900a27c" name="adf24308523669dc57ad15492c900a27c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf24308523669dc57ad15492c900a27c">&#9670;&#160;</a></span>sensiScenarioFactory_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario_factory.html">ScenarioFactory</a>&gt; sensiScenarioFactory_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00191">191</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
<a id="abc775bc68d5c2a673f8a454972be6387" name="abc775bc68d5c2a673f8a454972be6387"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc775bc68d5c2a673f8a454972be6387">&#9670;&#160;</a></span>overrideTenors_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classbool.html">bool</a> overrideTenors_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00192">192</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
<a id="a3dd077c2c46a5babc0511ba2648e2321" name="a3dd077c2c46a5babc0511ba2648e2321"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dd077c2c46a5babc0511ba2648e2321">&#9670;&#160;</a></span>continueOnError_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classbool.html">bool</a> continueOnError_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00192">192</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
<a id="a5b3e16a7e9154afd40dc67d7c1109f60" name="a5b3e16a7e9154afd40dc67d7c1109f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b3e16a7e9154afd40dc67d7c1109f60">&#9670;&#160;</a></span>shiftSizes_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real&gt; shiftSizes_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the shift sizes for each risk factor key. </p>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00195">195</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
<a id="a59e36c7dd5c6dff3b7bcfeac0e350ff5" name="a59e36c7dd5c6dff3b7bcfeac0e350ff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e36c7dd5c6dff3b7bcfeac0e350ff5">&#9670;&#160;</a></span>baseValues_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::Real&gt; baseValues_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Holds the base valuesfor each risk factor key. </p>

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00197">197</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
<a id="a4b4544f478033671c1fd68173f115187" name="a4b4544f478033671c1fd68173f115187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b4544f478033671c1fd68173f115187">&#9670;&#160;</a></span>baseScenarioAbsolute_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a>&gt; baseScenarioAbsolute_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="sensitivityscenariogenerator_8hpp_source.html#l00199">199</a> of file <a class="el" href="sensitivityscenariogenerator_8hpp_source.html">sensitivityscenariogenerator.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
