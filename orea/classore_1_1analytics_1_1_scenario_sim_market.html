<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>OREAnalytics: ScenarioSimMarket Class Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="oreaextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-analytics@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.12</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceore.html">ore</a></li><li class="navelem"><a class="el" href="namespaceore_1_1analytics.html">analytics</a></li><li class="navelem"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classore_1_1analytics_1_1_scenario_sim_market-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ScenarioSimMarket Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Simulation Market updated with discrete scenarios.  
 <a href="classore_1_1analytics_1_1_scenario_sim_market.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="scenariosimmarket_8hpp_source.html">orea/scenario/scenariosimmarket.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for ScenarioSimMarket:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market__inherit__graph.png" border="0" usemap="#a_scenario_sim_market_inherit__map" alt="Inheritance graph"/></div>
<map name="a_scenario_sim_market_inherit__map" id="a_scenario_sim_market_inherit__map">
<area shape="rect" title="Simulation Market updated with discrete scenarios." alt="" coords="5,1736,212,2451"/>
<area shape="rect" href="classore_1_1analytics_1_1_sim_market.html" title="Simulation Market." alt="" coords="43,1457,175,1688"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html" title=" " alt="" coords="11,577,207,1409"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market.html" title=" " alt="" coords="17,5,201,529"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for ScenarioSimMarket:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market__coll__graph.png" border="0" usemap="#a_scenario_sim_market_coll__map" alt="Collaboration graph"/></div>
<map name="a_scenario_sim_market_coll__map" id="a_scenario_sim_market_coll__map">
<area shape="rect" title="Simulation Market updated with discrete scenarios." alt="" coords="1824,1809,2031,2216"/>
<area shape="rect" href="classore_1_1analytics_1_1_sim_market.html" title="Simulation Market." alt="" coords="1542,1450,1674,1651"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html" title=" " alt="" coords="3583,929,3747,1321"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market.html" title=" " alt="" coords="3467,401,3650,808"/>
<area shape="rect" title=" " alt="" coords="3276,108,3334,148"/>
<area shape="rect" title=" " alt="" coords="3219,247,3362,302"/>
<area shape="rect" title=" " alt="" coords="3386,247,3578,302"/>
<area shape="rect" title=" " alt="" coords="3603,247,3772,302"/>
<area shape="rect" target="_parent" href="../ored/structore_1_1data_1_1_ibor_fallback_config_1_1_fallback_data.html" title=" " alt="" coords="1263,585,1366,625"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="573,255,624,295"/>
<area shape="rect" title=" " alt="" coords="207,585,315,625"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html" title=" " alt="" coords="694,1428,916,1673"/>
<area shape="rect" title=" " alt="" coords="3580,108,3705,148"/>
<area shape="rect" title=" " alt="" coords="2668,108,2766,148"/>
<area shape="rect" title=" " alt="" coords="4070,240,4249,309"/>
<area shape="rect" title=" " alt="" coords="1015,1516,1243,1585"/>
<area shape="rect" title=" " alt="" coords="1354,1523,1517,1578"/>
<area shape="rect" title=" " alt="" coords="1035,1091,1204,1160"/>
<area shape="rect" title=" " alt="" coords="4928,5,4967,45"/>
<area shape="rect" title=" " alt="" coords="3873,1105,3950,1145"/>
<area shape="rect" title=" " alt="" coords="1071,5,1110,45"/>
<area shape="rect" title=" " alt="" coords="358,255,449,295"/>
<area shape="rect" title=" " alt="" coords="3729,108,3953,148"/>
<area shape="rect" title=" " alt="" coords="3978,108,4179,148"/>
<area shape="rect" title=" " alt="" coords="4203,108,4346,148"/>
<area shape="rect" title=" " alt="" coords="4370,108,4568,148"/>
<area shape="rect" title=" " alt="" coords="2502,255,2556,295"/>
<area shape="rect" title=" " alt="" coords="6215,577,6366,632"/>
<area shape="rect" title=" " alt="" coords="6390,570,6620,639"/>
<area shape="rect" title=" " alt="" coords="6644,577,6851,632"/>
<area shape="rect" title=" " alt="" coords="6875,577,7092,632"/>
<area shape="rect" title=" " alt="" coords="1670,570,1881,639"/>
<area shape="rect" title=" " alt="" coords="1905,570,2052,639"/>
<area shape="rect" title=" " alt="" coords="2076,570,2259,639"/>
<area shape="rect" title=" " alt="" coords="2283,570,2468,639"/>
<area shape="rect" title=" " alt="" coords="2492,570,2678,639"/>
<area shape="rect" title=" " alt="" coords="2702,570,2930,639"/>
<area shape="rect" title=" " alt="" coords="2954,577,3144,632"/>
<area shape="rect" title=" " alt="" coords="3168,570,3351,639"/>
<area shape="rect" title=" " alt="" coords="3674,570,3869,639"/>
<area shape="rect" title=" " alt="" coords="3894,570,4100,639"/>
<area shape="rect" title=" " alt="" coords="4124,570,4323,639"/>
<area shape="rect" title=" " alt="" coords="4347,570,4546,639"/>
<area shape="rect" title=" " alt="" coords="4570,570,4771,639"/>
<area shape="rect" title=" " alt="" coords="4795,570,4980,639"/>
<area shape="rect" title=" " alt="" coords="5004,570,5270,639"/>
<area shape="rect" title=" " alt="" coords="5294,563,5505,647"/>
<area shape="rect" title=" " alt="" coords="5529,563,5724,647"/>
<area shape="rect" title=" " alt="" coords="5748,570,5992,639"/>
<area shape="rect" title=" " alt="" coords="6016,570,6191,639"/>
<area shape="rect" title=" " alt="" coords="1574,255,1626,295"/>
<area shape="rect" title=" " alt="" coords="1180,585,1238,625"/>
<area shape="rect" href="classore_1_1analytics_1_1_risk_factor_key.html" title="Data types stored in the scenario class." alt="" coords="1368,1083,1503,1167"/>
<area shape="rect" title=" " alt="" coords="1126,255,1273,295"/>
<area shape="rect" title=" " alt="" coords="2232,1523,2455,1578"/>
<area shape="rect" title=" " alt="" coords="2479,1523,2656,1578"/>
<area shape="rect" title=" " alt="" coords="2681,1523,2870,1578"/>
<area shape="rect" title=" " alt="" coords="2895,1523,3072,1578"/>
<area shape="rect" title=" " alt="" coords="3096,1523,3274,1578"/>
<area shape="rect" title=" " alt="" coords="1698,1523,1832,1578"/>
<area shape="rect" title=" " alt="" coords="1390,585,1468,625"/>
<area shape="rect" title=" " alt="" coords="1492,585,1544,625"/>
<area shape="rect" title=" " alt="" coords="441,1105,628,1145"/>
<area shape="rect" title=" " alt="" coords="433,1523,636,1578"/>
<area shape="rect" title=" " alt="" coords="3298,1523,3475,1578"/>
<area shape="rect" title=" " alt="" coords="3513,1531,3574,1571"/>
<area shape="rect" title=" " alt="" coords="1856,1523,1999,1578"/>
<area shape="rect" title=" " alt="" coords="3772,1105,3849,1145"/>
<area shape="rect" title=" " alt="" coords="2023,1509,2208,1593"/>
<area shape="rect" title=" " alt="" coords="3995,1083,4154,1167"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_x_m_l_serializable.html" title=" " alt="" coords="703,1054,851,1197"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a96f64187600d595cafbd67f1230a39f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a96f64187600d595cafbd67f1230a39f0">ScenarioSimMarket</a> (const <a class="el" href="classbool.html">bool</a> <a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>)</td></tr>
<tr class="memdesc:a96f64187600d595cafbd67f1230a39f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a96f64187600d595cafbd67f1230a39f0">More...</a><br /></td></tr>
<tr class="separator:a96f64187600d595cafbd67f1230a39f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa1871a4d657d10b08c3c64d35f736ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#afa1871a4d657d10b08c3c64d35f736ec">ScenarioSimMarket</a> (const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">Market</a> &gt; &amp;initMarket, const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;parameters, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, const <a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a> &amp;<a class="elRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>=<a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a>(), const <a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a> &amp;todaysMarketParams=<a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a>(), const <a class="el" href="classbool.html">bool</a> continueOnError=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ae015beb42bffe5d7d3aea905a45bd673">useSpreadedTermStructures</a>=false, const <a class="el" href="classbool.html">bool</a> cacheSimData=false, const <a class="el" href="classbool.html">bool</a> allowPartialScenarios=false, const <a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a> &amp;iborFallbackConfig=<a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ae1cac12f251897f232fda19ee46c06de">IborFallbackConfig::defaultConfig</a>(), const <a class="el" href="classbool.html">bool</a> <a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>=true, const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;offSetScenario=nullptr)</td></tr>
<tr class="separator:afa1871a4d657d10b08c3c64d35f736ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb38a0edc39d7edcb571010c80ca002"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a9fb38a0edc39d7edcb571010c80ca002">ScenarioSimMarket</a> (const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">Market</a> &gt; &amp;initMarket, const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;parameters, const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a> &gt; &amp;<a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab44a4a6e17e2c28d464cf9ed93fd53a6">fixingManager</a>, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, const <a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a> &amp;<a class="elRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>=<a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a>(), const <a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a> &amp;todaysMarketParams=<a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a>(), const <a class="el" href="classbool.html">bool</a> continueOnError=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ae015beb42bffe5d7d3aea905a45bd673">useSpreadedTermStructures</a>=false, const <a class="el" href="classbool.html">bool</a> cacheSimData=false, const <a class="el" href="classbool.html">bool</a> allowPartialScenarios=false, const <a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a> &amp;iborFallbackConfig=<a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ae1cac12f251897f232fda19ee46c06de">IborFallbackConfig::defaultConfig</a>(), const <a class="el" href="classbool.html">bool</a> <a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>=true, const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;offSetScenario=nullptr)</td></tr>
<tr class="separator:a9fb38a0edc39d7edcb571010c80ca002"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2881469fc28e18615c2c6d731c9f031e"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2881469fc28e18615c2c6d731c9f031e">scenarioGenerator</a> ()</td></tr>
<tr class="memdesc:a2881469fc28e18615c2c6d731c9f031e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set scenario generator.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a2881469fc28e18615c2c6d731c9f031e">More...</a><br /></td></tr>
<tr class="separator:a2881469fc28e18615c2c6d731c9f031e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5365731cf5a2d101a1339733217207a1"><td class="memItemLeft" align="right" valign="top">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5365731cf5a2d101a1339733217207a1">scenarioGenerator</a> () const</td></tr>
<tr class="memdesc:a5365731cf5a2d101a1339733217207a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get scenario generator.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a5365731cf5a2d101a1339733217207a1">More...</a><br /></td></tr>
<tr class="separator:a5365731cf5a2d101a1339733217207a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94902666c868cdbafb65b73fb7f5f2a2"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_aggregation_scenario_data.html">AggregationScenarioData</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a94902666c868cdbafb65b73fb7f5f2a2">aggregationScenarioData</a> ()</td></tr>
<tr class="memdesc:a94902666c868cdbafb65b73fb7f5f2a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set aggregation data.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a94902666c868cdbafb65b73fb7f5f2a2">More...</a><br /></td></tr>
<tr class="separator:a94902666c868cdbafb65b73fb7f5f2a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6aa3387494a7b492f6444097c7e06a6"><td class="memItemLeft" align="right" valign="top">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_aggregation_scenario_data.html">AggregationScenarioData</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ae6aa3387494a7b492f6444097c7e06a6">aggregationScenarioData</a> () const</td></tr>
<tr class="memdesc:ae6aa3387494a7b492f6444097c7e06a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get aggregation data.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#ae6aa3387494a7b492f6444097c7e06a6">More...</a><br /></td></tr>
<tr class="separator:ae6aa3387494a7b492f6444097c7e06a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada0e6808fa5835b649902b19335373fc"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_filter.html">ScenarioFilter</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ada0e6808fa5835b649902b19335373fc">filter</a> ()</td></tr>
<tr class="memdesc:ada0e6808fa5835b649902b19335373fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set scenarioFilter.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#ada0e6808fa5835b649902b19335373fc">More...</a><br /></td></tr>
<tr class="separator:ada0e6808fa5835b649902b19335373fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc3bfa6a7a06b02fc44c29a9def32b2"><td class="memItemLeft" align="right" valign="top">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_filter.html">ScenarioFilter</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a3dc3bfa6a7a06b02fc44c29a9def32b2">filter</a> () const</td></tr>
<tr class="memdesc:a3dc3bfa6a7a06b02fc44c29a9def32b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get scenarioFilter.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a3dc3bfa6a7a06b02fc44c29a9def32b2">More...</a><br /></td></tr>
<tr class="separator:a3dc3bfa6a7a06b02fc44c29a9def32b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a920e8326cba13f15e736d1fccfb021e1"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a920e8326cba13f15e736d1fccfb021e1">preUpdate</a> () override</td></tr>
<tr class="memdesc:a920e8326cba13f15e736d1fccfb021e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a920e8326cba13f15e736d1fccfb021e1">More...</a><br /></td></tr>
<tr class="separator:a920e8326cba13f15e736d1fccfb021e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561629c4d0ec128f4db39420deb0a31e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a561629c4d0ec128f4db39420deb0a31e">updateScenario</a> (const Date &amp;) override</td></tr>
<tr class="memdesc:a561629c4d0ec128f4db39420deb0a31e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve next market scenario and apply this, but don't update date.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a561629c4d0ec128f4db39420deb0a31e">More...</a><br /></td></tr>
<tr class="separator:a561629c4d0ec128f4db39420deb0a31e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2626e9e88cd833a3ae5d59ad644a3ec"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac2626e9e88cd833a3ae5d59ad644a3ec">updateDate</a> (const Date &amp;) override</td></tr>
<tr class="memdesc:ac2626e9e88cd833a3ae5d59ad644a3ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update to the given date.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#ac2626e9e88cd833a3ae5d59ad644a3ec">More...</a><br /></td></tr>
<tr class="separator:ac2626e9e88cd833a3ae5d59ad644a3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66e8c7b1c859c027ace5465e80d0cb24"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a66e8c7b1c859c027ace5465e80d0cb24">postUpdate</a> (const Date &amp;d, <a class="el" href="classbool.html">bool</a> withFixings) override</td></tr>
<tr class="memdesc:a66e8c7b1c859c027ace5465e80d0cb24"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="elRef" href="../qle/class_observable.html">Observable</a> reset depending on selected mode, instrument updates.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a66e8c7b1c859c027ace5465e80d0cb24">More...</a><br /></td></tr>
<tr class="separator:a66e8c7b1c859c027ace5465e80d0cb24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af551fe030025884eddc38791c15952f4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#af551fe030025884eddc38791c15952f4">updateAsd</a> (const Date &amp;) override</td></tr>
<tr class="memdesc:af551fe030025884eddc38791c15952f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update aggregation scenario data.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#af551fe030025884eddc38791c15952f4">More...</a><br /></td></tr>
<tr class="separator:af551fe030025884eddc38791c15952f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebfcdbbd0fe4efbff10b180be50ca6bc"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#aebfcdbbd0fe4efbff10b180be50ca6bc">reset</a> () override</td></tr>
<tr class="memdesc:aebfcdbbd0fe4efbff10b180be50ca6bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset sim market to initial state.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#aebfcdbbd0fe4efbff10b180be50ca6bc">More...</a><br /></td></tr>
<tr class="separator:aebfcdbbd0fe4efbff10b180be50ca6bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b6372bd81c034a0552434322b39b6f5"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a7b6372bd81c034a0552434322b39b6f5">baseScenario</a> () const</td></tr>
<tr class="separator:a7b6372bd81c034a0552434322b39b6f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e47535378dbfb78f160010cd90580a5"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a8e47535378dbfb78f160010cd90580a5">baseScenarioAbsolute</a> () const</td></tr>
<tr class="separator:a8e47535378dbfb78f160010cd90580a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae015beb42bffe5d7d3aea905a45bd673"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ae015beb42bffe5d7d3aea905a45bd673">useSpreadedTermStructures</a> () const</td></tr>
<tr class="separator:ae015beb42bffe5d7d3aea905a45bd673"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab44a4a6e17e2c28d464cf9ed93fd53a6"><td class="memItemLeft" align="right" valign="top">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab44a4a6e17e2c28d464cf9ed93fd53a6">fixingManager</a> () const override</td></tr>
<tr class="memdesc:ab44a4a6e17e2c28d464cf9ed93fd53a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the fixing manager.  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#ab44a4a6e17e2c28d464cf9ed93fd53a6">More...</a><br /></td></tr>
<tr class="separator:ab44a4a6e17e2c28d464cf9ed93fd53a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81628b0a72ab4ce23fe200e43afb64b4"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a81628b0a72ab4ce23fe200e43afb64b4">isSimulated</a> (const <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a> &amp;factor) const</td></tr>
<tr class="memdesc:a81628b0a72ab4ce23fe200e43afb64b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">is risk factor key simulated by this sim market instance?  <a href="classore_1_1analytics_1_1_scenario_sim_market.html#a81628b0a72ab4ce23fe200e43afb64b4">More...</a><br /></td></tr>
<tr class="separator:a81628b0a72ab4ce23fe200e43afb64b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d1470789fa6352a7a6d0127a15bf43a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a3d1470789fa6352a7a6d0127a15bf43a">applyScenario</a> (const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;scenario)</td></tr>
<tr class="separator:a3d1470789fa6352a7a6d0127a15bf43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classore_1_1analytics_1_1_sim_market"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classore_1_1analytics_1_1_sim_market')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classore_1_1analytics_1_1_sim_market.html">SimMarket</a></td></tr>
<tr class="memitem:a6933f6de9f5ae10da55a06d8a9fa6a1b inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a6933f6de9f5ae10da55a06d8a9fa6a1b">SimMarket</a> (const <a class="el" href="classbool.html">bool</a> <a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>)</td></tr>
<tr class="separator:a6933f6de9f5ae10da55a06d8a9fa6a1b inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a986455ce398dd052a5db761bb87dbddb inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a986455ce398dd052a5db761bb87dbddb">update</a> (const Date &amp;d)</td></tr>
<tr class="memdesc:a986455ce398dd052a5db761bb87dbddb inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate or retrieve market scenario, update market, notify termstructures and update fixings.  <a href="classore_1_1analytics_1_1_sim_market.html#a986455ce398dd052a5db761bb87dbddb">More...</a><br /></td></tr>
<tr class="separator:a986455ce398dd052a5db761bb87dbddb inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a873046bac3378591c2fb4a82be5e62 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a0a873046bac3378591c2fb4a82be5e62">preUpdate</a> ()=0</td></tr>
<tr class="memdesc:a0a873046bac3378591c2fb4a82be5e62 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="elRef" href="../qle/class_observable.html">Observable</a> settings depending on selected mode, before we update the market.  <a href="classore_1_1analytics_1_1_sim_market.html#a0a873046bac3378591c2fb4a82be5e62">More...</a><br /></td></tr>
<tr class="separator:a0a873046bac3378591c2fb4a82be5e62 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84849c9baa872216c2ce4a7fa2d7bd9b inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a84849c9baa872216c2ce4a7fa2d7bd9b">updateDate</a> (const Date &amp;)=0</td></tr>
<tr class="memdesc:a84849c9baa872216c2ce4a7fa2d7bd9b inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update to the given date.  <a href="classore_1_1analytics_1_1_sim_market.html#a84849c9baa872216c2ce4a7fa2d7bd9b">More...</a><br /></td></tr>
<tr class="separator:a84849c9baa872216c2ce4a7fa2d7bd9b inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cfdf3ebf837d13431c04ece1599ca67 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a9cfdf3ebf837d13431c04ece1599ca67">updateScenario</a> (const Date &amp;)=0</td></tr>
<tr class="memdesc:a9cfdf3ebf837d13431c04ece1599ca67 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve next market scenario and apply this, but don't update date.  <a href="classore_1_1analytics_1_1_sim_market.html#a9cfdf3ebf837d13431c04ece1599ca67">More...</a><br /></td></tr>
<tr class="separator:a9cfdf3ebf837d13431c04ece1599ca67 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad81bb9be8e09438c20c91a32a8423159 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#ad81bb9be8e09438c20c91a32a8423159">postUpdate</a> (const Date &amp;d, <a class="el" href="classbool.html">bool</a> withFixings)=0</td></tr>
<tr class="memdesc:ad81bb9be8e09438c20c91a32a8423159 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="elRef" href="../qle/class_observable.html">Observable</a> reset depending on selected mode, instrument updates.  <a href="classore_1_1analytics_1_1_sim_market.html#ad81bb9be8e09438c20c91a32a8423159">More...</a><br /></td></tr>
<tr class="separator:ad81bb9be8e09438c20c91a32a8423159 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fb4885d160348e4b6d3f88dc97d5d7c inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a1fb4885d160348e4b6d3f88dc97d5d7c">updateAsd</a> (const Date &amp;)=0</td></tr>
<tr class="memdesc:a1fb4885d160348e4b6d3f88dc97d5d7c inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update aggregation scenario data.  <a href="classore_1_1analytics_1_1_sim_market.html#a1fb4885d160348e4b6d3f88dc97d5d7c">More...</a><br /></td></tr>
<tr class="separator:a1fb4885d160348e4b6d3f88dc97d5d7c inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1918fbfef3312a3a3b97b6e3de68d545 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a1918fbfef3312a3a3b97b6e3de68d545">numeraire</a> ()</td></tr>
<tr class="memdesc:a1918fbfef3312a3a3b97b6e3de68d545 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return current numeraire value.  <a href="classore_1_1analytics_1_1_sim_market.html#a1918fbfef3312a3a3b97b6e3de68d545">More...</a><br /></td></tr>
<tr class="separator:a1918fbfef3312a3a3b97b6e3de68d545 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d0bec1112c1be625546da15f2cc6cf4 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">const std::string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a3d0bec1112c1be625546da15f2cc6cf4">label</a> ()</td></tr>
<tr class="memdesc:a3d0bec1112c1be625546da15f2cc6cf4 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return current scenario label, if any.  <a href="classore_1_1analytics_1_1_sim_market.html#a3d0bec1112c1be625546da15f2cc6cf4">More...</a><br /></td></tr>
<tr class="separator:a3d0bec1112c1be625546da15f2cc6cf4 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20dcbdfbd0ec77afc802522bb7e379c1 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a20dcbdfbd0ec77afc802522bb7e379c1">reset</a> ()=0</td></tr>
<tr class="memdesc:a20dcbdfbd0ec77afc802522bb7e379c1 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset sim market to initial state.  <a href="classore_1_1analytics_1_1_sim_market.html#a20dcbdfbd0ec77afc802522bb7e379c1">More...</a><br /></td></tr>
<tr class="separator:a20dcbdfbd0ec77afc802522bb7e379c1 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28fae5abb2d8e7d0b5d668ddbffa24d5 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a28fae5abb2d8e7d0b5d668ddbffa24d5">fixingManager</a> () const =0</td></tr>
<tr class="memdesc:a28fae5abb2d8e7d0b5d668ddbffa24d5 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the fixing manager.  <a href="classore_1_1analytics_1_1_sim_market.html#a28fae5abb2d8e7d0b5d668ddbffa24d5">More...</a><br /></td></tr>
<tr class="separator:a28fae5abb2d8e7d0b5d668ddbffa24d5 inherit pub_methods_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classore_1_1data_1_1_market_impl"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classore_1_1data_1_1_market_impl')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el"  href="../ored/classore_1_1data_1_1_market_impl.html">MarketImpl</a></td></tr>
<tr class="memitem:a5212a2150d797539278884214424e590 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5212a2150d797539278884214424e590">MarketImpl</a> (const <a class="el" href="classbool.html">bool</a> <a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>)</td></tr>
<tr class="separator:a5212a2150d797539278884214424e590 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679e458460d4e04a68054390ce2e5cf3 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Date&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a679e458460d4e04a68054390ce2e5cf3">asofDate</a> () const override</td></tr>
<tr class="separator:a679e458460d4e04a68054390ce2e5cf3 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7d29fd30616cfe3c462d7d84eaf4ef9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">yieldCurve</a> (const <a class="elRef" href="../ored/namespaceore_1_1data.html#ac6f42eb3486232f025ca701de91409cc">YieldCurveType</a> &amp;type, const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ae7d29fd30616cfe3c462d7d84eaf4ef9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480fc1dd443cef1efb182e31b9197cb8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a480fc1dd443cef1efb182e31b9197cb8">discountCurveImpl</a> (const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a480fc1dd443cef1efb182e31b9197cb8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468f6942c6cd702ce1b0a6368e94ee92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a468f6942c6cd702ce1b0a6368e94ee92">yieldCurve</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a468f6942c6cd702ce1b0a6368e94ee92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea15232be6eb71feca2c59137631f732 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_ibor_index.html">IborIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aea15232be6eb71feca2c59137631f732 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59684278372260fbf998460e3ddf949 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; SwapIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ac59684278372260fbf998460e3ddf949 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c37e6656d0d18a7ddc19dc4d406a766 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; QuantLib::SwaptionVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1c37e6656d0d18a7ddc19dc4d406a766">swaptionVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a1c37e6656d0d18a7ddc19dc4d406a766 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd15d7307d3eabe0b1d9012e64cd3aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a0dd15d7307d3eabe0b1d9012e64cd3aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1177363d3c16f7c943b873d8ebd14f4d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a1177363d3c16f7c943b873d8ebd14f4d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af32816f8f26575ae1b76f6c12692ffa0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; QuantLib::SwaptionVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#af32816f8f26575ae1b76f6c12692ffa0">yieldVol</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:af32816f8f26575ae1b76f6c12692ffa0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78775af5754336e57ae363f4cbb43315 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_fx_index.html">QuantExt::FxIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a78775af5754336e57ae363f4cbb43315">fxIndexImpl</a> (const string &amp;<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a78775af5754336e57ae363f4cbb43315 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa8bd6429c01a971334f6b7cc24bdb0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aaaa8bd6429c01a971334f6b7cc24bdb0">fxRateImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aaaa8bd6429c01a971334f6b7cc24bdb0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a509be6c04b926b4c867b45e402fed19a inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a509be6c04b926b4c867b45e402fed19a">fxSpotImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a509be6c04b926b4c867b45e402fed19a inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5216216380b983d0c4f0d0d8bf8f8e95 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5216216380b983d0c4f0d0d8bf8f8e95">fxVolImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a5216216380b983d0c4f0d0d8bf8f8e95 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a816b9cd7808e94b1aebd46ef23f76f97 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_curve.html">QuantExt::CreditCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a816b9cd7808e94b1aebd46ef23f76f97 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf97013f8bcc3d9ad31cd4dfdb362cfc inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aaf97013f8bcc3d9ad31cd4dfdb362cfc">recoveryRate</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aaf97013f8bcc3d9ad31cd4dfdb362cfc inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7629364e5c05d0e15739d25a2592b6 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5b7629364e5c05d0e15739d25a2592b6">cdsVol</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a5b7629364e5c05d0e15739d25a2592b6 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19d11313dd07fa55bb3a33b33aa5c770 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_base_correlation_term_structure.html">QuantExt::BaseCorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a19d11313dd07fa55bb3a33b33aa5c770">baseCorrelation</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a19d11313dd07fa55bb3a33b33aa5c770 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad70d4ddc47d3221152b30f58df835cdf inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; OptionletVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ad70d4ddc47d3221152b30f58df835cdf">capFloorVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ad70d4ddc47d3221152b30f58df835cdf inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc90f11798a50d031cfbed369c6f3a92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">std::pair&lt; string, QuantLib::Period &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#acc90f11798a50d031cfbed369c6f3a92">capFloorVolIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:acc90f11798a50d031cfbed369c6f3a92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e2fa33b29d555c00925751d95b91b1 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; QuantExt::YoYOptionletVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a92e2fa33b29d555c00925751d95b91b1">yoyCapFloorVol</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a92e2fa33b29d555c00925751d95b91b1 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2043641bdf8622ce37e5fa96d83cd8e9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; ZeroInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a2043641bdf8622ce37e5fa96d83cd8e9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1b633ccf740828de4e98b038f3ba39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YoYInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ade1b633ccf740828de4e98b038f3ba39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8d28d57ee5fb98efc218a82f075575 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; CPIVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5a8d28d57ee5fb98efc218a82f075575">cpiInflationCapFloorVolatilitySurface</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a5a8d28d57ee5fb98efc218a82f075575 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33fff7168b7c7af1e957d68565e4ee4 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab33fff7168b7c7af1e957d68565e4ee4">equitySpot</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ab33fff7168b7c7af1e957d68565e4ee4 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e2bf8d9c6e49a938c4259d491f0efa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_equity_index2.html">QuantExt::EquityIndex2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a21e2bf8d9c6e49a938c4259d491f0efa">equityCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a21e2bf8d9c6e49a938c4259d491f0efa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74205069d128d1ea28e02d8164897fc2 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a74205069d128d1ea28e02d8164897fc2">equityDividendCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a74205069d128d1ea28e02d8164897fc2 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fcb04b7d3cc1f9c220318c71051ee8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a26fcb04b7d3cc1f9c220318c71051ee8">equityVol</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a26fcb04b7d3cc1f9c220318c71051ee8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbee2a26a4993a8a77ead14217e32a14 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#afbee2a26a4993a8a77ead14217e32a14">equityForecastCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:afbee2a26a4993a8a77ead14217e32a14 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17072a7a0f5ccf9a132ea530c2968a2b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a17072a7a0f5ccf9a132ea530c2968a2b">securitySpread</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a17072a7a0f5ccf9a132ea530c2968a2b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320a82af8e6a68f66b46b401c5b3b33b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_inflation_index_observer.html">QuantExt::InflationIndexObserver</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a320a82af8e6a68f66b46b401c5b3b33b">baseCpis</a> (const string &amp;index, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a320a82af8e6a68f66b46b401c5b3b33b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22c6188a5f378934b69965aa7c6cb39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_price_term_structure.html">QuantExt::PriceTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab22c6188a5f378934b69965aa7c6cb39">commodityPriceCurve</a> (const string &amp;commodityName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ab22c6188a5f378934b69965aa7c6cb39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060fec48de83d55fa494933357fa3e9d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_commodity_index.html">QuantExt::CommodityIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a060fec48de83d55fa494933357fa3e9d">commodityIndex</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a060fec48de83d55fa494933357fa3e9d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af497cb1a23fea3ee208b83076f76e6aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#af497cb1a23fea3ee208b83076f76e6aa">commodityVolatility</a> (const string &amp;commodityName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:af497cb1a23fea3ee208b83076f76e6aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad449ed0141640824d2167e88ac863e06 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_correlation_term_structure.html">QuantExt::CorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ad449ed0141640824d2167e88ac863e06">correlationCurve</a> (const string &amp;index1, const string &amp;index2, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ad449ed0141640824d2167e88ac863e06 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa871e1771f29abeefabe1f71c554ad39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa871e1771f29abeefabe1f71c554ad39">cpr</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aa871e1771f29abeefabe1f71c554ad39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eba6adfc1a3b8bcb42e9fef23e30791 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0eba6adfc1a3b8bcb42e9fef23e30791">MarketImpl</a> (const <a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html">MarketImpl</a> &amp;)=delete</td></tr>
<tr class="separator:a0eba6adfc1a3b8bcb42e9fef23e30791 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89936be569c502830bb52b877fb4e415 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html">MarketImpl</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a89936be569c502830bb52b877fb4e415">operator=</a> (const <a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html">MarketImpl</a> &amp;)=delete</td></tr>
<tr class="separator:a89936be569c502830bb52b877fb4e415 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61dc3722ab70d2406698eb3191acc61 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab61dc3722ab70d2406698eb3191acc61">refresh</a> (const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) override</td></tr>
<tr class="separator:ab61dc3722ab70d2406698eb3191acc61 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679e458460d4e04a68054390ce2e5cf3 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Date&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a679e458460d4e04a68054390ce2e5cf3">asofDate</a> () const override</td></tr>
<tr class="separator:a679e458460d4e04a68054390ce2e5cf3 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7d29fd30616cfe3c462d7d84eaf4ef9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">yieldCurve</a> (const <a class="elRef" href="../ored/namespaceore_1_1data.html#ac6f42eb3486232f025ca701de91409cc">YieldCurveType</a> &amp;type, const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ae7d29fd30616cfe3c462d7d84eaf4ef9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480fc1dd443cef1efb182e31b9197cb8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a480fc1dd443cef1efb182e31b9197cb8">discountCurveImpl</a> (const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a480fc1dd443cef1efb182e31b9197cb8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a468f6942c6cd702ce1b0a6368e94ee92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a468f6942c6cd702ce1b0a6368e94ee92">yieldCurve</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a468f6942c6cd702ce1b0a6368e94ee92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea15232be6eb71feca2c59137631f732 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_ibor_index.html">IborIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aea15232be6eb71feca2c59137631f732 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59684278372260fbf998460e3ddf949 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; SwapIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ac59684278372260fbf998460e3ddf949 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c37e6656d0d18a7ddc19dc4d406a766 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; QuantLib::SwaptionVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1c37e6656d0d18a7ddc19dc4d406a766">swaptionVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a1c37e6656d0d18a7ddc19dc4d406a766 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dd15d7307d3eabe0b1d9012e64cd3aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a0dd15d7307d3eabe0b1d9012e64cd3aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1177363d3c16f7c943b873d8ebd14f4d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a1177363d3c16f7c943b873d8ebd14f4d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af32816f8f26575ae1b76f6c12692ffa0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; QuantLib::SwaptionVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#af32816f8f26575ae1b76f6c12692ffa0">yieldVol</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:af32816f8f26575ae1b76f6c12692ffa0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78775af5754336e57ae363f4cbb43315 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_fx_index.html">QuantExt::FxIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a78775af5754336e57ae363f4cbb43315">fxIndexImpl</a> (const string &amp;<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a78775af5754336e57ae363f4cbb43315 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaaa8bd6429c01a971334f6b7cc24bdb0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aaaa8bd6429c01a971334f6b7cc24bdb0">fxRateImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aaaa8bd6429c01a971334f6b7cc24bdb0 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a509be6c04b926b4c867b45e402fed19a inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a509be6c04b926b4c867b45e402fed19a">fxSpotImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a509be6c04b926b4c867b45e402fed19a inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5216216380b983d0c4f0d0d8bf8f8e95 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5216216380b983d0c4f0d0d8bf8f8e95">fxVolImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a5216216380b983d0c4f0d0d8bf8f8e95 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a816b9cd7808e94b1aebd46ef23f76f97 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_curve.html">QuantExt::CreditCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a816b9cd7808e94b1aebd46ef23f76f97 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf97013f8bcc3d9ad31cd4dfdb362cfc inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aaf97013f8bcc3d9ad31cd4dfdb362cfc">recoveryRate</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aaf97013f8bcc3d9ad31cd4dfdb362cfc inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b7629364e5c05d0e15739d25a2592b6 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5b7629364e5c05d0e15739d25a2592b6">cdsVol</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a5b7629364e5c05d0e15739d25a2592b6 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19d11313dd07fa55bb3a33b33aa5c770 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_base_correlation_term_structure.html">QuantExt::BaseCorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a19d11313dd07fa55bb3a33b33aa5c770">baseCorrelation</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a19d11313dd07fa55bb3a33b33aa5c770 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad70d4ddc47d3221152b30f58df835cdf inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; OptionletVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ad70d4ddc47d3221152b30f58df835cdf">capFloorVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ad70d4ddc47d3221152b30f58df835cdf inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc90f11798a50d031cfbed369c6f3a92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">std::pair&lt; string, QuantLib::Period &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#acc90f11798a50d031cfbed369c6f3a92">capFloorVolIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:acc90f11798a50d031cfbed369c6f3a92 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92e2fa33b29d555c00925751d95b91b1 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; QuantExt::YoYOptionletVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a92e2fa33b29d555c00925751d95b91b1">yoyCapFloorVol</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a92e2fa33b29d555c00925751d95b91b1 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2043641bdf8622ce37e5fa96d83cd8e9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; ZeroInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a2043641bdf8622ce37e5fa96d83cd8e9 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade1b633ccf740828de4e98b038f3ba39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YoYInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ade1b633ccf740828de4e98b038f3ba39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a8d28d57ee5fb98efc218a82f075575 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; CPIVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5a8d28d57ee5fb98efc218a82f075575">cpiInflationCapFloorVolatilitySurface</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a5a8d28d57ee5fb98efc218a82f075575 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33fff7168b7c7af1e957d68565e4ee4 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab33fff7168b7c7af1e957d68565e4ee4">equitySpot</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ab33fff7168b7c7af1e957d68565e4ee4 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e2bf8d9c6e49a938c4259d491f0efa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_equity_index2.html">QuantExt::EquityIndex2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a21e2bf8d9c6e49a938c4259d491f0efa">equityCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a21e2bf8d9c6e49a938c4259d491f0efa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74205069d128d1ea28e02d8164897fc2 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a74205069d128d1ea28e02d8164897fc2">equityDividendCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a74205069d128d1ea28e02d8164897fc2 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26fcb04b7d3cc1f9c220318c71051ee8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a26fcb04b7d3cc1f9c220318c71051ee8">equityVol</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a26fcb04b7d3cc1f9c220318c71051ee8 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbee2a26a4993a8a77ead14217e32a14 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#afbee2a26a4993a8a77ead14217e32a14">equityForecastCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:afbee2a26a4993a8a77ead14217e32a14 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17072a7a0f5ccf9a132ea530c2968a2b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a17072a7a0f5ccf9a132ea530c2968a2b">securitySpread</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a17072a7a0f5ccf9a132ea530c2968a2b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320a82af8e6a68f66b46b401c5b3b33b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_inflation_index_observer.html">QuantExt::InflationIndexObserver</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a320a82af8e6a68f66b46b401c5b3b33b">baseCpis</a> (const string &amp;index, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a320a82af8e6a68f66b46b401c5b3b33b inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab22c6188a5f378934b69965aa7c6cb39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_price_term_structure.html">QuantExt::PriceTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab22c6188a5f378934b69965aa7c6cb39">commodityPriceCurve</a> (const string &amp;commodityName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ab22c6188a5f378934b69965aa7c6cb39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a060fec48de83d55fa494933357fa3e9d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_commodity_index.html">QuantExt::CommodityIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a060fec48de83d55fa494933357fa3e9d">commodityIndex</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:a060fec48de83d55fa494933357fa3e9d inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af497cb1a23fea3ee208b83076f76e6aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#af497cb1a23fea3ee208b83076f76e6aa">commodityVolatility</a> (const string &amp;commodityName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:af497cb1a23fea3ee208b83076f76e6aa inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad449ed0141640824d2167e88ac863e06 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_correlation_term_structure.html">QuantExt::CorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ad449ed0141640824d2167e88ac863e06">correlationCurve</a> (const string &amp;index1, const string &amp;index2, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:ad449ed0141640824d2167e88ac863e06 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa871e1771f29abeefabe1f71c554ad39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa871e1771f29abeefabe1f71c554ad39">cpr</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const override</td></tr>
<tr class="separator:aa871e1771f29abeefabe1f71c554ad39 inherit pub_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classore_1_1data_1_1_market"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classore_1_1data_1_1_market')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el"  href="../ored/classore_1_1data_1_1_market.html">Market</a></td></tr>
<tr class="memitem:ae547762c79e2f9dc47358e2ca309921b inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ae547762c79e2f9dc47358e2ca309921b">Market</a> (const <a class="el" href="classbool.html">bool</a> <a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>)</td></tr>
<tr class="separator:ae547762c79e2f9dc47358e2ca309921b inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e182b04d9891fd2854fd5f4654477ef inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a3e182b04d9891fd2854fd5f4654477ef">~Market</a> ()</td></tr>
<tr class="separator:a3e182b04d9891fd2854fd5f4654477ef inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac84b11c68c5a1ae442b3e47301ec939b inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Date&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac84b11c68c5a1ae442b3e47301ec939b">asofDate</a> () const=0</td></tr>
<tr class="separator:ac84b11c68c5a1ae442b3e47301ec939b inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92bf9c09da194c21383204ac3f3857d inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aa92bf9c09da194c21383204ac3f3857d">yieldCurve</a> (const <a class="elRef" href="../ored/namespaceore_1_1data.html#ac6f42eb3486232f025ca701de91409cc">YieldCurveType</a> &amp;type, const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aa92bf9c09da194c21383204ac3f3857d inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff00023d0e25ad7c0bf29e8cc97f9e00 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a> (const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:aff00023d0e25ad7c0bf29e8cc97f9e00 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea1e978ddb0a43b487424e43d409021 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a6ea1e978ddb0a43b487424e43d409021">discountCurveImpl</a> (const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a6ea1e978ddb0a43b487424e43d409021 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac9221aec95ccdfc9c1dd1f0fa176b5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aeac9221aec95ccdfc9c1dd1f0fa176b5">yieldCurve</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aeac9221aec95ccdfc9c1dd1f0fa176b5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e092b24477cc4ce28970189447bcdfa inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_ibor_index.html">IborIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a6e092b24477cc4ce28970189447bcdfa">iborIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a6e092b24477cc4ce28970189447bcdfa inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a926927b9429d23af2d03f946db89e013 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; SwapIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a926927b9429d23af2d03f946db89e013">swapIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a926927b9429d23af2d03f946db89e013 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a993e36a71afa7bb2f84db45be7926ce0 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_swaption_volatility_structure.html">SwaptionVolatilityStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a993e36a71afa7bb2f84db45be7926ce0">swaptionVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a993e36a71afa7bb2f84db45be7926ce0 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec78f60e1e4c5b046e957d202c4d26b inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#abec78f60e1e4c5b046e957d202c4d26b">shortSwapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:abec78f60e1e4c5b046e957d202c4d26b inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7be429352f7374c40472522816b10c inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2f7be429352f7374c40472522816b10c">swapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a2f7be429352f7374c40472522816b10c inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5302fb40d6cb42f0fc9f80fcf07268d5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_swaption_volatility_structure.html">SwaptionVolatilityStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a5302fb40d6cb42f0fc9f80fcf07268d5">yieldVol</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a5302fb40d6cb42f0fc9f80fcf07268d5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d884a61027d5434d524779453a5b918 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_fx_index.html">QuantExt::FxIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a> (const string &amp;fxIndex, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a8d884a61027d5434d524779453a5b918 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39b58fb3758f6506ed0c8d59beeeb15 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_fx_index.html">QuantExt::FxIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ad39b58fb3758f6506ed0c8d59beeeb15">fxIndexImpl</a> (const string &amp;<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ad39b58fb3758f6506ed0c8d59beeeb15 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c559acede2b82e98252067757600b56 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2c559acede2b82e98252067757600b56">fxRate</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a2c559acede2b82e98252067757600b56 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad806378863fc47de6f5febb66f41715b inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ad806378863fc47de6f5febb66f41715b">fxRateImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ad806378863fc47de6f5febb66f41715b inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6a2501015e2227c3f1a4f621c21ab4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a0b6a2501015e2227c3f1a4f621c21ab4">fxSpot</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a0b6a2501015e2227c3f1a4f621c21ab4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa5019642975aabcb65f2d2c570ad1d inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#acfa5019642975aabcb65f2d2c570ad1d">fxSpotImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:acfa5019642975aabcb65f2d2c570ad1d inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b97563fda6d29885fa5b3e8931bc6d4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a5b97563fda6d29885fa5b3e8931bc6d4">fxVol</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a5b97563fda6d29885fa5b3e8931bc6d4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee9949a86d2e8c75757557a85220fa6c inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aee9949a86d2e8c75757557a85220fa6c">fxVolImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aee9949a86d2e8c75757557a85220fa6c inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c124280a30ee7628084760a45ea2be inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_curve.html">QuantExt::CreditCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a03c124280a30ee7628084760a45ea2be">defaultCurve</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a03c124280a30ee7628084760a45ea2be inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659799d94897b273e2f103f288dd4e88 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a659799d94897b273e2f103f288dd4e88">recoveryRate</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a659799d94897b273e2f103f288dd4e88 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7767415b76a76df6f41256d0555055ea inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a7767415b76a76df6f41256d0555055ea">cdsVol</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a7767415b76a76df6f41256d0555055ea inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54efe66ad72a90b60c3d178cc305f2d3 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_base_correlation_term_structure.html">QuantExt::BaseCorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a54efe66ad72a90b60c3d178cc305f2d3">baseCorrelation</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a54efe66ad72a90b60c3d178cc305f2d3 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c293a70a030a0914ca6bc5096d9651 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; OptionletVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a17c293a70a030a0914ca6bc5096d9651">capFloorVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a17c293a70a030a0914ca6bc5096d9651 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f587d07c5a2e8e27c544b4f01ce971 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; std::string, QuantLib::Period &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a85f587d07c5a2e8e27c544b4f01ce971">capFloorVolIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a85f587d07c5a2e8e27c544b4f01ce971 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561e812f68832c1673603dac51440e46 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; QuantExt::YoYOptionletVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a561e812f68832c1673603dac51440e46">yoyCapFloorVol</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a561e812f68832c1673603dac51440e46 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d53f457e5c61f2257ef3e110ee4990 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; ZeroInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a57d53f457e5c61f2257ef3e110ee4990">zeroInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a57d53f457e5c61f2257ef3e110ee4990 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a308a309caf5a573a22c3577b25c49 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YoYInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ad7a308a309caf5a573a22c3577b25c49">yoyInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ad7a308a309caf5a573a22c3577b25c49 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dff1e32f3d57d98dfb445e6c355568 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; CPIVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a04dff1e32f3d57d98dfb445e6c355568">cpiInflationCapFloorVolatilitySurface</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a04dff1e32f3d57d98dfb445e6c355568 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b2f8257c2265b610b8a452def126bcc inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a0b2f8257c2265b610b8a452def126bcc">equitySpot</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a0b2f8257c2265b610b8a452def126bcc inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4250c7ce19e0adfa7f537132943f2a inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ade4250c7ce19e0adfa7f537132943f2a">equityDividendCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ade4250c7ce19e0adfa7f537132943f2a inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b49275ba9e36be18467170a2d7ceeba inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a4b49275ba9e36be18467170a2d7ceeba">equityForecastCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a4b49275ba9e36be18467170a2d7ceeba inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec93ba3bc563f014d0baa82925e0d771 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_equity_index2.html">QuantExt::EquityIndex2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aec93ba3bc563f014d0baa82925e0d771">equityCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aec93ba3bc563f014d0baa82925e0d771 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2021a4225605cf58597030a0414c9c45 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2021a4225605cf58597030a0414c9c45">securitySpread</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a2021a4225605cf58597030a0414c9c45 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47ddd567f84d73e5f1c8201823356b1c inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_price_term_structure.html">QuantExt::PriceTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a47ddd567f84d73e5f1c8201823356b1c">commodityPriceCurve</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a47ddd567f84d73e5f1c8201823356b1c inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba53f51e9be834d434b6505ad714123 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_commodity_index.html">QuantExt::CommodityIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#adba53f51e9be834d434b6505ad714123">commodityIndex</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:adba53f51e9be834d434b6505ad714123 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10caaa9d3124a851e7a532f35de6469f inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a10caaa9d3124a851e7a532f35de6469f">commodityVolatility</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a10caaa9d3124a851e7a532f35de6469f inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725108ebabde9e800e91b1234893b830 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_correlation_term_structure.html">QuantExt::CorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a725108ebabde9e800e91b1234893b830">correlationCurve</a> (const std::string &amp;index1, const std::string &amp;index2, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a725108ebabde9e800e91b1234893b830 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa55f431986256c6b1e78155cd68c7963 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aa55f431986256c6b1e78155cd68c7963">equityVol</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aa55f431986256c6b1e78155cd68c7963 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c71374dc7c0b31fe840056483d7b04e inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8c71374dc7c0b31fe840056483d7b04e">refresh</a> (const string &amp;)</td></tr>
<tr class="separator:a8c71374dc7c0b31fe840056483d7b04e inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2385ed27720695755e6caeae52eb8295 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2385ed27720695755e6caeae52eb8295">cpr</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a2385ed27720695755e6caeae52eb8295 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d67016dee39ce8f4588deb0745460f inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a88d67016dee39ce8f4588deb0745460f">commodityCurveLookup</a> (const string &amp;pm) const</td></tr>
<tr class="separator:a88d67016dee39ce8f4588deb0745460f inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4863c98e5313c78043dc6317840807a inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a> () const</td></tr>
<tr class="separator:ac4863c98e5313c78043dc6317840807a inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa92bf9c09da194c21383204ac3f3857d inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aa92bf9c09da194c21383204ac3f3857d">yieldCurve</a> (const <a class="elRef" href="../ored/namespaceore_1_1data.html#ac6f42eb3486232f025ca701de91409cc">YieldCurveType</a> &amp;type, const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aa92bf9c09da194c21383204ac3f3857d inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff00023d0e25ad7c0bf29e8cc97f9e00 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a> (const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:aff00023d0e25ad7c0bf29e8cc97f9e00 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea1e978ddb0a43b487424e43d409021 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a6ea1e978ddb0a43b487424e43d409021">discountCurveImpl</a> (const string &amp;ccy, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a6ea1e978ddb0a43b487424e43d409021 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeac9221aec95ccdfc9c1dd1f0fa176b5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aeac9221aec95ccdfc9c1dd1f0fa176b5">yieldCurve</a> (const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aeac9221aec95ccdfc9c1dd1f0fa176b5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e092b24477cc4ce28970189447bcdfa inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_ibor_index.html">IborIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a6e092b24477cc4ce28970189447bcdfa">iborIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a6e092b24477cc4ce28970189447bcdfa inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a926927b9429d23af2d03f946db89e013 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; SwapIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a926927b9429d23af2d03f946db89e013">swapIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a926927b9429d23af2d03f946db89e013 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a993e36a71afa7bb2f84db45be7926ce0 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_swaption_volatility_structure.html">SwaptionVolatilityStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a993e36a71afa7bb2f84db45be7926ce0">swaptionVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a993e36a71afa7bb2f84db45be7926ce0 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abec78f60e1e4c5b046e957d202c4d26b inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#abec78f60e1e4c5b046e957d202c4d26b">shortSwapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:abec78f60e1e4c5b046e957d202c4d26b inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7be429352f7374c40472522816b10c inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2f7be429352f7374c40472522816b10c">swapIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a2f7be429352f7374c40472522816b10c inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5302fb40d6cb42f0fc9f80fcf07268d5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_swaption_volatility_structure.html">SwaptionVolatilityStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a5302fb40d6cb42f0fc9f80fcf07268d5">yieldVol</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a5302fb40d6cb42f0fc9f80fcf07268d5 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d884a61027d5434d524779453a5b918 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_fx_index.html">QuantExt::FxIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a> (const string &amp;fxIndex, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a8d884a61027d5434d524779453a5b918 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad39b58fb3758f6506ed0c8d59beeeb15 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_fx_index.html">QuantExt::FxIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ad39b58fb3758f6506ed0c8d59beeeb15">fxIndexImpl</a> (const string &amp;<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a>, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ad39b58fb3758f6506ed0c8d59beeeb15 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c559acede2b82e98252067757600b56 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2c559acede2b82e98252067757600b56">fxRate</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a2c559acede2b82e98252067757600b56 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad806378863fc47de6f5febb66f41715b inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ad806378863fc47de6f5febb66f41715b">fxRateImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ad806378863fc47de6f5febb66f41715b inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b6a2501015e2227c3f1a4f621c21ab4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a0b6a2501015e2227c3f1a4f621c21ab4">fxSpot</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a0b6a2501015e2227c3f1a4f621c21ab4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfa5019642975aabcb65f2d2c570ad1d inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#acfa5019642975aabcb65f2d2c570ad1d">fxSpotImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:acfa5019642975aabcb65f2d2c570ad1d inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b97563fda6d29885fa5b3e8931bc6d4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a5b97563fda6d29885fa5b3e8931bc6d4">fxVol</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:a5b97563fda6d29885fa5b3e8931bc6d4 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee9949a86d2e8c75757557a85220fa6c inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aee9949a86d2e8c75757557a85220fa6c">fxVolImpl</a> (const string &amp;ccypair, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aee9949a86d2e8c75757557a85220fa6c inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c124280a30ee7628084760a45ea2be inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_curve.html">QuantExt::CreditCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a03c124280a30ee7628084760a45ea2be">defaultCurve</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a03c124280a30ee7628084760a45ea2be inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659799d94897b273e2f103f288dd4e88 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a659799d94897b273e2f103f288dd4e88">recoveryRate</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a659799d94897b273e2f103f288dd4e88 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7767415b76a76df6f41256d0555055ea inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a7767415b76a76df6f41256d0555055ea">cdsVol</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a7767415b76a76df6f41256d0555055ea inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54efe66ad72a90b60c3d178cc305f2d3 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_base_correlation_term_structure.html">QuantExt::BaseCorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a54efe66ad72a90b60c3d178cc305f2d3">baseCorrelation</a> (const string &amp;, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a54efe66ad72a90b60c3d178cc305f2d3 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c293a70a030a0914ca6bc5096d9651 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; OptionletVolatilityStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a17c293a70a030a0914ca6bc5096d9651">capFloorVol</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a17c293a70a030a0914ca6bc5096d9651 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85f587d07c5a2e8e27c544b4f01ce971 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual std::pair&lt; std::string, QuantLib::Period &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a85f587d07c5a2e8e27c544b4f01ce971">capFloorVolIndexBase</a> (const string &amp;key, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a85f587d07c5a2e8e27c544b4f01ce971 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561e812f68832c1673603dac51440e46 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; QuantExt::YoYOptionletVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a561e812f68832c1673603dac51440e46">yoyCapFloorVol</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a561e812f68832c1673603dac51440e46 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d53f457e5c61f2257ef3e110ee4990 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; ZeroInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a57d53f457e5c61f2257ef3e110ee4990">zeroInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a57d53f457e5c61f2257ef3e110ee4990 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7a308a309caf5a573a22c3577b25c49 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YoYInflationIndex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ad7a308a309caf5a573a22c3577b25c49">yoyInflationIndex</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ad7a308a309caf5a573a22c3577b25c49 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04dff1e32f3d57d98dfb445e6c355568 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; CPIVolatilitySurface &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a04dff1e32f3d57d98dfb445e6c355568">cpiInflationCapFloorVolatilitySurface</a> (const string &amp;indexName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a04dff1e32f3d57d98dfb445e6c355568 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b2f8257c2265b610b8a452def126bcc inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a0b2f8257c2265b610b8a452def126bcc">equitySpot</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a0b2f8257c2265b610b8a452def126bcc inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade4250c7ce19e0adfa7f537132943f2a inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ade4250c7ce19e0adfa7f537132943f2a">equityDividendCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:ade4250c7ce19e0adfa7f537132943f2a inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b49275ba9e36be18467170a2d7ceeba inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a4b49275ba9e36be18467170a2d7ceeba">equityForecastCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a4b49275ba9e36be18467170a2d7ceeba inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec93ba3bc563f014d0baa82925e0d771 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_equity_index2.html">QuantExt::EquityIndex2</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#aec93ba3bc563f014d0baa82925e0d771">equityCurve</a> (const string &amp;eqName, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:aec93ba3bc563f014d0baa82925e0d771 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2021a4225605cf58597030a0414c9c45 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a2021a4225605cf58597030a0414c9c45">securitySpread</a> (const string &amp;securityID, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a2021a4225605cf58597030a0414c9c45 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47ddd567f84d73e5f1c8201823356b1c inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_price_term_structure.html">QuantExt::PriceTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a47ddd567f84d73e5f1c8201823356b1c">commodityPriceCurve</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a47ddd567f84d73e5f1c8201823356b1c inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adba53f51e9be834d434b6505ad714123 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_commodity_index.html">QuantExt::CommodityIndex</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#adba53f51e9be834d434b6505ad714123">commodityIndex</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:adba53f51e9be834d434b6505ad714123 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10caaa9d3124a851e7a532f35de6469f inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a10caaa9d3124a851e7a532f35de6469f">commodityVolatility</a> (const std::string &amp;commodityName, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a10caaa9d3124a851e7a532f35de6469f inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a725108ebabde9e800e91b1234893b830 inherit pub_methods_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">virtual QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_correlation_term_structure.html">QuantExt::CorrelationTermStructure</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a725108ebabde9e800e91b1234893b830">correlationCurve</a> (const std::string &amp;index1, const std::string &amp;index2, const std::string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const=0</td></tr>
<tr class="separator:a725108ebabde9e800e91b1234893b830 inherit pub_methods_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:afd151e890d7a129bea4022a7a0d4dce3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a> (std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt; &amp;simDataTmp, std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, Real &gt; &amp;absoluteSimDataTmp, const <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a> keyType, const std::string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const std::vector&lt; std::vector&lt; Real &gt; &gt; &amp;coordinates)</td></tr>
<tr class="separator:afd151e890d7a129bea4022a7a0d4dce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfed719476afdb574d21318aa9a1118"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a6cfed719476afdb574d21318aa9a1118">addYieldCurve</a> (const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">Market</a> &gt; &amp;initMarket, const std::string &amp;configuration, const <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a> rf, const string &amp;key, const vector&lt; Period &gt; &amp;tenors, <a class="el" href="classbool.html">bool</a> &amp;simDataWritten, <a class="el" href="classbool.html">bool</a> simulate=true, <a class="el" href="classbool.html">bool</a> spreaded=false)</td></tr>
<tr class="separator:a6cfed719476afdb574d21318aa9a1118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a333c90f525cb31f0eaa29fed1593ba72"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a> (const std::string &amp;yieldSpecId, const <a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a> &amp;todaysMarketParams, const std::string &amp;configuration, const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">ore::data::Market</a> &gt; &amp;market=nullptr) const</td></tr>
<tr class="separator:a333c90f525cb31f0eaa29fed1593ba72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a301b6c1dfdbe2500cb0b6a499e0b5734"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a301b6c1dfdbe2500cb0b6a499e0b5734">addSwapIndexToSsm</a> (const std::string &amp;indexName, const <a class="el" href="classbool.html">bool</a> continueOnError)</td></tr>
<tr class="separator:a301b6c1dfdbe2500cb0b6a499e0b5734"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_classore_1_1data_1_1_market_impl"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classore_1_1data_1_1_market_impl')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el"  href="../ored/classore_1_1data_1_1_market_impl.html">MarketImpl</a></td></tr>
<tr class="memitem:af2e760ddfcac8f64fa739d3e8bf6362b inherit pro_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#af2e760ddfcac8f64fa739d3e8bf6362b">require</a> (const <a class="elRef" href="../ored/namespaceore_1_1data.html#a64fa7957018b15e7967bb30da5ddd66d">MarketObject</a> o, const string &amp;<a class="elRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>, const string &amp;configuration, const <a class="el" href="classbool.html">bool</a> forceBuild=false) const</td></tr>
<tr class="separator:af2e760ddfcac8f64fa739d3e8bf6362b inherit pro_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af731b404daf72d32a4986990c5190bcc inherit pro_methods_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#af731b404daf72d32a4986990c5190bcc">addSwapIndex</a> (const string &amp;swapindex, const string &amp;discountIndex, const string &amp;configuration=<a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) const</td></tr>
<tr class="separator:af731b404daf72d32a4986990c5190bcc inherit pro_methods_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a63c0747af118c1d41066cd31f6cd084d"><td class="memItemLeft" align="right" valign="top">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a></td></tr>
<tr class="separator:a63c0747af118c1d41066cd31f6cd084d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f6ff7197821c6208621e218ac60c361"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4f6ff7197821c6208621e218ac60c361">scenarioGenerator_</a></td></tr>
<tr class="separator:a4f6ff7197821c6208621e218ac60c361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc0c946cb6a258c3c295f74a5b10cdcc"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_aggregation_scenario_data.html">AggregationScenarioData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a></td></tr>
<tr class="separator:afc0c946cb6a258c3c295f74a5b10cdcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327eb9d6ae1ae728199147f68ba0909c"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a327eb9d6ae1ae728199147f68ba0909c">fixingManager_</a></td></tr>
<tr class="separator:a327eb9d6ae1ae728199147f68ba0909c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f193d3de7c1a94311d8c1ea52a889c7"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_filter.html">ScenarioFilter</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a></td></tr>
<tr class="separator:a2f193d3de7c1a94311d8c1ea52a889c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a076bfc216eaef4fe4e0667a433e1ad76"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a></td></tr>
<tr class="separator:a076bfc216eaef4fe4e0667a433e1ad76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b99f8838062291f6201c9f819cd3da1"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a></td></tr>
<tr class="separator:a5b99f8838062291f6201c9f819cd3da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65d3596672b1e758c866798baa9bee78"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a65d3596672b1e758c866798baa9bee78">baseScenarioAbsolute_</a></td></tr>
<tr class="separator:a65d3596672b1e758c866798baa9bee78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e0a3d6ee8e66a9f56640aefd9636502"><td class="memItemLeft" align="right" valign="top">std::vector&lt; QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a></td></tr>
<tr class="separator:a4e0a3d6ee8e66a9f56640aefd9636502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff642c824541d0d41f36ce46b7756809"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#aff642c824541d0d41f36ce46b7756809">cachedSimDataActive_</a></td></tr>
<tr class="separator:aff642c824541d0d41f36ce46b7756809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634c17ea8a85013693d3b91344d9faf5"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a634c17ea8a85013693d3b91344d9faf5">cachedSimDataKeysHash_</a> = 0</td></tr>
<tr class="separator:a634c17ea8a85013693d3b91344d9faf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0235f0e84cb47d21daf8793e66f0242f"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a0235f0e84cb47d21daf8793e66f0242f">nonSimulatedFactors_</a></td></tr>
<tr class="separator:a0235f0e84cb47d21daf8793e66f0242f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53cfefe400aac2623306853c887ef20a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a></td></tr>
<tr class="separator:a53cfefe400aac2623306853c887ef20a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66079855d4dadc55e8f684e17bfce63"><td class="memItemLeft" align="right" valign="top">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a></td></tr>
<tr class="separator:ad66079855d4dadc55e8f684e17bfce63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b2289c143003c7964bfeb7e570c504"><td class="memItemLeft" align="right" valign="top">std::set&lt; std::tuple&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a>, std::string, std::vector&lt; std::vector&lt; Real &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a></td></tr>
<tr class="separator:ab5b2289c143003c7964bfeb7e570c504"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8084e71c12327fddaa89613722b4624"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac8084e71c12327fddaa89613722b4624">cacheSimData_</a></td></tr>
<tr class="separator:ac8084e71c12327fddaa89613722b4624"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a035b0b5a2360c3ee4490089fee6523"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a7a035b0b5a2360c3ee4490089fee6523">allowPartialScenarios_</a></td></tr>
<tr class="separator:a7a035b0b5a2360c3ee4490089fee6523"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a5eb0d03fa8e820cf67d44e8c0b21a"><td class="memItemLeft" align="right" valign="top"><a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a></td></tr>
<tr class="separator:ac9a5eb0d03fa8e820cf67d44e8c0b21a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55687aaad8fa83a41d2c8a83846fbfbb"><td class="memItemLeft" align="right" valign="top">std::set&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">ore::analytics::RiskFactorKey</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a55687aaad8fa83a41d2c8a83846fbfbb">diffToBaseKeys_</a></td></tr>
<tr class="separator:a55687aaad8fa83a41d2c8a83846fbfbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41a3cb015d4569715fcf400ab2de2ddd"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a></td></tr>
<tr class="separator:a41a3cb015d4569715fcf400ab2de2ddd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0e9fb72add803a7cca3013e13f70b37"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a></td></tr>
<tr class="separator:ab0e9fb72add803a7cca3013e13f70b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classore_1_1analytics_1_1_sim_market"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classore_1_1analytics_1_1_sim_market')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classore_1_1analytics_1_1_sim_market.html">SimMarket</a></td></tr>
<tr class="memitem:a48499ce399f638bd4b30e412c014461d inherit pro_attribs_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a48499ce399f638bd4b30e412c014461d">numeraire_</a></td></tr>
<tr class="separator:a48499ce399f638bd4b30e412c014461d inherit pro_attribs_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c7a0e45859f37b148337debf0399c7 inherit pro_attribs_classore_1_1analytics_1_1_sim_market"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classore_1_1analytics_1_1_sim_market.html#a29c7a0e45859f37b148337debf0399c7">label_</a></td></tr>
<tr class="separator:a29c7a0e45859f37b148337debf0399c7 inherit pro_attribs_classore_1_1analytics_1_1_sim_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classore_1_1data_1_1_market_impl"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classore_1_1data_1_1_market_impl')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el"  href="../ored/classore_1_1data_1_1_market_impl.html">MarketImpl</a></td></tr>
<tr class="memitem:ae647dad4005a503dc047518e84fb9a08 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">Date&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a></td></tr>
<tr class="separator:ae647dad4005a503dc047518e84fb9a08 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bdb311cafacc7ef02e31db35cdd3c2b inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_f_x_triangulation.html">FXTriangulation</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5bdb311cafacc7ef02e31db35cdd3c2b">fx_</a></td></tr>
<tr class="separator:a5bdb311cafacc7ef02e31db35cdd3c2b inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c7ff8d8c31e2f85fbb37384bcac3290 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; tuple&lt; string, <a class="elRef" href="../ored/namespaceore_1_1data.html#ac6f42eb3486232f025ca701de91409cc">YieldCurveType</a>, string &gt;, Handle&lt; YieldTermStructure &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6c7ff8d8c31e2f85fbb37384bcac3290">yieldCurves_</a></td></tr>
<tr class="separator:a6c7ff8d8c31e2f85fbb37384bcac3290 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7750155dbe018c9040751ec807770b35 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_ibor_index.html">IborIndex</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a7750155dbe018c9040751ec807770b35">iborIndices_</a></td></tr>
<tr class="separator:a7750155dbe018c9040751ec807770b35 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae48d2576be0780a502b2a5d5b607a24a inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; SwapIndex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae48d2576be0780a502b2a5d5b607a24a">swapIndices_</a></td></tr>
<tr class="separator:ae48d2576be0780a502b2a5d5b607a24a inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e8780cb54cc1f2120dc22af3b903ee inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantLib::SwaptionVolatilityStructure &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa4e8780cb54cc1f2120dc22af3b903ee">swaptionCurves_</a></td></tr>
<tr class="separator:aa4e8780cb54cc1f2120dc22af3b903ee inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb886da44dcd5171d9371487aca3b1cf inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, pair&lt; string, string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#acb886da44dcd5171d9371487aca3b1cf">swaptionIndexBases_</a></td></tr>
<tr class="separator:acb886da44dcd5171d9371487aca3b1cf inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae14cb3cad5042b1b2cdb640b4a11a3c6 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantLib::SwaptionVolatilityStructure &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae14cb3cad5042b1b2cdb640b4a11a3c6">yieldVolCurves_</a></td></tr>
<tr class="separator:ae14cb3cad5042b1b2cdb640b4a11a3c6 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b8442b6d8873c160be5e0e52c8b3071 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5b8442b6d8873c160be5e0e52c8b3071">fxVols_</a></td></tr>
<tr class="separator:a5b8442b6d8873c160be5e0e52c8b3071 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fbc788235c5a4e14315fb5f117c4d35 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_curve.html">QuantExt::CreditCurve</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6fbc788235c5a4e14315fb5f117c4d35">defaultCurves_</a></td></tr>
<tr class="separator:a6fbc788235c5a4e14315fb5f117c4d35 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bd2645934bf424bec9d60d3a146554e inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a8bd2645934bf424bec9d60d3a146554e">cdsVols_</a></td></tr>
<tr class="separator:a8bd2645934bf424bec9d60d3a146554e inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7e08433597ac99460ac5bfc347173c0 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_base_correlation_term_structure.html">QuantExt::BaseCorrelationTermStructure</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa7e08433597ac99460ac5bfc347173c0">baseCorrelations_</a></td></tr>
<tr class="separator:aa7e08433597ac99460ac5bfc347173c0 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0192d884dd8d1a6bc1c887bf251b0bc inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">recoveryRates_</a></td></tr>
<tr class="separator:ab0192d884dd8d1a6bc1c887bf251b0bc inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b4a7aa3ac7df041878c7e173a3c64ec inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; OptionletVolatilityStructure &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0b4a7aa3ac7df041878c7e173a3c64ec">capFloorCurves_</a></td></tr>
<tr class="separator:a0b4a7aa3ac7df041878c7e173a3c64ec inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afea30f55f4e6ac11d14c3389276aa3d7 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, std::pair&lt; string, QuantLib::Period &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#afea30f55f4e6ac11d14c3389276aa3d7">capFloorIndexBase_</a></td></tr>
<tr class="separator:afea30f55f4e6ac11d14c3389276aa3d7 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cad6ae2928d269c2dbbaf607d3d15d8 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_yo_y_optionlet_volatility_surface.html">YoYOptionletVolatilitySurface</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a7cad6ae2928d269c2dbbaf607d3d15d8">yoyCapFloorVolSurfaces_</a></td></tr>
<tr class="separator:a7cad6ae2928d269c2dbbaf607d3d15d8 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4b30e0d4ca91a8246986ea7173164fc inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; ZeroInflationIndex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac4b30e0d4ca91a8246986ea7173164fc">zeroInflationIndices_</a></td></tr>
<tr class="separator:ac4b30e0d4ca91a8246986ea7173164fc inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8873185426918c5d252bd2457a92ce1d inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; YoYInflationIndex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a8873185426918c5d252bd2457a92ce1d">yoyInflationIndices_</a></td></tr>
<tr class="separator:a8873185426918c5d252bd2457a92ce1d inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589f42a64e6ab40d77a122443976d382 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; CPIVolatilitySurface &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a589f42a64e6ab40d77a122443976d382">cpiInflationCapFloorVolatilitySurfaces_</a></td></tr>
<tr class="separator:a589f42a64e6ab40d77a122443976d382 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b352f577f3990c44c91b4b8ffa93a48 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a9b352f577f3990c44c91b4b8ffa93a48">equitySpots_</a></td></tr>
<tr class="separator:a9b352f577f3990c44c91b4b8ffa93a48 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada78e1e842b03e527818f6d6b9fc3bcf inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_black_vol_term_structure.html">BlackVolTermStructure</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ada78e1e842b03e527818f6d6b9fc3bcf">equityVols_</a></td></tr>
<tr class="separator:ada78e1e842b03e527818f6d6b9fc3bcf inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae73ab4348cb8a38e480b6b4f36502acd inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae73ab4348cb8a38e480b6b4f36502acd">securitySpreads_</a></td></tr>
<tr class="separator:ae73ab4348cb8a38e480b6b4f36502acd inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598238b952f3026fc385030cfa02b5dd inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_inflation_index_observer.html">QuantExt::InflationIndexObserver</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a598238b952f3026fc385030cfa02b5dd">baseCpis_</a></td></tr>
<tr class="separator:a598238b952f3026fc385030cfa02b5dd inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21f5030728e25a766476309c37b67149 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; tuple&lt; string, string, string &gt;, Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_correlation_term_structure.html">QuantExt::CorrelationTermStructure</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a21f5030728e25a766476309c37b67149">correlationCurves_</a></td></tr>
<tr class="separator:a21f5030728e25a766476309c37b67149 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c9a8e7f8ce0fb904eda53256b2a17db inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_commodity_index.html">QuantExt::CommodityIndex</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6c9a8e7f8ce0fb904eda53256b2a17db">commodityIndices_</a></td></tr>
<tr class="separator:a6c9a8e7f8ce0fb904eda53256b2a17db inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec9f1b5af32d4247654bb8bf5c20bef9 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aec9f1b5af32d4247654bb8bf5c20bef9">commodityVols_</a></td></tr>
<tr class="separator:aec9f1b5af32d4247654bb8bf5c20bef9 inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d4b29028a553466f69f9d816eaada5c inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, QuantLib::Handle&lt; <a class="elRef" href="../qle/class_quant_ext_1_1_equity_index2.html">QuantExt::EquityIndex2</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a4d4b29028a553466f69f9d816eaada5c">equityCurves_</a></td></tr>
<tr class="separator:a4d4b29028a553466f69f9d816eaada5c inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa94a1440fdab7170ac9d69e82622239b inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa94a1440fdab7170ac9d69e82622239b">cprs_</a></td></tr>
<tr class="separator:aa94a1440fdab7170ac9d69e82622239b inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b2387d9f59959bb1318dd9d38f4209b inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memItemLeft" align="right" valign="top">map&lt; string, std::set&lt; QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../qle/class_term_structure.html">TermStructure</a> &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2b2387d9f59959bb1318dd9d38f4209b">refreshTs_</a></td></tr>
<tr class="separator:a2b2387d9f59959bb1318dd9d38f4209b inherit pro_attribs_classore_1_1data_1_1_market_impl"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classore_1_1data_1_1_market"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classore_1_1data_1_1_market')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el"  href="../ored/classore_1_1data_1_1_market.html">Market</a></td></tr>
<tr class="memitem:a3ebabbfe6789901b849383c54c951c8c inherit pro_attribs_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a3ebabbfe6789901b849383c54c951c8c">handlePseudoCurrencies_</a></td></tr>
<tr class="separator:a3ebabbfe6789901b849383c54c951c8c inherit pro_attribs_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_attribs_classore_1_1data_1_1_market"><td colspan="2" onclick="javascript:toggleInherit('pub_static_attribs_classore_1_1data_1_1_market')"><img src="closed.png" alt="-"/>&#160;Static Public Attributes inherited from <a class="el"  href="../ored/classore_1_1data_1_1_market.html">Market</a></td></tr>
<tr class="memitem:ab336651e3455fff1764bf576a5785bbd inherit pub_static_attribs_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">static const string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">defaultConfiguration</a></td></tr>
<tr class="separator:ab336651e3455fff1764bf576a5785bbd inherit pub_static_attribs_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e8c1f6899f657c5721476bca7bc27fe inherit pub_static_attribs_classore_1_1data_1_1_market"><td class="memItemLeft" align="right" valign="top">static const string&#160;</td><td class="memItemRight" valign="bottom"><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#a0e8c1f6899f657c5721476bca7bc27fe">inCcyConfiguration</a></td></tr>
<tr class="separator:a0e8c1f6899f657c5721476bca7bc27fe inherit pub_static_attribs_classore_1_1data_1_1_market"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Simulation Market updated with discrete scenarios. </p>
<p >If useSpreadedTermStructures is true, spreaded term structures over the initMarket for supported risk factors will be generated. This is used by the <a class="el" href="classore_1_1analytics_1_1_sensitivity_scenario_generator.html" title="Sensitivity Scenario Generator.">SensitivityScenarioGenerator</a>.</p>
<p >If cacheSimData is true, the scenario application is optimised. This requires that all scenarios are <a class="el" href="classore_1_1analytics_1_1_simple_scenario.html">SimpleScenario</a> instances with identical key structure in their data.</p>
<p >If allowPartialScenarios is true, the check that all simData_ is touched by a scenario is disabled. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00068">68</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a96f64187600d595cafbd67f1230a39f0" name="a96f64187600d595cafbd67f1230a39f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96f64187600d595cafbd67f1230a39f0">&#9670;&#160;</a></span>ScenarioSimMarket() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>handlePseudoCurrencies</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00071">71</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   71</span>: <a class="code hl_function" href="classore_1_1analytics_1_1_sim_market.html#a6933f6de9f5ae10da55a06d8a9fa6a1b">SimMarket</a>(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>) {}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sim_market_html_a6933f6de9f5ae10da55a06d8a9fa6a1b"><div class="ttname"><a href="classore_1_1analytics_1_1_sim_market.html#a6933f6de9f5ae10da55a06d8a9fa6a1b">ore::analytics::SimMarket::SimMarket</a></div><div class="ttdeci">SimMarket(const bool handlePseudoCurrencies)</div><div class="ttdef"><b>Definition:</b> <a href="simmarket_8hpp_source.html#l00046">simmarket.hpp:46</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_html_ac4863c98e5313c78043dc6317840807a"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">ore::data::Market::handlePseudoCurrencies</a></div><div class="ttdeci">bool handlePseudoCurrencies() const</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa1871a4d657d10b08c3c64d35f736ec" name="afa1871a4d657d10b08c3c64d35f736ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa1871a4d657d10b08c3c64d35f736ec">&#9670;&#160;</a></span>ScenarioSimMarket() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">Market</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>initMarket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>configuration</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a> &amp;&#160;</td>
          <td class="paramname"><em>curveConfigs</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>todaysMarketParams</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>continueOnError</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>useSpreadedTermStructures</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>cacheSimData</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>allowPartialScenarios</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>iborFallbackConfig</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ae1cac12f251897f232fda19ee46c06de">IborFallbackConfig::defaultConfig</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>handlePseudoCurrencies</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>offSetScenario</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00306">306</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  314</span>    : <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a96f64187600d595cafbd67f1230a39f0">ScenarioSimMarket</a>(initMarket, parameters, QuantLib::ext::make_shared&lt;FixingManager&gt;(initMarket-&gt;asofDate()),</div>
<div class="line"><span class="lineno">  315</span>                        configuration, curveConfigs, todaysMarketParams, continueOnError, <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#ae015beb42bffe5d7d3aea905a45bd673">useSpreadedTermStructures</a>,</div>
<div class="line"><span class="lineno">  316</span>                        cacheSimData, allowPartialScenarios, iborFallbackConfig, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>,</div>
<div class="line"><span class="lineno">  317</span>                        offSetScenario) {}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a96f64187600d595cafbd67f1230a39f0"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a96f64187600d595cafbd67f1230a39f0">ore::analytics::ScenarioSimMarket::ScenarioSimMarket</a></div><div class="ttdeci">ScenarioSimMarket(const bool handlePseudoCurrencies)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00071">scenariosimmarket.hpp:71</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ae015beb42bffe5d7d3aea905a45bd673"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ae015beb42bffe5d7d3aea905a45bd673">ore::analytics::ScenarioSimMarket::useSpreadedTermStructures</a></div><div class="ttdeci">bool useSpreadedTermStructures() const</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00134">scenariosimmarket.hpp:134</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9fb38a0edc39d7edcb571010c80ca002" name="a9fb38a0edc39d7edcb571010c80ca002"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9fb38a0edc39d7edcb571010c80ca002">&#9670;&#160;</a></span>ScenarioSimMarket() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html">ScenarioSimMarket</a> </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">Market</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>initMarket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>parameters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>fixingManager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>configuration</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a> &amp;&#160;</td>
          <td class="paramname"><em>curveConfigs</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_curve_configurations.html">ore::data::CurveConfigurations</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>todaysMarketParams</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>continueOnError</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>useSpreadedTermStructures</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>cacheSimData</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>allowPartialScenarios</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a> &amp;&#160;</td>
          <td class="paramname"><em>iborFallbackConfig</em> = <code><a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ae1cac12f251897f232fda19ee46c06de">IborFallbackConfig::defaultConfig</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>handlePseudoCurrencies</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>offSetScenario</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00319">319</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  325</span>    : <a class="code hl_function" href="classore_1_1analytics_1_1_sim_market.html#a6933f6de9f5ae10da55a06d8a9fa6a1b">SimMarket</a>(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#ac4863c98e5313c78043dc6317840807a">handlePseudoCurrencies</a>), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>(parameters), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a327eb9d6ae1ae728199147f68ba0909c">fixingManager_</a>(<a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab44a4a6e17e2c28d464cf9ed93fd53a6">fixingManager</a>),</div>
<div class="line"><span class="lineno">  326</span>      <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>(QuantLib::ext::make_shared&lt;ScenarioFilter&gt;()), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>(<a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#ae015beb42bffe5d7d3aea905a45bd673">useSpreadedTermStructures</a>),</div>
<div class="line"><span class="lineno">  327</span>      <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac8084e71c12327fddaa89613722b4624">cacheSimData_</a>(cacheSimData), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a7a035b0b5a2360c3ee4490089fee6523">allowPartialScenarios_</a>(allowPartialScenarios),</div>
<div class="line"><span class="lineno">  328</span>      <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a>(iborFallbackConfig), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>(offSetScenario) {</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building ScenarioSimMarket...&quot;</span>);</div>
<div class="line"><span class="lineno">  331</span>    <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> = initMarket-&gt;asofDate();</div>
<div class="line"><span class="lineno">  332</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;AsOf &quot;</span> &lt;&lt; QuantLib::io::iso_date(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>));</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment">// check ssm parameters</span></div>
<div class="line"><span class="lineno">  335</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;interpolation() == <span class="stringliteral">&quot;LogLinear&quot;</span> || <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;interpolation() == <span class="stringliteral">&quot;LinearZero&quot;</span>,</div>
<div class="line"><span class="lineno">  336</span>               <span class="stringliteral">&quot;ScenarioSimMarket: Interpolation (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;interpolation()</div>
<div class="line"><span class="lineno">  337</span>                                                    &lt;&lt; <span class="stringliteral">&quot;) must be set to &#39;LogLinear&#39; or &#39;LinearZero&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  338</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;extrapolation() == <span class="stringliteral">&quot;FlatZero&quot;</span> || <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;extrapolation() == <span class="stringliteral">&quot;FlatFwd&quot;</span>,</div>
<div class="line"><span class="lineno">  339</span>               <span class="stringliteral">&quot;ScenarioSimMarket: YieldCurves / Extrapolation (&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;extrapolation()</div>
<div class="line"><span class="lineno">  340</span>                                                                   &lt;&lt; <span class="stringliteral">&quot;&#39;) must be set to &#39;FlatZero&#39; or &#39;FlatFwd&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  341</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;defaultCurveExtrapolation() == <span class="stringliteral">&quot;FlatZero&quot;</span> ||</div>
<div class="line"><span class="lineno">  342</span>                   <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;defaultCurveExtrapolation() == <span class="stringliteral">&quot;FlatFwd&quot;</span>,</div>
<div class="line"><span class="lineno">  343</span>               <span class="stringliteral">&quot;ScenarioSimMarket: DefaultCurves / Extrapolation (&#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;extrapolation()</div>
<div class="line"><span class="lineno">  344</span>                                                                     &lt;&lt; <span class="stringliteral">&quot;&#39;) must be set to &#39;FlatZero&#39; or &#39;FlatFwd&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; param : parameters-&gt;parameters()) {</div>
<div class="line"><span class="lineno">  347</span>        <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  348</span>            <span class="comment">// we populate the temp containers for each curve and write the result to the global</span></div>
<div class="line"><span class="lineno">  349</span>            <span class="comment">// containers only if the set of data points is complete for this curve</span></div>
<div class="line"><span class="lineno">  350</span>            std::map&lt;RiskFactorKey, QuantLib::ext::shared_ptr&lt;SimpleQuote&gt;&gt; simDataTmp;</div>
<div class="line"><span class="lineno">  351</span>            std::map&lt;RiskFactorKey, Real&gt; absoluteSimDataTmp;</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>            boost::timer::cpu_timer timer;</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>            <span class="keywordflow">switch</span> (param.first) {</div>
<div class="line"><span class="lineno">  356</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3">RiskFactorKey::KeyType::FXSpot</a>: {</div>
<div class="line"><span class="lineno">  357</span>            std::map&lt;std::string, Handle&lt;Quote&gt;&gt; fxQuotes;</div>
<div class="line"><span class="lineno">  358</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  359</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  360</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  361</span>                        <span class="comment">// constructing fxSpots_</span></div>
<div class="line"><span class="lineno">  362</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;adding &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; FX rates&quot;</span>);</div>
<div class="line"><span class="lineno">  363</span>                        Real v = initMarket-&gt;fxSpot(name, configuration)-&gt;value();</div>
<div class="line"><span class="lineno">  364</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 1.0 : v);</div>
<div class="line"><span class="lineno">  365</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  366</span>                            <span class="keyword">auto</span> m = [v](Real x) { <span class="keywordflow">return</span> x * v; };</div>
<div class="line"><span class="lineno">  367</span>                            fxQuotes[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>] = Handle&lt;Quote&gt;(</div>
<div class="line"><span class="lineno">  368</span>                                QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(Handle&lt;Quote&gt;(q), m));</div>
<div class="line"><span class="lineno">  369</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  370</span>                            fxQuotes[<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno">  371</span>                        }</div>
<div class="line"><span class="lineno">  372</span>                        <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno">  373</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno">  374</span>                            simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  375</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  376</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  377</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  378</span>                                                           std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  379</span>                                                           std::forward_as_tuple(v));</div>
<div class="line"><span class="lineno">  380</span>                            }</div>
<div class="line"><span class="lineno">  381</span>                        }</div>
<div class="line"><span class="lineno">  382</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {});</div>
<div class="line"><span class="lineno">  383</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  384</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  385</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno">  386</span>                    }</div>
<div class="line"><span class="lineno">  387</span>                }</div>
<div class="line"><span class="lineno">  388</span>                <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5bdb311cafacc7ef02e31db35cdd3c2b">fx_</a> = QuantLib::ext::make_shared&lt;FXTriangulation&gt;(fxQuotes);</div>
<div class="line"><span class="lineno">  389</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  390</span>            }</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313">RiskFactorKey::KeyType::DiscountCurve</a>:</div>
<div class="line"><span class="lineno">  393</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738">RiskFactorKey::KeyType::YieldCurve</a>:</div>
<div class="line"><span class="lineno">  394</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  395</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  396</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  397</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yield curve..&quot;</span>);</div>
<div class="line"><span class="lineno">  398</span>                        vector&lt;Period&gt; tenors = parameters-&gt;yieldCurveTenors(name);</div>
<div class="line"><span class="lineno">  399</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a6cfed719476afdb574d21318aa9a1118">addYieldCurve</a>(initMarket, configuration, param.first, name, tenors, simDataWritten,</div>
<div class="line"><span class="lineno">  400</span>                                      param.second.first, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>);</div>
<div class="line"><span class="lineno">  401</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yield curve done&quot;</span>);</div>
<div class="line"><span class="lineno">  402</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  403</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno">  404</span>                    }</div>
<div class="line"><span class="lineno">  405</span>                }</div>
<div class="line"><span class="lineno">  406</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614">RiskFactorKey::KeyType::IndexCurve</a>: {</div>
<div class="line"><span class="lineno">  409</span>                <span class="comment">// make sure we built overnight indices first, so that we can build ibor fallback indices</span></div>
<div class="line"><span class="lineno">  410</span>                <span class="comment">// that depend on them</span></div>
<div class="line"><span class="lineno">  411</span>                std::vector&lt;std::string&gt; indices;</div>
<div class="line"><span class="lineno">  412</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; i : param.second.second) {</div>
<div class="line"><span class="lineno">  413</span>                    <span class="keywordtype">bool</span> isOn = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  414</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  415</span>                        isOn = QuantLib::ext::dynamic_pointer_cast&lt;OvernightIndex&gt;(*initMarket-&gt;iborIndex(i, configuration)) !=</div>
<div class="line"><span class="lineno">  416</span>                               <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  417</span>                    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno">  418</span>                    }</div>
<div class="line"><span class="lineno">  419</span>                    <span class="keywordflow">if</span> (isOn)</div>
<div class="line"><span class="lineno">  420</span>                        indices.insert(indices.begin(), i);</div>
<div class="line"><span class="lineno">  421</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  422</span>                        indices.push_back(i);</div>
<div class="line"><span class="lineno">  423</span>                }</div>
<div class="line"><span class="lineno">  424</span>                <span class="comment">// loop over sorted indices and build them</span></div>
<div class="line"><span class="lineno">  425</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : indices) {</div>
<div class="line"><span class="lineno">  426</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  427</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  428</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; index curve&quot;</span>);</div>
<div class="line"><span class="lineno">  429</span>                        std::vector&lt;string&gt; indexTokens;</div>
<div class="line"><span class="lineno">  430</span>                        split(indexTokens, name, boost::is_any_of(<span class="stringliteral">&quot;-&quot;</span>));</div>
<div class="line"><span class="lineno">  431</span>                        Handle&lt;IborIndex&gt; index;</div>
<div class="line"><span class="lineno">  432</span>                        <span class="keywordflow">if</span> (indexTokens[1] == <span class="stringliteral">&quot;GENERIC&quot;</span>) {</div>
<div class="line"><span class="lineno">  433</span>                            <span class="comment">// If we have a generic curve build the index using the index currency&#39;s discount curve</span></div>
<div class="line"><span class="lineno">  434</span>                            <span class="comment">// no need to check for a convention based ibor index in this case</span></div>
<div class="line"><span class="lineno">  435</span>                            index = Handle&lt;IborIndex&gt;(</div>
<div class="line"><span class="lineno">  436</span>                                <a class="code hl_functionRef" href="../ored/group__utilities.html#ga2d18ab5807f92319c9db2c13f4904738">parseIborIndex</a>(name, initMarket-&gt;discountCurve(indexTokens[0], configuration)));</div>
<div class="line"><span class="lineno">  437</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  438</span>                            index = initMarket-&gt;iborIndex(name, configuration);</div>
<div class="line"><span class="lineno">  439</span>                        }</div>
<div class="line"><span class="lineno">  440</span>                        QL_REQUIRE(!index.empty(), <span class="stringliteral">&quot;index object for &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; not provided&quot;</span>);</div>
<div class="line"><span class="lineno">  441</span>                        Handle&lt;YieldTermStructure&gt; wrapperIndex = index-&gt;forwardingTermStructure();</div>
<div class="line"><span class="lineno">  442</span>                        QL_REQUIRE(!wrapperIndex.empty(), <span class="stringliteral">&quot;no termstructure for index &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno">  443</span>                        vector&lt;string&gt; keys(parameters-&gt;yieldCurveTenors(name).size());</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>                        DayCounter dc = wrapperIndex-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  446</span>                        vector&lt;Time&gt; yieldCurveTimes(1, 0.0);        <span class="comment">// include today</span></div>
<div class="line"><span class="lineno">  447</span>                        vector&lt;Date&gt; yieldCurveDates(1, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>);</div>
<div class="line"><span class="lineno">  448</span>                        QL_REQUIRE(parameters-&gt;yieldCurveTenors(name).front() &gt; 0 * Days,</div>
<div class="line"><span class="lineno">  449</span>                                   <span class="stringliteral">&quot;yield curve tenors must not include t=0&quot;</span>);</div>
<div class="line"><span class="lineno">  450</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; tenor : parameters-&gt;yieldCurveTenors(name)) {</div>
<div class="line"><span class="lineno">  451</span>                            yieldCurveTimes.push_back(dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + tenor));</div>
<div class="line"><span class="lineno">  452</span>                            yieldCurveDates.push_back(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + tenor);</div>
<div class="line"><span class="lineno">  453</span>                        }</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>                        <span class="comment">// include today</span></div>
<div class="line"><span class="lineno">  456</span>                        vector&lt;Handle&lt;Quote&gt;&gt; quotes;</div>
<div class="line"><span class="lineno">  457</span>                        QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(<span class="keyword">new</span> SimpleQuote(1.0));</div>
<div class="line"><span class="lineno">  458</span>                        quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>                        <span class="keywordflow">for</span> (Size i = 0; i &lt; yieldCurveTimes.size() - 1; i++) {</div>
<div class="line"><span class="lineno">  461</span>                            Real val = wrapperIndex-&gt;discount(yieldCurveDates[i + 1]);</div>
<div class="line"><span class="lineno">  462</span>                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(<span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 1.0 : val));</div>
<div class="line"><span class="lineno">  463</span>                            Handle&lt;Quote&gt; qh(q);</div>
<div class="line"><span class="lineno">  464</span>                            quotes.push_back(qh);</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>                            simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno">  467</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  468</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  469</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  470</span>                                                           std::forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno">  471</span>                                                           std::forward_as_tuple(val));</div>
<div class="line"><span class="lineno">  472</span>                            }</div>
<div class="line"><span class="lineno">  473</span>                            <span class="comment">// FIXME where do we check whether the risk factor is simulated?</span></div>
<div class="line"><span class="lineno">  474</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;ScenarioSimMarket index curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; discount[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; val);</div>
<div class="line"><span class="lineno">  475</span>                        }</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name,</div>
<div class="line"><span class="lineno">  478</span>                                     {std::vector&lt;Real&gt;(std::next(yieldCurveTimes.begin(), 1), yieldCurveTimes.end())});</div>
<div class="line"><span class="lineno">  479</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>                        QuantLib::ext::shared_ptr&lt;YieldTermStructure&gt; indexCurve = makeYieldCurve(</div>
<div class="line"><span class="lineno">  482</span>                            name, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>, wrapperIndex, yieldCurveTimes, quotes, dc,</div>
<div class="line"><span class="lineno">  483</span>                            index-&gt;fixingCalendar(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;interpolation(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;extrapolation());</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>                        Handle&lt;YieldTermStructure&gt; ich(indexCurve);</div>
<div class="line"><span class="lineno">  486</span>                        <span class="keywordflow">if</span> (wrapperIndex-&gt;allowsExtrapolation())</div>
<div class="line"><span class="lineno">  487</span>                            ich-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>                        QuantLib::ext::shared_ptr&lt;IborIndex&gt; i = index-&gt;clone(ich);</div>
<div class="line"><span class="lineno">  490</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a>.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#aeaad076823e67dfa54115c5db2f29d96">isIndexReplaced</a>(name, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>)) {</div>
<div class="line"><span class="lineno">  491</span>                            <span class="comment">// handle ibor fallback indices</span></div>
<div class="line"><span class="lineno">  492</span>                            <span class="keyword">auto</span> fallbackData = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a>.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#a6ca7e3d959dbdba95b5247634af86d1b">fallbackData</a>(name);</div>
<div class="line"><span class="lineno">  493</span>                            <span class="keyword">auto</span> f = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a7750155dbe018c9040751ec807770b35">iborIndices_</a>.find(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, fallbackData.rfrIndex));</div>
<div class="line"><span class="lineno">  494</span>                            QL_REQUIRE(f != <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a7750155dbe018c9040751ec807770b35">iborIndices_</a>.end(),</div>
<div class="line"><span class="lineno">  495</span>                                       <span class="stringliteral">&quot;Could not build ibor fallback index &#39;&quot;</span></div>
<div class="line"><span class="lineno">  496</span>                                           &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;, because rfr index &#39;&quot;</span> &lt;&lt; fallbackData.rfrIndex</div>
<div class="line"><span class="lineno">  497</span>                                           &lt;&lt; <span class="stringliteral">&quot;&#39; is not present in scenario sim market, is the rfr index in the &quot;</span></div>
<div class="line"><span class="lineno">  498</span>                                              <span class="stringliteral">&quot;scenario sim market parameters?&quot;</span>);</div>
<div class="line"><span class="lineno">  499</span>                            <span class="keyword">auto</span> rfrInd = QuantLib::ext::dynamic_pointer_cast&lt;OvernightIndex&gt;(*f-&gt;second);</div>
<div class="line"><span class="lineno">  500</span>                            QL_REQUIRE(rfrInd != <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno">  501</span>                                       <span class="stringliteral">&quot;Could not cast &#39;&quot;</span></div>
<div class="line"><span class="lineno">  502</span>                                           &lt;&lt; fallbackData.rfrIndex</div>
<div class="line"><span class="lineno">  503</span>                                           &lt;&lt; <span class="stringliteral">&quot;&#39; to overnight index when building the ibor fallback index &#39;&quot;</span> &lt;&lt; name</div>
<div class="line"><span class="lineno">  504</span>                                           &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  505</span>                            <span class="keywordflow">if</span> (<span class="keyword">auto</span> original = QuantLib::ext::dynamic_pointer_cast&lt;OvernightIndex&gt;(i))</div>
<div class="line"><span class="lineno">  506</span>                                i = QuantLib::ext::make_shared&lt;QuantExt::FallbackOvernightIndex&gt;(</div>
<div class="line"><span class="lineno">  507</span>                                original, rfrInd, fallbackData.spread, fallbackData.switchDate,</div>
<div class="line"><span class="lineno">  508</span>                                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a>.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ad955f8a6580ab44cc9ff95f86d456a03">useRfrCurveInSimulationMarket</a>());</div>
<div class="line"><span class="lineno">  509</span>                                        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  510</span>                                i = QuantLib::ext::make_shared&lt;QuantExt::FallbackIborIndex&gt;(</div>
<div class="line"><span class="lineno">  511</span>                                                i, rfrInd, fallbackData.spread, fallbackData.switchDate,</div>
<div class="line"><span class="lineno">  512</span>                                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a>.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ad955f8a6580ab44cc9ff95f86d456a03">useRfrCurveInSimulationMarket</a>());</div>
<div class="line"><span class="lineno">  513</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;built ibor fall back index &#39;&quot;</span></div>
<div class="line"><span class="lineno">  514</span>                                 &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39; with rfr index &#39;&quot;</span> &lt;&lt; fallbackData.rfrIndex &lt;&lt; <span class="stringliteral">&quot;&#39;, spread &quot;</span></div>
<div class="line"><span class="lineno">  515</span>                                 &lt;&lt; fallbackData.spread &lt;&lt; <span class="stringliteral">&quot;, use rfr curve in scen sim market: &quot;</span> &lt;&lt; std::boolalpha</div>
<div class="line"><span class="lineno">  516</span>                                 &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">iborFallbackConfig_</a>.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ad955f8a6580ab44cc9ff95f86d456a03">useRfrCurveInSimulationMarket</a>());</div>
<div class="line"><span class="lineno">  517</span>                        }</div>
<div class="line"><span class="lineno">  518</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a7750155dbe018c9040751ec807770b35">iborIndices_</a>.insert(</div>
<div class="line"><span class="lineno">  519</span>                            make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;IborIndex&gt;(i)));</div>
<div class="line"><span class="lineno">  520</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; index curve done&quot;</span>);</div>
<div class="line"><span class="lineno">  521</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  522</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno">  523</span>                    }</div>
<div class="line"><span class="lineno">  524</span>                }</div>
<div class="line"><span class="lineno">  525</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  526</span>            }</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad">RiskFactorKey::KeyType::EquitySpot</a>:</div>
<div class="line"><span class="lineno">  529</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  530</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  531</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  532</span>                        <span class="comment">// building equity spots</span></div>
<div class="line"><span class="lineno">  533</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;adding &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; equity spot...&quot;</span>);</div>
<div class="line"><span class="lineno">  534</span>                        Real spotVal = initMarket-&gt;equitySpot(name, configuration)-&gt;value();</div>
<div class="line"><span class="lineno">  535</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 1.0 : spotVal);</div>
<div class="line"><span class="lineno">  536</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  537</span>                            <span class="keyword">auto</span> m = [spotVal](Real x) { <span class="keywordflow">return</span> x * spotVal; };</div>
<div class="line"><span class="lineno">  538</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a9b352f577f3990c44c91b4b8ffa93a48">equitySpots_</a>.insert(</div>
<div class="line"><span class="lineno">  539</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno">  540</span>                                          Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(</div>
<div class="line"><span class="lineno">  541</span>                                              Handle&lt;Quote&gt;(q), m))));</div>
<div class="line"><span class="lineno">  542</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  543</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a9b352f577f3990c44c91b4b8ffa93a48">equitySpots_</a>.insert(</div>
<div class="line"><span class="lineno">  544</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;Quote&gt;(q)));</div>
<div class="line"><span class="lineno">  545</span>                        }</div>
<div class="line"><span class="lineno">  546</span>                        simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  547</span>                                           std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  548</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  549</span>                            absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  550</span>                                                       std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  551</span>                                                       std::forward_as_tuple(spotVal));</div>
<div class="line"><span class="lineno">  552</span>                        }</div>
<div class="line"><span class="lineno">  553</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {});</div>
<div class="line"><span class="lineno">  554</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  555</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;adding &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; equity spot done&quot;</span>);</div>
<div class="line"><span class="lineno">  556</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  557</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno">  558</span>                    }</div>
<div class="line"><span class="lineno">  559</span>                }</div>
<div class="line"><span class="lineno">  560</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438">RiskFactorKey::KeyType::DividendYield</a>:</div>
<div class="line"><span class="lineno">  563</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  564</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  565</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  566</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; equity dividend yield curve..&quot;</span>);</div>
<div class="line"><span class="lineno">  567</span>                        vector&lt;Period&gt; tenors = parameters-&gt;equityDividendTenors(name);</div>
<div class="line"><span class="lineno">  568</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a6cfed719476afdb574d21318aa9a1118">addYieldCurve</a>(initMarket, configuration, param.first, name, tenors, simDataWritten,</div>
<div class="line"><span class="lineno">  569</span>                                      param.second.first, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>);</div>
<div class="line"><span class="lineno">  570</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; equity dividend yield curve done&quot;</span>);</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>                        <span class="comment">// Equity spots and Yield/Index curves added first so we can now build equity index</span></div>
<div class="line"><span class="lineno">  573</span>                        <span class="comment">// First get Forecast Curve</span></div>
<div class="line"><span class="lineno">  574</span>                        <span class="keywordtype">string</span> forecastCurve;</div>
<div class="line"><span class="lineno">  575</span>                        <span class="keywordflow">if</span> (<a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.hasEquityCurveConfig(name)) {</div>
<div class="line"><span class="lineno">  576</span>                            <span class="comment">// From the equity config, get the currency and forecast curve of the equity</span></div>
<div class="line"><span class="lineno">  577</span>                            <span class="keyword">auto</span> eqVolConfig = <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.equityCurveConfig(name);</div>
<div class="line"><span class="lineno">  578</span>                            <span class="keywordtype">string</span> forecastName = eqVolConfig-&gt;forecastingCurve();</div>
<div class="line"><span class="lineno">  579</span>                            <span class="keywordtype">string</span> eqCcy = eqVolConfig-&gt;currency();</div>
<div class="line"><span class="lineno">  580</span>                            <span class="comment">// Build a YieldCurveSpec and extract the yieldCurveSpec name</span></div>
<div class="line"><span class="lineno">  581</span>                            <a class="code hl_classRef" href="../ored/classore_1_1data_1_1_yield_curve_spec.html">YieldCurveSpec</a> ycspec(eqCcy, forecastName);</div>
<div class="line"><span class="lineno">  582</span>                            forecastCurve = ycspec.name();</div>
<div class="line"><span class="lineno">  583</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Got forecast curve &#39;&quot;</span> &lt;&lt; forecastCurve &lt;&lt; <span class="stringliteral">&quot;&#39; from equity curve config for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno">  584</span>                        }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>                        <span class="comment">// Get the nominal term structure from this scenario simulation market</span></div>
<div class="line"><span class="lineno">  587</span>                        Handle&lt;YieldTermStructure&gt; forecastTs =</div>
<div class="line"><span class="lineno">  588</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a>(forecastCurve, todaysMarketParams, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><span class="lineno">  589</span>                        Handle&lt;EquityIndex2&gt; curve = initMarket-&gt;equityCurve(name, configuration);</div>
<div class="line"><span class="lineno">  590</span> </div>
<div class="line"><span class="lineno">  591</span>                        <span class="comment">// If forecast term structure is empty, fall back on this scenario simulation market&#39;s discount</span></div>
<div class="line"><span class="lineno">  592</span>                        <span class="comment">// curve</span></div>
<div class="line"><span class="lineno">  593</span>                        <span class="keywordflow">if</span> (forecastTs.empty()) {</div>
<div class="line"><span class="lineno">  594</span>                            <span class="keywordtype">string</span> ccy = curve-&gt;currency().code();</div>
<div class="line"><span class="lineno">  595</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Falling back on the discount curve for currency &#39;&quot;</span></div>
<div class="line"><span class="lineno">  596</span>                                 &lt;&lt; ccy &lt;&lt; <span class="stringliteral">&quot;&#39; for equity forecast curve &#39;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno">  597</span>                            forecastTs = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a>(ccy);</div>
<div class="line"><span class="lineno">  598</span>                        }</div>
<div class="line"><span class="lineno">  599</span>                        QuantLib::ext::shared_ptr&lt;EquityIndex2&gt; ei(</div>
<div class="line"><span class="lineno">  600</span>                            curve-&gt;clone(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab33fff7168b7c7af1e957d68565e4ee4">equitySpot</a>(name, configuration), forecastTs,</div>
<div class="line"><span class="lineno">  601</span>                                         <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">yieldCurve</a>(YieldCurveType::EquityDividend, name, configuration)));</div>
<div class="line"><span class="lineno">  602</span>                        Handle&lt;EquityIndex2&gt; eh(ei);</div>
<div class="line"><span class="lineno">  603</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a4d4b29028a553466f69f9d816eaada5c">equityCurves_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), eh));</div>
<div class="line"><span class="lineno">  604</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  605</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno">  606</span>                    }</div>
<div class="line"><span class="lineno">  607</span>                }</div>
<div class="line"><span class="lineno">  608</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23">RiskFactorKey::KeyType::SecuritySpread</a>:</div>
<div class="line"><span class="lineno">  611</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  612</span>                    <span class="comment">// security spreads and recovery rates are optional</span></div>
<div class="line"><span class="lineno">  613</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  614</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Adding security spread &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; from configuration &quot;</span> &lt;&lt; configuration);</div>
<div class="line"><span class="lineno">  615</span>                        Real v = initMarket-&gt;securitySpread(name, configuration)-&gt;value();</div>
<div class="line"><span class="lineno">  616</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : v);</div>
<div class="line"><span class="lineno">  617</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  618</span>                            <span class="keyword">auto</span> m = [v](Real x) { <span class="keywordflow">return</span> x + v; };</div>
<div class="line"><span class="lineno">  619</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae73ab4348cb8a38e480b6b4f36502acd">securitySpreads_</a>.insert(</div>
<div class="line"><span class="lineno">  620</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno">  621</span>                                          Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(</div>
<div class="line"><span class="lineno">  622</span>                                              Handle&lt;Quote&gt;(q), m))));</div>
<div class="line"><span class="lineno">  623</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  624</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae73ab4348cb8a38e480b6b4f36502acd">securitySpreads_</a>.insert(</div>
<div class="line"><span class="lineno">  625</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;Quote&gt;(q)));</div>
<div class="line"><span class="lineno">  626</span>                        }</div>
<div class="line"><span class="lineno">  627</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno">  628</span>                            simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  629</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  630</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  631</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  632</span>                                                           std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  633</span>                                                           std::forward_as_tuple(v));</div>
<div class="line"><span class="lineno">  634</span>                            }</div>
<div class="line"><span class="lineno">  635</span>                        }</div>
<div class="line"><span class="lineno">  636</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {});</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  639</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;skipping this object: &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><span class="lineno">  640</span>                    }</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  643</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Adding security recovery rate &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; from configuration &quot;</span> &lt;&lt; configuration);</div>
<div class="line"><span class="lineno">  644</span>                        Real v = initMarket-&gt;recoveryRate(name, configuration)-&gt;value();</div>
<div class="line"><span class="lineno">  645</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 1.0 : v);</div>
<div class="line"><span class="lineno">  646</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  647</span>                            <span class="keyword">auto</span> m = [v](Real x) { <span class="keywordflow">return</span> x * v; };</div>
<div class="line"><span class="lineno">  648</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">recoveryRates_</a>.insert(</div>
<div class="line"><span class="lineno">  649</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno">  650</span>                                          Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(</div>
<div class="line"><span class="lineno">  651</span>                                              Handle&lt;Quote&gt;(q), m))));</div>
<div class="line"><span class="lineno">  652</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  653</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">recoveryRates_</a>.insert(</div>
<div class="line"><span class="lineno">  654</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;Quote&gt;(q)));</div>
<div class="line"><span class="lineno">  655</span>                        }</div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>                        <span class="comment">// TODO this comes from the default curves section in the parameters,</span></div>
<div class="line"><span class="lineno">  658</span>                        <span class="comment">// do we want to specify the simulation of security recovery rates separately?</span></div>
<div class="line"><span class="lineno">  659</span>                        <span class="keywordflow">if</span> (parameters-&gt;simulateRecoveryRates()) {</div>
<div class="line"><span class="lineno">  660</span>                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  661</span>                                               std::forward_as_tuple(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">RiskFactorKey::KeyType::RecoveryRate</a>, name),</div>
<div class="line"><span class="lineno">  662</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  663</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  664</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  665</span>                                                           std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno">  666</span>                                                           std::forward_as_tuple(v));</div>
<div class="line"><span class="lineno">  667</span>                            }</div>
<div class="line"><span class="lineno">  668</span>                        }</div>
<div class="line"><span class="lineno">  669</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">RiskFactorKey::KeyType::RecoveryRate</a>, name, {});</div>
<div class="line"><span class="lineno">  670</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  671</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;skipping this object: &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><span class="lineno">  672</span>                    }</div>
<div class="line"><span class="lineno">  673</span>                }</div>
<div class="line"><span class="lineno">  674</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">RiskFactorKey::KeyType::SwaptionVolatility</a>:</div>
<div class="line"><span class="lineno">  677</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b69e07aebb6ce88afa81cdc54f1b345">RiskFactorKey::KeyType::YieldVolatility</a>:</div>
<div class="line"><span class="lineno">  678</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  679</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  680</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  681</span>                        <span class="comment">// set parameters for swaption resp. yield vols</span></div>
<div class="line"><span class="lineno">  682</span>                        RelinkableHandle&lt;SwaptionVolatilityStructure&gt; wrapper;</div>
<div class="line"><span class="lineno">  683</span>                        vector&lt;Period&gt; optionTenors, underlyingTenors;</div>
<div class="line"><span class="lineno">  684</span>                        vector&lt;Real&gt; strikeSpreads;</div>
<div class="line"><span class="lineno">  685</span>                        <span class="keywordtype">string</span> <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a> = <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a> = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  686</span>                        <span class="keywordtype">bool</span> isCube, isAtm, simulateAtmOnly;</div>
<div class="line"><span class="lineno">  687</span>                        <span class="keywordflow">if</span> (param.first == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">RiskFactorKey::KeyType::SwaptionVolatility</a>) {</div>
<div class="line"><span class="lineno">  688</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; swaption volatility curve...&quot;</span>);</div>
<div class="line"><span class="lineno">  689</span>                            wrapper.linkTo(*initMarket-&gt;swaptionVol(name, configuration));</div>
<div class="line"><span class="lineno">  690</span>                            <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a> = initMarket-&gt;shortSwapIndexBase(name, configuration);</div>
<div class="line"><span class="lineno">  691</span>                            <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a> = initMarket-&gt;swapIndexBase(name, configuration);</div>
<div class="line"><span class="lineno">  692</span>                            isCube = parameters-&gt;swapVolIsCube(name);</div>
<div class="line"><span class="lineno">  693</span>                            optionTenors = parameters-&gt;swapVolExpiries(name);</div>
<div class="line"><span class="lineno">  694</span>                            underlyingTenors = parameters-&gt;swapVolTerms(name);</div>
<div class="line"><span class="lineno">  695</span>                            strikeSpreads = parameters-&gt;swapVolStrikeSpreads(name);</div>
<div class="line"><span class="lineno">  696</span>                            simulateAtmOnly = parameters-&gt;simulateSwapVolATMOnly();</div>
<div class="line"><span class="lineno">  697</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  698</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yield volatility curve...&quot;</span>);</div>
<div class="line"><span class="lineno">  699</span>                            wrapper.linkTo(*initMarket-&gt;yieldVol(name, configuration));</div>
<div class="line"><span class="lineno">  700</span>                            isCube = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  701</span>                            optionTenors = parameters-&gt;yieldVolExpiries();</div>
<div class="line"><span class="lineno">  702</span>                            underlyingTenors = parameters-&gt;yieldVolTerms();</div>
<div class="line"><span class="lineno">  703</span>                            strikeSpreads = {0.0};</div>
<div class="line"><span class="lineno">  704</span>                            simulateAtmOnly = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  705</span>                        }</div>
<div class="line"><span class="lineno">  706</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Initial market &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yield volatility type = &quot;</span> &lt;&lt; wrapper-&gt;volatilityType());</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>                        <span class="comment">// Check if underlying market surface is atm or smile</span></div>
<div class="line"><span class="lineno">  709</span>                        isAtm = QuantLib::ext::dynamic_pointer_cast&lt;SwaptionVolatilityMatrix&gt;(*wrapper) != <span class="keyword">nullptr</span> ||</div>
<div class="line"><span class="lineno">  710</span>                                QuantLib::ext::dynamic_pointer_cast&lt;ConstantSwaptionVolatility&gt;(*wrapper) != <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>                        Handle&lt;SwaptionVolatilityStructure&gt; svp;</div>
<div class="line"><span class="lineno">  713</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno">  714</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating yield vols for ccy &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno">  715</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;YieldVol T0  source is atm     : &quot;</span> &lt;&lt; (isAtm ? <span class="stringliteral">&quot;True&quot;</span> : <span class="stringliteral">&quot;False&quot;</span>));</div>
<div class="line"><span class="lineno">  716</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;YieldVol ssm target is cube    : &quot;</span> &lt;&lt; (isCube ? <span class="stringliteral">&quot;True&quot;</span> : <span class="stringliteral">&quot;False&quot;</span>));</div>
<div class="line"><span class="lineno">  717</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;YieldVol simulate atm only     : &quot;</span> &lt;&lt; (simulateAtmOnly ? <span class="stringliteral">&quot;True&quot;</span> : <span class="stringliteral">&quot;False&quot;</span>));</div>
<div class="line"><span class="lineno">  718</span>                            <span class="keywordflow">if</span> (simulateAtmOnly) {</div>
<div class="line"><span class="lineno">  719</span>                                QL_REQUIRE(strikeSpreads.size() == 1 &amp;&amp; <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(strikeSpreads[0], 0),</div>
<div class="line"><span class="lineno">  720</span>                                           <span class="stringliteral">&quot;for atmOnly strikeSpreads must be {0.0}&quot;</span>);</div>
<div class="line"><span class="lineno">  721</span>                            }</div>
<div class="line"><span class="lineno">  722</span>                            QuantLib::ext::shared_ptr&lt;QuantLib::SwaptionVolatilityCube&gt; cube;</div>
<div class="line"><span class="lineno">  723</span>                            <span class="keywordflow">if</span> (isCube &amp;&amp; !isAtm) {</div>
<div class="line"><span class="lineno">  724</span>                                QuantLib::ext::shared_ptr&lt;SwaptionVolCubeWithATM&gt; tmp =</div>
<div class="line"><span class="lineno">  725</span>                                    QuantLib::ext::dynamic_pointer_cast&lt;SwaptionVolCubeWithATM&gt;(*wrapper);</div>
<div class="line"><span class="lineno">  726</span>                                QL_REQUIRE(tmp, <span class="stringliteral">&quot;swaption cube missing&quot;</span>);</div>
<div class="line"><span class="lineno">  727</span>                                cube = tmp-&gt;cube();</div>
<div class="line"><span class="lineno">  728</span>                            }</div>
<div class="line"><span class="lineno">  729</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes, atmQuotes;</div>
<div class="line"><span class="lineno">  730</span>                            quotes.resize(optionTenors.size() * underlyingTenors.size(),</div>
<div class="line"><span class="lineno">  731</span>                                          vector&lt;Handle&lt;Quote&gt;&gt;(strikeSpreads.size(), Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno">  732</span>                            atmQuotes.resize(optionTenors.size(),</div>
<div class="line"><span class="lineno">  733</span>                                             std::vector&lt;Handle&lt;Quote&gt;&gt;(underlyingTenors.size(), Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno">  734</span>                            vector&lt;vector&lt;Real&gt;&gt; shift(optionTenors.size(), vector&lt;Real&gt;(underlyingTenors.size(), 0.0));</div>
<div class="line"><span class="lineno">  735</span>                            Size atmSlice = std::find_if(strikeSpreads.begin(), strikeSpreads.end(),</div>
<div class="line"><span class="lineno">  736</span>                                                         [](<span class="keyword">const</span> Real s) { return close_enough(s, 0.0); }) -</div>
<div class="line"><span class="lineno">  737</span>                                            strikeSpreads.begin();</div>
<div class="line"><span class="lineno">  738</span>                            QL_REQUIRE(atmSlice &lt; strikeSpreads.size(),</div>
<div class="line"><span class="lineno">  739</span>                                       <span class="stringliteral">&quot;could not find atm slice (strikeSpreads do not contain 0.0)&quot;</span>);</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>                            <span class="comment">// convert to normal if</span></div>
<div class="line"><span class="lineno">  742</span>                            <span class="comment">// a) we have a swaption (i.e. not a yield) volatility and</span></div>
<div class="line"><span class="lineno">  743</span>                            <span class="comment">// b) the T0 term structure is not normal</span></div>
<div class="line"><span class="lineno">  744</span>                            <span class="comment">// c) we are not in the situation of simulating ATM only and having a non-normal cube in T0,</span></div>
<div class="line"><span class="lineno">  745</span>                            <span class="comment">//    since in this case the T0 structure is dynamically used to determine the sim market</span></div>
<div class="line"><span class="lineno">  746</span>                            <span class="comment">//    vols</span></div>
<div class="line"><span class="lineno">  747</span>                            <span class="comment">// d) we do not use spreaded term structures, in which case we keep the original T0</span></div>
<div class="line"><span class="lineno">  748</span>                            <span class="comment">//    term structure in any case</span></div>
<div class="line"><span class="lineno">  749</span>                            <span class="keywordtype">bool</span> convertToNormal = wrapper-&gt;volatilityType() != Normal &amp;&amp;</div>
<div class="line"><span class="lineno">  750</span>                                                   param.first == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">RiskFactorKey::KeyType::SwaptionVolatility</a> &amp;&amp;</div>
<div class="line"><span class="lineno">  751</span>                                                   (!simulateAtmOnly || isAtm) &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>;</div>
<div class="line"><span class="lineno">  752</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;T0 ts is normal             : &quot;</span> &lt;&lt; (wrapper-&gt;volatilityType() == Normal ? <span class="stringliteral">&quot;True&quot;</span></div>
<div class="line"><span class="lineno">  753</span>                                                                                                          : <span class="stringliteral">&quot;False&quot;</span>));</div>
<div class="line"><span class="lineno">  754</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Have swaption vol           : &quot;</span></div>
<div class="line"><span class="lineno">  755</span>                                 &lt;&lt; (param.first == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">RiskFactorKey::KeyType::SwaptionVolatility</a> ? <span class="stringliteral">&quot;True&quot;</span> : <span class="stringliteral">&quot;False&quot;</span>));</div>
<div class="line"><span class="lineno">  756</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Will convert to normal vol  : &quot;</span> &lt;&lt; (convertToNormal ? <span class="stringliteral">&quot;True&quot;</span> : <span class="stringliteral">&quot;False&quot;</span>));</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>                            <span class="comment">// Set up a vol converter, and create if vol type is not normal</span></div>
<div class="line"><span class="lineno">  759</span>                            <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_swaption_volatility_converter.html">SwaptionVolatilityConverter</a>* converter = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  760</span>                            <span class="keywordflow">if</span> (convertToNormal) {</div>
<div class="line"><span class="lineno">  761</span>                                Handle&lt;SwapIndex&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a> = initMarket-&gt;swapIndex(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>, configuration);</div>
<div class="line"><span class="lineno">  762</span>                                Handle&lt;SwapIndex&gt; shortSwapIndex =</div>
<div class="line"><span class="lineno">  763</span>                                    initMarket-&gt;swapIndex(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a>, configuration);</div>
<div class="line"><span class="lineno">  764</span>                                converter = <span class="keyword">new</span> <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_swaption_volatility_converter.html">SwaptionVolatilityConverter</a>(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, *wrapper, *<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a>,</div>
<div class="line"><span class="lineno">  765</span>                                                                            *shortSwapIndex, Normal);</div>
<div class="line"><span class="lineno">  766</span>                            }</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>                            <span class="keywordflow">for</span> (Size k = 0; k &lt; strikeSpreads.size(); ++k) {</div>
<div class="line"><span class="lineno">  769</span>                                <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno">  770</span>                                    <span class="keywordflow">for</span> (Size j = 0; j &lt; underlyingTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  771</span>                                        Real strike = Null&lt;Real&gt;();</div>
<div class="line"><span class="lineno">  772</span>                                        <span class="keywordflow">if</span> (!simulateAtmOnly &amp;&amp; cube)</div>
<div class="line"><span class="lineno">  773</span>                                            strike = cube-&gt;atmStrike(optionTenors[i], underlyingTenors[j]) +</div>
<div class="line"><span class="lineno">  774</span>                                                     strikeSpreads[k];</div>
<div class="line"><span class="lineno">  775</span>                                        Real vol;</div>
<div class="line"><span class="lineno">  776</span>                                        <span class="keywordflow">if</span> (convertToNormal) {</div>
<div class="line"><span class="lineno">  777</span>                                            <span class="comment">// if not a normal volatility use the converted to convert to normal at</span></div>
<div class="line"><span class="lineno">  778</span>                                            <span class="comment">// given point</span></div>
<div class="line"><span class="lineno">  779</span>                                            vol = converter-&gt;<a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_swaption_volatility_converter.html#affb7c71beffe1005e48ae98615eaaf4c">convert</a>(wrapper-&gt;optionDateFromTenor(optionTenors[i]),</div>
<div class="line"><span class="lineno">  780</span>                                                                     underlyingTenors[j], strikeSpreads[k],</div>
<div class="line"><span class="lineno">  781</span>                                                                     wrapper-&gt;dayCounter(), Normal);</div>
<div class="line"><span class="lineno">  782</span>                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  783</span>                                            vol =</div>
<div class="line"><span class="lineno">  784</span>                                                wrapper-&gt;volatility(optionTenors[i], underlyingTenors[j], strike, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  785</span>                                        }</div>
<div class="line"><span class="lineno">  786</span>                                        QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno">  787</span>                                            <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol));</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>                                        Size index = i * underlyingTenors.size() * strikeSpreads.size() +</div>
<div class="line"><span class="lineno">  790</span>                                                     j * strikeSpreads.size() + k;</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>                                        simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  793</span>                                                           std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno">  794</span>                                                           std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  795</span>                                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  796</span>                                            absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno">  797</span>                                                                       std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno">  798</span>                                                                       std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno">  799</span>                                        }</div>
<div class="line"><span class="lineno">  800</span>                                        <span class="keyword">auto</span> tmp = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno">  801</span>                                        quotes[i * underlyingTenors.size() + j][k] = tmp;</div>
<div class="line"><span class="lineno">  802</span>                                        <span class="keywordflow">if</span> (k == atmSlice) {</div>
<div class="line"><span class="lineno">  803</span>                                            atmQuotes[i][j] = tmp;</div>
<div class="line"><span class="lineno">  804</span>                                            shift[i][j] =</div>
<div class="line"><span class="lineno">  805</span>                                                !convertToNormal &amp;&amp; wrapper-&gt;volatilityType() == ShiftedLognormal</div>
<div class="line"><span class="lineno">  806</span>                                                    ? wrapper-&gt;shift(optionTenors[i], underlyingTenors[j])</div>
<div class="line"><span class="lineno">  807</span>                                                    : 0.0;</div>
<div class="line"><span class="lineno">  808</span>                                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;AtmVol at &quot;</span> &lt;&lt; optionTenors.at(i) &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; underlyingTenors.at(j)</div>
<div class="line"><span class="lineno">  809</span>                                                              &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; vol &lt;&lt; <span class="stringliteral">&quot;, shift is &quot;</span> &lt;&lt; shift[i][j]</div>
<div class="line"><span class="lineno">  810</span>                                                              &lt;&lt; <span class="stringliteral">&quot;, (name,index) = (&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  811</span>                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  812</span>                                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;SmileVol at &quot;</span> &lt;&lt; optionTenors.at(i) &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; underlyingTenors.at(j)</div>
<div class="line"><span class="lineno">  813</span>                                                                &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; strikeSpreads.at(k) &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; vol</div>
<div class="line"><span class="lineno">  814</span>                                                                &lt;&lt; <span class="stringliteral">&quot;, (name,index) = (&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; index &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  815</span>                                        }</div>
<div class="line"><span class="lineno">  816</span>                                    }</div>
<div class="line"><span class="lineno">  817</span>                                }</div>
<div class="line"><span class="lineno">  818</span>                            }</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>                            std::vector&lt;std::vector&lt;Real&gt;&gt; coordinates(3);</div>
<div class="line"><span class="lineno">  821</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno">  822</span>                                coordinates[0].push_back(</div>
<div class="line"><span class="lineno">  823</span>                                    wrapper-&gt;timeFromReference(wrapper-&gt;optionDateFromTenor(optionTenors[i])));</div>
<div class="line"><span class="lineno">  824</span>                            }</div>
<div class="line"><span class="lineno">  825</span>                            <span class="keywordflow">for</span> (Size j = 0; j &lt; underlyingTenors.size(); ++j) {</div>
<div class="line"><span class="lineno">  826</span>                                coordinates[1].push_back(wrapper-&gt;swapLength(underlyingTenors[j]));</div>
<div class="line"><span class="lineno">  827</span>                            }</div>
<div class="line"><span class="lineno">  828</span>                            <span class="keywordflow">for</span> (Size k = 0; k &lt; strikeSpreads.size(); ++k) {</div>
<div class="line"><span class="lineno">  829</span>                                coordinates[2].push_back(strikeSpreads[k]);</div>
<div class="line"><span class="lineno">  830</span>                            }</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, coordinates);</div>
<div class="line"><span class="lineno">  833</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  834</span>                            <span class="keywordtype">bool</span> flatExtrapolation = <span class="keyword">true</span>; <span class="comment">// FIXME: get this from curve configuration</span></div>
<div class="line"><span class="lineno">  835</span>                            VolatilityType volType = convertToNormal ? Normal : wrapper-&gt;volatilityType();</div>
<div class="line"><span class="lineno">  836</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  837</span>                </div>
<div class="line"><span class="lineno">  838</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno">  839</span>                                <span class="keywordtype">bool</span> stickyStrike = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;swapVolSmileDynamics(name) == <span class="stringliteral">&quot;StickyStrike&quot;</span>;</div>
<div class="line"><span class="lineno">  840</span>                                QuantLib::ext::shared_ptr&lt;SwapIndex&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a>, shortSwapIndex;</div>
<div class="line"><span class="lineno">  841</span>                                QuantLib::ext::shared_ptr&lt;SwapIndex&gt; simSwapIndex, simShortSwapIndex;</div>
<div class="line"><span class="lineno">  842</span>                                <span class="keywordflow">if</span> (!stickyStrike) {</div>
<div class="line"><span class="lineno">  843</span>                                    <span class="keywordflow">if</span> (<a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a301b6c1dfdbe2500cb0b6a499e0b5734">addSwapIndexToSsm</a>(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>, continueOnError)) {</div>
<div class="line"><span class="lineno">  844</span>                                        simSwapIndex = *this-&gt;<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a>(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>, configuration);</div>
<div class="line"><span class="lineno">  845</span>                                    }</div>
<div class="line"><span class="lineno">  846</span>                                    <span class="keywordflow">if</span> (<a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a301b6c1dfdbe2500cb0b6a499e0b5734">addSwapIndexToSsm</a>(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a>, continueOnError)) {</div>
<div class="line"><span class="lineno">  847</span>                                        simShortSwapIndex = *this-&gt;<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a>(shortSwapIndexBase, configuration);</div>
<div class="line"><span class="lineno">  848</span>                                    }</div>
<div class="line"><span class="lineno">  849</span>                                    <span class="keywordflow">if</span> (simSwapIndex == <span class="keyword">nullptr</span> || simShortSwapIndex == <span class="keyword">nullptr</span>)</div>
<div class="line"><span class="lineno">  850</span>                                        stickyStrike = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  851</span>                                }</div>
<div class="line"><span class="lineno">  852</span>                                <span class="keywordflow">if</span>(!<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>.empty())</div>
<div class="line"><span class="lineno">  853</span>                                    <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a> = *initMarket-&gt;swapIndex(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>, configuration);</div>
<div class="line"><span class="lineno">  854</span>                                <span class="keywordflow">if</span>(!<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a>.empty())</div>
<div class="line"><span class="lineno">  855</span>                                    shortSwapIndex = *initMarket-&gt;swapIndex(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a>, configuration);</div>
<div class="line"><span class="lineno">  856</span>                                svp =</div>
<div class="line"><span class="lineno">  857</span>                                    Handle&lt;SwaptionVolatilityStructure&gt;(QuantLib::ext::make_shared&lt;SpreadedSwaptionVolatility&gt;(</div>
<div class="line"><span class="lineno">  858</span>                                        wrapper, optionTenors, underlyingTenors, strikeSpreads, quotes, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a>,</div>
<div class="line"><span class="lineno">  859</span>                                        shortSwapIndex, simSwapIndex, simShortSwapIndex, !stickyStrike));</div>
<div class="line"><span class="lineno">  860</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  861</span>                                Handle&lt;SwaptionVolatilityStructure&gt; atm;</div>
<div class="line"><span class="lineno">  862</span>                                atm = Handle&lt;SwaptionVolatilityStructure&gt;(QuantLib::ext::make_shared&lt;SwaptionVolatilityMatrix&gt;(</div>
<div class="line"><span class="lineno">  863</span>                                    wrapper-&gt;calendar(), wrapper-&gt;businessDayConvention(), optionTenors,</div>
<div class="line"><span class="lineno">  864</span>                                    underlyingTenors, atmQuotes, dc, flatExtrapolation, volType, shift));</div>
<div class="line"><span class="lineno">  865</span>                                atm-&gt;enableExtrapolation(); <span class="comment">// see below for svp, take this from T0 config?</span></div>
<div class="line"><span class="lineno">  866</span>                                <span class="keywordflow">if</span> (simulateAtmOnly) {</div>
<div class="line"><span class="lineno">  867</span>                                    <span class="keywordflow">if</span> (isAtm) {</div>
<div class="line"><span class="lineno">  868</span>                                        svp = atm;</div>
<div class="line"><span class="lineno">  869</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  870</span>                                        <span class="comment">// floating reference date matrix in sim market</span></div>
<div class="line"><span class="lineno">  871</span>                                        <span class="comment">// if we have a cube, we keep the vol spreads constant under scenarios</span></div>
<div class="line"><span class="lineno">  872</span>                                        <span class="comment">// notice that cube is from todaysmarket, so it has a fixed reference date,</span></div>
<div class="line"><span class="lineno">  873</span>                                        <span class="comment">// which means that we keep the smiles constant in terms of vol spreads when</span></div>
<div class="line"><span class="lineno">  874</span>                                        <span class="comment">// moving forward in time; notice also that the volatility will be &quot;sticky</span></div>
<div class="line"><span class="lineno">  875</span>                                        <span class="comment">// strike&quot;, i.e. it will not react to changes in the ATM level</span></div>
<div class="line"><span class="lineno">  876</span>                                        svp = Handle&lt;SwaptionVolatilityStructure&gt;(</div>
<div class="line"><span class="lineno">  877</span>                                            QuantLib::ext::make_shared&lt;SwaptionVolatilityConstantSpread&gt;(atm, wrapper));</div>
<div class="line"><span class="lineno">  878</span>                                    }</div>
<div class="line"><span class="lineno">  879</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  880</span>                                    <span class="keywordflow">if</span> (isCube) {</div>
<div class="line"><span class="lineno">  881</span>                                        QuantLib::ext::shared_ptr&lt;SwaptionVolatilityCube&gt; tmp(<span class="keyword">new</span> <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_swaption_vol_cube2.html">QuantExt::SwaptionVolCube2</a>(</div>
<div class="line"><span class="lineno">  882</span>                                            atm, optionTenors, underlyingTenors, strikeSpreads, quotes,</div>
<div class="line"><span class="lineno">  883</span>                                            *initMarket-&gt;swapIndex(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>, configuration),</div>
<div class="line"><span class="lineno">  884</span>                                            *initMarket-&gt;swapIndex(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a>, configuration), <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  885</span>                                            flatExtrapolation, <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  886</span>                                        tmp-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  887</span>                                        svp = Handle&lt;SwaptionVolatilityStructure&gt;(</div>
<div class="line"><span class="lineno">  888</span>                                            QuantLib::ext::make_shared&lt;SwaptionVolCubeWithATM&gt;(tmp));</div>
<div class="line"><span class="lineno">  889</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  890</span>                                        svp = atm;</div>
<div class="line"><span class="lineno">  891</span>                                    }</div>
<div class="line"><span class="lineno">  892</span>                                }</div>
<div class="line"><span class="lineno">  893</span>                            }</div>
<div class="line"><span class="lineno">  894</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  895</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;swapVolDecayMode();</div>
<div class="line"><span class="lineno">  896</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno">  897</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Dynamic (&quot;</span> &lt;&lt; wrapper-&gt;volatilityType() &lt;&lt; <span class="stringliteral">&quot;) yield vols (&quot;</span> &lt;&lt; decayModeString</div>
<div class="line"><span class="lineno">  898</span>                                            &lt;&lt; <span class="stringliteral">&quot;) for qualifier &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>                            QL_REQUIRE(!QuantLib::ext::dynamic_pointer_cast&lt;ProxySwaptionVolatility&gt;(*wrapper),</div>
<div class="line"><span class="lineno">  901</span>                                <span class="stringliteral">&quot;DynamicSwaptionVolatilityMatrix does not support ProxySwaptionVolatility surface&quot;</span>);</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>                            QuantLib::ext::shared_ptr&lt;SwaptionVolatilityStructure&gt; atmSlice;</div>
<div class="line"><span class="lineno">  904</span>                            <span class="keywordflow">if</span> (isAtm)</div>
<div class="line"><span class="lineno">  905</span>                                atmSlice = *wrapper;</div>
<div class="line"><span class="lineno">  906</span>                            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  907</span>                                <span class="keyword">auto</span> c = QuantLib::ext::dynamic_pointer_cast&lt;SwaptionVolCubeWithATM&gt;(*wrapper);</div>
<div class="line"><span class="lineno">  908</span>                                QL_REQUIRE(c, <span class="stringliteral">&quot;internal error - expected swaption cube to be SwaptionVolCubeWithATM.&quot;</span>);</div>
<div class="line"><span class="lineno">  909</span>                                atmSlice = *c-&gt;cube()-&gt;atmVol();</div>
<div class="line"><span class="lineno">  910</span>                            }</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>                            <span class="keywordflow">if</span> (isCube)</div>
<div class="line"><span class="lineno">  913</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Only ATM slice is considered from init market&#39;s cube&quot;</span>);</div>
<div class="line"><span class="lineno">  914</span>                            QuantLib::ext::shared_ptr&lt;QuantLib::SwaptionVolatilityStructure&gt; svolp =</div>
<div class="line"><span class="lineno">  915</span>                                QuantLib::ext::make_shared&lt;QuantExt::DynamicSwaptionVolatilityMatrix&gt;(</div>
<div class="line"><span class="lineno">  916</span>                                    atmSlice, 0, NullCalendar(), decayMode);</div>
<div class="line"><span class="lineno">  917</span>                            svp = Handle&lt;SwaptionVolatilityStructure&gt;(svolp);</div>
<div class="line"><span class="lineno">  918</span>                        }</div>
<div class="line"><span class="lineno">  919</span>                        svp-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  920</span>                        svp-&gt;enableExtrapolation(); <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Simulation market &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yield volatility type = &quot;</span> &lt;&lt; svp-&gt;volatilityType());</div>
<div class="line"><span class="lineno">  923</span> </div>
<div class="line"><span class="lineno">  924</span>                        <span class="keywordflow">if</span> (param.first == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">RiskFactorKey::KeyType::SwaptionVolatility</a>) {</div>
<div class="line"><span class="lineno">  925</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa4e8780cb54cc1f2120dc22af3b903ee">swaptionCurves_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), svp));</div>
<div class="line"><span class="lineno">  926</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#acb886da44dcd5171d9371487aca3b1cf">swaptionIndexBases_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno">  927</span>                                                                 make_pair(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">shortSwapIndexBase</a>, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>)));</div>
<div class="line"><span class="lineno">  928</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#acb886da44dcd5171d9371487aca3b1cf">swaptionIndexBases_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno">  929</span>                                                                 make_pair(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">swapIndexBase</a>)));</div>
<div class="line"><span class="lineno">  930</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  931</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae14cb3cad5042b1b2cdb640b4a11a3c6">yieldVolCurves_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), svp));</div>
<div class="line"><span class="lineno">  932</span>                        }</div>
<div class="line"><span class="lineno">  933</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  934</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno">  935</span>                    }</div>
<div class="line"><span class="lineno">  936</span>                }</div>
<div class="line"><span class="lineno">  937</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab">RiskFactorKey::KeyType::OptionletVolatility</a>:</div>
<div class="line"><span class="lineno">  940</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno">  941</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  942</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  943</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; cap/floor volatility curve...&quot;</span>);</div>
<div class="line"><span class="lineno">  944</span>                        Handle&lt;OptionletVolatilityStructure&gt; wrapper = initMarket-&gt;capFloorVol(name, configuration);</div>
<div class="line"><span class="lineno">  945</span>                        <span class="keyword">auto</span> [iborIndexName, rateComputationPeriod] =</div>
<div class="line"><span class="lineno">  946</span>                            initMarket-&gt;capFloorVolIndexBase(name, configuration);</div>
<div class="line"><span class="lineno">  947</span>                        QuantLib::ext::shared_ptr&lt;IborIndex&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a> =</div>
<div class="line"><span class="lineno">  948</span>                            iborIndexName.empty() ? nullptr : <a class="code hl_functionRef" href="../ored/group__utilities.html#ga2d18ab5807f92319c9db2c13f4904738">parseIborIndex</a>(iborIndexName);</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Initial market cap/floor volatility type = &quot;</span> &lt;&lt; wrapper-&gt;volatilityType());</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>                        Handle&lt;OptionletVolatilityStructure&gt; hCapletVol;</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>                        <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno">  955</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno">  956</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating Cap/Floor Optionlet vols for key &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>                            <span class="comment">// Try to get the ibor index that the cap floor structure relates to</span></div>
<div class="line"><span class="lineno">  959</span>                            <span class="comment">// We use this to convert Period to Date below to sample from `wrapper`</span></div>
<div class="line"><span class="lineno">  960</span>                            Natural settleDays = 0;</div>
<div class="line"><span class="lineno">  961</span>                            <span class="keywordtype">bool</span> isOis = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  962</span>                            Calendar iborCalendar;</div>
<div class="line"><span class="lineno">  963</span>                            Size onSettlementDays = 0;</div>
<div class="line"><span class="lineno">  964</span> </div>
<div class="line"><span class="lineno">  965</span>                            <span class="comment">// get the curve config for the index, or if not available for its ccy</span></div>
<div class="line"><span class="lineno">  966</span>                            QuantLib::ext::shared_ptr&lt;CapFloorVolatilityCurveConfig&gt; config;</div>
<div class="line"><span class="lineno">  967</span>                            <span class="keywordflow">if</span> (<a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.hasCapFloorVolCurveConfig(name)) {</div>
<div class="line"><span class="lineno">  968</span>                                config = <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.capFloorVolCurveConfig(name);</div>
<div class="line"><span class="lineno">  969</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  970</span>                                <span class="keywordflow">if</span> (<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a> &amp;&amp; <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.hasCapFloorVolCurveConfig(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>-&gt;currency().code())) {</div>
<div class="line"><span class="lineno">  971</span>                                    config = <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.capFloorVolCurveConfig(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>-&gt;currency().code());</div>
<div class="line"><span class="lineno">  972</span>                                }</div>
<div class="line"><span class="lineno">  973</span>                            }</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>                            <span class="comment">// get info from the config if we have one</span></div>
<div class="line"><span class="lineno">  976</span>                            <span class="keywordflow">if</span> (config) {</div>
<div class="line"><span class="lineno">  977</span>                                settleDays = config-&gt;settleDays();</div>
<div class="line"><span class="lineno">  978</span>                                onSettlementDays = config-&gt;onCapSettlementDays();</div>
<div class="line"><span class="lineno">  979</span>                            }</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>                            <span class="comment">// derive info from the ibor index</span></div>
<div class="line"><span class="lineno">  982</span>                            <span class="keywordflow">if</span> (<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>) {</div>
<div class="line"><span class="lineno">  983</span>                                iborCalendar = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>-&gt;fixingCalendar();</div>
<div class="line"><span class="lineno">  984</span>                                isOis = QuantLib::ext::dynamic_pointer_cast&lt;OvernightIndex&gt;(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>) != <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="lineno">  985</span>                            }</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>                            vector&lt;Period&gt; optionTenors = parameters-&gt;capFloorVolExpiries(name);</div>
<div class="line"><span class="lineno">  988</span>                            vector&lt;Date&gt; optionDates(optionTenors.size());</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span>                            vector&lt;Real&gt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a> = parameters-&gt;capFloorVolStrikes(name);</div>
<div class="line"><span class="lineno">  991</span>                            <span class="keywordtype">bool</span> isAtm = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  992</span>                            <span class="comment">// Strikes may be empty here which means that an ATM curve has been configured</span></div>
<div class="line"><span class="lineno">  993</span>                            <span class="keywordflow">if</span> (<a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.empty()) {</div>
<div class="line"><span class="lineno">  994</span>                                QL_REQUIRE(</div>
<div class="line"><span class="lineno">  995</span>                                    parameters-&gt;capFloorVolIsAtm(name),</div>
<div class="line"><span class="lineno">  996</span>                                    <span class="stringliteral">&quot;Strikes for &quot;</span></div>
<div class="line"><span class="lineno">  997</span>                                        &lt;&lt; name</div>
<div class="line"><span class="lineno">  998</span>                                        &lt;&lt; <span class="stringliteral">&quot; is empty in simulation parameters so expected its ATM flag to be true&quot;</span>);</div>
<div class="line"><span class="lineno">  999</span>                                <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a> = {0.0};</div>
<div class="line"><span class="lineno"> 1000</span>                                isAtm = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1001</span>                            }</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes(</div>
<div class="line"><span class="lineno"> 1004</span>                                optionTenors.size(), vector&lt;Handle&lt;Quote&gt;&gt;(<a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(), Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;cap floor use adjusted option pillars = &quot;</span> &lt;&lt; std::boolalpha &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;capFloorVolAdjustOptionletPillars());</div>
<div class="line"><span class="lineno"> 1007</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;have ibor index = &quot;</span> &lt;&lt; std::boolalpha &lt;&lt; (<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a> != <span class="keyword">nullptr</span>));</div>
<div class="line"><span class="lineno"> 1008</span> </div>
<div class="line"><span class="lineno"> 1009</span>                            Rate atmStrike = Null&lt;Rate&gt;();</div>
<div class="line"><span class="lineno"> 1010</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno"> 1011</span> </div>
<div class="line"><span class="lineno"> 1012</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;capFloorVolAdjustOptionletPillars() &amp;&amp; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>) {</div>
<div class="line"><span class="lineno"> 1013</span>                                    <span class="comment">// If we ask for cap pillars at tenors t_i for i = 1,...,N, we should attempt to</span></div>
<div class="line"><span class="lineno"> 1014</span>                                    <span class="comment">// place the optionlet pillars at the fixing date of the last optionlet in the cap</span></div>
<div class="line"><span class="lineno"> 1015</span>                                    <span class="comment">// with tenor t_i, if capFloorVolAdjustOptionletPillars is true.</span></div>
<div class="line"><span class="lineno"> 1016</span>                                    <span class="keywordflow">if</span>(isOis) {</div>
<div class="line"><span class="lineno"> 1017</span>                                        Leg capFloor =</div>
<div class="line"><span class="lineno"> 1018</span>                                            <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html">MakeOISCapFloor</a>(</div>
<div class="line"><span class="lineno"> 1019</span>                                                CapFloor::Cap, optionTenors[i],</div>
<div class="line"><span class="lineno"> 1020</span>                                                QuantLib::ext::dynamic_pointer_cast&lt;QuantLib::OvernightIndex&gt;(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>),</div>
<div class="line"><span class="lineno"> 1021</span>                                                rateComputationPeriod, 0.0)</div>
<div class="line"><span class="lineno"> 1022</span>                                                .<a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a6842ee3fbbf88963ed4d02e7ddb70c22">withTelescopicValueDates</a>(<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1023</span>                                                .<a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a5c92a8fb4d7a5de84d60cb01ca39a864">withSettlementDays</a>(onSettlementDays);</div>
<div class="line"><span class="lineno"> 1024</span>                                        <span class="keywordflow">if</span> (capFloor.empty()) {</div>
<div class="line"><span class="lineno"> 1025</span>                                            optionDates[i] = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + 1;</div>
<div class="line"><span class="lineno"> 1026</span>                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1027</span>                                            <span class="keyword">auto</span> lastCoupon = QuantLib::ext::dynamic_pointer_cast&lt;</div>
<div class="line"><span class="lineno"> 1028</span>                                                <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_capped_floored_overnight_indexed_coupon.html">QuantExt::CappedFlooredOvernightIndexedCoupon</a>&gt;(capFloor.back());</div>
<div class="line"><span class="lineno"> 1029</span>                                            QL_REQUIRE(lastCoupon, <span class="stringliteral">&quot;SSM internal error, could not cast to &quot;</span></div>
<div class="line"><span class="lineno"> 1030</span>                                                                   <span class="stringliteral">&quot;CappedFlooredOvernightIndexedCoupon &quot;</span></div>
<div class="line"><span class="lineno"> 1031</span>                                                                   <span class="stringliteral">&quot;when building optionlet vol for &#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1032</span>                                                                       &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39; (index=&quot;</span> &lt;&lt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>-&gt;name()</div>
<div class="line"><span class="lineno"> 1033</span>                                                                       &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1034</span>                                            optionDates[i] =</div>
<div class="line"><span class="lineno"> 1035</span>                                                std::max(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + 1, lastCoupon-&gt;underlying()-&gt;fixingDates().front());</div>
<div class="line"><span class="lineno"> 1036</span>                                        }</div>
<div class="line"><span class="lineno"> 1037</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1038</span>                                        QuantLib::ext::shared_ptr&lt;CapFloor&gt; capFloor =</div>
<div class="line"><span class="lineno"> 1039</span>                                            MakeCapFloor(CapFloor::Cap, optionTenors[i], <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>, 0.0, 0 * Days);</div>
<div class="line"><span class="lineno"> 1040</span>                                        <span class="keywordflow">if</span> (capFloor-&gt;floatingLeg().empty()) {</div>
<div class="line"><span class="lineno"> 1041</span>                                            optionDates[i] = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + 1;</div>
<div class="line"><span class="lineno"> 1042</span>                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1043</span>                                            optionDates[i] =</div>
<div class="line"><span class="lineno"> 1044</span>                                                std::max(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + 1, capFloor-&gt;lastFloatingRateCoupon()-&gt;fixingDate());</div>
<div class="line"><span class="lineno"> 1045</span>                                        }</div>
<div class="line"><span class="lineno"> 1046</span>                                    }</div>
<div class="line"><span class="lineno"> 1047</span>                                    QL_REQUIRE(i == 0 || optionDates[i] &gt; optionDates[i - 1],</div>
<div class="line"><span class="lineno"> 1048</span>                                               <span class="stringliteral">&quot;SSM: got non-increasing option dates &quot;</span></div>
<div class="line"><span class="lineno"> 1049</span>                                                   &lt;&lt; optionDates[i - 1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; optionDates[i] &lt;&lt; <span class="stringliteral">&quot; for tenors &quot;</span></div>
<div class="line"><span class="lineno"> 1050</span>                                                   &lt;&lt; optionTenors[i - 1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; optionTenors[i] &lt;&lt; <span class="stringliteral">&quot; for index &quot;</span></div>
<div class="line"><span class="lineno"> 1051</span>                                                   &lt;&lt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>-&gt;name());</div>
<div class="line"><span class="lineno"> 1052</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1053</span>                                    <span class="comment">// Otherwise, just place the optionlet pillars at the configured tenors.</span></div>
<div class="line"><span class="lineno"> 1054</span>                                    optionDates[i] = wrapper-&gt;optionDateFromTenor(optionTenors[i]);</div>
<div class="line"><span class="lineno"> 1055</span>                                    <span class="keywordflow">if</span> (iborCalendar != Calendar()) {</div>
<div class="line"><span class="lineno"> 1056</span>                                        <span class="comment">// In case the original cap floor surface has the incorrect calendar configured.</span></div>
<div class="line"><span class="lineno"> 1057</span>                                        optionDates[i] = iborCalendar.adjust(optionDates[i]);</div>
<div class="line"><span class="lineno"> 1058</span>                                    }</div>
<div class="line"><span class="lineno"> 1059</span>                                }</div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Option [tenor, date] pair is [&quot;</span> &lt;&lt; optionTenors[i] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno"> 1062</span>                                                                      &lt;&lt; io::iso_date(optionDates[i]) &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>                                <span class="comment">// If ATM, use initial market&#39;s discount curve and ibor index to calculate ATM rate</span></div>
<div class="line"><span class="lineno"> 1065</span>                                <span class="keywordflow">if</span> (isAtm) {</div>
<div class="line"><span class="lineno"> 1066</span>                                    QL_REQUIRE(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a> != <span class="keyword">nullptr</span>,</div>
<div class="line"><span class="lineno"> 1067</span>                                               <span class="stringliteral">&quot;SSM: Expected ibor index for key &quot;</span></div>
<div class="line"><span class="lineno"> 1068</span>                                                   &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; from the key or a curve config for a ccy&quot;</span>);</div>
<div class="line"><span class="lineno"> 1069</span>                                    <span class="keyword">auto</span> t0_iborIndex = *initMarket-&gt;iborIndex(</div>
<div class="line"><span class="lineno"> 1070</span>                                        IndexNameTranslator::instance().oreName(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>-&gt;name()), configuration);</div>
<div class="line"><span class="lineno"> 1071</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;capFloorVolUseCapAtm()) {</div>
<div class="line"><span class="lineno"> 1072</span>                                        QL_REQUIRE(!isOis, <span class="stringliteral">&quot;SSM: capFloorVolUseCapATM not supported for OIS indices (&quot;</span></div>
<div class="line"><span class="lineno"> 1073</span>                                                               &lt;&lt; t0_iborIndex-&gt;name() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno"> 1074</span>                                        QuantLib::ext::shared_ptr&lt;CapFloor&gt; cap =</div>
<div class="line"><span class="lineno"> 1075</span>                                            MakeCapFloor(CapFloor::Cap, optionTenors[i], t0_iborIndex, 0.0, 0 * Days);</div>
<div class="line"><span class="lineno"> 1076</span>                                        atmStrike = cap-&gt;atmRate(**initMarket-&gt;discountCurve(name, configuration));</div>
<div class="line"><span class="lineno"> 1077</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1078</span>                                        <span class="keywordflow">if</span> (isOis) {</div>
<div class="line"><span class="lineno"> 1079</span>                                            Leg capFloor =</div>
<div class="line"><span class="lineno"> 1080</span>                                                <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html">MakeOISCapFloor</a>(CapFloor::Cap, optionTenors[i],</div>
<div class="line"><span class="lineno"> 1081</span>                                                                QuantLib::ext::dynamic_pointer_cast&lt;OvernightIndex&gt;(t0_iborIndex),</div>
<div class="line"><span class="lineno"> 1082</span>                                                                rateComputationPeriod, 0.0)</div>
<div class="line"><span class="lineno"> 1083</span>                                                    .<a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a6842ee3fbbf88963ed4d02e7ddb70c22">withTelescopicValueDates</a>(<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno"> 1084</span>                                                    .<a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a5c92a8fb4d7a5de84d60cb01ca39a864">withSettlementDays</a>(onSettlementDays);</div>
<div class="line"><span class="lineno"> 1085</span>                                            <span class="keywordflow">if</span> (capFloor.empty()) {</div>
<div class="line"><span class="lineno"> 1086</span>                                                atmStrike = t0_iborIndex-&gt;fixing(optionDates[i]);</div>
<div class="line"><span class="lineno"> 1087</span>                                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1088</span>                                                <span class="keyword">auto</span> lastCoupon =</div>
<div class="line"><span class="lineno"> 1089</span>                                                    QuantLib::ext::dynamic_pointer_cast&lt;CappedFlooredOvernightIndexedCoupon&gt;(</div>
<div class="line"><span class="lineno"> 1090</span>                                                        capFloor.back());</div>
<div class="line"><span class="lineno"> 1091</span>                                                QL_REQUIRE(lastCoupon, <span class="stringliteral">&quot;SSM internal error, could not cast to &quot;</span></div>
<div class="line"><span class="lineno"> 1092</span>                                                                       <span class="stringliteral">&quot;CappedFlooredOvernightIndexedCoupon &quot;</span></div>
<div class="line"><span class="lineno"> 1093</span>                                                                       <span class="stringliteral">&quot;when building optionlet vol for &#39;&quot;</span></div>
<div class="line"><span class="lineno"> 1094</span>                                                                           &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;, index=&quot;</span> &lt;&lt; t0_iborIndex-&gt;name());</div>
<div class="line"><span class="lineno"> 1095</span>                                                atmStrike = lastCoupon-&gt;underlying()-&gt;rate();</div>
<div class="line"><span class="lineno"> 1096</span>                                            }</div>
<div class="line"><span class="lineno"> 1097</span>                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1098</span>                                            atmStrike = t0_iborIndex-&gt;fixing(optionDates[i]);</div>
<div class="line"><span class="lineno"> 1099</span>                                        }</div>
<div class="line"><span class="lineno"> 1100</span>                                    }</div>
<div class="line"><span class="lineno"> 1101</span>                                }</div>
<div class="line"><span class="lineno"> 1102</span> </div>
<div class="line"><span class="lineno"> 1103</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(); ++j) {</div>
<div class="line"><span class="lineno"> 1104</span>                                    Real strike = isAtm ? atmStrike : <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>[j];</div>
<div class="line"><span class="lineno"> 1105</span>                                    Real vol =</div>
<div class="line"><span class="lineno"> 1106</span>                                        wrapper-&gt;volatility(optionDates[i], strike, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1107</span>                                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Vol at [date, strike] pair [&quot;</span> &lt;&lt; optionDates[i] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; std::fixed</div>
<div class="line"><span class="lineno"> 1108</span>                                                                        &lt;&lt; std::setprecision(4) &lt;&lt; strike &lt;&lt; <span class="stringliteral">&quot;] is &quot;</span></div>
<div class="line"><span class="lineno"> 1109</span>                                                                        &lt;&lt; std::setprecision(12) &lt;&lt; vol);</div>
<div class="line"><span class="lineno"> 1110</span>                                    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q =</div>
<div class="line"><span class="lineno"> 1111</span>                                        QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol);</div>
<div class="line"><span class="lineno"> 1112</span>                                    Size index = i * <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size() + j;</div>
<div class="line"><span class="lineno"> 1113</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1114</span>                                                       std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 1115</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1116</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1117</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1118</span>                                                                   std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 1119</span>                                                                   std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 1120</span>                                    }</div>
<div class="line"><span class="lineno"> 1121</span>                                    quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 1122</span>                                }</div>
<div class="line"><span class="lineno"> 1123</span>                            }</div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span>                            std::vector&lt;std::vector&lt;Real&gt;&gt; coordinates(2);</div>
<div class="line"><span class="lineno"> 1126</span>                            <span class="keywordflow">for</span>(Size i=0;i&lt;optionTenors.size();++i) {</div>
<div class="line"><span class="lineno"> 1127</span>                                coordinates[0].push_back(</div>
<div class="line"><span class="lineno"> 1128</span>                                    wrapper-&gt;timeFromReference(wrapper-&gt;optionDateFromTenor(optionTenors[i])));</div>
<div class="line"><span class="lineno"> 1129</span>                            }</div>
<div class="line"><span class="lineno"> 1130</span>                            <span class="keywordflow">for</span>(Size j=0;j&lt;<a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size();++j) {</div>
<div class="line"><span class="lineno"> 1131</span>                                coordinates[1].push_back(isAtm ? atmStrike : strikes[j]);</div>
<div class="line"><span class="lineno"> 1132</span>                            }</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, coordinates);</div>
<div class="line"><span class="lineno"> 1135</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1138</span> </div>
<div class="line"><span class="lineno"> 1139</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1140</span>                                hCapletVol = Handle&lt;OptionletVolatilityStructure&gt;(</div>
<div class="line"><span class="lineno"> 1141</span>                                    QuantLib::ext::make_shared&lt;QuantExt::SpreadedOptionletVolatility2&gt;(wrapper, optionDates,</div>
<div class="line"><span class="lineno"> 1142</span>                                                                                               strikes, quotes));</div>
<div class="line"><span class="lineno"> 1143</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1144</span>                                <span class="comment">// FIXME: Works as of today only, i.e. for sensitivity/scenario analysis.</span></div>
<div class="line"><span class="lineno"> 1145</span>                                <span class="comment">// TODO: Build floating reference date StrippedOptionlet class for MC path generators</span></div>
<div class="line"><span class="lineno"> 1146</span>                                QuantLib::ext::shared_ptr&lt;StrippedOptionlet&gt; optionlet = QuantLib::ext::make_shared&lt;StrippedOptionlet&gt;(</div>
<div class="line"><span class="lineno"> 1147</span>                                    settleDays, wrapper-&gt;calendar(), wrapper-&gt;businessDayConvention(), <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>,</div>
<div class="line"><span class="lineno"> 1148</span>                                    optionDates, strikes, quotes, dc, wrapper-&gt;volatilityType(),</div>
<div class="line"><span class="lineno"> 1149</span>                                    wrapper-&gt;displacement());</div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>                                hCapletVol = Handle&lt;OptionletVolatilityStructure&gt;(</div>
<div class="line"><span class="lineno"> 1152</span>                                    QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_stripped_optionlet_adapter.html">QuantExt::StrippedOptionletAdapter&lt;LinearFlat, LinearFlat&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 1153</span>                                        optionlet));</div>
<div class="line"><span class="lineno"> 1154</span>                            }</div>
<div class="line"><span class="lineno"> 1155</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1156</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;capFloorVolDecayMode();</div>
<div class="line"><span class="lineno"> 1157</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>                            QL_REQUIRE(!QuantLib::ext::dynamic_pointer_cast&lt;ProxyOptionletVolatility&gt;(*wrapper), </div>
<div class="line"><span class="lineno"> 1160</span>                                <span class="stringliteral">&quot;DynamicOptionletVolatilityStructure does not support ProxyOptionletVolatility surface.&quot;</span>);</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>                            QuantLib::ext::shared_ptr&lt;OptionletVolatilityStructure&gt; capletVol =</div>
<div class="line"><span class="lineno"> 1163</span>                                QuantLib::ext::make_shared&lt;DynamicOptionletVolatilityStructure&gt;(*wrapper, 0, NullCalendar(),</div>
<div class="line"><span class="lineno"> 1164</span>                                                                                        decayMode);</div>
<div class="line"><span class="lineno"> 1165</span>                            hCapletVol = Handle&lt;OptionletVolatilityStructure&gt;(capletVol);</div>
<div class="line"><span class="lineno"> 1166</span>                        }</div>
<div class="line"><span class="lineno"> 1167</span>                        hCapletVol-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1168</span>                        hCapletVol-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1169</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a0b4a7aa3ac7df041878c7e173a3c64ec">capFloorCurves_</a>.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1170</span>                                                std::forward_as_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 1171</span>                                                std::forward_as_tuple(hCapletVol));</div>
<div class="line"><span class="lineno"> 1172</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#afea30f55f4e6ac11d14c3389276aa3d7">capFloorIndexBase_</a>.emplace(</div>
<div class="line"><span class="lineno"> 1173</span>                            std::piecewise_construct, std::forward_as_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 1174</span>                            std::forward_as_tuple(std::make_pair(iborIndexName, rateComputationPeriod)));</div>
<div class="line"><span class="lineno"> 1175</span> </div>
<div class="line"><span class="lineno"> 1176</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulation market cap/floor volatility type = &quot;</span> &lt;&lt; hCapletVol-&gt;volatilityType());</div>
<div class="line"><span class="lineno"> 1177</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1178</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1179</span>                    }</div>
<div class="line"><span class="lineno"> 1180</span>                }</div>
<div class="line"><span class="lineno"> 1181</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb">RiskFactorKey::KeyType::SurvivalProbability</a>:</div>
<div class="line"><span class="lineno"> 1184</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 1185</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1186</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1187</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; default curve..&quot;</span>);</div>
<div class="line"><span class="lineno"> 1188</span>                        <span class="keyword">auto</span> wrapper = initMarket-&gt;defaultCurve(name, configuration);</div>
<div class="line"><span class="lineno"> 1189</span>                        vector&lt;Handle&lt;Quote&gt;&gt; quotes;</div>
<div class="line"><span class="lineno"> 1190</span> </div>
<div class="line"><span class="lineno"> 1191</span>                        QL_REQUIRE(parameters-&gt;defaultTenors(name).front() &gt; 0 * Days,</div>
<div class="line"><span class="lineno"> 1192</span>                                   <span class="stringliteral">&quot;default curve tenors must not include t=0&quot;</span>);</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>                        vector&lt;Date&gt; dates(1, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>);</div>
<div class="line"><span class="lineno"> 1195</span>                        vector&lt;Real&gt; times(1, 0.0);</div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span>                        DayCounter dc = wrapper-&gt;curve()-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1198</span>            </div>
<div class="line"><span class="lineno"> 1199</span>                        <span class="keywordflow">for</span> (Size i = 0; i &lt; parameters-&gt;defaultTenors(name).<a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a777e216dee6069b548bb87da7152699e">size</a>(); i++) {</div>
<div class="line"><span class="lineno"> 1200</span>                            dates.push_back(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + parameters-&gt;defaultTenors(name)[i]);</div>
<div class="line"><span class="lineno"> 1201</span>                            times.push_back(dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, dates.back()));</div>
<div class="line"><span class="lineno"> 1202</span>                        }</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>                        QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(<span class="keyword">new</span> SimpleQuote(1.0));</div>
<div class="line"><span class="lineno"> 1205</span>                        quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno"> 1206</span>                        <span class="keywordflow">for</span> (Size i = 0; i &lt; dates.size() - 1; i++) {</div>
<div class="line"><span class="lineno"> 1207</span>                            Probability prob = wrapper-&gt;curve()-&gt;survivalProbability(dates[i + 1], <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1208</span>                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q =</div>
<div class="line"><span class="lineno"> 1209</span>                                QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 1.0 : prob);</div>
<div class="line"><span class="lineno"> 1210</span>                            <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno"> 1211</span>                            <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 1212</span>                                simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1213</span>                                                   std::forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno"> 1214</span>                                                   std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1215</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;ScenarioSimMarket default curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; survival[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; prob);</div>
<div class="line"><span class="lineno"> 1216</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1217</span>                                    absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1218</span>                                                               std::forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno"> 1219</span>                                                               std::forward_as_tuple(prob));</div>
<div class="line"><span class="lineno"> 1220</span>                                }</div>
<div class="line"><span class="lineno"> 1221</span>                            }</div>
<div class="line"><span class="lineno"> 1222</span>                            Handle&lt;Quote&gt; qh(q);</div>
<div class="line"><span class="lineno"> 1223</span>                            quotes.push_back(qh);</div>
<div class="line"><span class="lineno"> 1224</span>                        }</div>
<div class="line"><span class="lineno"> 1225</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name,</div>
<div class="line"><span class="lineno"> 1226</span>                                     {std::vector&lt;Real&gt;(std::next(times.begin(), 1), times.end())});</div>
<div class="line"><span class="lineno"> 1227</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1228</span>                        Calendar cal = <a class="code hl_functionRef" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14">ore::data::parseCalendar</a>(parameters-&gt;defaultCurveCalendar(name));</div>
<div class="line"><span class="lineno"> 1229</span>                        Handle&lt;DefaultProbabilityTermStructure&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a>;</div>
<div class="line"><span class="lineno"> 1230</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1231</span>                            <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a> = Handle&lt;DefaultProbabilityTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1232</span>                                QuantLib::ext::make_shared&lt;QuantExt::SpreadedSurvivalProbabilityTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1233</span>                                    wrapper-&gt;curve(), times, quotes,</div>
<div class="line"><span class="lineno"> 1234</span>                                    parameters-&gt;defaultCurveExtrapolation() == <span class="stringliteral">&quot;FlatZero&quot;</span></div>
<div class="line"><span class="lineno"> 1235</span>                                        ? QuantExt::SpreadedSurvivalProbabilityTermStructure::Extrapolation::flatZero</div>
<div class="line"><span class="lineno"> 1236</span>                                        : QuantExt::SpreadedSurvivalProbabilityTermStructure::Extrapolation::flatFwd));</div>
<div class="line"><span class="lineno"> 1237</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1238</span>                            <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a> = Handle&lt;DefaultProbabilityTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1239</span>                                QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_survival_probability_curve.html">QuantExt::SurvivalProbabilityCurve&lt;LogLinear&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 1240</span>                                    dates, quotes, dc, cal, std::vector&lt;Handle&lt;Quote&gt;&gt;(), std::vector&lt;Date&gt;(),</div>
<div class="line"><span class="lineno"> 1241</span>                                    LogLinear(),</div>
<div class="line"><span class="lineno"> 1242</span>                                    parameters-&gt;defaultCurveExtrapolation() == <span class="stringliteral">&quot;FlatZero&quot;</span></div>
<div class="line"><span class="lineno"> 1243</span>                                        ? <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_survival_probability_curve.html">QuantExt::SurvivalProbabilityCurve&lt;LogLinear&gt;::Extrapolation::flatZero</a></div>
<div class="line"><span class="lineno"> 1244</span>                                        : <a class="code hl_classRef" href="../qle/class_quant_ext_1_1_survival_probability_curve.html">QuantExt::SurvivalProbabilityCurve&lt;LogLinear&gt;::Extrapolation::flatFwd</a>));</div>
<div class="line"><span class="lineno"> 1245</span>                        }</div>
<div class="line"><span class="lineno"> 1246</span>                        <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a>-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1247</span>                        <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a>-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1248</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6fbc788235c5a4e14315fb5f117c4d35">defaultCurves_</a>.insert(make_pair(</div>
<div class="line"><span class="lineno"> 1249</span>                            make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 1250</span>                            Handle&lt;CreditCurve&gt;(QuantLib::ext::make_shared&lt;CreditCurve&gt;(</div>
<div class="line"><span class="lineno"> 1251</span>                                <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a>, wrapper-&gt;rateCurve(), wrapper-&gt;recovery(), wrapper-&gt;refData()))));</div>
<div class="line"><span class="lineno"> 1252</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1253</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1254</span>                    }</div>
<div class="line"><span class="lineno"> 1255</span>                }</div>
<div class="line"><span class="lineno"> 1256</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">RiskFactorKey::KeyType::RecoveryRate</a>:</div>
<div class="line"><span class="lineno"> 1259</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 1260</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1261</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1262</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Adding security recovery rate &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; from configuration &quot;</span> &lt;&lt; configuration);</div>
<div class="line"><span class="lineno"> 1263</span>                        Real v = initMarket-&gt;recoveryRate(name, configuration)-&gt;value();</div>
<div class="line"><span class="lineno"> 1264</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 1.0 : v);</div>
<div class="line"><span class="lineno"> 1265</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1266</span>                            <span class="keyword">auto</span> m = [v](Real x) { <span class="keywordflow">return</span> x * v; };</div>
<div class="line"><span class="lineno"> 1267</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">recoveryRates_</a>.insert(</div>
<div class="line"><span class="lineno"> 1268</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 1269</span>                                          Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(</div>
<div class="line"><span class="lineno"> 1270</span>                                              Handle&lt;Quote&gt;(q), m))));</div>
<div class="line"><span class="lineno"> 1271</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1272</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">recoveryRates_</a>.insert(</div>
<div class="line"><span class="lineno"> 1273</span>                                make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;Quote&gt;(q)));</div>
<div class="line"><span class="lineno"> 1274</span>                        }</div>
<div class="line"><span class="lineno"> 1275</span>                        <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno"> 1276</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 1277</span>                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1278</span>                                               std::forward_as_tuple(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">RiskFactorKey::KeyType::RecoveryRate</a>, name),</div>
<div class="line"><span class="lineno"> 1279</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1280</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1281</span>                                absoluteSimDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 1282</span>                                    std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1283</span>                                    std::forward_as_tuple(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">RiskFactorKey::KeyType::RecoveryRate</a>, name),</div>
<div class="line"><span class="lineno"> 1284</span>                                    std::forward_as_tuple(v));</div>
<div class="line"><span class="lineno"> 1285</span>                            }</div>
<div class="line"><span class="lineno"> 1286</span>                        }</div>
<div class="line"><span class="lineno"> 1287</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {});</div>
<div class="line"><span class="lineno"> 1288</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1289</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">recoveryRates_</a>.insert(</div>
<div class="line"><span class="lineno"> 1290</span>                            make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;Quote&gt;(q)));</div>
<div class="line"><span class="lineno"> 1291</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1292</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1293</span>                    }</div>
<div class="line"><span class="lineno"> 1294</span>                }</div>
<div class="line"><span class="lineno"> 1295</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9">RiskFactorKey::KeyType::CDSVolatility</a>:</div>
<div class="line"><span class="lineno"> 1298</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 1299</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1300</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1301</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;  cds vols..&quot;</span>);</div>
<div class="line"><span class="lineno"> 1302</span>                        Handle&lt;QuantExt::CreditVolCurve&gt; wrapper = initMarket-&gt;cdsVol(name, configuration);</div>
<div class="line"><span class="lineno"> 1303</span>                        Handle&lt;QuantExt::CreditVolCurve&gt; cvh;</div>
<div class="line"><span class="lineno"> 1304</span>                        <span class="keywordtype">bool</span> stickyStrike = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;cdsVolSmileDynamics(name) == <span class="stringliteral">&quot;StickyStrike&quot;</span>;</div>
<div class="line"><span class="lineno"> 1305</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 1306</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating CDS Vols for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1307</span>                            vector&lt;Handle&lt;Quote&gt;&gt; quotes;</div>
<div class="line"><span class="lineno"> 1308</span>                            vector&lt;Volatility&gt; vols;</div>
<div class="line"><span class="lineno"> 1309</span>                            vector&lt;Time&gt; times;</div>
<div class="line"><span class="lineno"> 1310</span>                            vector&lt;Date&gt; expiryDates;</div>
<div class="line"><span class="lineno"> 1311</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1312</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; parameters-&gt;cdsVolExpiries().<a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a777e216dee6069b548bb87da7152699e">size</a>(); i++) {</div>
<div class="line"><span class="lineno"> 1313</span>                                Date date = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + parameters-&gt;cdsVolExpiries()[i];</div>
<div class="line"><span class="lineno"> 1314</span>                                expiryDates.push_back(date);</div>
<div class="line"><span class="lineno"> 1315</span>                                <span class="comment">// hardcoded, single term 5y</span></div>
<div class="line"><span class="lineno"> 1316</span>                                <a class="code hl_enumvalueRef" href="../ored/namespaceore_1_1data.html#a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf">Volatility</a> vol = wrapper-&gt;volatility(date, 5.0, Null&lt;Real&gt;(), wrapper-&gt;type());</div>
<div class="line"><span class="lineno"> 1317</span>                                vols.push_back(vol);</div>
<div class="line"><span class="lineno"> 1318</span>                                times.push_back(dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, date));</div>
<div class="line"><span class="lineno"> 1319</span>                                QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q =</div>
<div class="line"><span class="lineno"> 1320</span>                                    QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol);</div>
<div class="line"><span class="lineno"> 1321</span>                                <span class="keywordflow">if</span> (parameters-&gt;simulateCdsVols()) {</div>
<div class="line"><span class="lineno"> 1322</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1323</span>                                                       std::forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno"> 1324</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1325</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1326</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1327</span>                                                                   std::forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno"> 1328</span>                                                                   std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 1329</span>                                    }</div>
<div class="line"><span class="lineno"> 1330</span>                                }</div>
<div class="line"><span class="lineno"> 1331</span>                                quotes.emplace_back(q);</div>
<div class="line"><span class="lineno"> 1332</span>                            }</div>
<div class="line"><span class="lineno"> 1333</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {times});</div>
<div class="line"><span class="lineno"> 1334</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1335</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ||</div>
<div class="line"><span class="lineno"> 1336</span>                                (!<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> &amp;&amp; parameters-&gt;simulateCdsVolATMOnly())) {</div>
<div class="line"><span class="lineno"> 1337</span>                                std::vector&lt;Handle&lt;Quote&gt;&gt; spreads;</div>
<div class="line"><span class="lineno"> 1338</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;simulateCdsVolATMOnly()) {</div>
<div class="line"><span class="lineno"> 1339</span>                                    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; quotes.size(); i++) {</div>
<div class="line"><span class="lineno"> 1340</span>                                        Handle&lt;Quote&gt; atmVol(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(quotes[i]-&gt;<a class="code hl_variableRef" href="../ored/computationgraphbuilder_8cpp.html#a68c611e65dfff92886c4627c9fdde094">value</a>()));</div>
<div class="line"><span class="lineno"> 1341</span>                                        Handle&lt;Quote&gt; quote(QuantLib::ext::make_shared &lt;</div>
<div class="line"><span class="lineno"> 1342</span>                                                            CompositeQuote&lt;std::minus&lt;double&gt;&gt;&gt;(quotes[i], atmVol,</div>
<div class="line"><span class="lineno"> 1343</span>                                                                                               std::minus&lt;double&gt;()));</div>
<div class="line"><span class="lineno"> 1344</span>                                        spreads.push_back(quote);</div>
<div class="line"><span class="lineno"> 1345</span>                                    }</div>
<div class="line"><span class="lineno"> 1346</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1347</span>                                    spreads = quotes;</div>
<div class="line"><span class="lineno"> 1348</span>                                }</div>
<div class="line"><span class="lineno"> 1349</span>                                std::vector&lt;QuantLib::Period&gt; simTerms;</div>
<div class="line"><span class="lineno"> 1350</span>                                std::vector&lt;Handle&lt;CreditCurve&gt;&gt; simTermCurves;</div>
<div class="line"><span class="lineno"> 1351</span>                                <span class="keywordflow">if</span> (<a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.hasCdsVolCurveConfig(name)) {</div>
<div class="line"><span class="lineno"> 1352</span>                                    <span class="comment">// get the term curves from the curve config if possible</span></div>
<div class="line"><span class="lineno"> 1353</span>                                    <span class="keyword">auto</span> cc = <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.cdsVolCurveConfig(name);</div>
<div class="line"><span class="lineno"> 1354</span>                                    simTerms = cc-&gt;terms();</div>
<div class="line"><span class="lineno"> 1355</span>                                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; c : cc-&gt;termCurves())</div>
<div class="line"><span class="lineno"> 1356</span>                                        simTermCurves.push_back(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a>(<a class="code hl_functionRef" href="../ored/group__curves.html#ga7c53f293f4ad98e691c6a93b6be26e9a">parseCurveSpec</a>(c)-&gt;curveConfigID()));</div>
<div class="line"><span class="lineno"> 1357</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1358</span>                                    <span class="comment">// assume the default curve names follow the naming convention volName_5Y</span></div>
<div class="line"><span class="lineno"> 1359</span>                                    simTerms = wrapper-&gt;terms();</div>
<div class="line"><span class="lineno"> 1360</span>                                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; t : simTerms) {</div>
<div class="line"><span class="lineno"> 1361</span>                                        simTermCurves.push_back(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">defaultCurve</a>(name + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(t)));</div>
<div class="line"><span class="lineno"> 1362</span>                                    }</div>
<div class="line"><span class="lineno"> 1363</span>                                }</div>
<div class="line"><span class="lineno"> 1364</span>                                cvh = Handle&lt;CreditVolCurve&gt;(QuantLib::ext::make_shared&lt;SpreadedCreditVolCurve&gt;(</div>
<div class="line"><span class="lineno"> 1365</span>                                    wrapper, expiryDates, spreads, !stickyStrike, simTerms, simTermCurves));</div>
<div class="line"><span class="lineno"> 1366</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1367</span>                                <span class="comment">// TODO support strike and term dependence</span></div>
<div class="line"><span class="lineno"> 1368</span>                                cvh = Handle&lt;CreditVolCurve&gt;(QuantLib::ext::make_shared&lt;CreditVolCurveWrapper&gt;(</div>
<div class="line"><span class="lineno"> 1369</span>                                    Handle&lt;BlackVolTermStructure&gt;(QuantLib::ext::make_shared&lt;BlackVarianceCurve3&gt;(</div>
<div class="line"><span class="lineno"> 1370</span>                                        0, NullCalendar(), wrapper-&gt;businessDayConvention(), dc, times, quotes,</div>
<div class="line"><span class="lineno"> 1371</span>                                        <span class="keyword">false</span>))));</div>
<div class="line"><span class="lineno"> 1372</span>                            }</div>
<div class="line"><span class="lineno"> 1373</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1374</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;cdsVolDecayMode();</div>
<div class="line"><span class="lineno"> 1375</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Deterministic CDS Vols with decay mode &quot;</span> &lt;&lt; decayModeString &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1376</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>                            <span class="comment">// TODO support strike and term dependence, hardcoded term 5y</span></div>
<div class="line"><span class="lineno"> 1379</span>                            cvh = Handle&lt;CreditVolCurve&gt;(</div>
<div class="line"><span class="lineno"> 1380</span>                                QuantLib::ext::make_shared&lt;CreditVolCurveWrapper&gt;(Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1381</span>                                    QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_dynamic_black_vol_term_structure.html">QuantExt::DynamicBlackVolTermStructure&lt;tag::curve&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 1382</span>                                        Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1383</span>                                            QuantLib::ext::make_shared&lt;BlackVolFromCreditVolWrapper&gt;(wrapper, 5.0)),</div>
<div class="line"><span class="lineno"> 1384</span>                                        0, NullCalendar(), decayMode,</div>
<div class="line"><span class="lineno"> 1385</span>                                        stickyStrike ? <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa7958a422936150bb6ec2a9634789f7d5">StickyStrike</a> : <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa3c712c65297116157beb42df5b5a2273">StickyLogMoneyness</a>))));</div>
<div class="line"><span class="lineno"> 1386</span>                        }</div>
<div class="line"><span class="lineno"> 1387</span>                        cvh-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1388</span>                        <span class="keywordflow">if</span> (wrapper-&gt;allowsExtrapolation())</div>
<div class="line"><span class="lineno"> 1389</span>                            cvh-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1390</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a8bd2645934bf424bec9d60d3a146554e">cdsVols_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), cvh));</div>
<div class="line"><span class="lineno"> 1391</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1392</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1393</span>                    }</div>
<div class="line"><span class="lineno"> 1394</span>                }</div>
<div class="line"><span class="lineno"> 1395</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1396</span> </div>
<div class="line"><span class="lineno"> 1397</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942">RiskFactorKey::KeyType::FXVolatility</a>:</div>
<div class="line"><span class="lineno"> 1398</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 1399</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1400</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1401</span>                        Handle&lt;BlackVolTermStructure&gt; wrapper = initMarket-&gt;fxVol(name, configuration);</div>
<div class="line"><span class="lineno"> 1402</span>                        Handle&lt;Quote&gt; spot = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#a0b6a2501015e2227c3f1a4f621c21ab4">fxSpot</a>(name);</div>
<div class="line"><span class="lineno"> 1403</span>                        QL_REQUIRE(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>.length() == 6, <span class="stringliteral">&quot;invalid ccy pair length&quot;</span>);</div>
<div class="line"><span class="lineno"> 1404</span>                        <span class="keywordtype">string</span> forCcy = <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>.substr(0, 3);</div>
<div class="line"><span class="lineno"> 1405</span>                        <span class="keywordtype">string</span> domCcy = <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>.substr(3, 3);</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>                        <span class="comment">// Get the yield curve IDs from the FX volatility configuration</span></div>
<div class="line"><span class="lineno"> 1408</span>                        <span class="comment">// They may still be empty</span></div>
<div class="line"><span class="lineno"> 1409</span>                        <span class="keywordtype">string</span> foreignTsId;</div>
<div class="line"><span class="lineno"> 1410</span>                        <span class="keywordtype">string</span> domesticTsId;</div>
<div class="line"><span class="lineno"> 1411</span>                        <span class="keywordflow">if</span> (<a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.hasFxVolCurveConfig(name)) {</div>
<div class="line"><span class="lineno"> 1412</span>                            <span class="keyword">auto</span> fxVolConfig = <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.fxVolCurveConfig(name);</div>
<div class="line"><span class="lineno"> 1413</span>                            foreignTsId = fxVolConfig-&gt;fxForeignYieldCurveID();</div>
<div class="line"><span class="lineno"> 1414</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Got foreign term structure &#39;&quot;</span> &lt;&lt; foreignTsId</div>
<div class="line"><span class="lineno"> 1415</span>                                                                &lt;&lt; <span class="stringliteral">&quot;&#39; from FX volatility curve config for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1416</span>                            domesticTsId = fxVolConfig-&gt;fxDomesticYieldCurveID();</div>
<div class="line"><span class="lineno"> 1417</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Got domestic term structure &#39;&quot;</span> &lt;&lt; domesticTsId</div>
<div class="line"><span class="lineno"> 1418</span>                                                                 &lt;&lt; <span class="stringliteral">&quot;&#39; from FX volatility curve config for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1419</span>                        }</div>
<div class="line"><span class="lineno"> 1420</span>                        Handle&lt;BlackVolTermStructure&gt; fvh;</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>                        <span class="keywordtype">bool</span> stickyStrike = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;fxVolSmileDynamics(name) == <span class="stringliteral">&quot;StickyStrike&quot;</span>;</div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 1425</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating FX Vols for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1426</span>                            <span class="keyword">auto</span>&amp; expiries = parameters-&gt;fxVolExpiries(name);</div>
<div class="line"><span class="lineno"> 1427</span>                            Size m = expiries.size();</div>
<div class="line"><span class="lineno"> 1428</span>                            Calendar cal = wrapper-&gt;calendar();</div>
<div class="line"><span class="lineno"> 1429</span>                            <span class="keywordflow">if</span> (cal.empty()) {</div>
<div class="line"><span class="lineno"> 1430</span>                                cal = NullCalendar();</div>
<div class="line"><span class="lineno"> 1431</span>                            }</div>
<div class="line"><span class="lineno"> 1432</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1433</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes;</div>
<div class="line"><span class="lineno"> 1434</span>                            vector&lt;Time&gt; times(m);</div>
<div class="line"><span class="lineno"> 1435</span>                            vector&lt;Date&gt; dates(m);</div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span>                            <span class="comment">// Attempt to get the relevant yield curves from the initial market</span></div>
<div class="line"><span class="lineno"> 1438</span>                            Handle&lt;YieldTermStructure&gt; initForTS =</div>
<div class="line"><span class="lineno"> 1439</span>                                <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a>(foreignTsId, todaysMarketParams, configuration, initMarket);</div>
<div class="line"><span class="lineno"> 1440</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Foreign term structure &#39;&quot;</span> &lt;&lt; foreignTsId &lt;&lt; <span class="stringliteral">&quot;&#39; from t_0 market is &quot;</span></div>
<div class="line"><span class="lineno"> 1441</span>                                                            &lt;&lt; (initForTS.empty() ? <span class="stringliteral">&quot;empty&quot;</span> : <span class="stringliteral">&quot;not empty&quot;</span>));</div>
<div class="line"><span class="lineno"> 1442</span>                            Handle&lt;YieldTermStructure&gt; initDomTS =</div>
<div class="line"><span class="lineno"> 1443</span>                                <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a>(domesticTsId, todaysMarketParams, configuration, initMarket);</div>
<div class="line"><span class="lineno"> 1444</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Domestic term structure &#39;&quot;</span> &lt;&lt; domesticTsId &lt;&lt; <span class="stringliteral">&quot;&#39; from t_0 market is &quot;</span></div>
<div class="line"><span class="lineno"> 1445</span>                                                             &lt;&lt; (initDomTS.empty() ? <span class="stringliteral">&quot;empty&quot;</span> : <span class="stringliteral">&quot;not empty&quot;</span>));</div>
<div class="line"><span class="lineno"> 1446</span> </div>
<div class="line"><span class="lineno"> 1447</span>                            <span class="comment">// fall back on discount curves</span></div>
<div class="line"><span class="lineno"> 1448</span>                            <span class="keywordflow">if</span> (initForTS.empty() || initDomTS.empty()) {</div>
<div class="line"><span class="lineno"> 1449</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Falling back on the discount curves for &quot;</span> &lt;&lt; forCcy &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; domCcy</div>
<div class="line"><span class="lineno"> 1450</span>                                                                                &lt;&lt; <span class="stringliteral">&quot; from t_0 market&quot;</span>);</div>
<div class="line"><span class="lineno"> 1451</span>                                initForTS = initMarket-&gt;discountCurve(forCcy, configuration);</div>
<div class="line"><span class="lineno"> 1452</span>                                initDomTS = initMarket-&gt;discountCurve(domCcy, configuration);</div>
<div class="line"><span class="lineno"> 1453</span>                            }</div>
<div class="line"><span class="lineno"> 1454</span> </div>
<div class="line"><span class="lineno"> 1455</span>                            <span class="comment">// Attempt to get the relevant yield curves from this scenario simulation market</span></div>
<div class="line"><span class="lineno"> 1456</span>                            Handle&lt;YieldTermStructure&gt; forTS =</div>
<div class="line"><span class="lineno"> 1457</span>                                <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a>(foreignTsId, todaysMarketParams, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><span class="lineno"> 1458</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Foreign term structure &#39;&quot;</span> &lt;&lt; foreignTsId &lt;&lt; <span class="stringliteral">&quot;&#39; from sim market is &quot;</span></div>
<div class="line"><span class="lineno"> 1459</span>                                                            &lt;&lt; (forTS.empty() ? <span class="stringliteral">&quot;empty&quot;</span> : <span class="stringliteral">&quot;not empty&quot;</span>));</div>
<div class="line"><span class="lineno"> 1460</span>                            Handle&lt;YieldTermStructure&gt; domTS =</div>
<div class="line"><span class="lineno"> 1461</span>                                <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a>(domesticTsId, todaysMarketParams, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><span class="lineno"> 1462</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Domestic term structure &#39;&quot;</span> &lt;&lt; domesticTsId &lt;&lt; <span class="stringliteral">&quot;&#39; from sim market is &quot;</span></div>
<div class="line"><span class="lineno"> 1463</span>                                                             &lt;&lt; (domTS.empty() ? <span class="stringliteral">&quot;empty&quot;</span> : <span class="stringliteral">&quot;not empty&quot;</span>));</div>
<div class="line"><span class="lineno"> 1464</span> </div>
<div class="line"><span class="lineno"> 1465</span>                            <span class="comment">// fall back on discount curves</span></div>
<div class="line"><span class="lineno"> 1466</span>                            <span class="keywordflow">if</span> (forTS.empty() || domTS.empty()) {</div>
<div class="line"><span class="lineno"> 1467</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Falling back on the discount curves for &quot;</span> &lt;&lt; forCcy &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> &lt;&lt; domCcy</div>
<div class="line"><span class="lineno"> 1468</span>                                                                                &lt;&lt; <span class="stringliteral">&quot; from sim market&quot;</span>);</div>
<div class="line"><span class="lineno"> 1469</span>                                forTS = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a>(forCcy);</div>
<div class="line"><span class="lineno"> 1470</span>                                domTS = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a>(domCcy);</div>
<div class="line"><span class="lineno"> 1471</span>                            }</div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>                            <span class="keywordflow">for</span> (Size k = 0; k &lt; m; k++) {</div>
<div class="line"><span class="lineno"> 1474</span>                                dates[k] = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + expiries[k];</div>
<div class="line"><span class="lineno"> 1475</span>                                times[k] = wrapper-&gt;timeFromReference(dates[k]);</div>
<div class="line"><span class="lineno"> 1476</span>                            }</div>
<div class="line"><span class="lineno"> 1477</span> </div>
<div class="line"><span class="lineno"> 1478</span>                            QuantLib::ext::shared_ptr&lt;BlackVolTermStructure&gt; fxVolCurve;</div>
<div class="line"><span class="lineno"> 1479</span>                            <span class="keywordflow">if</span> (parameters-&gt;fxVolIsSurface(name)) {</div>
<div class="line"><span class="lineno"> 1480</span>                                vector&lt;Real&gt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>;</div>
<div class="line"><span class="lineno"> 1481</span>                                <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a> = parameters-&gt;fxUseMoneyness(name) ? parameters-&gt;fxVolMoneyness(name)</div>
<div class="line"><span class="lineno"> 1482</span>                                                                           : parameters-&gt;fxVolStdDevs(name);</div>
<div class="line"><span class="lineno"> 1483</span>                                Size n = <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size();</div>
<div class="line"><span class="lineno"> 1484</span>                                quotes.resize(n, vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1485</span> </div>
<div class="line"><span class="lineno"> 1486</span>                                <span class="comment">// hardcode this for now</span></div>
<div class="line"><span class="lineno"> 1487</span>                                <span class="keywordtype">bool</span> flatExtrapolation = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1488</span> </div>
<div class="line"><span class="lineno"> 1489</span>                                <span class="comment">// get vol matrix to feed to surface</span></div>
<div class="line"><span class="lineno"> 1490</span>                                <span class="keywordflow">if</span> (parameters-&gt;fxUseMoneyness(name)) { <span class="comment">// if moneyness</span></div>
<div class="line"><span class="lineno"> 1491</span>                                    <span class="keywordflow">for</span> (Size j = 0; j &lt; m; j++) {</div>
<div class="line"><span class="lineno"> 1492</span>                                        <span class="keywordflow">for</span> (Size i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno"> 1493</span>                                            Real mon = <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>[i];</div>
<div class="line"><span class="lineno"> 1494</span>                                            <span class="comment">// strike (assuming forward prices)</span></div>
<div class="line"><span class="lineno"> 1495</span>                                            Real k = spot-&gt;value() * mon * initForTS-&gt;discount(dates[j]) /</div>
<div class="line"><span class="lineno"> 1496</span>                                                     initDomTS-&gt;discount(dates[j]);</div>
<div class="line"><span class="lineno"> 1497</span>                                            Size idx = i * m + j;</div>
<div class="line"><span class="lineno"> 1498</span> </div>
<div class="line"><span class="lineno"> 1499</span>                                            <a class="code hl_enumvalueRef" href="../ored/namespaceore_1_1data.html#a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf">Volatility</a> vol = wrapper-&gt;blackVol(dates[j], k, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1500</span>                                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno"> 1501</span>                                                <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol));</div>
<div class="line"><span class="lineno"> 1502</span>                                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1503</span>                                                               std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1504</span>                                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1505</span>                                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1506</span>                                                absoluteSimDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 1507</span>                                                    std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1508</span>                                                    std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1509</span>                                                    std::forward_as_tuple(q-&gt;value()));</div>
<div class="line"><span class="lineno"> 1510</span>                                            }</div>
<div class="line"><span class="lineno"> 1511</span>                                            quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 1512</span>                                        }</div>
<div class="line"><span class="lineno"> 1513</span>                                    }</div>
<div class="line"><span class="lineno"> 1514</span>                                    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {strikes, times});</div>
<div class="line"><span class="lineno"> 1515</span>                                    simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1516</span>                                    <span class="comment">// build the surface</span></div>
<div class="line"><span class="lineno"> 1517</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1518</span>                                        fxVolCurve = QuantLib::ext::make_shared&lt;SpreadedBlackVolatilitySurfaceMoneynessForward&gt;(</div>
<div class="line"><span class="lineno"> 1519</span>                                            Handle&lt;BlackVolTermStructure&gt;(wrapper), spot, times,</div>
<div class="line"><span class="lineno"> 1520</span>                                            parameters-&gt;fxVolMoneyness(name), quotes,</div>
<div class="line"><span class="lineno"> 1521</span>                                            Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(spot-&gt;value())), initForTS,</div>
<div class="line"><span class="lineno"> 1522</span>                                            initDomTS, forTS, domTS, stickyStrike);</div>
<div class="line"><span class="lineno"> 1523</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1524</span>                                        fxVolCurve = QuantLib::ext::make_shared&lt;BlackVarianceSurfaceMoneynessForward&gt;(</div>
<div class="line"><span class="lineno"> 1525</span>                                            cal, spot, times, parameters-&gt;fxVolMoneyness(name), quotes, dc, forTS,</div>
<div class="line"><span class="lineno"> 1526</span>                                            domTS, stickyStrike, flatExtrapolation);</div>
<div class="line"><span class="lineno"> 1527</span>                                    }</div>
<div class="line"><span class="lineno"> 1528</span>                                } <span class="keywordflow">else</span> { <span class="comment">// if stdDevPoints</span></div>
<div class="line"><span class="lineno"> 1529</span>                                    <span class="comment">// forwards</span></div>
<div class="line"><span class="lineno"> 1530</span>                                    vector&lt;Real&gt; fwds;</div>
<div class="line"><span class="lineno"> 1531</span>                                    vector&lt;Real&gt; atmVols;</div>
<div class="line"><span class="lineno"> 1532</span>                                    <span class="keywordflow">for</span> (Size i = 0; i &lt; m; i++) {</div>
<div class="line"><span class="lineno"> 1533</span>                                        Real k = spot-&gt;value() * initForTS-&gt;discount(dates[i]) / initDomTS-&gt;discount(dates[i]);</div>
<div class="line"><span class="lineno"> 1534</span>                                        fwds.push_back(k);</div>
<div class="line"><span class="lineno"> 1535</span>                                        atmVols.push_back(wrapper-&gt;blackVol(dates[i], k));</div>
<div class="line"><span class="lineno"> 1536</span>                                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;on date &quot;</span> &lt;&lt; dates[i] &lt;&lt; <span class="stringliteral">&quot;: fwd = &quot;</span> &lt;&lt; fwds.back()</div>
<div class="line"><span class="lineno"> 1537</span>                                                        &lt;&lt; <span class="stringliteral">&quot;, atmVol = &quot;</span> &lt;&lt; atmVols.back());</div>
<div class="line"><span class="lineno"> 1538</span>                                    }</div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>                                    <span class="comment">// interpolations</span></div>
<div class="line"><span class="lineno"> 1541</span>                                    Interpolation forwardCurve =</div>
<div class="line"><span class="lineno"> 1542</span>                                        Linear().interpolate(times.begin(), times.end(), fwds.begin());</div>
<div class="line"><span class="lineno"> 1543</span>                                    Interpolation atmVolCurve =</div>
<div class="line"><span class="lineno"> 1544</span>                                        Linear().interpolate(times.begin(), times.end(), atmVols.begin());</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>                                    <span class="comment">// populate quotes</span></div>
<div class="line"><span class="lineno"> 1547</span>                                    vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; absQuotes(n,</div>
<div class="line"><span class="lineno"> 1548</span>                                                                            vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1549</span>                                    <a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_black_variance_surface_std_devs.html#ae16f88d114d997f6ab73eed253ee0a10">BlackVarianceSurfaceStdDevs::populateVolMatrix</a>(wrapper, absQuotes, times,</div>
<div class="line"><span class="lineno"> 1550</span>                                                                                   parameters-&gt;fxVolStdDevs(name),</div>
<div class="line"><span class="lineno"> 1551</span>                                                                                   forwardCurve, atmVolCurve);</div>
<div class="line"><span class="lineno"> 1552</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1553</span>                                        <span class="keywordflow">for</span> (Size i = 0; i &lt; n; ++i)</div>
<div class="line"><span class="lineno"> 1554</span>                                            <span class="keywordflow">for</span> (Size j = 0; j &lt; m; ++j)</div>
<div class="line"><span class="lineno"> 1555</span>                                                quotes[i][j] = Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(0.0));</div>
<div class="line"><span class="lineno"> 1556</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1557</span>                                        quotes = absQuotes;</div>
<div class="line"><span class="lineno"> 1558</span>                                    }</div>
<div class="line"><span class="lineno"> 1559</span> </div>
<div class="line"><span class="lineno"> 1560</span>                                    <span class="comment">// sort out simDataTemp</span></div>
<div class="line"><span class="lineno"> 1561</span>                                    <span class="keywordflow">for</span> (Size i = 0; i &lt; m; i++) {</div>
<div class="line"><span class="lineno"> 1562</span>                                        <span class="keywordflow">for</span> (Size j = 0; j &lt; n; j++) {</div>
<div class="line"><span class="lineno"> 1563</span>                                            Size idx = j * m + i;</div>
<div class="line"><span class="lineno"> 1564</span>                                            QuantLib::ext::shared_ptr&lt;Quote&gt; q = quotes[j][i].currentLink();</div>
<div class="line"><span class="lineno"> 1565</span>                                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; sq =</div>
<div class="line"><span class="lineno"> 1566</span>                                                QuantLib::ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(q);</div>
<div class="line"><span class="lineno"> 1567</span>                                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1568</span>                                                               std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1569</span>                                                               std::forward_as_tuple(sq));</div>
<div class="line"><span class="lineno"> 1570</span>                                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1571</span>                                                absoluteSimDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 1572</span>                                                    std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1573</span>                                                    std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1574</span>                                                    std::forward_as_tuple(absQuotes[j][i]-&gt;value()));</div>
<div class="line"><span class="lineno"> 1575</span>                                            }</div>
<div class="line"><span class="lineno"> 1576</span>                                        }</div>
<div class="line"><span class="lineno"> 1577</span>                                    }</div>
<div class="line"><span class="lineno"> 1578</span>                                    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {strikes, times});</div>
<div class="line"><span class="lineno"> 1579</span>                                    simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1580</span> </div>
<div class="line"><span class="lineno"> 1581</span>                                    <span class="comment">// set up a FX Index</span></div>
<div class="line"><span class="lineno"> 1582</span>                                    Handle&lt;FxIndex&gt; fxInd = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">fxIndex</a>(name);</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>                                    <span class="keywordflow">if</span> (parameters-&gt;fxUseMoneyness(name)) { <span class="comment">// moneyness</span></div>
<div class="line"><span class="lineno"> 1585</span>                                    } <span class="keywordflow">else</span> {                                <span class="comment">// standard deviations</span></div>
<div class="line"><span class="lineno"> 1586</span>                                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1587</span>                                            fxVolCurve = QuantLib::ext::make_shared&lt;SpreadedBlackVolatilitySurfaceStdDevs&gt;(</div>
<div class="line"><span class="lineno"> 1588</span>                                                Handle&lt;BlackVolTermStructure&gt;(wrapper), spot, times,</div>
<div class="line"><span class="lineno"> 1589</span>                                                parameters-&gt;fxVolStdDevs(name), quotes,</div>
<div class="line"><span class="lineno"> 1590</span>                                                Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(spot-&gt;value())),</div>
<div class="line"><span class="lineno"> 1591</span>                                                initForTS, initDomTS, forTS, domTS, stickyStrike);</div>
<div class="line"><span class="lineno"> 1592</span>                                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1593</span>                                            fxVolCurve = QuantLib::ext::make_shared&lt;BlackVarianceSurfaceStdDevs&gt;(</div>
<div class="line"><span class="lineno"> 1594</span>                                                cal, spot, times, parameters-&gt;fxVolStdDevs(name), quotes, dc,</div>
<div class="line"><span class="lineno"> 1595</span>                                                fxInd.currentLink(), stickyStrike, flatExtrapolation);</div>
<div class="line"><span class="lineno"> 1596</span>                                        }</div>
<div class="line"><span class="lineno"> 1597</span>                                    }</div>
<div class="line"><span class="lineno"> 1598</span>                                }                            </div>
<div class="line"><span class="lineno"> 1599</span>                            } <span class="keywordflow">else</span> { <span class="comment">// not a surface - case for ATM or simulateATMOnly</span></div>
<div class="line"><span class="lineno"> 1600</span>                                quotes.resize(1, vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1601</span>                                <span class="comment">// Only need ATM quotes in this case</span></div>
<div class="line"><span class="lineno"> 1602</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; m; j++) {</div>
<div class="line"><span class="lineno"> 1603</span>                                    <span class="comment">// Index is expires then moneyness.</span></div>
<div class="line"><span class="lineno"> 1604</span>                                    Size idx = j;</div>
<div class="line"><span class="lineno"> 1605</span>                                    Real f =</div>
<div class="line"><span class="lineno"> 1606</span>                                        spot-&gt;value() * initForTS-&gt;discount(dates[j]) / initDomTS-&gt;discount(dates[j]);</div>
<div class="line"><span class="lineno"> 1607</span>                                    <a class="code hl_enumvalueRef" href="../ored/namespaceore_1_1data.html#a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf">Volatility</a> vol = wrapper-&gt;blackVol(dates[j], f);</div>
<div class="line"><span class="lineno"> 1608</span>                                    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno"> 1609</span>                                        <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol));</div>
<div class="line"><span class="lineno"> 1610</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1611</span>                                                       std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1612</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1613</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1614</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1615</span>                                                                   std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1616</span>                                                                   std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 1617</span>                                    }</div>
<div class="line"><span class="lineno"> 1618</span>                                    quotes[0][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 1619</span>                                }</div>
<div class="line"><span class="lineno"> 1620</span> </div>
<div class="line"><span class="lineno"> 1621</span>                                <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {times});</div>
<div class="line"><span class="lineno"> 1622</span>                                simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1623</span> </div>
<div class="line"><span class="lineno"> 1624</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1625</span>                                    <span class="comment">// if simulate atm only is false, we use the ATM slice from the wrapper only</span></div>
<div class="line"><span class="lineno"> 1626</span>                                    <span class="comment">// the smile dynamics is sticky strike here always (if t0 is a surface)</span></div>
<div class="line"><span class="lineno"> 1627</span>                                    fxVolCurve = QuantLib::ext::make_shared&lt;SpreadedBlackVolatilityCurve&gt;(</div>
<div class="line"><span class="lineno"> 1628</span>                                        Handle&lt;BlackVolTermStructure&gt;(wrapper), times, quotes[0],</div>
<div class="line"><span class="lineno"> 1629</span>                                        !parameters-&gt;simulateFxVolATMOnly());</div>
<div class="line"><span class="lineno"> 1630</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1631</span>                                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;ATM FX Vols (BlackVarianceCurve3) for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1632</span>                                    QuantLib::ext::shared_ptr&lt;BlackVolTermStructure&gt; atmCurve;</div>
<div class="line"><span class="lineno"> 1633</span>                                    atmCurve = QuantLib::ext::make_shared&lt;BlackVarianceCurve3&gt;(</div>
<div class="line"><span class="lineno"> 1634</span>                                        0, NullCalendar(), wrapper-&gt;businessDayConvention(), dc, times, quotes[0], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1635</span>                                    <span class="comment">// if we have a surface but are only simulating atm vols we wrap the atm curve and</span></div>
<div class="line"><span class="lineno"> 1636</span>                                    <span class="comment">// the full t0 surface</span></div>
<div class="line"><span class="lineno"> 1637</span>                                    <span class="keywordflow">if</span> (parameters-&gt;simulateFxVolATMOnly()) {</div>
<div class="line"><span class="lineno"> 1638</span>                                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating FX Vols (FXVolatilityConstantSpread) for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1639</span>                                        fxVolCurve = QuantLib::ext::make_shared&lt;BlackVolatilityConstantSpread&gt;(</div>
<div class="line"><span class="lineno"> 1640</span>                                            Handle&lt;BlackVolTermStructure&gt;(atmCurve), wrapper);</div>
<div class="line"><span class="lineno"> 1641</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1642</span>                                        fxVolCurve = atmCurve;</div>
<div class="line"><span class="lineno"> 1643</span>                                    }</div>
<div class="line"><span class="lineno"> 1644</span>                                }</div>
<div class="line"><span class="lineno"> 1645</span>                            }</div>
<div class="line"><span class="lineno"> 1646</span>                            fvh = Handle&lt;BlackVolTermStructure&gt;(fxVolCurve);</div>
<div class="line"><span class="lineno"> 1647</span> </div>
<div class="line"><span class="lineno"> 1648</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1649</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;fxVolDecayMode();</div>
<div class="line"><span class="lineno"> 1650</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Deterministic FX Vols with decay mode &quot;</span> &lt;&lt; decayModeString &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1651</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>                            <span class="comment">// currently only curves (i.e. strike independent) FX volatility structures are</span></div>
<div class="line"><span class="lineno"> 1654</span>                            <span class="comment">// supported, so we use a) the more efficient curve tag and b) a hard coded sticky</span></div>
<div class="line"><span class="lineno"> 1655</span>                            <span class="comment">// strike stickiness, since then no yield term structures and no fx spot are required</span></div>
<div class="line"><span class="lineno"> 1656</span>                            <span class="comment">// that define the ATM level - to be revisited when FX surfaces are supported</span></div>
<div class="line"><span class="lineno"> 1657</span>                            fvh = Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1658</span>                                QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_dynamic_black_vol_term_structure.html">QuantExt::DynamicBlackVolTermStructure&lt;tag::curve&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 1659</span>                                    wrapper, 0, NullCalendar(), decayMode,</div>
<div class="line"><span class="lineno"> 1660</span>                                    stickyStrike ? <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa7958a422936150bb6ec2a9634789f7d5">StickyStrike</a> : <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa3c712c65297116157beb42df5b5a2273">StickyLogMoneyness</a>));</div>
<div class="line"><span class="lineno"> 1661</span>                        }</div>
<div class="line"><span class="lineno"> 1662</span> </div>
<div class="line"><span class="lineno"> 1663</span>                        fvh-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1664</span>                        fvh-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1665</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5b8442b6d8873c160be5e0e52c8b3071">fxVols_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), fvh));</div>
<div class="line"><span class="lineno"> 1666</span> </div>
<div class="line"><span class="lineno"> 1667</span>                        <span class="comment">// build inverted surface</span></div>
<div class="line"><span class="lineno"> 1668</span>                        QL_REQUIRE(<a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>.size() == 6, <span class="stringliteral">&quot;Invalid Ccy pair &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1669</span>                        <span class="keywordtype">string</span> reverse = <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>.substr(3) + <a class="code hl_variableRef" href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>.substr(0, 3);</div>
<div class="line"><span class="lineno"> 1670</span>                        Handle&lt;QuantLib::BlackVolTermStructure&gt; ifvh(</div>
<div class="line"><span class="lineno"> 1671</span>                            QuantLib::ext::make_shared&lt;BlackInvertedVolTermStructure&gt;(fvh));</div>
<div class="line"><span class="lineno"> 1672</span>                        ifvh-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1673</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a5b8442b6d8873c160be5e0e52c8b3071">fxVols_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, reverse), ifvh));</div>
<div class="line"><span class="lineno"> 1674</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1675</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1676</span>                    }</div>
<div class="line"><span class="lineno"> 1677</span>                }</div>
<div class="line"><span class="lineno"> 1678</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b">RiskFactorKey::KeyType::EquityVolatility</a>:</div>
<div class="line"><span class="lineno"> 1681</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 1682</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1683</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1684</span>                        Handle&lt;BlackVolTermStructure&gt; wrapper = initMarket-&gt;equityVol(name, configuration);</div>
<div class="line"><span class="lineno"> 1685</span>                        Handle&lt;BlackVolTermStructure&gt; evh;</div>
<div class="line"><span class="lineno"> 1686</span> </div>
<div class="line"><span class="lineno"> 1687</span>                        <span class="keywordtype">bool</span> stickyStrike = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;equityVolSmileDynamics(name) == <span class="stringliteral">&quot;StickyStrike&quot;</span>;</div>
<div class="line"><span class="lineno"> 1688</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 1689</span>                            <span class="keyword">auto</span> eqCurve = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a21e2bf8d9c6e49a938c4259d491f0efa">equityCurve</a>(name, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><span class="lineno"> 1690</span>                            Handle&lt;Quote&gt; spot = eqCurve-&gt;equitySpot();</div>
<div class="line"><span class="lineno"> 1691</span>                            <span class="keyword">auto</span> expiries = parameters-&gt;equityVolExpiries(name);</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>                            Size m = expiries.size();</div>
<div class="line"><span class="lineno"> 1694</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes;</div>
<div class="line"><span class="lineno"> 1695</span>                            vector&lt;Time&gt; times(m);</div>
<div class="line"><span class="lineno"> 1696</span>                            vector&lt;Date&gt; dates(m);</div>
<div class="line"><span class="lineno"> 1697</span>                            Calendar cal;</div>
<div class="line"><span class="lineno"> 1698</span>                            <span class="keywordflow">if</span> (<a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.hasEquityVolCurveConfig(name)) {</div>
<div class="line"><span class="lineno"> 1699</span>                                <span class="keyword">auto</span> cfg = <a class="code hl_variableRef" href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a>.equityVolCurveConfig(name);</div>
<div class="line"><span class="lineno"> 1700</span>                                <span class="keywordflow">if</span> (cfg-&gt;calendar().empty())</div>
<div class="line"><span class="lineno"> 1701</span>                                    cal = <a class="code hl_functionRef" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14">parseCalendar</a>(cfg-&gt;ccy());</div>
<div class="line"><span class="lineno"> 1702</span>                                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1703</span>                                    cal = <a class="code hl_functionRef" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14">parseCalendar</a>(cfg-&gt;calendar());</div>
<div class="line"><span class="lineno"> 1704</span>                            }</div>
<div class="line"><span class="lineno"> 1705</span>                            <span class="keywordflow">if</span> (cal.empty() || cal == NullCalendar()) {</div>
<div class="line"><span class="lineno"> 1706</span>                                <span class="comment">// take the equity curves calendar - this at least ensures fixings align</span></div>
<div class="line"><span class="lineno"> 1707</span>                                cal = eqCurve-&gt;fixingCalendar();</div>
<div class="line"><span class="lineno"> 1708</span>                            }</div>
<div class="line"><span class="lineno"> 1709</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>                            <span class="keywordflow">for</span> (Size k = 0; k &lt; m; k++) {</div>
<div class="line"><span class="lineno"> 1712</span>                                dates[k] = cal.advance(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, expiries[k]);</div>
<div class="line"><span class="lineno"> 1713</span>                                times[k] = dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, dates[k]);</div>
<div class="line"><span class="lineno"> 1714</span>                            }</div>
<div class="line"><span class="lineno"> 1715</span> </div>
<div class="line"><span class="lineno"> 1716</span>                            QuantLib::ext::shared_ptr&lt;BlackVolTermStructure&gt; eqVolCurve;</div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>                            <span class="keywordflow">if</span> (parameters-&gt;equityVolIsSurface(name)) {</div>
<div class="line"><span class="lineno"> 1719</span>                                vector&lt;Real&gt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>;</div>
<div class="line"><span class="lineno"> 1720</span>                                <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a> = parameters-&gt;equityUseMoneyness(name)</div>
<div class="line"><span class="lineno"> 1721</span>                                              ? parameters-&gt;equityVolMoneyness(name)</div>
<div class="line"><span class="lineno"> 1722</span>                                              : parameters-&gt;equityVolStandardDevs(name);</div>
<div class="line"><span class="lineno"> 1723</span>                                Size n = <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size();</div>
<div class="line"><span class="lineno"> 1724</span>                                quotes.resize(n, vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1725</span> </div>
<div class="line"><span class="lineno"> 1726</span>                                <span class="keywordflow">if</span> (parameters-&gt;equityUseMoneyness(name)) { <span class="comment">// moneyness surface</span></div>
<div class="line"><span class="lineno"> 1727</span>                                    <span class="keywordflow">for</span> (Size j = 0; j &lt; m; j++) {</div>
<div class="line"><span class="lineno"> 1728</span>                                        <span class="keywordflow">for</span> (Size i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno"> 1729</span>                                            Real mon = <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>[i];</div>
<div class="line"><span class="lineno"> 1730</span>                                            <span class="comment">// strike (assuming forward prices)</span></div>
<div class="line"><span class="lineno"> 1731</span>                                            Real k = eqCurve-&gt;forecastFixing(dates[j]) * mon;</div>
<div class="line"><span class="lineno"> 1732</span>                                            Size idx = i * m + j;</div>
<div class="line"><span class="lineno"> 1733</span>                                            <a class="code hl_enumvalueRef" href="../ored/namespaceore_1_1data.html#a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf">Volatility</a> vol = wrapper-&gt;blackVol(dates[j], k);</div>
<div class="line"><span class="lineno"> 1734</span>                                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno"> 1735</span>                                                <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol));</div>
<div class="line"><span class="lineno"> 1736</span>                                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1737</span>                                                               std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1738</span>                                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1739</span>                                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1740</span>                                                absoluteSimDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 1741</span>                                                    std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1742</span>                                                    std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1743</span>                                                    std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 1744</span>                                            }</div>
<div class="line"><span class="lineno"> 1745</span>                                            quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 1746</span>                                        }</div>
<div class="line"><span class="lineno"> 1747</span>                                    }</div>
<div class="line"><span class="lineno"> 1748</span>                                    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {strikes, times});</div>
<div class="line"><span class="lineno"> 1749</span>                                    simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1750</span>                                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating EQ Vols (BlackVarianceSurfaceMoneyness) for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1751</span>                                    </div>
<div class="line"><span class="lineno"> 1752</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1753</span>                                        eqVolCurve = QuantLib::ext::make_shared&lt;SpreadedBlackVolatilitySurfaceMoneynessForward&gt;(</div>
<div class="line"><span class="lineno"> 1754</span>                                            Handle&lt;BlackVolTermStructure&gt;(wrapper), spot, times,</div>
<div class="line"><span class="lineno"> 1755</span>                                            parameters-&gt;equityVolMoneyness(name), quotes,</div>
<div class="line"><span class="lineno"> 1756</span>                                            Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(spot-&gt;value())),</div>
<div class="line"><span class="lineno"> 1757</span>                                            initMarket-&gt;equityCurve(name, configuration)-&gt;equityDividendCurve(),</div>
<div class="line"><span class="lineno"> 1758</span>                                            initMarket-&gt;equityCurve(name, configuration)-&gt;equityForecastCurve(),</div>
<div class="line"><span class="lineno"> 1759</span>                                            eqCurve-&gt;equityDividendCurve(), eqCurve-&gt;equityForecastCurve(),</div>
<div class="line"><span class="lineno"> 1760</span>                                            stickyStrike);</div>
<div class="line"><span class="lineno"> 1761</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1762</span>                                        <span class="comment">// FIXME should that be Forward, since we read the vols at fwd moneyness above?</span></div>
<div class="line"><span class="lineno"> 1763</span>                                        eqVolCurve = QuantLib::ext::make_shared&lt;BlackVarianceSurfaceMoneynessSpot&gt;(</div>
<div class="line"><span class="lineno"> 1764</span>                                            cal, spot, times, parameters-&gt;equityVolMoneyness(name), quotes, dc,</div>
<div class="line"><span class="lineno"> 1765</span>                                            stickyStrike);</div>
<div class="line"><span class="lineno"> 1766</span>                                    }</div>
<div class="line"><span class="lineno"> 1767</span>                                    eqVolCurve-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1768</span> </div>
<div class="line"><span class="lineno"> 1769</span>                                } <span class="keywordflow">else</span> { <span class="comment">// standard deviations surface</span></div>
<div class="line"><span class="lineno"> 1770</span>                                    <span class="comment">// forwards</span></div>
<div class="line"><span class="lineno"> 1771</span>                                    vector&lt;Real&gt; fwds;</div>
<div class="line"><span class="lineno"> 1772</span>                                    vector&lt;Real&gt; atmVols;</div>
<div class="line"><span class="lineno"> 1773</span>                                    <span class="keywordflow">for</span> (Size i = 0; i &lt; expiries.size(); i++) {</div>
<div class="line"><span class="lineno"> 1774</span>                                        <span class="keyword">auto</span> eqForward = eqCurve-&gt;forecastFixing(dates[i]);</div>
<div class="line"><span class="lineno"> 1775</span>                                        fwds.push_back(eqForward);</div>
<div class="line"><span class="lineno"> 1776</span>                                        atmVols.push_back(wrapper-&gt;blackVol(dates[i], eqForward));</div>
<div class="line"><span class="lineno"> 1777</span>                                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;on date &quot;</span> &lt;&lt; dates[i] &lt;&lt; <span class="stringliteral">&quot;: fwd = &quot;</span> &lt;&lt; fwds.back()</div>
<div class="line"><span class="lineno"> 1778</span>                                                        &lt;&lt; <span class="stringliteral">&quot;, atmVol = &quot;</span> &lt;&lt; atmVols.back());</div>
<div class="line"><span class="lineno"> 1779</span>                                    }</div>
<div class="line"><span class="lineno"> 1780</span> </div>
<div class="line"><span class="lineno"> 1781</span>                                    <span class="comment">// interpolations</span></div>
<div class="line"><span class="lineno"> 1782</span>                                    Interpolation forwardCurve =</div>
<div class="line"><span class="lineno"> 1783</span>                                        Linear().interpolate(times.begin(), times.end(), fwds.begin());</div>
<div class="line"><span class="lineno"> 1784</span>                                    Interpolation atmVolCurve =</div>
<div class="line"><span class="lineno"> 1785</span>                                        Linear().interpolate(times.begin(), times.end(), atmVols.begin());</div>
<div class="line"><span class="lineno"> 1786</span> </div>
<div class="line"><span class="lineno"> 1787</span>                                    <span class="comment">// populate quotes</span></div>
<div class="line"><span class="lineno"> 1788</span>                                    vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; absQuotes(n,</div>
<div class="line"><span class="lineno"> 1789</span>                                                                            vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1790</span>                                    <a class="code hl_functionRef" href="../qle/class_quant_ext_1_1_black_variance_surface_std_devs.html#ae16f88d114d997f6ab73eed253ee0a10">BlackVarianceSurfaceStdDevs::populateVolMatrix</a>(wrapper, absQuotes, times, strikes,</div>
<div class="line"><span class="lineno"> 1791</span>                                                                                   forwardCurve, atmVolCurve);</div>
<div class="line"><span class="lineno"> 1792</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1793</span>                                        <span class="keywordflow">for</span> (Size i = 0; i &lt; n; ++i)</div>
<div class="line"><span class="lineno"> 1794</span>                                            <span class="keywordflow">for</span> (Size j = 0; j &lt; m; ++j)</div>
<div class="line"><span class="lineno"> 1795</span>                                                quotes[i][j] = Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(0.0));</div>
<div class="line"><span class="lineno"> 1796</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1797</span>                                        quotes = absQuotes;</div>
<div class="line"><span class="lineno"> 1798</span>                                    }</div>
<div class="line"><span class="lineno"> 1799</span> </div>
<div class="line"><span class="lineno"> 1800</span>                                    <span class="comment">// add to simDataTemp</span></div>
<div class="line"><span class="lineno"> 1801</span>                                    <span class="keywordflow">for</span> (Size i = 0; i &lt; m; i++) {</div>
<div class="line"><span class="lineno"> 1802</span>                                        <span class="keywordflow">for</span> (Size j = 0; j &lt; n; j++) {</div>
<div class="line"><span class="lineno"> 1803</span>                                            Size idx = j * m + i;</div>
<div class="line"><span class="lineno"> 1804</span>                                            QuantLib::ext::shared_ptr&lt;Quote&gt; q = quotes[j][i].currentLink();</div>
<div class="line"><span class="lineno"> 1805</span>                                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; sq =</div>
<div class="line"><span class="lineno"> 1806</span>                                                QuantLib::ext::dynamic_pointer_cast&lt;SimpleQuote&gt;(q);</div>
<div class="line"><span class="lineno"> 1807</span>                                            QL_REQUIRE(sq, <span class="stringliteral">&quot;Quote is not a SimpleQuote&quot;</span>); <span class="comment">// why do we need this?</span></div>
<div class="line"><span class="lineno"> 1808</span>                                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1809</span>                                                               std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1810</span>                                                               std::forward_as_tuple(sq));</div>
<div class="line"><span class="lineno"> 1811</span>                                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1812</span>                                                absoluteSimDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 1813</span>                                                    std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1814</span>                                                    std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1815</span>                                                    std::forward_as_tuple(absQuotes[j][i]-&gt;value()));</div>
<div class="line"><span class="lineno"> 1816</span>                                            }</div>
<div class="line"><span class="lineno"> 1817</span>                                        }</div>
<div class="line"><span class="lineno"> 1818</span>                                    }</div>
<div class="line"><span class="lineno"> 1819</span>                                    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {strikes, times});</div>
<div class="line"><span class="lineno"> 1820</span>                                    simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1821</span>                                    <span class="keywordtype">bool</span> flatExtrapolation = <span class="keyword">true</span>; <span class="comment">// flat extrapolation of strikes at far ends.</span></div>
<div class="line"><span class="lineno"> 1822</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1823</span>                                        eqVolCurve = QuantLib::ext::make_shared&lt;SpreadedBlackVolatilitySurfaceStdDevs&gt;(</div>
<div class="line"><span class="lineno"> 1824</span>                                            Handle&lt;BlackVolTermStructure&gt;(wrapper), spot, times,</div>
<div class="line"><span class="lineno"> 1825</span>                                            parameters-&gt;equityVolStandardDevs(name), quotes,</div>
<div class="line"><span class="lineno"> 1826</span>                                            Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(spot-&gt;value())),</div>
<div class="line"><span class="lineno"> 1827</span>                                            initMarket-&gt;equityCurve(name, configuration)-&gt;equityDividendCurve(),</div>
<div class="line"><span class="lineno"> 1828</span>                                            initMarket-&gt;equityCurve(name, configuration)-&gt;equityForecastCurve(),</div>
<div class="line"><span class="lineno"> 1829</span>                                            eqCurve-&gt;equityDividendCurve(), eqCurve-&gt;equityForecastCurve(),</div>
<div class="line"><span class="lineno"> 1830</span>                                            stickyStrike);</div>
<div class="line"><span class="lineno"> 1831</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1832</span>                                        eqVolCurve = QuantLib::ext::make_shared&lt;BlackVarianceSurfaceStdDevs&gt;(</div>
<div class="line"><span class="lineno"> 1833</span>                                            cal, spot, times, parameters-&gt;equityVolStandardDevs(name), quotes, dc,</div>
<div class="line"><span class="lineno"> 1834</span>                                            eqCurve.currentLink(), stickyStrike, flatExtrapolation);</div>
<div class="line"><span class="lineno"> 1835</span>                                    }</div>
<div class="line"><span class="lineno"> 1836</span>                                }</div>
<div class="line"><span class="lineno"> 1837</span>                            } <span class="keywordflow">else</span> { <span class="comment">// not a surface - case for ATM or simulateATMOnly</span></div>
<div class="line"><span class="lineno"> 1838</span>                                quotes.resize(1, vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 1839</span>                                <span class="comment">// Only need ATM quotes in this case</span></div>
<div class="line"><span class="lineno"> 1840</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; m; j++) {</div>
<div class="line"><span class="lineno"> 1841</span>                                    <span class="comment">// Index is expires then moneyness. TODO: is this the best?</span></div>
<div class="line"><span class="lineno"> 1842</span>                                    Size idx = j;</div>
<div class="line"><span class="lineno"> 1843</span>                                    <span class="keyword">auto</span> eqForward = eqCurve-&gt;fixing(dates[j]);</div>
<div class="line"><span class="lineno"> 1844</span>                                    <a class="code hl_enumvalueRef" href="../ored/namespaceore_1_1data.html#a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf">Volatility</a> vol = wrapper-&gt;blackVol(dates[j], eqForward);</div>
<div class="line"><span class="lineno"> 1845</span>                                    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno"> 1846</span>                                        <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol));</div>
<div class="line"><span class="lineno"> 1847</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1848</span>                                                       std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1849</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1850</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1851</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1852</span>                                                                   std::forward_as_tuple(param.first, name, idx),</div>
<div class="line"><span class="lineno"> 1853</span>                                                                   std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 1854</span>                                    }</div>
<div class="line"><span class="lineno"> 1855</span>                                    quotes[0][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 1856</span>                                }</div>
<div class="line"><span class="lineno"> 1857</span> </div>
<div class="line"><span class="lineno"> 1858</span>                                <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {times});</div>
<div class="line"><span class="lineno"> 1859</span>                                simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1860</span> </div>
<div class="line"><span class="lineno"> 1861</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1862</span>                                    <span class="comment">// if simulate atm only is false, we use the ATM slice from the wrapper only</span></div>
<div class="line"><span class="lineno"> 1863</span>                                    <span class="comment">// the smile dynamics is sticky strike here always (if t0 is a surface)</span></div>
<div class="line"><span class="lineno"> 1864</span>                                    eqVolCurve = QuantLib::ext::make_shared&lt;SpreadedBlackVolatilityCurve&gt;(</div>
<div class="line"><span class="lineno"> 1865</span>                                        Handle&lt;BlackVolTermStructure&gt;(wrapper), times, quotes[0],</div>
<div class="line"><span class="lineno"> 1866</span>                                        !parameters-&gt;simulateEquityVolATMOnly());</div>
<div class="line"><span class="lineno"> 1867</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1868</span>                                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;ATM EQ Vols (BlackVarianceCurve3) for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1869</span>                                    QuantLib::ext::shared_ptr&lt;BlackVolTermStructure&gt; atmCurve;</div>
<div class="line"><span class="lineno"> 1870</span>                                    atmCurve = QuantLib::ext::make_shared&lt;BlackVarianceCurve3&gt;(0, NullCalendar(),</div>
<div class="line"><span class="lineno"> 1871</span>                                                                                       wrapper-&gt;businessDayConvention(),</div>
<div class="line"><span class="lineno"> 1872</span>                                                                                       dc, times, quotes[0], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1873</span>                                    <span class="comment">// if we have a surface but are only simulating atm vols we wrap the atm curve and</span></div>
<div class="line"><span class="lineno"> 1874</span>                                    <span class="comment">// the full t0 surface</span></div>
<div class="line"><span class="lineno"> 1875</span>                                    <span class="keywordflow">if</span> (parameters-&gt;simulateEquityVolATMOnly()) {</div>
<div class="line"><span class="lineno"> 1876</span>                                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating EQ Vols (EquityVolatilityConstantSpread) for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1877</span>                                        eqVolCurve = QuantLib::ext::make_shared&lt;BlackVolatilityConstantSpread&gt;(</div>
<div class="line"><span class="lineno"> 1878</span>                                            Handle&lt;BlackVolTermStructure&gt;(atmCurve), wrapper);</div>
<div class="line"><span class="lineno"> 1879</span>                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1880</span>                                        eqVolCurve = atmCurve;</div>
<div class="line"><span class="lineno"> 1881</span>                                    }</div>
<div class="line"><span class="lineno"> 1882</span>                                }</div>
<div class="line"><span class="lineno"> 1883</span>                            }</div>
<div class="line"><span class="lineno"> 1884</span>                            evh = Handle&lt;BlackVolTermStructure&gt;(eqVolCurve);</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1887</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;equityVolDecayMode();</div>
<div class="line"><span class="lineno"> 1888</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Deterministic EQ Vols with decay mode &quot;</span> &lt;&lt; decayModeString &lt;&lt; <span class="stringliteral">&quot; for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1889</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno"> 1890</span> </div>
<div class="line"><span class="lineno"> 1891</span>                            <span class="comment">// currently only curves (i.e. strike independent) EQ volatility structures are</span></div>
<div class="line"><span class="lineno"> 1892</span>                            <span class="comment">// supported, so we use a) the more efficient curve tag and b) a hard coded sticky</span></div>
<div class="line"><span class="lineno"> 1893</span>                            <span class="comment">// strike stickiness, since then no yield term structures and no EQ spot are required</span></div>
<div class="line"><span class="lineno"> 1894</span>                            <span class="comment">// that define the ATM level - to be revisited when EQ surfaces are supported</span></div>
<div class="line"><span class="lineno"> 1895</span>                            evh = Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 1896</span>                                QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_dynamic_black_vol_term_structure.html">QuantExt::DynamicBlackVolTermStructure&lt;tag::curve&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 1897</span>                                    wrapper, 0, NullCalendar(), decayMode,</div>
<div class="line"><span class="lineno"> 1898</span>                                    stickyStrike ? <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa7958a422936150bb6ec2a9634789f7d5">StickyStrike</a> : <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa3c712c65297116157beb42df5b5a2273">StickyLogMoneyness</a>));</div>
<div class="line"><span class="lineno"> 1899</span>                        }</div>
<div class="line"><span class="lineno"> 1900</span> </div>
<div class="line"><span class="lineno"> 1901</span>                        evh-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1902</span>                        <span class="keywordflow">if</span> (wrapper-&gt;allowsExtrapolation())</div>
<div class="line"><span class="lineno"> 1903</span>                            evh-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 1904</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ada78e1e842b03e527818f6d6b9fc3bcf">equityVols_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), evh));</div>
<div class="line"><span class="lineno"> 1905</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;EQ volatility curve built for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1906</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1907</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1908</span>                    }</div>
<div class="line"><span class="lineno"> 1909</span>                }</div>
<div class="line"><span class="lineno"> 1910</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1911</span> </div>
<div class="line"><span class="lineno"> 1912</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba">RiskFactorKey::KeyType::BaseCorrelation</a>:</div>
<div class="line"><span class="lineno"> 1913</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 1914</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1915</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 1916</span>                        Handle&lt;QuantExt::BaseCorrelationTermStructure&gt; wrapper =</div>
<div class="line"><span class="lineno"> 1917</span>                            initMarket-&gt;baseCorrelation(name, configuration);</div>
<div class="line"><span class="lineno"> 1918</span>                        <span class="keywordflow">if</span> (!param.second.first)</div>
<div class="line"><span class="lineno"> 1919</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa7e08433597ac99460ac5bfc347173c0">baseCorrelations_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), wrapper));</div>
<div class="line"><span class="lineno"> 1920</span>                        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1921</span>                            std::vector&lt;Real&gt; times;</div>
<div class="line"><span class="lineno"> 1922</span>                            Size nd = parameters-&gt;baseCorrelationDetachmentPoints().size();</div>
<div class="line"><span class="lineno"> 1923</span>                            Size nt = parameters-&gt;baseCorrelationTerms().size();</div>
<div class="line"><span class="lineno"> 1924</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes(nd, vector&lt;Handle&lt;Quote&gt;&gt;(nt));</div>
<div class="line"><span class="lineno"> 1925</span>                            vector&lt;Period&gt; terms(nt);</div>
<div class="line"><span class="lineno"> 1926</span>                            vector&lt;double&gt; detachmentPoints(nd);</div>
<div class="line"><span class="lineno"> 1927</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; nd; ++i) {</div>
<div class="line"><span class="lineno"> 1928</span>                                Real lossLevel = parameters-&gt;baseCorrelationDetachmentPoints()[i];</div>
<div class="line"><span class="lineno"> 1929</span>                                detachmentPoints[i] = lossLevel;</div>
<div class="line"><span class="lineno"> 1930</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; nt; ++j) {</div>
<div class="line"><span class="lineno"> 1931</span>                                    Period term = parameters-&gt;baseCorrelationTerms()[j];</div>
<div class="line"><span class="lineno"> 1932</span>                                    <span class="keywordflow">if</span> (i == 0)</div>
<div class="line"><span class="lineno"> 1933</span>                                        terms[j] = term;</div>
<div class="line"><span class="lineno"> 1934</span>                                    times.push_back(wrapper-&gt;timeFromReference(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + term));</div>
<div class="line"><span class="lineno"> 1935</span>                                    Real bc = wrapper-&gt;correlation(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + term, lossLevel, <span class="keyword">true</span>); <span class="comment">// extrapolate</span></div>
<div class="line"><span class="lineno"> 1936</span>                                    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q =</div>
<div class="line"><span class="lineno"> 1937</span>                                        QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : bc);</div>
<div class="line"><span class="lineno"> 1938</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1939</span>                                                       std::forward_as_tuple(param.first, name, i * nt + j),</div>
<div class="line"><span class="lineno"> 1940</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 1941</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1942</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 1943</span>                                                                   std::forward_as_tuple(param.first, name, i * nt + j),</div>
<div class="line"><span class="lineno"> 1944</span>                                                                   std::forward_as_tuple(bc));</div>
<div class="line"><span class="lineno"> 1945</span>                                    }</div>
<div class="line"><span class="lineno"> 1946</span>                                    quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 1947</span>                                }</div>
<div class="line"><span class="lineno"> 1948</span>                            }</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(</div>
<div class="line"><span class="lineno"> 1951</span>                                simDataTmp, absoluteSimDataTmp, param.first, name,</div>
<div class="line"><span class="lineno"> 1952</span>                                {parameters-&gt;baseCorrelationDetachmentPoints(), times});</div>
<div class="line"><span class="lineno"> 1953</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1954</span> </div>
<div class="line"><span class="lineno"> 1955</span>                            <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1956</span>                            <span class="keywordflow">if</span> (nt == 1) {                           </div>
<div class="line"><span class="lineno"> 1957</span>                                terms.push_back(terms[0] + 1 * terms[0].units()); <span class="comment">// arbitrary, but larger than the first term</span></div>
<div class="line"><span class="lineno"> 1958</span>                                <span class="keywordflow">for</span> (Size i = 0; i &lt; nd; ++i)</div>
<div class="line"><span class="lineno"> 1959</span>                                    quotes[i].push_back(quotes[i][0]);</div>
<div class="line"><span class="lineno"> 1960</span>                            }</div>
<div class="line"><span class="lineno"> 1961</span> </div>
<div class="line"><span class="lineno"> 1962</span>                            <span class="keywordflow">if</span> (nd == 1) {</div>
<div class="line"><span class="lineno"> 1963</span>                                quotes.push_back(vector&lt;Handle&lt;Quote&gt;&gt;(terms.size()));</div>
<div class="line"><span class="lineno"> 1964</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; terms.size(); ++j)</div>
<div class="line"><span class="lineno"> 1965</span>                                    quotes[1][j] = quotes[0][j];</div>
<div class="line"><span class="lineno"> 1966</span> </div>
<div class="line"><span class="lineno"> 1967</span>                                <span class="keywordflow">if</span> (detachmentPoints[0] &lt; 1.0 &amp;&amp; !QuantLib::close_enough(detachmentPoints[0], 1.0)) {</div>
<div class="line"><span class="lineno"> 1968</span>                                    detachmentPoints.push_back(1.0);</div>
<div class="line"><span class="lineno"> 1969</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1970</span>                                    detachmentPoints.insert(detachmentPoints.begin(), 0.01); <span class="comment">// arbitrary, but larger than then 0 and less than 1.0</span></div>
<div class="line"><span class="lineno"> 1971</span>                                }</div>
<div class="line"><span class="lineno"> 1972</span>                            }</div>
<div class="line"><span class="lineno"> 1973</span>                            </div>
<div class="line"><span class="lineno"> 1974</span>                            QuantLib::ext::shared_ptr&lt;QuantExt::BaseCorrelationTermStructure&gt; bcp;</div>
<div class="line"><span class="lineno"> 1975</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 1976</span>                                bcp = QuantLib::ext::make_shared&lt;QuantExt::SpreadedBaseCorrelationCurve&gt;(</div>
<div class="line"><span class="lineno"> 1977</span>                                    wrapper, terms, detachmentPoints, quotes);</div>
<div class="line"><span class="lineno"> 1978</span>                                bcp-&gt;enableExtrapolation(wrapper-&gt;allowsExtrapolation());</div>
<div class="line"><span class="lineno"> 1979</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1980</span>                                DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 1981</span>                                bcp = QuantLib::ext::make_shared&lt;InterpolatedBaseCorrelationTermStructure&lt;Bilinear&gt;&gt;(</div>
<div class="line"><span class="lineno"> 1982</span>                                    wrapper-&gt;settlementDays(), wrapper-&gt;calendar(), wrapper-&gt;businessDayConvention(),</div>
<div class="line"><span class="lineno"> 1983</span>                                    terms, detachmentPoints, quotes, dc);</div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>                                bcp-&gt;enableExtrapolation(wrapper-&gt;allowsExtrapolation());</div>
<div class="line"><span class="lineno"> 1986</span>                            }</div>
<div class="line"><span class="lineno"> 1987</span>                            bcp-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1988</span>                            Handle&lt;QuantExt::BaseCorrelationTermStructure&gt; bch(bcp);</div>
<div class="line"><span class="lineno"> 1989</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa7e08433597ac99460ac5bfc347173c0">baseCorrelations_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), bch));</div>
<div class="line"><span class="lineno"> 1990</span>                        }</div>
<div class="line"><span class="lineno"> 1991</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Base correlations built for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 1992</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 1993</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 1994</span>                    }</div>
<div class="line"><span class="lineno"> 1995</span>                }</div>
<div class="line"><span class="lineno"> 1996</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1997</span> </div>
<div class="line"><span class="lineno"> 1998</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca6e7c1dee048f032ac6ff1a0b21a396e2">RiskFactorKey::KeyType::CPIIndex</a>:</div>
<div class="line"><span class="lineno"> 1999</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2000</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2001</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2002</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;adding &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; base CPI price&quot;</span>);</div>
<div class="line"><span class="lineno"> 2003</span>                        Handle&lt;ZeroInflationIndex&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a> =</div>
<div class="line"><span class="lineno"> 2004</span>                            initMarket-&gt;zeroInflationIndex(name, configuration);</div>
<div class="line"><span class="lineno"> 2005</span>                        Period obsLag = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a>-&gt;zeroInflationTermStructure()-&gt;observationLag();</div>
<div class="line"><span class="lineno"> 2006</span>                        Date <a class="code hl_functionRef" href="../qle/namespace_quant_ext_1_1_zero_inflation.html#a57de786c1c8988b6da9d354282b4b370">fixingDate</a> = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a>-&gt;zeroInflationTermStructure()-&gt;baseDate();</div>
<div class="line"><span class="lineno"> 2007</span>                        Real baseCPI = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a>-&gt;fixing(fixingDate);</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>                        QuantLib::ext::shared_ptr&lt;InflationIndex&gt; inflationIndex =</div>
<div class="line"><span class="lineno"> 2010</span>                            QuantLib::ext::dynamic_pointer_cast&lt;InflationIndex&gt;(*<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a>);</div>
<div class="line"><span class="lineno"> 2011</span> </div>
<div class="line"><span class="lineno"> 2012</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(baseCPI);</div>
<div class="line"><span class="lineno"> 2013</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2014</span>                            <span class="keyword">auto</span> m = [baseCPI](Real x) { <span class="keywordflow">return</span> x * baseCPI; };</div>
<div class="line"><span class="lineno"> 2015</span>                            Handle&lt;InflationIndexObserver&gt; inflObserver(</div>
<div class="line"><span class="lineno"> 2016</span>                                QuantLib::ext::make_shared&lt;InflationIndexObserver&gt;(</div>
<div class="line"><span class="lineno"> 2017</span>                                    inflationIndex,</div>
<div class="line"><span class="lineno"> 2018</span>                                    Handle&lt;Quote&gt;(</div>
<div class="line"><span class="lineno"> 2019</span>                                        QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(Handle&lt;Quote&gt;(q), m)),</div>
<div class="line"><span class="lineno"> 2020</span>                                    obsLag));</div>
<div class="line"><span class="lineno"> 2021</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a598238b952f3026fc385030cfa02b5dd">baseCpis_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), inflObserver));</div>
<div class="line"><span class="lineno"> 2022</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2023</span>                            Handle&lt;InflationIndexObserver&gt; inflObserver(</div>
<div class="line"><span class="lineno"> 2024</span>                                QuantLib::ext::make_shared&lt;InflationIndexObserver&gt;(inflationIndex, Handle&lt;Quote&gt;(q),</div>
<div class="line"><span class="lineno"> 2025</span>                                                                                   obsLag));</div>
<div class="line"><span class="lineno"> 2026</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a598238b952f3026fc385030cfa02b5dd">baseCpis_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), inflObserver));</div>
<div class="line"><span class="lineno"> 2027</span>                        }</div>
<div class="line"><span class="lineno"> 2028</span>                        simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno"> 2029</span>                                           std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2030</span>                        <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2031</span>                            absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2032</span>                                                       std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno"> 2033</span>                                                       std::forward_as_tuple(baseCPI));</div>
<div class="line"><span class="lineno"> 2034</span>                        }</div>
<div class="line"><span class="lineno"> 2035</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {});</div>
<div class="line"><span class="lineno"> 2036</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2037</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2038</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2039</span>                    }</div>
<div class="line"><span class="lineno"> 2040</span>                }</div>
<div class="line"><span class="lineno"> 2041</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2042</span> </div>
<div class="line"><span class="lineno"> 2043</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023">RiskFactorKey::KeyType::ZeroInflationCurve</a>:</div>
<div class="line"><span class="lineno"> 2044</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2045</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2046</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2047</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; zero inflation curve&quot;</span>);</div>
<div class="line"><span class="lineno"> 2048</span> </div>
<div class="line"><span class="lineno"> 2049</span>                        Handle&lt;ZeroInflationIndex&gt; inflationIndex = initMarket-&gt;zeroInflationIndex(name, configuration);</div>
<div class="line"><span class="lineno"> 2050</span>                        Handle&lt;ZeroInflationTermStructure&gt; inflationTs = inflationIndex-&gt;zeroInflationTermStructure();</div>
<div class="line"><span class="lineno"> 2051</span>                        vector&lt;string&gt; keys(parameters-&gt;zeroInflationTenors(name).size());</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>                        Date date0 = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> - inflationTs-&gt;observationLag();</div>
<div class="line"><span class="lineno"> 2054</span>                        DayCounter dc = inflationTs-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2055</span>                        vector&lt;Date&gt; quoteDates;</div>
<div class="line"><span class="lineno"> 2056</span>                        vector&lt;Time&gt; zeroCurveTimes(</div>
<div class="line"><span class="lineno"> 2057</span>                            1, -dc.yearFraction(inflationPeriod(date0, inflationTs-&gt;frequency()).first, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>));</div>
<div class="line"><span class="lineno"> 2058</span>                        vector&lt;Handle&lt;Quote&gt;&gt; quotes;</div>
<div class="line"><span class="lineno"> 2059</span>                        QL_REQUIRE(parameters-&gt;zeroInflationTenors(name).front() &gt; 0 * Days,</div>
<div class="line"><span class="lineno"> 2060</span>                                   <span class="stringliteral">&quot;zero inflation tenors must not include t=0&quot;</span>);</div>
<div class="line"><span class="lineno"> 2061</span> </div>
<div class="line"><span class="lineno"> 2062</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; tenor : parameters-&gt;zeroInflationTenors(name)) {</div>
<div class="line"><span class="lineno"> 2063</span>                            Date inflDate = inflationPeriod(date0 + tenor, inflationTs-&gt;frequency()).first;</div>
<div class="line"><span class="lineno"> 2064</span>                            zeroCurveTimes.push_back(dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, inflDate));</div>
<div class="line"><span class="lineno"> 2065</span>                            quoteDates.push_back(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + tenor);</div>
<div class="line"><span class="lineno"> 2066</span>                        }</div>
<div class="line"><span class="lineno"> 2067</span> </div>
<div class="line"><span class="lineno"> 2068</span>                        <span class="keywordflow">for</span> (Size i = 1; i &lt; zeroCurveTimes.size(); i++) {</div>
<div class="line"><span class="lineno"> 2069</span>                            Real rate = inflationTs-&gt;zeroRate(quoteDates[i - 1]);</div>
<div class="line"><span class="lineno"> 2070</span>                            <span class="keywordflow">if</span> (inflationTs-&gt;hasSeasonality()) {</div>
<div class="line"><span class="lineno"> 2071</span>                                Date <a class="code hl_functionRef" href="../qle/namespace_quant_ext_1_1_zero_inflation.html#a57de786c1c8988b6da9d354282b4b370">fixingDate</a> = quoteDates[i - 1] - inflationTs-&gt;observationLag();</div>
<div class="line"><span class="lineno"> 2072</span>                                rate = inflationTs-&gt;seasonality()-&gt;deseasonalisedZeroRate(fixingDate,                                 </div>
<div class="line"><span class="lineno"> 2073</span>                                    rate, *inflationTs.currentLink());</div>
<div class="line"><span class="lineno"> 2074</span>                            }</div>
<div class="line"><span class="lineno"> 2075</span>                            <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : rate);</div>
<div class="line"><span class="lineno"> 2076</span>                            <span class="keywordflow">if</span> (i == 1) {</div>
<div class="line"><span class="lineno"> 2077</span>                                <span class="comment">// add the zero rate at first tenor to the T0 time, to ensure flat interpolation of T1</span></div>
<div class="line"><span class="lineno"> 2078</span>                                <span class="comment">// rate for time t T0 &lt; t &lt; T1</span></div>
<div class="line"><span class="lineno"> 2079</span>                                quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno"> 2080</span>                            }</div>
<div class="line"><span class="lineno"> 2081</span>                            quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno"> 2082</span>                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2083</span>                                               std::forward_as_tuple(param.first, name, i - 1),</div>
<div class="line"><span class="lineno"> 2084</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2085</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>)</div>
<div class="line"><span class="lineno"> 2086</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2087</span>                                                           std::forward_as_tuple(param.first, name, i - 1),</div>
<div class="line"><span class="lineno"> 2088</span>                                                           std::forward_as_tuple(rate));</div>
<div class="line"><span class="lineno"> 2089</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;ScenarioSimMarket zero inflation curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; zeroRate[&quot;</span> &lt;&lt; i</div>
<div class="line"><span class="lineno"> 2090</span>                                                                           &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; rate);</div>
<div class="line"><span class="lineno"> 2091</span>                        }</div>
<div class="line"><span class="lineno"> 2092</span> </div>
<div class="line"><span class="lineno"> 2093</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name,</div>
<div class="line"><span class="lineno"> 2094</span>                                     {std::vector&lt;Real&gt;(std::next(zeroCurveTimes.begin(), 1), zeroCurveTimes.end())});</div>
<div class="line"><span class="lineno"> 2095</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2096</span>                                                </div>
<div class="line"><span class="lineno"> 2097</span>                        <span class="comment">// FIXME: Settlement days set to zero - needed for floating term structure implementation</span></div>
<div class="line"><span class="lineno"> 2098</span>                        QuantLib::ext::shared_ptr&lt;ZeroInflationTermStructure&gt; zeroCurve;</div>
<div class="line"><span class="lineno"> 2099</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2100</span>                            zeroCurve =</div>
<div class="line"><span class="lineno"> 2101</span>                                QuantLib::ext::make_shared&lt;SpreadedZeroInflationCurve&gt;(inflationTs, zeroCurveTimes, quotes);</div>
<div class="line"><span class="lineno"> 2102</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2103</span>                            zeroCurve = QuantLib::ext::make_shared&lt;ZeroInflationCurveObserverMoving&lt;Linear&gt;&gt;(</div>
<div class="line"><span class="lineno"> 2104</span>                                0, inflationIndex-&gt;fixingCalendar(), dc, inflationTs-&gt;observationLag(),</div>
<div class="line"><span class="lineno"> 2105</span>                                inflationTs-&gt;frequency(), <span class="keyword">false</span>, zeroCurveTimes, quotes,</div>
<div class="line"><span class="lineno"> 2106</span>                                inflationTs-&gt;seasonality());</div>
<div class="line"><span class="lineno"> 2107</span>                        }</div>
<div class="line"><span class="lineno"> 2108</span> </div>
<div class="line"><span class="lineno"> 2109</span>                        Handle&lt;ZeroInflationTermStructure&gt; its(zeroCurve);</div>
<div class="line"><span class="lineno"> 2110</span>                        its-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2111</span>                        its-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 2112</span>                        QuantLib::ext::shared_ptr&lt;ZeroInflationIndex&gt; i =</div>
<div class="line"><span class="lineno"> 2113</span>                            <a class="code hl_functionRef" href="../ored/group__utilities.html#ga03699115fbdbcf46b6351c3735fdec87">parseZeroInflationIndex</a>(name, Handle&lt;ZeroInflationTermStructure&gt;(its));</div>
<div class="line"><span class="lineno"> 2114</span>                        Handle&lt;ZeroInflationIndex&gt; zh(i);</div>
<div class="line"><span class="lineno"> 2115</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac4b30e0d4ca91a8246986ea7173164fc">zeroInflationIndices_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), zh));</div>
<div class="line"><span class="lineno"> 2116</span> </div>
<div class="line"><span class="lineno"> 2117</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; zero inflation curve done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2118</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2119</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2120</span>                    }</div>
<div class="line"><span class="lineno"> 2121</span>                }</div>
<div class="line"><span class="lineno"> 2122</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2123</span> </div>
<div class="line"><span class="lineno"> 2124</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2">RiskFactorKey::KeyType::ZeroInflationCapFloorVolatility</a>:</div>
<div class="line"><span class="lineno"> 2125</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2126</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2127</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2128</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; zero inflation cap/floor volatility curve...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2129</span>                        Handle&lt;QuantLib::CPIVolatilitySurface&gt; wrapper =</div>
<div class="line"><span class="lineno"> 2130</span>                            initMarket-&gt;cpiInflationCapFloorVolatilitySurface(name, configuration);</div>
<div class="line"><span class="lineno"> 2131</span>                        Handle&lt;ZeroInflationIndex&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a> =</div>
<div class="line"><span class="lineno"> 2132</span>                            initMarket-&gt;zeroInflationIndex(name, configuration);</div>
<div class="line"><span class="lineno"> 2133</span>                        <span class="comment">// LOG(&quot;Initial market zero inflation cap/floor volatility type = &quot; &lt;&lt;</span></div>
<div class="line"><span class="lineno"> 2134</span>                        <span class="comment">// wrapper-&gt;volatilityType());</span></div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>                        Handle&lt;QuantLib::CPIVolatilitySurface&gt; hCpiVol;</div>
<div class="line"><span class="lineno"> 2137</span> </div>
<div class="line"><span class="lineno"> 2138</span>                        <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno"> 2139</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 2140</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating zero inflation cap/floor vols for index name &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2141</span> </div>
<div class="line"><span class="lineno"> 2142</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2143</span>                            vector&lt;Period&gt; optionTenors = parameters-&gt;zeroInflationCapFloorVolExpiries(name);</div>
<div class="line"><span class="lineno"> 2144</span>                            vector&lt;Date&gt; optionDates(optionTenors.size());</div>
<div class="line"><span class="lineno"> 2145</span>                            vector&lt;Real&gt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a> = parameters-&gt;zeroInflationCapFloorVolStrikes(name);</div>
<div class="line"><span class="lineno"> 2146</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes(</div>
<div class="line"><span class="lineno"> 2147</span>                                optionTenors.size(), vector&lt;Handle&lt;Quote&gt;&gt;(<a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(), Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 2148</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno"> 2149</span>                                optionDates[i] = wrapper-&gt;optionDateFromTenor(optionTenors[i]);</div>
<div class="line"><span class="lineno"> 2150</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2151</span>                                    Real vol =</div>
<div class="line"><span class="lineno"> 2152</span>                                        wrapper-&gt;volatility(optionTenors[i], strikes[j], wrapper-&gt;observationLag(),</div>
<div class="line"><span class="lineno"> 2153</span>                                                            wrapper-&gt;allowsExtrapolation());</div>
<div class="line"><span class="lineno"> 2154</span>                                    <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol);</div>
<div class="line"><span class="lineno"> 2155</span>                                    Size index = i * <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size() + j;</div>
<div class="line"><span class="lineno"> 2156</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2157</span>                                                       std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 2158</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2159</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2160</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2161</span>                                                                   std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 2162</span>                                                                   std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 2163</span>                                    }</div>
<div class="line"><span class="lineno"> 2164</span>                                    quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 2165</span>                                }</div>
<div class="line"><span class="lineno"> 2166</span>                            }</div>
<div class="line"><span class="lineno"> 2167</span> </div>
<div class="line"><span class="lineno"> 2168</span>                            std::vector&lt;std::vector&lt;Real&gt;&gt; coordinates(2);</div>
<div class="line"><span class="lineno"> 2169</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno"> 2170</span>                                coordinates[0].push_back(</div>
<div class="line"><span class="lineno"> 2171</span>                                    wrapper-&gt;timeFromReference(wrapper-&gt;optionDateFromTenor(optionTenors[i])));</div>
<div class="line"><span class="lineno"> 2172</span>                            }</div>
<div class="line"><span class="lineno"> 2173</span>                            <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2174</span>                                coordinates[1].push_back(strikes[j]);</div>
<div class="line"><span class="lineno"> 2175</span>                            }</div>
<div class="line"><span class="lineno"> 2176</span> </div>
<div class="line"><span class="lineno"> 2177</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, coordinates);</div>
<div class="line"><span class="lineno"> 2178</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2179</span> </div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span> </div>
<div class="line"><span class="lineno"> 2182</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2183</span>                                <span class="keyword">auto</span> surface = QuantLib::ext::dynamic_pointer_cast&lt;QuantExt::CPIVolatilitySurface&gt;(wrapper.currentLink());</div>
<div class="line"><span class="lineno"> 2184</span>                                QL_REQUIRE(surface,</div>
<div class="line"><span class="lineno"> 2185</span>                                           <span class="stringliteral">&quot;Internal error, todays market should build QuantExt::CPIVolatiltiySurface &quot;</span></div>
<div class="line"><span class="lineno"> 2186</span>                                           <span class="stringliteral">&quot;instead of QuantLib::CPIVolatilitySurface&quot;</span>);</div>
<div class="line"><span class="lineno"> 2187</span>                                hCpiVol = Handle&lt;QuantLib::CPIVolatilitySurface&gt;(</div>
<div class="line"><span class="lineno"> 2188</span>                                    QuantLib::ext::make_shared&lt;SpreadedCPIVolatilitySurface&gt;(</div>
<div class="line"><span class="lineno"> 2189</span>                                        Handle&lt;QuantExt::CPIVolatilitySurface&gt;(surface), optionDates, strikes, quotes));</div>
<div class="line"><span class="lineno"> 2190</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2191</span>                                <span class="keyword">auto</span> surface =</div>
<div class="line"><span class="lineno"> 2192</span>                                    QuantLib::ext::dynamic_pointer_cast&lt;QuantExt::CPIVolatilitySurface&gt;(wrapper.currentLink());</div>
<div class="line"><span class="lineno"> 2193</span>                                QL_REQUIRE(surface,</div>
<div class="line"><span class="lineno"> 2194</span>                                           <span class="stringliteral">&quot;Internal error, todays market should build QuantExt::CPIVolatiltiySurface &quot;</span></div>
<div class="line"><span class="lineno"> 2195</span>                                           <span class="stringliteral">&quot;instead of QuantLib::CPIVolatilitySurface&quot;</span>);</div>
<div class="line"><span class="lineno"> 2196</span>                                hCpiVol = Handle&lt;QuantLib::CPIVolatilitySurface&gt;(</div>
<div class="line"><span class="lineno"> 2197</span>                                    QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_interpolated_c_p_i_volatility_surface.html">InterpolatedCPIVolatilitySurface&lt;Bilinear&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 2198</span>                                        optionTenors, strikes, quotes, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">zeroInflationIndex</a>.currentLink(),</div>
<div class="line"><span class="lineno"> 2199</span>                                        wrapper-&gt;settlementDays(), wrapper-&gt;calendar(),</div>
<div class="line"><span class="lineno"> 2200</span>                                        wrapper-&gt;businessDayConvention(), wrapper-&gt;dayCounter(),</div>
<div class="line"><span class="lineno"> 2201</span>                                        wrapper-&gt;observationLag(), surface-&gt;capFloorStartDate(), Bilinear(),</div>
<div class="line"><span class="lineno"> 2202</span>                                        surface-&gt;volatilityType(), surface-&gt;displacement()));</div>
<div class="line"><span class="lineno"> 2203</span>                            }</div>
<div class="line"><span class="lineno"> 2204</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2205</span>                            <span class="comment">// string decayModeString = parameters-&gt;zeroInflationCapFloorVolDecayMode();</span></div>
<div class="line"><span class="lineno"> 2206</span>                            <span class="comment">// ReactionToTimeDecay decayMode = parseDecayMode(decayModeString);</span></div>
<div class="line"><span class="lineno"> 2207</span>                            <span class="comment">// QuantLib::ext::shared_ptr&lt;CPIVolatilitySurface&gt; cpiVol =</span></div>
<div class="line"><span class="lineno"> 2208</span>                            <span class="comment">//     QuantLib::ext::make_shared&lt;QuantExt::DynamicCPIVolatilitySurface&gt;(*wrapper, decayMode);</span></div>
<div class="line"><span class="lineno"> 2209</span>                            <span class="comment">// hCpiVol = Handle&lt;CPIVolatilitySurface&gt;(cpiVol);#</span></div>
<div class="line"><span class="lineno"> 2210</span>                            <span class="comment">// FIXME</span></div>
<div class="line"><span class="lineno"> 2211</span>                            hCpiVol = wrapper;</div>
<div class="line"><span class="lineno"> 2212</span>                        }</div>
<div class="line"><span class="lineno"> 2213</span> </div>
<div class="line"><span class="lineno"> 2214</span>                        hCpiVol-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2215</span>                        <span class="keywordflow">if</span> (wrapper-&gt;allowsExtrapolation())</div>
<div class="line"><span class="lineno"> 2216</span>                            hCpiVol-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 2217</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a589f42a64e6ab40d77a122443976d382">cpiInflationCapFloorVolatilitySurfaces_</a>.emplace(</div>
<div class="line"><span class="lineno"> 2218</span>                            std::piecewise_construct, std::forward_as_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 2219</span>                            std::forward_as_tuple(hCpiVol));</div>
<div class="line"><span class="lineno"> 2220</span> </div>
<div class="line"><span class="lineno"> 2221</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2222</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2223</span>                    }</div>
<div class="line"><span class="lineno"> 2224</span>                }</div>
<div class="line"><span class="lineno"> 2225</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2226</span> </div>
<div class="line"><span class="lineno"> 2227</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401">RiskFactorKey::KeyType::YoYInflationCurve</a>:</div>
<div class="line"><span class="lineno"> 2228</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2229</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2230</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2231</span>                        Handle&lt;YoYInflationIndex&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a> =</div>
<div class="line"><span class="lineno"> 2232</span>                            initMarket-&gt;yoyInflationIndex(name, configuration);</div>
<div class="line"><span class="lineno"> 2233</span>                        Handle&lt;YoYInflationTermStructure&gt; yoyInflationTs =</div>
<div class="line"><span class="lineno"> 2234</span>                            <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a>-&gt;yoyInflationTermStructure();</div>
<div class="line"><span class="lineno"> 2235</span>                        vector&lt;string&gt; keys(parameters-&gt;yoyInflationTenors(name).size());</div>
<div class="line"><span class="lineno"> 2236</span> </div>
<div class="line"><span class="lineno"> 2237</span>                        Date date0 = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> - yoyInflationTs-&gt;observationLag();</div>
<div class="line"><span class="lineno"> 2238</span>                        DayCounter dc = yoyInflationTs-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2239</span>                        vector&lt;Date&gt; quoteDates;</div>
<div class="line"><span class="lineno"> 2240</span>                        vector&lt;Time&gt; yoyCurveTimes(</div>
<div class="line"><span class="lineno"> 2241</span>                            1, -dc.yearFraction(inflationPeriod(date0, yoyInflationTs-&gt;frequency()).first, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>));</div>
<div class="line"><span class="lineno"> 2242</span>                        vector&lt;Handle&lt;Quote&gt;&gt; quotes;</div>
<div class="line"><span class="lineno"> 2243</span>                        QL_REQUIRE(parameters-&gt;yoyInflationTenors(name).front() &gt; 0 * Days,</div>
<div class="line"><span class="lineno"> 2244</span>                                   <span class="stringliteral">&quot;zero inflation tenors must not include t=0&quot;</span>);</div>
<div class="line"><span class="lineno"> 2245</span> </div>
<div class="line"><span class="lineno"> 2246</span>                        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; tenor : parameters-&gt;yoyInflationTenors(name)) {</div>
<div class="line"><span class="lineno"> 2247</span>                            Date inflDate = inflationPeriod(date0 + tenor, yoyInflationTs-&gt;frequency()).first;</div>
<div class="line"><span class="lineno"> 2248</span>                            yoyCurveTimes.push_back(dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, inflDate));</div>
<div class="line"><span class="lineno"> 2249</span>                            quoteDates.push_back(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + tenor);</div>
<div class="line"><span class="lineno"> 2250</span>                        }</div>
<div class="line"><span class="lineno"> 2251</span> </div>
<div class="line"><span class="lineno"> 2252</span>                        <span class="keywordflow">for</span> (Size i = 1; i &lt; yoyCurveTimes.size(); i++) {</div>
<div class="line"><span class="lineno"> 2253</span>                            Real rate = yoyInflationTs-&gt;yoyRate(quoteDates[i - 1]);</div>
<div class="line"><span class="lineno"> 2254</span>                            <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : rate);</div>
<div class="line"><span class="lineno"> 2255</span>                            <span class="keywordflow">if</span> (i == 1) {</div>
<div class="line"><span class="lineno"> 2256</span>                                <span class="comment">// add the zero rate at first tenor to the T0 time, to ensure flat interpolation of T1</span></div>
<div class="line"><span class="lineno"> 2257</span>                                <span class="comment">// rate for time t T0 &lt; t &lt; T1</span></div>
<div class="line"><span class="lineno"> 2258</span>                                quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno"> 2259</span>                            }</div>
<div class="line"><span class="lineno"> 2260</span>                            quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno"> 2261</span>                            simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2262</span>                                               std::forward_as_tuple(param.first, name, i - 1),</div>
<div class="line"><span class="lineno"> 2263</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2264</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>)</div>
<div class="line"><span class="lineno"> 2265</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2266</span>                                                           std::forward_as_tuple(param.first, name, i - 1),</div>
<div class="line"><span class="lineno"> 2267</span>                                                           std::forward_as_tuple(rate));</div>
<div class="line"><span class="lineno"> 2268</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;ScenarioSimMarket yoy inflation curve &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yoyRate[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; rate);</div>
<div class="line"><span class="lineno"> 2269</span>                        }</div>
<div class="line"><span class="lineno"> 2270</span> </div>
<div class="line"><span class="lineno"> 2271</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name,</div>
<div class="line"><span class="lineno"> 2272</span>                                     {std::vector&lt;Real&gt;(std::next(yoyCurveTimes.begin(), 1), yoyCurveTimes.end())});</div>
<div class="line"><span class="lineno"> 2273</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2274</span>                                                </div>
<div class="line"><span class="lineno"> 2275</span>                        QuantLib::ext::shared_ptr&lt;YoYInflationTermStructure&gt; yoyCurve;</div>
<div class="line"><span class="lineno"> 2276</span>                        <span class="comment">// Note this is *not* a floating term structure, it is only suitable for sensi runs</span></div>
<div class="line"><span class="lineno"> 2277</span>                        <span class="comment">// TODO: floating</span></div>
<div class="line"><span class="lineno"> 2278</span>                        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2279</span>                            yoyCurve =</div>
<div class="line"><span class="lineno"> 2280</span>                                QuantLib::ext::make_shared&lt;SpreadedYoYInflationCurve&gt;(yoyInflationTs, yoyCurveTimes, quotes);</div>
<div class="line"><span class="lineno"> 2281</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2282</span>                            yoyCurve = QuantLib::ext::make_shared&lt;YoYInflationCurveObserverMoving&lt;Linear&gt;&gt;(</div>
<div class="line"><span class="lineno"> 2283</span>                                0, <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a>-&gt;fixingCalendar(), dc, yoyInflationTs-&gt;observationLag(),</div>
<div class="line"><span class="lineno"> 2284</span>                                yoyInflationTs-&gt;frequency(), <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a>-&gt;interpolated(), yoyCurveTimes,</div>
<div class="line"><span class="lineno"> 2285</span>                                quotes, yoyInflationTs-&gt;seasonality());</div>
<div class="line"><span class="lineno"> 2286</span>                        }</div>
<div class="line"><span class="lineno"> 2287</span>                        yoyCurve-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2288</span>                        Handle&lt;YoYInflationTermStructure&gt; its(yoyCurve);</div>
<div class="line"><span class="lineno"> 2289</span>                        its-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 2290</span>                        QuantLib::ext::shared_ptr&lt;YoYInflationIndex&gt; i(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">yoyInflationIndex</a>-&gt;clone(its));</div>
<div class="line"><span class="lineno"> 2291</span>                        Handle&lt;YoYInflationIndex&gt; zh(i);</div>
<div class="line"><span class="lineno"> 2292</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a8873185426918c5d252bd2457a92ce1d">yoyInflationIndices_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), zh));</div>
<div class="line"><span class="lineno"> 2293</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2294</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2295</span>                    }</div>
<div class="line"><span class="lineno"> 2296</span>                }</div>
<div class="line"><span class="lineno"> 2297</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00">RiskFactorKey::KeyType::YoYInflationCapFloorVolatility</a>:</div>
<div class="line"><span class="lineno"> 2300</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2301</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2302</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2303</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yoy inflation cap/floor volatility curve...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2304</span>                        Handle&lt;QuantExt::YoYOptionletVolatilitySurface&gt; wrapper =</div>
<div class="line"><span class="lineno"> 2305</span>                            initMarket-&gt;yoyCapFloorVol(name, configuration);</div>
<div class="line"><span class="lineno"> 2306</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Initial market &quot;</span></div>
<div class="line"><span class="lineno"> 2307</span>                            &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; yoy inflation cap/floor volatility type = &quot;</span> &lt;&lt; wrapper-&gt;volatilityType());</div>
<div class="line"><span class="lineno"> 2308</span>                        Handle&lt;QuantExt::YoYOptionletVolatilitySurface&gt; hYoYCapletVol;</div>
<div class="line"><span class="lineno"> 2309</span> </div>
<div class="line"><span class="lineno"> 2310</span>                        <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno"> 2311</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 2312</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulating yoy inflation optionlet vols for index name &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2313</span>                            vector&lt;Period&gt; optionTenors = parameters-&gt;yoyInflationCapFloorVolExpiries(name);</div>
<div class="line"><span class="lineno"> 2314</span>                            vector&lt;Date&gt; optionDates(optionTenors.size());</div>
<div class="line"><span class="lineno"> 2315</span>                            vector&lt;Real&gt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a> = parameters-&gt;yoyInflationCapFloorVolStrikes(name);</div>
<div class="line"><span class="lineno"> 2316</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes(</div>
<div class="line"><span class="lineno"> 2317</span>                                optionTenors.size(), vector&lt;Handle&lt;Quote&gt;&gt;(<a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(), Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 2318</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno"> 2319</span>                                optionDates[i] = wrapper-&gt;optionDateFromTenor(optionTenors[i]);</div>
<div class="line"><span class="lineno"> 2320</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2321</span>                                    Real vol =</div>
<div class="line"><span class="lineno"> 2322</span>                                        wrapper-&gt;volatility(optionTenors[i], strikes[j], wrapper-&gt;observationLag(),</div>
<div class="line"><span class="lineno"> 2323</span>                                                            wrapper-&gt;allowsExtrapolation());</div>
<div class="line"><span class="lineno"> 2324</span>                                    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno"> 2325</span>                                        <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol));</div>
<div class="line"><span class="lineno"> 2326</span>                                    Size index = i * <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size() + j;</div>
<div class="line"><span class="lineno"> 2327</span>                                    simDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2328</span>                                                       std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 2329</span>                                                       std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2330</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2331</span>                                        absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2332</span>                                                                   std::forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 2333</span>                                                                   std::forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 2334</span>                                    }</div>
<div class="line"><span class="lineno"> 2335</span>                                    quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 2336</span>                                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;ScenarioSimMarket yoy cf vol &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; tenor #&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; strike #&quot;</span> &lt;&lt; j</div>
<div class="line"><span class="lineno"> 2337</span>                                                                         &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vol);</div>
<div class="line"><span class="lineno"> 2338</span>                                }</div>
<div class="line"><span class="lineno"> 2339</span>                            }</div>
<div class="line"><span class="lineno"> 2340</span> </div>
<div class="line"><span class="lineno"> 2341</span>                            std::vector&lt;std::vector&lt;Real&gt;&gt; coordinates(2);</div>
<div class="line"><span class="lineno"> 2342</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; optionTenors.size(); ++i) {</div>
<div class="line"><span class="lineno"> 2343</span>                                coordinates[0].push_back(</div>
<div class="line"><span class="lineno"> 2344</span>                                    wrapper-&gt;timeFromReference(wrapper-&gt;optionDateFromTenor(optionTenors[i])));</div>
<div class="line"><span class="lineno"> 2345</span>                            }</div>
<div class="line"><span class="lineno"> 2346</span>                            <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variableRef" href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2347</span>                                coordinates[1].push_back(strikes[j]);</div>
<div class="line"><span class="lineno"> 2348</span>                            }</div>
<div class="line"><span class="lineno"> 2349</span> </div>
<div class="line"><span class="lineno"> 2350</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, coordinates);</div>
<div class="line"><span class="lineno"> 2351</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2352</span> </div>
<div class="line"><span class="lineno"> 2353</span>                            DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2354</span>                </div>
<div class="line"><span class="lineno"> 2355</span>                            QuantLib::ext::shared_ptr&lt;QuantExt::YoYOptionletVolatilitySurface&gt; yoyoptionletvolsurface;</div>
<div class="line"><span class="lineno"> 2356</span>                            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2357</span>                                yoyoptionletvolsurface = QuantLib::ext::make_shared&lt;QuantExt::SpreadedYoYVolatilitySurface&gt;(</div>
<div class="line"><span class="lineno"> 2358</span>                                    wrapper, optionDates, strikes, quotes);</div>
<div class="line"><span class="lineno"> 2359</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2360</span>                                yoyoptionletvolsurface = QuantLib::ext::make_shared&lt;StrippedYoYInflationOptionletVol&gt;(</div>
<div class="line"><span class="lineno"> 2361</span>                                    0, wrapper-&gt;calendar(), wrapper-&gt;businessDayConvention(), dc,</div>
<div class="line"><span class="lineno"> 2362</span>                                    wrapper-&gt;observationLag(), wrapper-&gt;frequency(), wrapper-&gt;indexIsInterpolated(),</div>
<div class="line"><span class="lineno"> 2363</span>                                    optionDates, strikes, quotes, wrapper-&gt;volatilityType(), wrapper-&gt;displacement());</div>
<div class="line"><span class="lineno"> 2364</span>                            }</div>
<div class="line"><span class="lineno"> 2365</span>                            hYoYCapletVol = Handle&lt;QuantExt::YoYOptionletVolatilitySurface&gt;(yoyoptionletvolsurface);</div>
<div class="line"><span class="lineno"> 2366</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2367</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;yoyInflationCapFloorVolDecayMode();</div>
<div class="line"><span class="lineno"> 2368</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno"> 2369</span>                            QuantLib::ext::shared_ptr&lt;QuantExt::DynamicYoYOptionletVolatilitySurface&gt; yoyCapletVol =</div>
<div class="line"><span class="lineno"> 2370</span>                                QuantLib::ext::make_shared&lt;QuantExt::DynamicYoYOptionletVolatilitySurface&gt;(*wrapper, decayMode);</div>
<div class="line"><span class="lineno"> 2371</span>                            hYoYCapletVol = Handle&lt;QuantExt::YoYOptionletVolatilitySurface&gt;(yoyCapletVol);</div>
<div class="line"><span class="lineno"> 2372</span>                        }</div>
<div class="line"><span class="lineno"> 2373</span>                        hYoYCapletVol-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2374</span>                        <span class="keywordflow">if</span> (wrapper-&gt;allowsExtrapolation())</div>
<div class="line"><span class="lineno"> 2375</span>                            hYoYCapletVol-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 2376</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a7cad6ae2928d269c2dbbaf607d3d15d8">yoyCapFloorVolSurfaces_</a>.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2377</span>                                                        std::forward_as_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 2378</span>                                                        std::forward_as_tuple(hYoYCapletVol));</div>
<div class="line"><span class="lineno"> 2379</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Simulation market yoy inflation cap/floor volatility type = &quot;</span></div>
<div class="line"><span class="lineno"> 2380</span>                            &lt;&lt; hYoYCapletVol-&gt;volatilityType());</div>
<div class="line"><span class="lineno"> 2381</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2382</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2383</span>                    }</div>
<div class="line"><span class="lineno"> 2384</span>                }</div>
<div class="line"><span class="lineno"> 2385</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2386</span> </div>
<div class="line"><span class="lineno"> 2387</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88">RiskFactorKey::KeyType::CommodityCurve</a>: {</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span>                std::vector&lt;std::string&gt; curveNames;</div>
<div class="line"><span class="lineno"> 2390</span>                std::vector&lt;std::string&gt; basisCurves;</div>
<div class="line"><span class="lineno"> 2391</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2392</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2393</span>                        Handle&lt;PriceTermStructure&gt; initialCommodityCurve =</div>
<div class="line"><span class="lineno"> 2394</span>                            initMarket-&gt;commodityPriceCurve(name, configuration);</div>
<div class="line"><span class="lineno"> 2395</span>                        QuantLib::ext::shared_ptr&lt;CommodityBasisPriceTermStructure&gt; basisCurve =</div>
<div class="line"><span class="lineno"> 2396</span>                            QuantLib::ext::dynamic_pointer_cast&lt;QuantExt::CommodityBasisPriceTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2397</span>                                initialCommodityCurve.currentLink());</div>
<div class="line"><span class="lineno"> 2398</span>                        <span class="keywordflow">if</span> (basisCurve != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2399</span>                            basisCurves.push_back(name);</div>
<div class="line"><span class="lineno"> 2400</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2401</span>                            curveNames.push_back(name);</div>
<div class="line"><span class="lineno"> 2402</span>                        }</div>
<div class="line"><span class="lineno"> 2403</span>                    } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 2404</span>                        curveNames.push_back(name);</div>
<div class="line"><span class="lineno"> 2405</span>                    }</div>
<div class="line"><span class="lineno"> 2406</span>                }</div>
<div class="line"><span class="lineno"> 2407</span>                curveNames.insert(curveNames.end(), basisCurves.begin(), basisCurves.end());</div>
<div class="line"><span class="lineno"> 2408</span> </div>
<div class="line"><span class="lineno"> 2409</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : curveNames) {</div>
<div class="line"><span class="lineno"> 2410</span> </div>
<div class="line"><span class="lineno"> 2411</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2412</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2413</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building commodity curve for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2414</span> </div>
<div class="line"><span class="lineno"> 2415</span>                        <span class="comment">// Time zero initial market commodity curve</span></div>
<div class="line"><span class="lineno"> 2416</span>                        Handle&lt;PriceTermStructure&gt; initialCommodityCurve =</div>
<div class="line"><span class="lineno"> 2417</span>                            initMarket-&gt;commodityPriceCurve(name, configuration);</div>
<div class="line"><span class="lineno"> 2418</span> </div>
<div class="line"><span class="lineno"> 2419</span>                        <span class="keywordtype">bool</span> allowsExtrapolation = initialCommodityCurve-&gt;allowsExtrapolation();</div>
<div class="line"><span class="lineno"> 2420</span> </div>
<div class="line"><span class="lineno"> 2421</span>                        <span class="comment">// Get the configured simulation tenors. Simulation tenors being empty at this point means</span></div>
<div class="line"><span class="lineno"> 2422</span>                        <span class="comment">// that we wish to use the pillar date points from the t_0 market PriceTermStructure.</span></div>
<div class="line"><span class="lineno"> 2423</span>                        vector&lt;Period&gt; simulationTenors = parameters-&gt;commodityCurveTenors(name);</div>
<div class="line"><span class="lineno"> 2424</span>                        DayCounter commodityCurveDayCounter = initialCommodityCurve-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2425</span>                        <span class="keywordflow">if</span> (simulationTenors.empty()) {</div>
<div class="line"><span class="lineno"> 2426</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;simulation tenors are empty, use &quot;</span></div>
<div class="line"><span class="lineno"> 2427</span>                                 &lt;&lt; initialCommodityCurve-&gt;pillarDates().size()</div>
<div class="line"><span class="lineno"> 2428</span>                                 &lt;&lt; <span class="stringliteral">&quot; pillar dates from T0 curve to build ssm curve.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2429</span>                            simulationTenors.reserve(initialCommodityCurve-&gt;pillarDates().size());</div>
<div class="line"><span class="lineno"> 2430</span>                            <span class="keywordflow">for</span> (<span class="keyword">const</span> Date&amp; d : initialCommodityCurve-&gt;pillarDates()) {</div>
<div class="line"><span class="lineno"> 2431</span>                                QL_REQUIRE(d &gt;= <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, <span class="stringliteral">&quot;Commodity curve pillar date (&quot;</span> &lt;&lt; io::iso_date(d)</div>
<div class="line"><span class="lineno"> 2432</span>                                                                                       &lt;&lt; <span class="stringliteral">&quot;) must be after as of (&quot;</span></div>
<div class="line"><span class="lineno"> 2433</span>                                                                                       &lt;&lt; io::iso_date(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>) &lt;&lt; <span class="stringliteral">&quot;).&quot;</span>);</div>
<div class="line"><span class="lineno"> 2434</span>                                simulationTenors.push_back(Period(d - <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, Days));</div>
<div class="line"><span class="lineno"> 2435</span>                            }</div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span>                            <span class="comment">// It isn&#39;t great to be updating parameters here. However, actual tenors are requested</span></div>
<div class="line"><span class="lineno"> 2438</span>                            <span class="comment">// downstream from parameters and they need to be populated.</span></div>
<div class="line"><span class="lineno"> 2439</span>                            parameters-&gt;setCommodityCurveTenors(name, simulationTenors);</div>
<div class="line"><span class="lineno"> 2440</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2441</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;using &quot;</span> &lt;&lt; simulationTenors.size() &lt;&lt; <span class="stringliteral">&quot; simulation tenors.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2442</span>                        }</div>
<div class="line"><span class="lineno"> 2443</span> </div>
<div class="line"><span class="lineno"> 2444</span>                        <span class="comment">// Get prices at specified simulation times from time 0 market curve and place in quotes</span></div>
<div class="line"><span class="lineno"> 2445</span>                        vector&lt;Handle&lt;Quote&gt;&gt; quotes(simulationTenors.size());</div>
<div class="line"><span class="lineno"> 2446</span>                        vector&lt;Real&gt; times;</div>
<div class="line"><span class="lineno"> 2447</span>                        <span class="keywordflow">for</span> (Size i = 0; i &lt; simulationTenors.size(); i++) {</div>
<div class="line"><span class="lineno"> 2448</span>                            Date d = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + simulationTenors[i];</div>
<div class="line"><span class="lineno"> 2449</span>                            Real price = initialCommodityCurve-&gt;price(d, allowsExtrapolation);</div>
<div class="line"><span class="lineno"> 2450</span>                            times.push_back(initialCommodityCurve-&gt;timeFromReference(d));</div>
<div class="line"><span class="lineno"> 2451</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;Commodity curve: price at &quot;</span> &lt;&lt; io::iso_date(d) &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt; price);</div>
<div class="line"><span class="lineno"> 2452</span>                            <span class="comment">// if we simulate the factors and use spreaded ts, the quote should be zero</span></div>
<div class="line"><span class="lineno"> 2453</span>                            QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; quote = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(</div>
<div class="line"><span class="lineno"> 2454</span>                                param.second.first &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : price);</div>
<div class="line"><span class="lineno"> 2455</span>                            quotes[i] = Handle&lt;Quote&gt;(quote);</div>
<div class="line"><span class="lineno"> 2456</span> </div>
<div class="line"><span class="lineno"> 2457</span>                            <span class="comment">// If we are simulating commodities, add the quote to simData_</span></div>
<div class="line"><span class="lineno"> 2458</span>                            <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 2459</span>                                simDataTmp.emplace(piecewise_construct, forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno"> 2460</span>                                                   forward_as_tuple(quote));</div>
<div class="line"><span class="lineno"> 2461</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>)</div>
<div class="line"><span class="lineno"> 2462</span>                                    absoluteSimDataTmp.emplace(piecewise_construct,</div>
<div class="line"><span class="lineno"> 2463</span>                                                               forward_as_tuple(param.first, name, i),</div>
<div class="line"><span class="lineno"> 2464</span>                                                               forward_as_tuple(price));</div>
<div class="line"><span class="lineno"> 2465</span>                            }</div>
<div class="line"><span class="lineno"> 2466</span>                        }</div>
<div class="line"><span class="lineno"> 2467</span> </div>
<div class="line"><span class="lineno"> 2468</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {times});</div>
<div class="line"><span class="lineno"> 2469</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2470</span>                        QuantLib::ext::shared_ptr&lt;PriceTermStructure&gt; priceCurve;</div>
<div class="line"><span class="lineno"> 2471</span> </div>
<div class="line"><span class="lineno"> 2472</span>                        <span class="keywordflow">if</span> (param.second.first &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2473</span>                            vector&lt;Real&gt; simulationTimes;</div>
<div class="line"><span class="lineno"> 2474</span>                            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; t : simulationTenors) {</div>
<div class="line"><span class="lineno"> 2475</span>                                simulationTimes.push_back(commodityCurveDayCounter.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + t));</div>
<div class="line"><span class="lineno"> 2476</span>                            }</div>
<div class="line"><span class="lineno"> 2477</span>                            <span class="keywordflow">if</span> (simulationTimes.front() != 0.0) {</div>
<div class="line"><span class="lineno"> 2478</span>                                simulationTimes.insert(simulationTimes.begin(), 0.0);</div>
<div class="line"><span class="lineno"> 2479</span>                                quotes.insert(quotes.begin(), quotes.front());</div>
<div class="line"><span class="lineno"> 2480</span>                            }</div>
<div class="line"><span class="lineno"> 2481</span>                            <span class="comment">// Created spreaded commodity price curve if we simulate commodities and spreads should be</span></div>
<div class="line"><span class="lineno"> 2482</span>                            <span class="comment">// used</span></div>
<div class="line"><span class="lineno"> 2483</span>                            priceCurve = QuantLib::ext::make_shared&lt;SpreadedPriceTermStructure&gt;(initialCommodityCurve,</div>
<div class="line"><span class="lineno"> 2484</span>                                                                                        simulationTimes, quotes);</div>
<div class="line"><span class="lineno"> 2485</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2486</span>                            priceCurve= QuantLib::ext::make_shared&lt;InterpolatedPriceCurve&lt;LinearFlat&gt;&gt;(</div>
<div class="line"><span class="lineno"> 2487</span>                                simulationTenors, quotes, commodityCurveDayCounter, initialCommodityCurve-&gt;currency());</div>
<div class="line"><span class="lineno"> 2488</span>                        }</div>
<div class="line"><span class="lineno"> 2489</span>                        </div>
<div class="line"><span class="lineno"> 2490</span>                        <span class="keyword">auto</span> orgBasisCurve =</div>
<div class="line"><span class="lineno"> 2491</span>                            QuantLib::ext::dynamic_pointer_cast&lt;QuantExt::CommodityBasisPriceTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2492</span>                                initialCommodityCurve.currentLink());</div>
<div class="line"><span class="lineno"> 2493</span> </div>
<div class="line"><span class="lineno"> 2494</span>                        Handle&lt;PriceTermStructure&gt; pts;  </div>
<div class="line"><span class="lineno"> 2495</span>                        <span class="keywordflow">if</span> (orgBasisCurve == <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2496</span>                            pts = Handle&lt;PriceTermStructure&gt;(priceCurve);</div>
<div class="line"><span class="lineno"> 2497</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2498</span>                            <span class="keyword">auto</span> baseIndex = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6c9a8e7f8ce0fb904eda53256b2a17db">commodityIndices_</a>.find(</div>
<div class="line"><span class="lineno"> 2499</span>                                {<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, orgBasisCurve-&gt;baseIndex()-&gt;underlyingName()});</div>
<div class="line"><span class="lineno"> 2500</span>                            QL_REQUIRE(baseIndex != <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6c9a8e7f8ce0fb904eda53256b2a17db">commodityIndices_</a>.end(),</div>
<div class="line"><span class="lineno"> 2501</span>                                       <span class="stringliteral">&quot;Internal error in scenariosimmarket: couldn&#39;t find underlying base curve &#39;&quot;</span></div>
<div class="line"><span class="lineno"> 2502</span>                                           &lt;&lt; orgBasisCurve-&gt;baseIndex()-&gt;underlyingName()</div>
<div class="line"><span class="lineno"> 2503</span>                                           &lt;&lt; <span class="stringliteral">&quot;&#39; while building commodity basis curve &#39;&quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><span class="lineno"> 2504</span>                            pts = Handle&lt;PriceTermStructure&gt;(QuantLib::ext::make_shared&lt;CommodityBasisPriceCurveWrapper&gt;(</div>
<div class="line"><span class="lineno"> 2505</span>                                orgBasisCurve, baseIndex-&gt;second.currentLink(), priceCurve));</div>
<div class="line"><span class="lineno"> 2506</span>                        } </div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span>                        pts-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2509</span>                        pts-&gt;enableExtrapolation(allowsExtrapolation);</div>
<div class="line"><span class="lineno"> 2510</span> </div>
<div class="line"><span class="lineno"> 2511</span>                        Handle&lt;CommodityIndex&gt; commIdx(<a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#abd022b98516a69b335865f8c17a645cf">parseCommodityIndex</a>(name, <span class="keyword">false</span>, pts));</div>
<div class="line"><span class="lineno"> 2512</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6c9a8e7f8ce0fb904eda53256b2a17db">commodityIndices_</a>.emplace(piecewise_construct,</div>
<div class="line"><span class="lineno"> 2513</span>                                                  forward_as_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 2514</span>                                                  forward_as_tuple(commIdx));</div>
<div class="line"><span class="lineno"> 2515</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2516</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2517</span>                    }</div>
<div class="line"><span class="lineno"> 2518</span>                }</div>
<div class="line"><span class="lineno"> 2519</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2520</span>            }</div>
<div class="line"><span class="lineno"> 2521</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807">RiskFactorKey::KeyType::CommodityVolatility</a>:</div>
<div class="line"><span class="lineno"> 2522</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2523</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2524</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2525</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building commodity volatility for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2526</span> </div>
<div class="line"><span class="lineno"> 2527</span>                        <span class="comment">// Get initial base volatility structure</span></div>
<div class="line"><span class="lineno"> 2528</span>                        Handle&lt;BlackVolTermStructure&gt; baseVol = initMarket-&gt;commodityVolatility(name, configuration);</div>
<div class="line"><span class="lineno"> 2529</span> </div>
<div class="line"><span class="lineno"> 2530</span>                        Handle&lt;BlackVolTermStructure&gt; newVol;</div>
<div class="line"><span class="lineno"> 2531</span>                        <span class="keywordtype">bool</span> stickyStrike = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;commodityVolSmileDynamics(name) == <span class="stringliteral">&quot;StickyStrike&quot;</span>;</div>
<div class="line"><span class="lineno"> 2532</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 2533</span> </div>
<div class="line"><span class="lineno"> 2534</span>                            <span class="comment">// Check and reorg moneyness and/or expiries to simplify subsequent code.</span></div>
<div class="line"><span class="lineno"> 2535</span>                            vector&lt;Real&gt; moneyness = parameters-&gt;commodityVolMoneyness(name);</div>
<div class="line"><span class="lineno"> 2536</span>                            QL_REQUIRE(!moneyness.empty(), <span class="stringliteral">&quot;Commodity volatility moneyness for &quot;</span></div>
<div class="line"><span class="lineno"> 2537</span>                                                               &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; should have at least one element.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2538</span>                            sort(moneyness.begin(), moneyness.end());</div>
<div class="line"><span class="lineno"> 2539</span>                            <span class="keyword">auto</span> mIt = unique(moneyness.begin(), moneyness.end(),</div>
<div class="line"><span class="lineno"> 2540</span>                                              [](<span class="keyword">const</span> Real&amp; x, <span class="keyword">const</span> Real&amp; y) { return close(x, y); });</div>
<div class="line"><span class="lineno"> 2541</span>                            QL_REQUIRE(mIt == moneyness.end(),</div>
<div class="line"><span class="lineno"> 2542</span>                                       <span class="stringliteral">&quot;Commodity volatility moneyness values for &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; should be unique.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2543</span> </div>
<div class="line"><span class="lineno"> 2544</span>                            vector&lt;Period&gt; expiries = parameters-&gt;commodityVolExpiries(name);</div>
<div class="line"><span class="lineno"> 2545</span>                            QL_REQUIRE(!expiries.empty(), <span class="stringliteral">&quot;Commodity volatility expiries for &quot;</span></div>
<div class="line"><span class="lineno"> 2546</span>                                                              &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; should have at least one element.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2547</span>                            sort(expiries.begin(), expiries.end());</div>
<div class="line"><span class="lineno"> 2548</span>                            <span class="keyword">auto</span> eIt = unique(expiries.begin(), expiries.end());</div>
<div class="line"><span class="lineno"> 2549</span>                            QL_REQUIRE(eIt == expiries.end(),</div>
<div class="line"><span class="lineno"> 2550</span>                                       <span class="stringliteral">&quot;Commodity volatility expiries for &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; should be unique.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2551</span> </div>
<div class="line"><span class="lineno"> 2552</span>                            <span class="comment">// Get this scenario simulation market&#39;s commodity price curve. An exception is expected</span></div>
<div class="line"><span class="lineno"> 2553</span>                            <span class="comment">// if there is no commodity curve but there is a commodity volatility.</span></div>
<div class="line"><span class="lineno"> 2554</span>                            <span class="keyword">const</span> <span class="keyword">auto</span>&amp; priceCurve = *<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab22c6188a5f378934b69965aa7c6cb39">commodityPriceCurve</a>(name, configuration);</div>
<div class="line"><span class="lineno"> 2555</span> </div>
<div class="line"><span class="lineno"> 2556</span>                            <span class="comment">// More than one moneyness implies a surface. If we have a surface, we will build a</span></div>
<div class="line"><span class="lineno"> 2557</span>                            <span class="comment">// forward surface below which requires two yield term structures, one for the commodity</span></div>
<div class="line"><span class="lineno"> 2558</span>                            <span class="comment">// price currency and another that recovers the commodity forward prices. We don&#39;t want</span></div>
<div class="line"><span class="lineno"> 2559</span>                            <span class="comment">// the commodity prices changing with changes in the commodity price currency yield curve</span></div>
<div class="line"><span class="lineno"> 2560</span>                            <span class="comment">// so we take a copy here - it will work for sticky strike false also.</span></div>
<div class="line"><span class="lineno"> 2561</span>                            <span class="keywordtype">bool</span> isSurface = moneyness.size() &gt; 1;</div>
<div class="line"><span class="lineno"> 2562</span>                            Handle&lt;YieldTermStructure&gt; yts;</div>
<div class="line"><span class="lineno"> 2563</span>                            Handle&lt;YieldTermStructure&gt; priceYts;</div>
<div class="line"><span class="lineno"> 2564</span> </div>
<div class="line"><span class="lineno"> 2565</span>                            <span class="keywordflow">if</span> (isSurface) {</div>
<div class="line"><span class="lineno"> 2566</span> </div>
<div class="line"><span class="lineno"> 2567</span>                                vector&lt;Date&gt; dates{<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>};</div>
<div class="line"><span class="lineno"> 2568</span>                                vector&lt;Real&gt; dfs{1.0};</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>                                <span class="keyword">auto</span> discCurve = <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a>(priceCurve-&gt;currency().code(), configuration);</div>
<div class="line"><span class="lineno"> 2571</span>                                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; expiry : expiries) {</div>
<div class="line"><span class="lineno"> 2572</span>                                    <span class="keyword">auto</span> d = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + expiry;</div>
<div class="line"><span class="lineno"> 2573</span>                                    <span class="keywordflow">if</span> (d == <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>)</div>
<div class="line"><span class="lineno"> 2574</span>                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2575</span>                                    dates.push_back(d);</div>
<div class="line"><span class="lineno"> 2576</span>                                    dfs.push_back(discCurve-&gt;discount(d, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno"> 2577</span>                                }</div>
<div class="line"><span class="lineno"> 2578</span> </div>
<div class="line"><span class="lineno"> 2579</span>                                <span class="keyword">auto</span> ytsPtr = QuantLib::ext::make_shared&lt;DiscountCurve&gt;(dates, dfs, discCurve-&gt;dayCounter());</div>
<div class="line"><span class="lineno"> 2580</span>                                ytsPtr-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 2581</span>                                yts = Handle&lt;YieldTermStructure&gt;(ytsPtr);</div>
<div class="line"><span class="lineno"> 2582</span>                                priceYts = Handle&lt;YieldTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2583</span>                                    QuantLib::ext::make_shared&lt;PriceTermStructureAdapter&gt;(priceCurve, ytsPtr));</div>
<div class="line"><span class="lineno"> 2584</span>                                priceYts-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno"> 2585</span>                            }</div>
<div class="line"><span class="lineno"> 2586</span> </div>
<div class="line"><span class="lineno"> 2587</span>                            <span class="comment">// Create surface of quotes, rows are moneyness, columns are expiries.</span></div>
<div class="line"><span class="lineno"> 2588</span>                            <span class="keyword">using </span>QuoteRow = vector&lt;Handle&lt;Quote&gt;&gt;;</div>
<div class="line"><span class="lineno"> 2589</span>                            <span class="keyword">using </span>QuoteMatrix = vector&lt;QuoteRow&gt;;</div>
<div class="line"><span class="lineno"> 2590</span>                            QuoteMatrix quotes(moneyness.size(), QuoteRow(expiries.size()));</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2592</span>                            <span class="comment">// Calculate up front the expiry times, dates and forward prices.</span></div>
<div class="line"><span class="lineno"> 2593</span>                            vector&lt;Date&gt; expiryDates(expiries.size());</div>
<div class="line"><span class="lineno"> 2594</span>                            vector&lt;Time&gt; expiryTimes(expiries.size());</div>
<div class="line"><span class="lineno"> 2595</span>                            vector&lt;Real&gt; forwards(expiries.size());</div>
<div class="line"><span class="lineno"> 2596</span>                            <span class="comment">// TODO: do we want to use the base vol dc or - as elsewhere - a dc specified in the ssm</span></div>
<div class="line"><span class="lineno"> 2597</span>                            <span class="comment">// parameters?</span></div>
<div class="line"><span class="lineno"> 2598</span>                            DayCounter dayCounter = baseVol-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2599</span>                            <span class="keywordflow">for</span> (Size j = 0; j &lt; expiries.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2600</span>                                Date d = <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + expiries[j];</div>
<div class="line"><span class="lineno"> 2601</span>                                expiryDates[j] = d;</div>
<div class="line"><span class="lineno"> 2602</span>                                expiryTimes[j] = dayCounter.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, d);</div>
<div class="line"><span class="lineno"> 2603</span>                                forwards[j] = priceCurve-&gt;price(d);</div>
<div class="line"><span class="lineno"> 2604</span>                            }</div>
<div class="line"><span class="lineno"> 2605</span> </div>
<div class="line"><span class="lineno"> 2606</span>                            <span class="comment">// Store the quotes.</span></div>
<div class="line"><span class="lineno"> 2607</span>                            Size index = 0;</div>
<div class="line"><span class="lineno"> 2608</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; moneyness.size(); ++i) {</div>
<div class="line"><span class="lineno"> 2609</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; expiries.size(); ++j) {</div>
<div class="line"><span class="lineno"> 2610</span>                                    Real strike = moneyness[i] * forwards[j];</div>
<div class="line"><span class="lineno"> 2611</span>                                    <span class="keyword">auto</span> vol = baseVol-&gt;blackVol(expiryDates[j], strike);</div>
<div class="line"><span class="lineno"> 2612</span>                                    <span class="keyword">auto</span> quote =</div>
<div class="line"><span class="lineno"> 2613</span>                                        QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : vol);</div>
<div class="line"><span class="lineno"> 2614</span>                                    simDataTmp.emplace(piecewise_construct, forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 2615</span>                                                       forward_as_tuple(quote));</div>
<div class="line"><span class="lineno"> 2616</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2617</span>                                        absoluteSimDataTmp.emplace(piecewise_construct,</div>
<div class="line"><span class="lineno"> 2618</span>                                                                   forward_as_tuple(param.first, name, index),</div>
<div class="line"><span class="lineno"> 2619</span>                                                                   forward_as_tuple(vol));</div>
<div class="line"><span class="lineno"> 2620</span>                                    }</div>
<div class="line"><span class="lineno"> 2621</span>                                    quotes[i][j] = Handle&lt;Quote&gt;(quote);</div>
<div class="line"><span class="lineno"> 2622</span>                                    ++index;</div>
<div class="line"><span class="lineno"> 2623</span>                                }</div>
<div class="line"><span class="lineno"> 2624</span>                            }</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {moneyness, expiryTimes});</div>
<div class="line"><span class="lineno"> 2627</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2628</span> </div>
<div class="line"><span class="lineno"> 2629</span>                            <span class="comment">// Create volatility structure</span></div>
<div class="line"><span class="lineno"> 2630</span>                            <span class="keywordflow">if</span> (!isSurface) {</div>
<div class="line"><span class="lineno"> 2631</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Ssm comm vol for &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; uses BlackVarianceCurve3.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2632</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2633</span>                                    newVol =</div>
<div class="line"><span class="lineno"> 2634</span>                                        Handle&lt;BlackVolTermStructure&gt;(QuantLib::ext::make_shared&lt;SpreadedBlackVolatilityCurve&gt;(</div>
<div class="line"><span class="lineno"> 2635</span>                                            Handle&lt;BlackVolTermStructure&gt;(baseVol), expiryTimes, quotes[0], <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno"> 2636</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2637</span>                                    newVol = Handle&lt;BlackVolTermStructure&gt;(QuantLib::ext::make_shared&lt;BlackVarianceCurve3&gt;(</div>
<div class="line"><span class="lineno"> 2638</span>                                        0, NullCalendar(), baseVol-&gt;businessDayConvention(), dayCounter, expiryTimes,</div>
<div class="line"><span class="lineno"> 2639</span>                                        quotes[0], <span class="keyword">false</span>));</div>
<div class="line"><span class="lineno"> 2640</span>                                }</div>
<div class="line"><span class="lineno"> 2641</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2642</span>                                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Ssm comm vol for &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; uses BlackVarianceSurfaceMoneynessSpot.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2643</span> </div>
<div class="line"><span class="lineno"> 2644</span>                                <span class="keywordtype">bool</span> flatExtrapMoneyness = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2645</span>                                Handle&lt;Quote&gt; spot(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(priceCurve-&gt;price(0)));</div>
<div class="line"><span class="lineno"> 2646</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2647</span>                                    <span class="comment">// get init market curves to populate sticky ts in vol surface ctor</span></div>
<div class="line"><span class="lineno"> 2648</span>                                    Handle&lt;YieldTermStructure&gt; initMarketYts =</div>
<div class="line"><span class="lineno"> 2649</span>                                        initMarket-&gt;discountCurve(priceCurve-&gt;currency().code(), configuration);</div>
<div class="line"><span class="lineno"> 2650</span>                                    Handle&lt;QuantExt::PriceTermStructure&gt; priceCurve =</div>
<div class="line"><span class="lineno"> 2651</span>                                        initMarket-&gt;commodityPriceCurve(name, configuration);</div>
<div class="line"><span class="lineno"> 2652</span>                                    Handle&lt;YieldTermStructure&gt; initMarketPriceYts(</div>
<div class="line"><span class="lineno"> 2653</span>                                        QuantLib::ext::make_shared&lt;PriceTermStructureAdapter&gt;(*priceCurve, *initMarketYts));</div>
<div class="line"><span class="lineno"> 2654</span>                                    <span class="comment">// create vol surface</span></div>
<div class="line"><span class="lineno"> 2655</span>                                    newVol = Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2656</span>                                        QuantLib::ext::make_shared&lt;SpreadedBlackVolatilitySurfaceMoneynessForward&gt;(</div>
<div class="line"><span class="lineno"> 2657</span>                                            Handle&lt;BlackVolTermStructure&gt;(baseVol), spot, expiryTimes, moneyness,</div>
<div class="line"><span class="lineno"> 2658</span>                                            quotes, Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;SimpleQuote&gt;(spot-&gt;value())),</div>
<div class="line"><span class="lineno"> 2659</span>                                            initMarketPriceYts, initMarketYts, priceYts, yts, stickyStrike));</div>
<div class="line"><span class="lineno"> 2660</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2661</span>                                    newVol = Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2662</span>                                        QuantLib::ext::make_shared&lt;BlackVarianceSurfaceMoneynessForward&gt;(</div>
<div class="line"><span class="lineno"> 2663</span>                                            baseVol-&gt;calendar(), spot, expiryTimes, moneyness, quotes, dayCounter,</div>
<div class="line"><span class="lineno"> 2664</span>                                            priceYts, yts, stickyStrike, flatExtrapMoneyness));</div>
<div class="line"><span class="lineno"> 2665</span>                                }</div>
<div class="line"><span class="lineno"> 2666</span>                            }</div>
<div class="line"><span class="lineno"> 2667</span> </div>
<div class="line"><span class="lineno"> 2668</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2669</span>                            <span class="keywordtype">string</span> decayModeString = parameters-&gt;commodityVolDecayMode();</div>
<div class="line"><span class="lineno"> 2670</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Deterministic commodity volatilities with decay mode &quot;</span> &lt;&lt; decayModeString &lt;&lt; <span class="stringliteral">&quot; for &quot;</span></div>
<div class="line"><span class="lineno"> 2671</span>                                                                                         &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2672</span>                            <a class="code hl_enumerationRef" href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a> decayMode = parseDecayMode(decayModeString);</div>
<div class="line"><span class="lineno"> 2673</span>                            <span class="comment">// Copy what was done for equity here</span></div>
<div class="line"><span class="lineno"> 2674</span>                            <span class="comment">// May need to revisit when looking at commodity RFE</span></div>
<div class="line"><span class="lineno"> 2675</span>                            newVol = Handle&lt;BlackVolTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2676</span>                                QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_dynamic_black_vol_term_structure.html">QuantExt::DynamicBlackVolTermStructure&lt;tag::curve&gt;</a>&gt;(</div>
<div class="line"><span class="lineno"> 2677</span>                                    baseVol, 0, NullCalendar(), decayMode,</div>
<div class="line"><span class="lineno"> 2678</span>                                    stickyStrike ? <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa7958a422936150bb6ec2a9634789f7d5">StickyStrike</a> : <a class="code hl_variableRef" href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa3c712c65297116157beb42df5b5a2273">StickyLogMoneyness</a>));</div>
<div class="line"><span class="lineno"> 2679</span>                        }</div>
<div class="line"><span class="lineno"> 2680</span> </div>
<div class="line"><span class="lineno"> 2681</span>                        newVol-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2682</span>                        newVol-&gt;enableExtrapolation(baseVol-&gt;allowsExtrapolation());</div>
<div class="line"><span class="lineno"> 2683</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#aec9f1b5af32d4247654bb8bf5c20bef9">commodityVols_</a>.emplace(piecewise_construct,</div>
<div class="line"><span class="lineno"> 2684</span>                                               forward_as_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 2685</span>                                               forward_as_tuple(newVol));</div>
<div class="line"><span class="lineno"> 2686</span> </div>
<div class="line"><span class="lineno"> 2687</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Commodity volatility curve built for &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2688</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2689</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2690</span>                    }</div>
<div class="line"><span class="lineno"> 2691</span>                }</div>
<div class="line"><span class="lineno"> 2692</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2693</span> </div>
<div class="line"><span class="lineno"> 2694</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">RiskFactorKey::KeyType::Correlation</a>:</div>
<div class="line"><span class="lineno"> 2695</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2696</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2697</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2698</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;Adding correlations for &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; from configuration &quot;</span> &lt;&lt; configuration);</div>
<div class="line"><span class="lineno"> 2699</span> </div>
<div class="line"><span class="lineno"> 2700</span>                        vector&lt;string&gt; tokens = <a class="code hl_functionRef" href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec">getCorrelationTokens</a>(name);</div>
<div class="line"><span class="lineno"> 2701</span>                        QL_REQUIRE(tokens.size() == 2, <span class="stringliteral">&quot;not a valid correlation pair: &quot;</span> &lt;&lt; name);</div>
<div class="line"><span class="lineno"> 2702</span>                        pair&lt;string, string&gt; pair = std::make_pair(tokens[0], tokens[1]);</div>
<div class="line"><span class="lineno"> 2703</span> </div>
<div class="line"><span class="lineno"> 2704</span>                        QuantLib::ext::shared_ptr&lt;QuantExt::CorrelationTermStructure&gt; corr;</div>
<div class="line"><span class="lineno"> 2705</span>                        Handle&lt;QuantExt::CorrelationTermStructure&gt; baseCorr =</div>
<div class="line"><span class="lineno"> 2706</span>                            initMarket-&gt;correlationCurve(pair.first, pair.second, configuration);</div>
<div class="line"><span class="lineno"> 2707</span> </div>
<div class="line"><span class="lineno"> 2708</span>                        Handle&lt;QuantExt::CorrelationTermStructure&gt; ch;</div>
<div class="line"><span class="lineno"> 2709</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 2710</span>                            Size n = parameters-&gt;correlationStrikes().size();</div>
<div class="line"><span class="lineno"> 2711</span>                            Size m = parameters-&gt;correlationExpiries().size();</div>
<div class="line"><span class="lineno"> 2712</span>                            vector&lt;vector&lt;Handle&lt;Quote&gt;&gt;&gt; quotes(n, vector&lt;Handle&lt;Quote&gt;&gt;(m, Handle&lt;Quote&gt;()));</div>
<div class="line"><span class="lineno"> 2713</span>                            vector&lt;Time&gt; times(m);</div>
<div class="line"><span class="lineno"> 2714</span>                            Calendar cal = baseCorr-&gt;calendar();</div>
<div class="line"><span class="lineno"> 2715</span>                            DayCounter dc = baseCorr-&gt;dayCounter();</div>
<div class="line"><span class="lineno"> 2716</span>                            </div>
<div class="line"><span class="lineno"> 2717</span>                            <span class="keywordflow">for</span> (Size i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno"> 2718</span>                                Real strike = parameters-&gt;correlationStrikes()[i];</div>
<div class="line"><span class="lineno"> 2719</span> </div>
<div class="line"><span class="lineno"> 2720</span>                                <span class="keywordflow">for</span> (Size j = 0; j &lt; m; j++) {</div>
<div class="line"><span class="lineno"> 2721</span>                                    <span class="comment">// Index is expiries then strike TODO: is this the best?</span></div>
<div class="line"><span class="lineno"> 2722</span>                                    Size idx = i * m + j;</div>
<div class="line"><span class="lineno"> 2723</span>                                    times[j] = dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + parameters-&gt;correlationExpiries()[j]);</div>
<div class="line"><span class="lineno"> 2724</span>                                    Real correlation =</div>
<div class="line"><span class="lineno"> 2725</span>                                        baseCorr-&gt;correlation(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + parameters-&gt;correlationExpiries()[j], strike);</div>
<div class="line"><span class="lineno"> 2726</span>                                    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(</div>
<div class="line"><span class="lineno"> 2727</span>                                        <span class="keyword">new</span> SimpleQuote(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : correlation));</div>
<div class="line"><span class="lineno"> 2728</span>                                    simDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 2729</span>                                        std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2730</span>                                        std::forward_as_tuple(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">RiskFactorKey::KeyType::Correlation</a>, name, idx),</div>
<div class="line"><span class="lineno"> 2731</span>                                        std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2732</span>                                    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2733</span>                                        absoluteSimDataTmp.emplace(</div>
<div class="line"><span class="lineno"> 2734</span>                                            std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2735</span>                                            std::forward_as_tuple(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">RiskFactorKey::KeyType::Correlation</a>, name, idx),</div>
<div class="line"><span class="lineno"> 2736</span>                                            std::forward_as_tuple(correlation));</div>
<div class="line"><span class="lineno"> 2737</span>                                    }</div>
<div class="line"><span class="lineno"> 2738</span>                                    quotes[i][j] = Handle&lt;Quote&gt;(q);</div>
<div class="line"><span class="lineno"> 2739</span>                                }</div>
<div class="line"><span class="lineno"> 2740</span>                            }</div>
<div class="line"><span class="lineno"> 2741</span> </div>
<div class="line"><span class="lineno"> 2742</span>                            <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name,</div>
<div class="line"><span class="lineno"> 2743</span>                                         {parameters-&gt;correlationStrikes(), times});</div>
<div class="line"><span class="lineno"> 2744</span>                            simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2745</span> </div>
<div class="line"><span class="lineno"> 2746</span>                            <span class="keywordflow">if</span> (n == 1 &amp;&amp; m == 1) {</div>
<div class="line"><span class="lineno"> 2747</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2748</span>                                    ch = Handle&lt;QuantExt::CorrelationTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2749</span>                                        QuantLib::ext::make_shared&lt;QuantExt::SpreadedCorrelationCurve&gt;(baseCorr, times,</div>
<div class="line"><span class="lineno"> 2750</span>                                                                                               quotes[0]));</div>
<div class="line"><span class="lineno"> 2751</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2752</span>                                    ch = Handle&lt;QuantExt::CorrelationTermStructure&gt;(QuantLib::ext::make_shared&lt;FlatCorrelation&gt;(</div>
<div class="line"><span class="lineno"> 2753</span>                                        baseCorr-&gt;settlementDays(), cal, quotes[0][0], dc));</div>
<div class="line"><span class="lineno"> 2754</span>                                }</div>
<div class="line"><span class="lineno"> 2755</span>                            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><span class="lineno"> 2756</span>                                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2757</span>                                    ch = Handle&lt;QuantExt::CorrelationTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2758</span>                                        QuantLib::ext::make_shared&lt;QuantExt::SpreadedCorrelationCurve&gt;(baseCorr, times,</div>
<div class="line"><span class="lineno"> 2759</span>                                                                                               quotes[0]));</div>
<div class="line"><span class="lineno"> 2760</span>                                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2761</span>                                    ch = Handle&lt;QuantExt::CorrelationTermStructure&gt;(</div>
<div class="line"><span class="lineno"> 2762</span>                                        QuantLib::ext::make_shared&lt;<a class="code hl_classRef" href="../qle/class_quant_ext_1_1_interpolated_correlation_curve.html">InterpolatedCorrelationCurve&lt;Linear&gt;</a>&gt;(times, quotes[0], dc,</div>
<div class="line"><span class="lineno"> 2763</span>                                                                                                 cal));</div>
<div class="line"><span class="lineno"> 2764</span>                                }</div>
<div class="line"><span class="lineno"> 2765</span>                            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2766</span>                                QL_FAIL(<span class="stringliteral">&quot;only atm or flat correlation termstructures currently supported&quot;</span>);</div>
<div class="line"><span class="lineno"> 2767</span>                            }</div>
<div class="line"><span class="lineno"> 2768</span> </div>
<div class="line"><span class="lineno"> 2769</span>                            ch-&gt;enableExtrapolation(baseCorr-&gt;allowsExtrapolation());</div>
<div class="line"><span class="lineno"> 2770</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2771</span>                            ch = Handle&lt;QuantExt::CorrelationTermStructure&gt;(*baseCorr);</div>
<div class="line"><span class="lineno"> 2772</span>                        }</div>
<div class="line"><span class="lineno"> 2773</span> </div>
<div class="line"><span class="lineno"> 2774</span>                        ch-&gt;setAdjustReferenceDate(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2775</span>                        <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a21f5030728e25a766476309c37b67149">correlationCurves_</a>[make_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, pair.first, pair.second)] = ch;</div>
<div class="line"><span class="lineno"> 2776</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2777</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2778</span>                    }</div>
<div class="line"><span class="lineno"> 2779</span>                }</div>
<div class="line"><span class="lineno"> 2780</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2781</span> </div>
<div class="line"><span class="lineno"> 2782</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca4e3f4e3431c7d01a332f5be79ff5f138">RiskFactorKey::KeyType::CPR</a>:</div>
<div class="line"><span class="lineno"> 2783</span>                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; name : param.second.second) {</div>
<div class="line"><span class="lineno"> 2784</span>                    <span class="keywordtype">bool</span> simDataWritten = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2785</span>                    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2786</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Adding cpr &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; from configuration &quot;</span> &lt;&lt; configuration);</div>
<div class="line"><span class="lineno"> 2787</span>                        Real v = initMarket-&gt;cpr(name, configuration)-&gt;value();</div>
<div class="line"><span class="lineno"> 2788</span>                        <span class="keyword">auto</span> q = QuantLib::ext::make_shared&lt;SimpleQuote&gt;(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a> ? 0.0 : v);</div>
<div class="line"><span class="lineno"> 2789</span>                                                <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2790</span>                            <span class="keyword">auto</span> m = [v](Real x) { <span class="keywordflow">return</span> x + v; };</div>
<div class="line"><span class="lineno"> 2791</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa94a1440fdab7170ac9d69e82622239b">cprs_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name),</div>
<div class="line"><span class="lineno"> 2792</span>                                                   Handle&lt;Quote&gt;(QuantLib::ext::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(</div>
<div class="line"><span class="lineno"> 2793</span>                                                       Handle&lt;Quote&gt;(q), m))));</div>
<div class="line"><span class="lineno"> 2794</span>                        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2795</span>                            <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#aa94a1440fdab7170ac9d69e82622239b">cprs_</a>.insert(make_pair(make_pair(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, name), Handle&lt;Quote&gt;(q)));</div>
<div class="line"><span class="lineno"> 2796</span>                        }</div>
<div class="line"><span class="lineno"> 2797</span> </div>
<div class="line"><span class="lineno"> 2798</span>                        <span class="keywordflow">if</span> (param.second.first) {</div>
<div class="line"><span class="lineno"> 2799</span>                            simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno"> 2800</span>                                               std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno"> 2801</span>                            <span class="keywordflow">if</span>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2802</span>                                absoluteSimDataTmp.emplace(std::piecewise_construct,</div>
<div class="line"><span class="lineno"> 2803</span>                                                           std::forward_as_tuple(param.first, name),</div>
<div class="line"><span class="lineno"> 2804</span>                                                           std::forward_as_tuple(v));</div>
<div class="line"><span class="lineno"> 2805</span>                            }</div>
<div class="line"><span class="lineno"> 2806</span>                        }</div>
<div class="line"><span class="lineno"> 2807</span>                        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, param.first, name, {});</div>
<div class="line"><span class="lineno"> 2808</span>                        simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2809</span>                    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2810</span>                        processException(continueOnError, e, name, param.first, simDataWritten);</div>
<div class="line"><span class="lineno"> 2811</span>                    }</div>
<div class="line"><span class="lineno"> 2812</span>                }</div>
<div class="line"><span class="lineno"> 2813</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2814</span> </div>
<div class="line"><span class="lineno"> 2815</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca55a1d75e1be44713e466c14ebaa876dd">RiskFactorKey::KeyType::SurvivalWeight</a>:</div>
<div class="line"><span class="lineno"> 2816</span>                <span class="comment">// nothing to do, these are written to asd</span></div>
<div class="line"><span class="lineno"> 2817</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2818</span> </div>
<div class="line"><span class="lineno"> 2819</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca407bdb81313c0f751a06f6a6562bd3bc">RiskFactorKey::KeyType::CreditState</a>:</div>
<div class="line"><span class="lineno"> 2820</span>                <span class="comment">// nothing to do, these are written to asd</span></div>
<div class="line"><span class="lineno"> 2821</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2822</span> </div>
<div class="line"><span class="lineno"> 2823</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca6adf97f83acf6453d4a6a4b1070f3754">RiskFactorKey::KeyType::None</a>:</div>
<div class="line"><span class="lineno"> 2824</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;RiskFactorKey None not yet implemented&quot;</span>);</div>
<div class="line"><span class="lineno"> 2825</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2826</span>            }</div>
<div class="line"><span class="lineno"> 2827</span> </div>
<div class="line"><span class="lineno"> 2828</span>            <span class="keywordflow">if</span> (!param.second.second.empty()) {</div>
<div class="line"><span class="lineno"> 2829</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;built &quot;</span> &lt;&lt; std::left &lt;&lt; std::setw(25) &lt;&lt; param.first &lt;&lt; std::right &lt;&lt; std::setw(10)</div>
<div class="line"><span class="lineno"> 2830</span>                             &lt;&lt; param.second.second.size() &lt;&lt; std::setprecision(3) &lt;&lt; std::setw(15)</div>
<div class="line"><span class="lineno"> 2831</span>                             &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(timer.elapsed().wall) / 1E6 &lt;&lt; <span class="stringliteral">&quot; ms&quot;</span>);</div>
<div class="line"><span class="lineno"> 2832</span>            }</div>
<div class="line"><span class="lineno"> 2833</span> </div>
<div class="line"><span class="lineno"> 2834</span>        } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2835</span>            <a class="code hl_classRef" href="../ored/classore_1_1data_1_1_structured_message.html">StructuredMessage</a>(ore::data::StructuredMessage::Category::Error,</div>
<div class="line"><span class="lineno"> 2836</span>                                   ore::data::StructuredMessage::Group::Curve, e.what(),</div>
<div class="line"><span class="lineno"> 2837</span>                                   {{<span class="stringliteral">&quot;exceptionType&quot;</span>, <span class="stringliteral">&quot;ScenarioSimMarket top level catch - this should never happen, &quot;</span></div>
<div class="line"><span class="lineno"> 2838</span>                                                 <span class="stringliteral">&quot;contact dev. Results are likely wrong or incomplete.&quot;</span>}})</div>
<div class="line"><span class="lineno"> 2839</span>                .<a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a250ccc1dd6b0731854784fddafb97284">log</a>();</div>
<div class="line"><span class="lineno"> 2840</span>            processException(continueOnError, e);</div>
<div class="line"><span class="lineno"> 2841</span>        }</div>
<div class="line"><span class="lineno"> 2842</span>    }</div>
<div class="line"><span class="lineno"> 2843</span> </div>
<div class="line"><span class="lineno"> 2844</span>    <span class="comment">// swap indices</span></div>
<div class="line"><span class="lineno"> 2845</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;building swap indices...&quot;</span>);</div>
<div class="line"><span class="lineno"> 2846</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; it : parameters-&gt;swapIndices()) {</div>
<div class="line"><span class="lineno"> 2847</span>        <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a301b6c1dfdbe2500cb0b6a499e0b5734">addSwapIndexToSsm</a>(it.first, continueOnError);</div>
<div class="line"><span class="lineno"> 2848</span>    }</div>
<div class="line"><span class="lineno"> 2849</span> </div>
<div class="line"><span class="lineno"> 2850</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;isAbsolute() &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2851</span>        <span class="keyword">auto</span> recastedScenario = <a class="code hl_function" href="namespaceore_1_1analytics.html#a35873d59d4c8215a5bf61bb1ef08a3b0">recastScenario</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;coordinates(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>);</div>
<div class="line"><span class="lineno"> 2852</span>        QL_REQUIRE(recastedScenario != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScenarioSimMarke: Offset Scenario couldn&#39;t applied&quot;</span>);</div>
<div class="line"><span class="lineno"> 2853</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [key, quote] : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 2854</span>            <span class="keywordflow">if</span> (recastedScenario-&gt;has(key)) {</div>
<div class="line"><span class="lineno"> 2855</span>                quote-&gt;setValue(recastedScenario-&gt;get(key));</div>
<div class="line"><span class="lineno"> 2856</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2857</span>                QL_FAIL(<span class="stringliteral">&quot;ScenarioSimMarket: Offset Scenario doesnt contain key &quot;</span></div>
<div class="line"><span class="lineno"> 2858</span>                        &lt;&lt; key</div>
<div class="line"><span class="lineno"> 2859</span>                        &lt;&lt; <span class="stringliteral">&quot;. Internal error, possibly an internal error in the recastScenario method, contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2860</span>            }</div>
<div class="line"><span class="lineno"> 2861</span>        }</div>
<div class="line"><span class="lineno"> 2862</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a> != <span class="keyword">nullptr</span> &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;isAbsolute() &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2863</span>        <span class="keyword">auto</span> recastedScenario = <a class="code hl_function" href="namespaceore_1_1analytics.html#a35873d59d4c8215a5bf61bb1ef08a3b0">recastScenario</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;coordinates(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>);</div>
<div class="line"><span class="lineno"> 2864</span>        QL_REQUIRE(recastedScenario != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScenarioSimMarke: Offset Scenario couldn&#39;t applied&quot;</span>);</div>
<div class="line"><span class="lineno"> 2865</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [key, data] : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 2866</span>            <span class="keywordflow">if</span> (recastedScenario-&gt;has(key)) {</div>
<div class="line"><span class="lineno"> 2867</span>                <span class="keyword">auto</span> shift = <a class="code hl_function" href="namespaceore_1_1analytics.html#a0a880169f5c4e0ca0aa9355efa4d1f45">getDifferenceScenario</a>(key.keytype, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a>[key], recastedScenario-&gt;get(key));</div>
<div class="line"><span class="lineno"> 2868</span>                <a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>-&gt;setValue(shift);</div>
<div class="line"><span class="lineno"> 2869</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a>[key] = recastedScenario-&gt;get(key);</div>
<div class="line"><span class="lineno"> 2870</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2871</span>                QL_FAIL(<span class="stringliteral">&quot;ScenarioSimMarket: Offset Scenario doesnt contain key &quot;</span></div>
<div class="line"><span class="lineno"> 2872</span>                        &lt;&lt; key</div>
<div class="line"><span class="lineno"> 2873</span>                        &lt;&lt; <span class="stringliteral">&quot;. Internal error, possibly an internal error in the recastScenario method, contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2874</span>            }</div>
<div class="line"><span class="lineno"> 2875</span>        }</div>
<div class="line"><span class="lineno"> 2876</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a> != <span class="keyword">nullptr</span> &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;isAbsolute() &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2877</span>        <span class="keyword">auto</span> recastedScenario = <a class="code hl_function" href="namespaceore_1_1analytics.html#a35873d59d4c8215a5bf61bb1ef08a3b0">recastScenario</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;coordinates(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>);</div>
<div class="line"><span class="lineno"> 2878</span>        QL_REQUIRE(recastedScenario != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScenarioSimMarke: Offset Scenario couldn&#39;t applied&quot;</span>);</div>
<div class="line"><span class="lineno"> 2879</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [key, quote] : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 2880</span>            <span class="keywordflow">if</span> (recastedScenario-&gt;has(key)) {</div>
<div class="line"><span class="lineno"> 2881</span>                quote-&gt;setValue(<a class="code hl_function" href="namespaceore_1_1analytics.html#adc1ca48a6a82bd5eb2496ae21e41d411">addDifferenceToScenario</a>(key.keytype, quote-&gt;value(), recastedScenario-&gt;get(key)));</div>
<div class="line"><span class="lineno"> 2882</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2883</span>                QL_FAIL(<span class="stringliteral">&quot;ScenarioSimMarket: Offset Scenario doesnt contain key &quot;</span></div>
<div class="line"><span class="lineno"> 2884</span>                        &lt;&lt; key</div>
<div class="line"><span class="lineno"> 2885</span>                        &lt;&lt; <span class="stringliteral">&quot;. Internal error, possibly an internal error in the recastScenario method, contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2886</span>            }</div>
<div class="line"><span class="lineno"> 2887</span>        }</div>
<div class="line"><span class="lineno"> 2888</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a> != <span class="keyword">nullptr</span> &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;isAbsolute() &amp;&amp; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2889</span>        <span class="keyword">auto</span> recastedScenario = <a class="code hl_function" href="namespaceore_1_1analytics.html#a35873d59d4c8215a5bf61bb1ef08a3b0">recastScenario</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">offsetScenario_</a>-&gt;coordinates(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>);</div>
<div class="line"><span class="lineno"> 2890</span>        QL_REQUIRE(recastedScenario != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScenarioSimMarke: Offset Scenario couldn&#39;t applied&quot;</span>);</div>
<div class="line"><span class="lineno"> 2891</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; [key, quote] : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 2892</span>            <span class="keywordflow">if</span> (recastedScenario-&gt;has(key)) {</div>
<div class="line"><span class="lineno"> 2893</span>                quote-&gt;setValue(recastedScenario-&gt;get(key));</div>
<div class="line"><span class="lineno"> 2894</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a>[key] =</div>
<div class="line"><span class="lineno"> 2895</span>                    <a class="code hl_function" href="namespaceore_1_1analytics.html#adc1ca48a6a82bd5eb2496ae21e41d411">addDifferenceToScenario</a>(key.keytype, <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a>[key], recastedScenario-&gt;get(key));</div>
<div class="line"><span class="lineno"> 2896</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2897</span>                QL_FAIL(<span class="stringliteral">&quot;ScenarioSimMarket: Offset Scenario doesnt contain key &quot;</span></div>
<div class="line"><span class="lineno"> 2898</span>                        &lt;&lt; key</div>
<div class="line"><span class="lineno"> 2899</span>                        &lt;&lt; <span class="stringliteral">&quot;. Internal error, possibly an internal error in the recastScenario method, contact dev.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2900</span>            }</div>
<div class="line"><span class="lineno"> 2901</span>        }</div>
<div class="line"><span class="lineno"> 2902</span>    }</div>
<div class="line"><span class="lineno"> 2903</span> </div>
<div class="line"><span class="lineno"> 2904</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building base scenario&quot;</span>);</div>
<div class="line"><span class="lineno"> 2905</span>    <span class="keyword">auto</span> tmp = QuantLib::ext::make_shared&lt;SimpleScenario&gt;(initMarket-&gt;asofDate(), <span class="stringliteral">&quot;BASE&quot;</span>, 1.0);</div>
<div class="line"><span class="lineno"> 2906</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>) {</div>
<div class="line"><span class="lineno"> 2907</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; data : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 2908</span>            tmp-&gt;add(<a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>.first, <a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>.second-&gt;value());</div>
<div class="line"><span class="lineno"> 2909</span>        }</div>
<div class="line"><span class="lineno"> 2910</span>        tmp-&gt;setAbsolute(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2911</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [type, name, coordinates] : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>) {</div>
<div class="line"><span class="lineno"> 2912</span>            tmp-&gt;setCoordinates(type, name, coordinates);</div>
<div class="line"><span class="lineno"> 2913</span>        }</div>
<div class="line"><span class="lineno"> 2914</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a65d3596672b1e758c866798baa9bee78">baseScenarioAbsolute_</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a> = tmp;</div>
<div class="line"><span class="lineno"> 2915</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2916</span>        <span class="keyword">auto</span> tmpAbs = QuantLib::ext::make_shared&lt;SimpleScenario&gt;(initMarket-&gt;asofDate(), <span class="stringliteral">&quot;BASE&quot;</span>, 1.0);</div>
<div class="line"><span class="lineno"> 2917</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; data : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 2918</span>            tmp-&gt;add(<a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>.first, <a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>.second-&gt;value());</div>
<div class="line"><span class="lineno"> 2919</span>        }</div>
<div class="line"><span class="lineno"> 2920</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; data : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a>) {</div>
<div class="line"><span class="lineno"> 2921</span>            tmpAbs-&gt;add(<a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>.first, <a class="code hl_variableRef" href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a>.second);</div>
<div class="line"><span class="lineno"> 2922</span>        }</div>
<div class="line"><span class="lineno"> 2923</span>        tmp-&gt;setAbsolute(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2924</span>        tmpAbs-&gt;setAbsolute(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2925</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; [type, name, coordinates] : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>) {</div>
<div class="line"><span class="lineno"> 2926</span>            tmp-&gt;setCoordinates(type, name, coordinates);</div>
<div class="line"><span class="lineno"> 2927</span>            tmpAbs-&gt;setCoordinates(type, name, coordinates);</div>
<div class="line"><span class="lineno"> 2928</span>        }</div>
<div class="line"><span class="lineno"> 2929</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a> = tmp;</div>
<div class="line"><span class="lineno"> 2930</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a65d3596672b1e758c866798baa9bee78">baseScenarioAbsolute_</a> = tmpAbs;</div>
<div class="line"><span class="lineno"> 2931</span>    }</div>
<div class="line"><span class="lineno"> 2932</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a>(<span class="stringliteral">&quot;building base scenario done&quot;</span>);</div>
<div class="line"><span class="lineno"> 2933</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_black_variance_surface_std_devs_html_ae16f88d114d997f6ab73eed253ee0a10"><div class="ttname"><a href="../qle/class_quant_ext_1_1_black_variance_surface_std_devs.html#ae16f88d114d997f6ab73eed253ee0a10">QuantExt::BlackVarianceSurfaceStdDevs::populateVolMatrix</a></div><div class="ttdeci">static void populateVolMatrix(const QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt; &amp;termStructre, std::vector&lt; std::vector&lt; Handle&lt; QuantLib::Quote &gt; &gt; &gt; &amp;quotesToPopulate, const std::vector&lt; Real &gt; &amp;times, const std::vector&lt; Real &gt; &amp;stdDevPoints, const QuantLib::Interpolation &amp;forwardCurve, const QuantLib::Interpolation atmVolCurve)</div></div>
<div class="ttc" id="aclass_quant_ext_1_1_capped_floored_overnight_indexed_coupon_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_capped_floored_overnight_indexed_coupon.html">QuantExt::CappedFlooredOvernightIndexedCoupon</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_dynamic_black_vol_term_structure_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_dynamic_black_vol_term_structure.html">QuantExt::DynamicBlackVolTermStructure</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_interpolated_c_p_i_volatility_surface_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_interpolated_c_p_i_volatility_surface.html">QuantExt::InterpolatedCPIVolatilitySurface</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_interpolated_correlation_curve_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_interpolated_correlation_curve.html">QuantExt::InterpolatedCorrelationCurve</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_make_o_i_s_cap_floor_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html">QuantExt::MakeOISCapFloor</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_make_o_i_s_cap_floor_html_a5c92a8fb4d7a5de84d60cb01ca39a864"><div class="ttname"><a href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a5c92a8fb4d7a5de84d60cb01ca39a864">QuantExt::MakeOISCapFloor::withSettlementDays</a></div><div class="ttdeci">MakeOISCapFloor &amp; withSettlementDays(Natural settlementDays)</div></div>
<div class="ttc" id="aclass_quant_ext_1_1_make_o_i_s_cap_floor_html_a6842ee3fbbf88963ed4d02e7ddb70c22"><div class="ttname"><a href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a6842ee3fbbf88963ed4d02e7ddb70c22">QuantExt::MakeOISCapFloor::withTelescopicValueDates</a></div><div class="ttdeci">MakeOISCapFloor &amp; withTelescopicValueDates(bool telescopicValueDates)</div></div>
<div class="ttc" id="aclass_quant_ext_1_1_stripped_optionlet_adapter_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_stripped_optionlet_adapter.html">QuantExt::StrippedOptionletAdapter</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_survival_probability_curve_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_survival_probability_curve.html">QuantExt::SurvivalProbabilityCurve</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_swaption_vol_cube2.html">QuantExt::SwaptionVolCube2</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_volatility_converter_html"><div class="ttname"><a href="../qle/class_quant_ext_1_1_swaption_volatility_converter.html">QuantExt::SwaptionVolatilityConverter</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_volatility_converter_html_affb7c71beffe1005e48ae98615eaaf4c"><div class="ttname"><a href="../qle/class_quant_ext_1_1_swaption_volatility_converter.html#affb7c71beffe1005e48ae98615eaaf4c">QuantExt::SwaptionVolatilityConverter::convert</a></div><div class="ttdeci">boost::shared_ptr&lt; SwaptionVolatilityStructure &gt; convert() const</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca07cf31a470614797e8fde5ef0ec16d00">ore::analytics::RiskFactorKey::KeyType::YoYInflationCapFloorVolatility</a></div><div class="ttdeci">@ YoYInflationCapFloorVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca093e4fe6b3d4a9ec87bc625fc3cd57c4">ore::analytics::RiskFactorKey::KeyType::SwaptionVolatility</a></div><div class="ttdeci">@ SwaptionVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1865917ae0607c5cd6bda79dd0ca7fa3">ore::analytics::RiskFactorKey::KeyType::FXSpot</a></div><div class="ttdeci">@ FXSpot</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b5732971f0b2e238e09996b0e4137ab">ore::analytics::RiskFactorKey::KeyType::OptionletVolatility</a></div><div class="ttdeci">@ OptionletVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca1b9077b75e9e77e2b989363fd63a5023">ore::analytics::RiskFactorKey::KeyType::ZeroInflationCurve</a></div><div class="ttdeci">@ ZeroInflationCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca3b4f5bcd113ba3a759fed5a53a6605ba">ore::analytics::RiskFactorKey::KeyType::BaseCorrelation</a></div><div class="ttdeci">@ BaseCorrelation</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca407bdb81313c0f751a06f6a6562bd3bc"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca407bdb81313c0f751a06f6a6562bd3bc">ore::analytics::RiskFactorKey::KeyType::CreditState</a></div><div class="ttdeci">@ CreditState</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca42161e24fddf24f41751e3615a22d942">ore::analytics::RiskFactorKey::KeyType::FXVolatility</a></div><div class="ttdeci">@ FXVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca4e3f4e3431c7d01a332f5be79ff5f138"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca4e3f4e3431c7d01a332f5be79ff5f138">ore::analytics::RiskFactorKey::KeyType::CPR</a></div><div class="ttdeci">@ CPR</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca508328efaa028c90d6e0174ed7389614">ore::analytics::RiskFactorKey::KeyType::IndexCurve</a></div><div class="ttdeci">@ IndexCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca55a1d75e1be44713e466c14ebaa876dd"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca55a1d75e1be44713e466c14ebaa876dd">ore::analytics::RiskFactorKey::KeyType::SurvivalWeight</a></div><div class="ttdeci">@ SurvivalWeight</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca5f750c3076b1c419d3d1684019d36b16">ore::analytics::RiskFactorKey::KeyType::Correlation</a></div><div class="ttdeci">@ Correlation</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca6adf97f83acf6453d4a6a4b1070f3754"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca6adf97f83acf6453d4a6a4b1070f3754">ore::analytics::RiskFactorKey::KeyType::None</a></div><div class="ttdeci">@ None</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca6e7c1dee048f032ac6ff1a0b21a396e2"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca6e7c1dee048f032ac6ff1a0b21a396e2">ore::analytics::RiskFactorKey::KeyType::CPIIndex</a></div><div class="ttdeci">@ CPIIndex</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca7627df19a0ced95c64deaa8cc8f542ad">ore::analytics::RiskFactorKey::KeyType::EquitySpot</a></div><div class="ttdeci">@ EquitySpot</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b60de0ad291c4d80cf3432965bc82f9">ore::analytics::RiskFactorKey::KeyType::CDSVolatility</a></div><div class="ttdeci">@ CDSVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca8b69e07aebb6ce88afa81cdc54f1b345"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8b69e07aebb6ce88afa81cdc54f1b345">ore::analytics::RiskFactorKey::KeyType::YieldVolatility</a></div><div class="ttdeci">@ YieldVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca8e8dc8f01c6bcb01d61bf55bacf2eca2">ore::analytics::RiskFactorKey::KeyType::ZeroInflationCapFloorVolatility</a></div><div class="ttdeci">@ ZeroInflationCapFloorVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca9d7d26f62c80f28bf77fe27b5916d72b">ore::analytics::RiskFactorKey::KeyType::EquityVolatility</a></div><div class="ttdeci">@ EquityVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caad7a4415513da5f62869964dbd864401">ore::analytics::RiskFactorKey::KeyType::YoYInflationCurve</a></div><div class="ttdeci">@ YoYInflationCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caae3e9d76749d0836ed0a77d47db75807">ore::analytics::RiskFactorKey::KeyType::CommodityVolatility</a></div><div class="ttdeci">@ CommodityVolatility</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">ore::analytics::RiskFactorKey::KeyType::RecoveryRate</a></div><div class="ttdeci">@ RecoveryRate</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238caba2340fc08c36e9473d88fa6d823c1fb">ore::analytics::RiskFactorKey::KeyType::SurvivalProbability</a></div><div class="ttdeci">@ SurvivalProbability</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac180e16777ec55d7f8be3f91ab6c0313">ore::analytics::RiskFactorKey::KeyType::DiscountCurve</a></div><div class="ttdeci">@ DiscountCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cac8dbbdbb04d984dd976732914ab27738">ore::analytics::RiskFactorKey::KeyType::YieldCurve</a></div><div class="ttdeci">@ YieldCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cacd59a2a4ff9ac8cc9915a32422983f23">ore::analytics::RiskFactorKey::KeyType::SecuritySpread</a></div><div class="ttdeci">@ SecuritySpread</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae3e94db8c7c495e9ccec519ddb8d2438">ore::analytics::RiskFactorKey::KeyType::DividendYield</a></div><div class="ttdeci">@ DividendYield</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_risk_factor_key_html_aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88"><div class="ttname"><a href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cae47e467708876f2be8f90cdd8bc65d88">ore::analytics::RiskFactorKey::KeyType::CommodityCurve</a></div><div class="ttdeci">@ CommodityCurve</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a076bfc216eaef4fe4e0667a433e1ad76"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">ore::analytics::ScenarioSimMarket::simData_</a></div><div class="ttdeci">std::map&lt; RiskFactorKey, QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt; simData_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00172">scenariosimmarket.hpp:172</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a2f193d3de7c1a94311d8c1ea52a889c7"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">ore::analytics::ScenarioSimMarket::filter_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; ScenarioFilter &gt; filter_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00170">scenariosimmarket.hpp:170</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a301b6c1dfdbe2500cb0b6a499e0b5734"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a301b6c1dfdbe2500cb0b6a499e0b5734">ore::analytics::ScenarioSimMarket::addSwapIndexToSsm</a></div><div class="ttdeci">bool addSwapIndexToSsm(const std::string &amp;indexName, const bool continueOnError)</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l02935">scenariosimmarket.cpp:2935</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a327eb9d6ae1ae728199147f68ba0909c"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a327eb9d6ae1ae728199147f68ba0909c">ore::analytics::ScenarioSimMarket::fixingManager_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; FixingManager &gt; fixingManager_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00169">scenariosimmarket.hpp:169</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a333c90f525cb31f0eaa29fed1593ba72"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">ore::analytics::ScenarioSimMarket::getYieldCurve</a></div><div class="ttdeci">QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt; getYieldCurve(const std::string &amp;yieldSpecId, const ore::data::TodaysMarketParameters &amp;todaysMarketParams, const std::string &amp;configuration, const QuantLib::ext::shared_ptr&lt; ore::data::Market &gt; &amp;market=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03196">scenariosimmarket.cpp:3196</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a53cfefe400aac2623306853c887ef20a"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">ore::analytics::ScenarioSimMarket::useSpreadedTermStructures_</a></div><div class="ttdeci">bool useSpreadedTermStructures_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00184">scenariosimmarket.hpp:184</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a5b99f8838062291f6201c9f819cd3da1"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">ore::analytics::ScenarioSimMarket::baseScenario_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Scenario &gt; baseScenario_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00173">scenariosimmarket.hpp:173</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a63c0747af118c1d41066cd31f6cd084d"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">ore::analytics::ScenarioSimMarket::parameters_</a></div><div class="ttdeci">const QuantLib::ext::shared_ptr&lt; ScenarioSimMarketParameters &gt; parameters_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00166">scenariosimmarket.hpp:166</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a65d3596672b1e758c866798baa9bee78"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a65d3596672b1e758c866798baa9bee78">ore::analytics::ScenarioSimMarket::baseScenarioAbsolute_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Scenario &gt; baseScenarioAbsolute_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00174">scenariosimmarket.hpp:174</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a6cfed719476afdb574d21318aa9a1118"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a6cfed719476afdb574d21318aa9a1118">ore::analytics::ScenarioSimMarket::addYieldCurve</a></div><div class="ttdeci">void addYieldCurve(const QuantLib::ext::shared_ptr&lt; Market &gt; &amp;initMarket, const std::string &amp;configuration, const RiskFactorKey::KeyType rf, const string &amp;key, const vector&lt; Period &gt; &amp;tenors, bool &amp;simDataWritten, bool simulate=true, bool spreaded=false)</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00249">scenariosimmarket.cpp:249</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a7a035b0b5a2360c3ee4490089fee6523"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a7a035b0b5a2360c3ee4490089fee6523">ore::analytics::ScenarioSimMarket::allowPartialScenarios_</a></div><div class="ttdeci">bool allowPartialScenarios_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00191">scenariosimmarket.hpp:191</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ab0e9fb72add803a7cca3013e13f70b37"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ab0e9fb72add803a7cca3013e13f70b37">ore::analytics::ScenarioSimMarket::offsetScenario_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Scenario &gt; offsetScenario_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00198">scenariosimmarket.hpp:198</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ab44a4a6e17e2c28d464cf9ed93fd53a6"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ab44a4a6e17e2c28d464cf9ed93fd53a6">ore::analytics::ScenarioSimMarket::fixingManager</a></div><div class="ttdeci">const QuantLib::ext::shared_ptr&lt; FixingManager &gt; &amp; fixingManager() const override</div><div class="ttdoc">Return the fixing manager.</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00137">scenariosimmarket.hpp:137</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ab5b2289c143003c7964bfeb7e570c504"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">ore::analytics::ScenarioSimMarket::coordinatesData_</a></div><div class="ttdeci">std::set&lt; std::tuple&lt; RiskFactorKey::KeyType, std::string, std::vector&lt; std::vector&lt; Real &gt; &gt; &gt; &gt; coordinatesData_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00188">scenariosimmarket.hpp:188</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ac8084e71c12327fddaa89613722b4624"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ac8084e71c12327fddaa89613722b4624">ore::analytics::ScenarioSimMarket::cacheSimData_</a></div><div class="ttdeci">bool cacheSimData_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00190">scenariosimmarket.hpp:190</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ac9a5eb0d03fa8e820cf67d44e8c0b21a"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ac9a5eb0d03fa8e820cf67d44e8c0b21a">ore::analytics::ScenarioSimMarket::iborFallbackConfig_</a></div><div class="ttdeci">IborFallbackConfig iborFallbackConfig_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00192">scenariosimmarket.hpp:192</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_ad66079855d4dadc55e8f684e17bfce63"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">ore::analytics::ScenarioSimMarket::absoluteSimData_</a></div><div class="ttdeci">std::map&lt; RiskFactorKey, Real &gt; absoluteSimData_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00185">scenariosimmarket.hpp:185</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_afd151e890d7a129bea4022a7a0d4dce3"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">ore::analytics::ScenarioSimMarket::writeSimData</a></div><div class="ttdeci">void writeSimData(std::map&lt; RiskFactorKey, QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt; &amp;simDataTmp, std::map&lt; RiskFactorKey, Real &gt; &amp;absoluteSimDataTmp, const RiskFactorKey::KeyType keyType, const std::string &amp;name, const std::vector&lt; std::vector&lt; Real &gt; &gt; &amp;coordinates)</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00238">scenariosimmarket.cpp:238</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_ibor_fallback_config_html_a6ca7e3d959dbdba95b5247634af86d1b"><div class="ttname"><a href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#a6ca7e3d959dbdba95b5247634af86d1b">ore::data::IborFallbackConfig::fallbackData</a></div><div class="ttdeci">const FallbackData &amp; fallbackData(const string &amp;iborIndex) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_ibor_fallback_config_html_ad955f8a6580ab44cc9ff95f86d456a03"><div class="ttname"><a href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ad955f8a6580ab44cc9ff95f86d456a03">ore::data::IborFallbackConfig::useRfrCurveInSimulationMarket</a></div><div class="ttdeci">bool useRfrCurveInSimulationMarket() const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_ibor_fallback_config_html_aeaad076823e67dfa54115c5db2f29d96"><div class="ttname"><a href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#aeaad076823e67dfa54115c5db2f29d96">ore::data::IborFallbackConfig::isIndexReplaced</a></div><div class="ttdeci">bool isIndexReplaced(const string &amp;iborIndex, const QuantLib::Date &amp;asof=QuantLib::Date::maxDate()) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_html_a0b6a2501015e2227c3f1a4f621c21ab4"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market.html#a0b6a2501015e2227c3f1a4f621c21ab4">ore::data::Market::fxSpot</a></div><div class="ttdeci">Handle&lt; Quote &gt; fxSpot(const string &amp;ccypair, const string &amp;configuration=Market::defaultConfiguration) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_html_a8d884a61027d5434d524779453a5b918"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918">ore::data::Market::fxIndex</a></div><div class="ttdeci">QuantLib::Handle&lt; QuantExt::FxIndex &gt; fxIndex(const string &amp;fxIndex, const string &amp;configuration=Market::defaultConfiguration) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_html_ab336651e3455fff1764bf576a5785bbd"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">ore::data::Market::defaultConfiguration</a></div><div class="ttdeci">static const string defaultConfiguration</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_html_aff00023d0e25ad7c0bf29e8cc97f9e00"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">ore::data::Market::discountCurve</a></div><div class="ttdeci">Handle&lt; YieldTermStructure &gt; discountCurve(const string &amp;ccy, const string &amp;configuration=Market::defaultConfiguration) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a0b4a7aa3ac7df041878c7e173a3c64ec"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a0b4a7aa3ac7df041878c7e173a3c64ec">ore::data::MarketImpl::capFloorCurves_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; OptionletVolatilityStructure &gt; &gt; capFloorCurves_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a0dd15d7307d3eabe0b1d9012e64cd3aa"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa">ore::data::MarketImpl::shortSwapIndexBase</a></div><div class="ttdeci">string shortSwapIndexBase(const string &amp;key, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a1177363d3c16f7c943b873d8ebd14f4d"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d">ore::data::MarketImpl::swapIndexBase</a></div><div class="ttdeci">string swapIndexBase(const string &amp;key, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a2043641bdf8622ce37e5fa96d83cd8e9"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9">ore::data::MarketImpl::zeroInflationIndex</a></div><div class="ttdeci">virtual Handle&lt; ZeroInflationIndex &gt; zeroInflationIndex(const string &amp;indexName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a21e2bf8d9c6e49a938c4259d491f0efa"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a21e2bf8d9c6e49a938c4259d491f0efa">ore::data::MarketImpl::equityCurve</a></div><div class="ttdeci">Handle&lt; QuantExt::EquityIndex2 &gt; equityCurve(const string &amp;eqName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a21f5030728e25a766476309c37b67149"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a21f5030728e25a766476309c37b67149">ore::data::MarketImpl::correlationCurves_</a></div><div class="ttdeci">map&lt; tuple&lt; string, string, string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; correlationCurves_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a4d4b29028a553466f69f9d816eaada5c"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a4d4b29028a553466f69f9d816eaada5c">ore::data::MarketImpl::equityCurves_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, QuantLib::Handle&lt; QuantExt::EquityIndex2 &gt; &gt; equityCurves_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a589f42a64e6ab40d77a122443976d382"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a589f42a64e6ab40d77a122443976d382">ore::data::MarketImpl::cpiInflationCapFloorVolatilitySurfaces_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; CPIVolatilitySurface &gt; &gt; cpiInflationCapFloorVolatilitySurfaces_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a598238b952f3026fc385030cfa02b5dd"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a598238b952f3026fc385030cfa02b5dd">ore::data::MarketImpl::baseCpis_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantExt::InflationIndexObserver &gt; &gt; baseCpis_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a5b8442b6d8873c160be5e0e52c8b3071"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a5b8442b6d8873c160be5e0e52c8b3071">ore::data::MarketImpl::fxVols_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; BlackVolTermStructure &gt; &gt; fxVols_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a5bdb311cafacc7ef02e31db35cdd3c2b"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a5bdb311cafacc7ef02e31db35cdd3c2b">ore::data::MarketImpl::fx_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; FXTriangulation &gt; fx_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a6c9a8e7f8ce0fb904eda53256b2a17db"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a6c9a8e7f8ce0fb904eda53256b2a17db">ore::data::MarketImpl::commodityIndices_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, QuantLib::Handle&lt; QuantExt::CommodityIndex &gt; &gt; commodityIndices_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a6fbc788235c5a4e14315fb5f117c4d35"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a6fbc788235c5a4e14315fb5f117c4d35">ore::data::MarketImpl::defaultCurves_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantExt::CreditCurve &gt; &gt; defaultCurves_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a7750155dbe018c9040751ec807770b35"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a7750155dbe018c9040751ec807770b35">ore::data::MarketImpl::iborIndices_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; IborIndex &gt; &gt; iborIndices_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a7cad6ae2928d269c2dbbaf607d3d15d8"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a7cad6ae2928d269c2dbbaf607d3d15d8">ore::data::MarketImpl::yoyCapFloorVolSurfaces_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; YoYOptionletVolatilitySurface &gt; &gt; yoyCapFloorVolSurfaces_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a816b9cd7808e94b1aebd46ef23f76f97"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97">ore::data::MarketImpl::defaultCurve</a></div><div class="ttdeci">Handle&lt; QuantExt::CreditCurve &gt; defaultCurve(const string &amp;, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a8873185426918c5d252bd2457a92ce1d"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a8873185426918c5d252bd2457a92ce1d">ore::data::MarketImpl::yoyInflationIndices_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; YoYInflationIndex &gt; &gt; yoyInflationIndices_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a8bd2645934bf424bec9d60d3a146554e"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a8bd2645934bf424bec9d60d3a146554e">ore::data::MarketImpl::cdsVols_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantExt::CreditVolCurve &gt; &gt; cdsVols_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a9b352f577f3990c44c91b4b8ffa93a48"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a9b352f577f3990c44c91b4b8ffa93a48">ore::data::MarketImpl::equitySpots_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt; equitySpots_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_aa4e8780cb54cc1f2120dc22af3b903ee"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#aa4e8780cb54cc1f2120dc22af3b903ee">ore::data::MarketImpl::swaptionCurves_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantLib::SwaptionVolatilityStructure &gt; &gt; swaptionCurves_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_aa7e08433597ac99460ac5bfc347173c0"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#aa7e08433597ac99460ac5bfc347173c0">ore::data::MarketImpl::baseCorrelations_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantExt::BaseCorrelationTermStructure &gt; &gt; baseCorrelations_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_aa94a1440fdab7170ac9d69e82622239b"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#aa94a1440fdab7170ac9d69e82622239b">ore::data::MarketImpl::cprs_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt; cprs_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ab0192d884dd8d1a6bc1c887bf251b0bc"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ab0192d884dd8d1a6bc1c887bf251b0bc">ore::data::MarketImpl::recoveryRates_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt; recoveryRates_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ab22c6188a5f378934b69965aa7c6cb39"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ab22c6188a5f378934b69965aa7c6cb39">ore::data::MarketImpl::commodityPriceCurve</a></div><div class="ttdeci">QuantLib::Handle&lt; QuantExt::PriceTermStructure &gt; commodityPriceCurve(const string &amp;commodityName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ab33fff7168b7c7af1e957d68565e4ee4"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ab33fff7168b7c7af1e957d68565e4ee4">ore::data::MarketImpl::equitySpot</a></div><div class="ttdeci">Handle&lt; Quote &gt; equitySpot(const string &amp;eqName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ac4b30e0d4ca91a8246986ea7173164fc"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ac4b30e0d4ca91a8246986ea7173164fc">ore::data::MarketImpl::zeroInflationIndices_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; ZeroInflationIndex &gt; &gt; zeroInflationIndices_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ac59684278372260fbf998460e3ddf949"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">ore::data::MarketImpl::swapIndex</a></div><div class="ttdeci">Handle&lt; SwapIndex &gt; swapIndex(const string &amp;indexName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_acb886da44dcd5171d9371487aca3b1cf"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#acb886da44dcd5171d9371487aca3b1cf">ore::data::MarketImpl::swaptionIndexBases_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, pair&lt; string, string &gt; &gt; swaptionIndexBases_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ada78e1e842b03e527818f6d6b9fc3bcf"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ada78e1e842b03e527818f6d6b9fc3bcf">ore::data::MarketImpl::equityVols_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; BlackVolTermStructure &gt; &gt; equityVols_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ade1b633ccf740828de4e98b038f3ba39"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39">ore::data::MarketImpl::yoyInflationIndex</a></div><div class="ttdeci">virtual Handle&lt; YoYInflationIndex &gt; yoyInflationIndex(const string &amp;indexName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ae14cb3cad5042b1b2cdb640b4a11a3c6"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ae14cb3cad5042b1b2cdb640b4a11a3c6">ore::data::MarketImpl::yieldVolCurves_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; QuantLib::SwaptionVolatilityStructure &gt; &gt; yieldVolCurves_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ae647dad4005a503dc047518e84fb9a08"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">ore::data::MarketImpl::asof_</a></div><div class="ttdeci">Date asof_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ae73ab4348cb8a38e480b6b4f36502acd"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ae73ab4348cb8a38e480b6b4f36502acd">ore::data::MarketImpl::securitySpreads_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, Handle&lt; Quote &gt; &gt; securitySpreads_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ae7d29fd30616cfe3c462d7d84eaf4ef9"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">ore::data::MarketImpl::yieldCurve</a></div><div class="ttdeci">Handle&lt; YieldTermStructure &gt; yieldCurve(const YieldCurveType &amp;type, const string &amp;ccy, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_aea15232be6eb71feca2c59137631f732"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">ore::data::MarketImpl::iborIndex</a></div><div class="ttdeci">Handle&lt; IborIndex &gt; iborIndex(const string &amp;indexName, const string &amp;configuration=Market::defaultConfiguration) const override</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_aec9f1b5af32d4247654bb8bf5c20bef9"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#aec9f1b5af32d4247654bb8bf5c20bef9">ore::data::MarketImpl::commodityVols_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, QuantLib::Handle&lt; QuantLib::BlackVolTermStructure &gt; &gt; commodityVols_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_afea30f55f4e6ac11d14c3389276aa3d7"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#afea30f55f4e6ac11d14c3389276aa3d7">ore::data::MarketImpl::capFloorIndexBase_</a></div><div class="ttdeci">map&lt; pair&lt; string, string &gt;, std::pair&lt; string, QuantLib::Period &gt; &gt; capFloorIndexBase_</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_structured_message_html"><div class="ttname"><a href="../ored/classore_1_1data_1_1_structured_message.html">ore::data::StructuredMessage</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_yield_curve_spec_html"><div class="ttname"><a href="../ored/classore_1_1data_1_1_yield_curve_spec.html">ore::data::YieldCurveSpec</a></div></div>
<div class="ttc" id="acomputationgraphbuilder_8cpp_html_a68c611e65dfff92886c4627c9fdde094"><div class="ttname"><a href="../ored/computationgraphbuilder_8cpp.html#a68c611e65dfff92886c4627c9fdde094">value</a></div><div class="ttdeci">SafeStack&lt; ValueType &gt; value</div></div>
<div class="ttc" id="agroup__curves_html_ga7c53f293f4ad98e691c6a93b6be26e9a"><div class="ttname"><a href="../ored/group__curves.html#ga7c53f293f4ad98e691c6a93b6be26e9a">ore::data::parseCurveSpec</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; CurveSpec &gt; parseCurveSpec(const string &amp;s)</div></div>
<div class="ttc" id="agroup__termstructures_html_gab34c882cbe4ad41fff0faecff9a280f8"><div class="ttname"><a href="../qle/group__termstructures.html#gab34c882cbe4ad41fff0faecff9a280f8">ReactionToTimeDecay</a></div><div class="ttdeci">ReactionToTimeDecay</div></div>
<div class="ttc" id="agroup__termstructures_html_gga240c64d937e9aa2c90cbf42c19e8aa2aa3c712c65297116157beb42df5b5a2273"><div class="ttname"><a href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa3c712c65297116157beb42df5b5a2273">QuantExt::StickyLogMoneyness</a></div><div class="ttdeci">StickyLogMoneyness</div></div>
<div class="ttc" id="agroup__termstructures_html_gga240c64d937e9aa2c90cbf42c19e8aa2aa7958a422936150bb6ec2a9634789f7d5"><div class="ttname"><a href="../qle/group__termstructures.html#gga240c64d937e9aa2c90cbf42c19e8aa2aa7958a422936150bb6ec2a9634789f7d5">QuantExt::StickyStrike</a></div><div class="ttdeci">StickyStrike</div></div>
<div class="ttc" id="agroup__utilities_html_ga03699115fbdbcf46b6351c3735fdec87"><div class="ttname"><a href="../ored/group__utilities.html#ga03699115fbdbcf46b6351c3735fdec87">ore::data::parseZeroInflationIndex</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; ZeroInflationIndex &gt; parseZeroInflationIndex(const string &amp;s, const Handle&lt; ZeroInflationTermStructure &gt; &amp;h=Handle&lt; ZeroInflationTermStructure &gt;())</div></div>
<div class="ttc" id="agroup__utilities_html_ga0f72d6fcccae10a674bdcd5095200f14"><div class="ttname"><a href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14">ore::data::parseCalendar</a></div><div class="ttdeci">Calendar parseCalendar(const string &amp;s)</div></div>
<div class="ttc" id="agroup__utilities_html_ga2d18ab5807f92319c9db2c13f4904738"><div class="ttname"><a href="../ored/group__utilities.html#ga2d18ab5807f92319c9db2c13f4904738">ore::data::parseIborIndex</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; IborIndex &gt; parseIborIndex(const string &amp;s, const Handle&lt; YieldTermStructure &gt; &amp;h=Handle&lt; YieldTermStructure &gt;())</div></div>
<div class="ttc" id="alog_8hpp_html_a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b"><div class="ttname"><a href="../ored/log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a></div><div class="ttdeci">data</div></div>
<div class="ttc" id="alog_8hpp_html_a158e0f085ddedfe5c8ed069986039f50"><div class="ttname"><a href="../ored/log_8hpp.html#a158e0f085ddedfe5c8ed069986039f50">LOG</a></div><div class="ttdeci">#define LOG(text)</div></div>
<div class="ttc" id="alog_8hpp_html_a34c7c8cde9b91d2eee82d7b9a0b66fd5"><div class="ttname"><a href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a></div><div class="ttdeci">#define DLOG(text)</div></div>
<div class="ttc" id="alog_8hpp_html_a9622ca943201e814041f051b7a10b3ea"><div class="ttname"><a href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a></div><div class="ttdeci">#define WLOG(text)</div></div>
<div class="ttc" id="alog_8hpp_html_a99aeca53f904c71a68070e1f9d310232"><div class="ttname"><a href="../ored/log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a></div><div class="ttdeci">#define TLOG(text)</div></div>
<div class="ttc" id="anamespace_quant_ext_1_1_zero_inflation_html_a57de786c1c8988b6da9d354282b4b370"><div class="ttname"><a href="../qle/namespace_quant_ext_1_1_zero_inflation.html#a57de786c1c8988b6da9d354282b4b370">fixingDate</a></div><div class="ttdeci">QuantLib::Date fixingDate(const QuantLib::Date &amp;d, const QuantLib::Period obsLag, const QuantLib::Frequency freq, bool interpolated)</div></div>
<div class="ttc" id="anamespace_quant_ext_html_a1cab4fb6a720eff245acb9f3a7a9e7c5"><div class="ttname"><a href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a></div><div class="ttdeci">Filter close_enough(const RandomVariable &amp;x, const RandomVariable &amp;y)</div></div>
<div class="ttc" id="anamespace_quant_ext_html_a250ccc1dd6b0731854784fddafb97284"><div class="ttname"><a href="../qle/namespace_quant_ext.html#a250ccc1dd6b0731854784fddafb97284">log</a></div><div class="ttdeci">RandomVariable log(RandomVariable x)</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a0a880169f5c4e0ca0aa9355efa4d1f45"><div class="ttname"><a href="namespaceore_1_1analytics.html#a0a880169f5c4e0ca0aa9355efa4d1f45">ore::analytics::getDifferenceScenario</a></div><div class="ttdeci">Real getDifferenceScenario(const RiskFactorKey::KeyType keyType, const Real v1, const Real v2)</div><div class="ttdef"><b>Definition:</b> <a href="scenarioutilities_8cpp_source.html#l00028">scenarioutilities.cpp:28</a></div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a35873d59d4c8215a5bf61bb1ef08a3b0"><div class="ttname"><a href="namespaceore_1_1analytics.html#a35873d59d4c8215a5bf61bb1ef08a3b0">ore::analytics::recastScenario</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Scenario &gt; recastScenario(const QuantLib::ext::shared_ptr&lt; Scenario &gt; &amp;scenario, const std::map&lt; std::pair&lt; RiskFactorKey::KeyType, std::string &gt;, std::vector&lt; std::vector&lt; Real &gt; &gt; &gt; &amp;oldCoordinates, const std::map&lt; std::pair&lt; RiskFactorKey::KeyType, std::string &gt;, std::vector&lt; std::vector&lt; Real &gt; &gt; &gt; &amp;newCoordinates)</div><div class="ttdef"><b>Definition:</b> <a href="scenarioutilities_8cpp_source.html#l00227">scenarioutilities.cpp:227</a></div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_adc1ca48a6a82bd5eb2496ae21e41d411"><div class="ttname"><a href="namespaceore_1_1analytics.html#adc1ca48a6a82bd5eb2496ae21e41d411">ore::analytics::addDifferenceToScenario</a></div><div class="ttdeci">Real addDifferenceToScenario(const RiskFactorKey::KeyType keyType, const Real v, const Real d)</div><div class="ttdef"><b>Definition:</b> <a href="scenarioutilities_8cpp_source.html#l00068">scenarioutilities.cpp:68</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a03690cad98f577e0a0992609f64704ec"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec">ore::data::getCorrelationTokens</a></div><div class="ttdeci">std::vector&lt; std::string &gt; getCorrelationTokens(const std::string &amp;name)</div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#a1dd3178717c03aef7d6851a3dfd92207ad4192ca9679d38110983141b896eebbf">MomentType::Volatility</a></div><div class="ttdeci">@ Volatility</div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a777e216dee6069b548bb87da7152699e"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#a777e216dee6069b548bb87da7152699e">ore::data::size</a></div><div class="ttdeci">Size size(const ValueType &amp;v)</div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a86651dfeb5c18ee891f7a4734d8cf455"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a></div><div class="ttdeci">std::string to_string(const LocationInfo &amp;l)</div></div>
<div class="ttc" id="anamespaceore_1_1data_html_abd022b98516a69b335865f8c17a645cf"><div class="ttname"><a href="../ored/namespaceore_1_1data.html#abd022b98516a69b335865f8c17a645cf">ore::data::parseCommodityIndex</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; QuantExt::CommodityIndex &gt; parseCommodityIndex(const string &amp;name, bool hasPrefix, const Handle&lt; PriceTermStructure &gt; &amp;ts, const Calendar &amp;cal, const bool enforceFutureIndex)</div></div>
<div class="ttc" id="atest_2analyticcashsettledeuropeanengine_8cpp_html_aa7b6f0cca80627aec257d302511d608c"><div class="ttname"><a href="../qle/test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a></div><div class="ttdeci">vector&lt; Real &gt; strikes</div></div>
<div class="ttc" id="atest_2commodityvolcurve_8cpp_html_a96a582300d10244c7df851066de48438"><div class="ttname"><a href="../ored/test_2commodityvolcurve_8cpp.html#a96a582300d10244c7df851066de48438">curveConfigs</a></div><div class="ttdeci">vector&lt; string &gt; curveConfigs</div></div>
<div class="ttc" id="atodaysmarketparameters_8cpp_html_a8ccf841cb59e451791bcb2e1ac4f1edc"><div class="ttname"><a href="../ored/todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a></div><div class="ttdeci">string name</div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_a9fb38a0edc39d7edcb571010c80ca002_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_a9fb38a0edc39d7edcb571010c80ca002_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_a9fb38a0edc39d7edcb571010c80ca002_cgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_a9fb38a0edc39d7edcb571010c80ca002_cgraph">
<area shape="rect" title=" " alt="" coords="5,1071,141,1096"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a301b6c1dfdbe2500cb0b6a499e0b5734" title=" " alt="" coords="223,5,369,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a6cfed719476afdb574d21318aa9a1118" title=" " alt="" coords="244,107,348,132"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3" title=" " alt="" coords="517,49,615,75"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9" title=" " alt="" coords="493,163,639,203"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="245,208,347,233"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#ab22c6188a5f378934b69965aa7c6cb39" title=" " alt="" coords="218,258,374,298"/>
<area shape="rect" target="_parent" href="../qle/class_quant_ext_1_1_swaption_volatility_converter.html#affb7c71beffe1005e48ae98615eaaf4c" title=" " alt="" coords="202,322,390,362"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#a816b9cd7808e94b1aebd46ef23f76f97" title=" " alt="" coords="223,386,369,426"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00" title=" " alt="" coords="231,450,361,490"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#a21e2bf8d9c6e49a938c4259d491f0efa" title=" " alt="" coords="223,514,369,554"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#ab33fff7168b7c7af1e957d68565e4ee4" title=" " alt="" coords="223,578,369,618"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#a6ca7e3d959dbdba95b5247634af86d1b" title=" " alt="" coords="203,642,389,682"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext_1_1_zero_inflation.html#a57de786c1c8988b6da9d354282b4b370" title=" " alt="" coords="257,707,335,732"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market.html#a8d884a61027d5434d524779453a5b918" title=" " alt="" coords="231,757,361,797"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market.html#a0b6a2501015e2227c3f1a4f621c21ab4" title=" " alt="" coords="231,821,361,861"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#a03690cad98f577e0a0992609f64704ec" title=" " alt="" coords="215,885,377,925"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72" title=" " alt="" coords="245,949,347,975"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732" title=" " alt="" coords="223,999,369,1039"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#aeaad076823e67dfa54115c5db2f29d96" title=" " alt="" coords="203,1063,389,1103"/>
<area shape="rect" target="_parent" href="../qle/namespace_quant_ext.html#a250ccc1dd6b0731854784fddafb97284" title=" " alt="" coords="277,1128,315,1153"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_curve_spec.html#afa7a10b4b56522f03c698ac514b0f844" title=" " alt="" coords="225,1178,367,1218"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga0f72d6fcccae10a674bdcd5095200f14" title=" " alt="" coords="214,1243,378,1268"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#abd022b98516a69b335865f8c17a645cf" title=" " alt="" coords="207,1293,385,1333"/>
<area shape="rect" target="_parent" href="../ored/group__curves.html#ga7c53f293f4ad98e691c6a93b6be26e9a" title=" " alt="" coords="209,1357,383,1383"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga2d18ab5807f92319c9db2c13f4904738" title=" " alt="" coords="213,1407,379,1432"/>
<area shape="rect" target="_parent" href="../ored/group__utilities.html#ga03699115fbdbcf46b6351c3735fdec87" title=" " alt="" coords="205,1457,387,1497"/>
<area shape="rect" target="_parent" href="../qle/class_quant_ext_1_1_black_variance_surface_std_devs.html#ae16f88d114d997f6ab73eed253ee0a10" title=" " alt="" coords="189,1521,403,1561"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#a0dd15d7307d3eabe0b1d9012e64cd3aa" title=" " alt="" coords="220,1585,372,1625"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#a777e216dee6069b548bb87da7152699e" title=" " alt="" coords="243,1649,349,1675"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949" title=" " alt="" coords="223,1699,369,1739"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#a1177363d3c16f7c943b873d8ebd14f4d" title=" " alt="" coords="223,1763,369,1803"/>
<area shape="rect" target="_parent" href="../ored/namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455" title=" " alt="" coords="231,1828,361,1853"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html#ad955f8a6580ab44cc9ff95f86d456a03" title=" " alt="" coords="191,1878,401,1918"/>
<area shape="rect" target="_parent" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a5c92a8fb4d7a5de84d60cb01ca39a864" title=" " alt="" coords="201,1942,391,1982"/>
<area shape="rect" target="_parent" href="../qle/class_quant_ext_1_1_make_o_i_s_cap_floor.html#a6842ee3fbbf88963ed4d02e7ddb70c22" title=" " alt="" coords="201,2006,391,2046"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#ade1b633ccf740828de4e98b038f3ba39" title=" " alt="" coords="223,2070,369,2110"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#a2043641bdf8622ce37e5fa96d83cd8e9" title=" " alt="" coords="223,2134,369,2174"/>
<area shape="rect" href="namespaceore_1_1analytics.html#af064e92bf12d8a7409563dfe1eff6760" title=" " alt="" coords="483,99,649,139"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a15146782240bf68d7923722c5371feb9" title=" " alt="" coords="451,878,681,918"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a75a2c24a3dc2abcc22320092c9ffa2e8" title=" " alt="" coords="451,942,681,982"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a451da96d7cc713be6c76c5b288cce4ca" title=" " alt="" coords="451,1006,681,1046"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a2881469fc28e18615c2c6d731c9f031e" name="a2881469fc28e18615c2c6d731c9f031e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2881469fc28e18615c2c6d731c9f031e">&#9670;&#160;</a></span>scenarioGenerator() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a> &gt; &amp; scenarioGenerator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set scenario generator. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00097">97</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4f6ff7197821c6208621e218ac60c361">scenarioGenerator_</a>; }</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a4f6ff7197821c6208621e218ac60c361"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a4f6ff7197821c6208621e218ac60c361">ore::analytics::ScenarioSimMarket::scenarioGenerator_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; ScenarioGenerator &gt; scenarioGenerator_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00167">scenariosimmarket.hpp:167</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5365731cf5a2d101a1339733217207a1" name="a5365731cf5a2d101a1339733217207a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5365731cf5a2d101a1339733217207a1">&#9670;&#160;</a></span>scenarioGenerator() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a> &gt; &amp; scenarioGenerator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get scenario generator. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00099">99</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4f6ff7197821c6208621e218ac60c361">scenarioGenerator_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a94902666c868cdbafb65b73fb7f5f2a2" name="a94902666c868cdbafb65b73fb7f5f2a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94902666c868cdbafb65b73fb7f5f2a2">&#9670;&#160;</a></span>aggregationScenarioData() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_aggregation_scenario_data.html">AggregationScenarioData</a> &gt; &amp; aggregationScenarioData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set aggregation data. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00102">102</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  102</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>; }</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_afc0c946cb6a258c3c295f74a5b10cdcc"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">ore::analytics::ScenarioSimMarket::asd_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; AggregationScenarioData &gt; asd_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00168">scenariosimmarket.hpp:168</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6aa3387494a7b492f6444097c7e06a6" name="ae6aa3387494a7b492f6444097c7e06a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6aa3387494a7b492f6444097c7e06a6">&#9670;&#160;</a></span>aggregationScenarioData() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_aggregation_scenario_data.html">AggregationScenarioData</a> &gt; &amp; aggregationScenarioData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get aggregation data. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00104">104</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  104</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ada0e6808fa5835b649902b19335373fc" name="ada0e6808fa5835b649902b19335373fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada0e6808fa5835b649902b19335373fc">&#9670;&#160;</a></span>filter() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_filter.html">ScenarioFilter</a> &gt; &amp; filter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set scenarioFilter. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00107">107</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  107</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dc3bfa6a7a06b02fc44c29a9def32b2" name="a3dc3bfa6a7a06b02fc44c29a9def32b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc3bfa6a7a06b02fc44c29a9def32b2">&#9670;&#160;</a></span>filter() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario_filter.html">ScenarioFilter</a> &gt; &amp; filter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get scenarioFilter. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00109">109</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a920e8326cba13f15e736d1fccfb021e1" name="a920e8326cba13f15e736d1fccfb021e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a920e8326cba13f15e736d1fccfb021e1">&#9670;&#160;</a></span>preUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void preUpdate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#a0a873046bac3378591c2fb4a82be5e62">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03095">3095</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3095</span>                                  {</div>
<div class="line"><span class="lineno"> 3096</span>    <a class="code hl_enumeration" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ObservationMode::Mode</a> om = ObservationMode::instance().mode();</div>
<div class="line"><span class="lineno"> 3097</span>    <span class="keywordflow">if</span> (om == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911abcfaccebf745acfd5e75351095a5394a">ObservationMode::Mode::Disable</a>)</div>
<div class="line"><span class="lineno"> 3098</span>        ObservableSettings::instance().disableUpdates(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3099</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (om == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911aa6c82656255dd03988eee0df651c1405">ObservationMode::Mode::Defer</a>)</div>
<div class="line"><span class="lineno"> 3100</span>        ObservableSettings::instance().disableUpdates(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3101</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_observation_mode_html_a46c8a310cf4c094f8c80e1cb8dc1f911"><div class="ttname"><a href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ore::analytics::ObservationMode::Mode</a></div><div class="ttdeci">Mode</div><div class="ttdoc">Allowable mode mode.</div><div class="ttdef"><b>Definition:</b> <a href="observationmode_8hpp_source.html#l00044">observationmode.hpp:44</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_observation_mode_html_a46c8a310cf4c094f8c80e1cb8dc1f911aa6c82656255dd03988eee0df651c1405"><div class="ttname"><a href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911aa6c82656255dd03988eee0df651c1405">ore::analytics::ObservationMode::Mode::Defer</a></div><div class="ttdeci">@ Defer</div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_observation_mode_html_a46c8a310cf4c094f8c80e1cb8dc1f911abcfaccebf745acfd5e75351095a5394a"><div class="ttname"><a href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911abcfaccebf745acfd5e75351095a5394a">ore::analytics::ObservationMode::Mode::Disable</a></div><div class="ttdeci">@ Disable</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a561629c4d0ec128f4db39420deb0a31e" name="a561629c4d0ec128f4db39420deb0a31e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a561629c4d0ec128f4db39420deb0a31e">&#9670;&#160;</a></span>updateScenario()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void updateScenario </td>
          <td>(</td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve next market scenario and apply this, but don't update date. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#a9cfdf3ebf837d13431c04ece1599ca67">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03119">3119</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3119</span>                                                    {</div>
<div class="line"><span class="lineno"> 3120</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4f6ff7197821c6208621e218ac60c361">scenarioGenerator_</a> != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScenarioSimMarket::update: no scenario generator set&quot;</span>);</div>
<div class="line"><span class="lineno"> 3121</span>    <span class="keyword">auto</span> scenario = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4f6ff7197821c6208621e218ac60c361">scenarioGenerator_</a>-&gt;next(d);</div>
<div class="line"><span class="lineno"> 3122</span>    QL_REQUIRE(scenario-&gt;asof() == d,</div>
<div class="line"><span class="lineno"> 3123</span>               <span class="stringliteral">&quot;Invalid Scenario date &quot;</span> &lt;&lt; scenario-&gt;asof() &lt;&lt; <span class="stringliteral">&quot;, expected &quot;</span> &lt;&lt; d);</div>
<div class="line"><span class="lineno"> 3124</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_sim_market.html#a48499ce399f638bd4b30e412c014461d">numeraire_</a> = scenario-&gt;getNumeraire();</div>
<div class="line"><span class="lineno"> 3125</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_sim_market.html#a29c7a0e45859f37b148337debf0399c7">label_</a> = scenario-&gt;label();</div>
<div class="line"><span class="lineno"> 3126</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a3d1470789fa6352a7a6d0127a15bf43a">applyScenario</a>(scenario);</div>
<div class="line"><span class="lineno"> 3127</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a3d1470789fa6352a7a6d0127a15bf43a"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a3d1470789fa6352a7a6d0127a15bf43a">ore::analytics::ScenarioSimMarket::applyScenario</a></div><div class="ttdeci">void applyScenario(const QuantLib::ext::shared_ptr&lt; Scenario &gt; &amp;scenario)</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l02978">scenariosimmarket.cpp:2978</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sim_market_html_a29c7a0e45859f37b148337debf0399c7"><div class="ttname"><a href="classore_1_1analytics_1_1_sim_market.html#a29c7a0e45859f37b148337debf0399c7">ore::analytics::SimMarket::label_</a></div><div class="ttdeci">std::string label_</div><div class="ttdef"><b>Definition:</b> <a href="simmarket_8hpp_source.html#l00086">simmarket.hpp:86</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_sim_market_html_a48499ce399f638bd4b30e412c014461d"><div class="ttname"><a href="classore_1_1analytics_1_1_sim_market.html#a48499ce399f638bd4b30e412c014461d">ore::analytics::SimMarket::numeraire_</a></div><div class="ttdeci">Real numeraire_</div><div class="ttdef"><b>Definition:</b> <a href="simmarket_8hpp_source.html#l00085">simmarket.hpp:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2626e9e88cd833a3ae5d59ad644a3ec" name="ac2626e9e88cd833a3ae5d59ad644a3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2626e9e88cd833a3ae5d59ad644a3ec">&#9670;&#160;</a></span>updateDate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void updateDate </td>
          <td>(</td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update to the given date. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#a84849c9baa872216c2ce4a7fa2d7bd9b">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03103">3103</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3103</span>                                                {</div>
<div class="line"><span class="lineno"> 3104</span>    <a class="code hl_enumeration" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ObservationMode::Mode</a> om = ObservationMode::instance().mode();</div>
<div class="line"><span class="lineno"> 3105</span>    <span class="keywordflow">if</span> (d != Settings::instance().evaluationDate())</div>
<div class="line"><span class="lineno"> 3106</span>        Settings::instance().evaluationDate() = d;</div>
<div class="line"><span class="lineno"> 3107</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (om == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911a9d4a8f2dfe3c62f3ce3011035d28fb66">ObservationMode::Mode::Unregister</a>) {</div>
<div class="line"><span class="lineno"> 3108</span>        <span class="comment">// Due to some of the notification chains having been unregistered,</span></div>
<div class="line"><span class="lineno"> 3109</span>        <span class="comment">// it is possible that some lazy objects might be missed in the case</span></div>
<div class="line"><span class="lineno"> 3110</span>        <span class="comment">// that the evaluation date has not been updated. Therefore, we</span></div>
<div class="line"><span class="lineno"> 3111</span>        <span class="comment">// manually kick off an observer notification from this level.</span></div>
<div class="line"><span class="lineno"> 3112</span>        <span class="comment">// We have unit regression tests in OREAnalyticsTestSuite to ensure</span></div>
<div class="line"><span class="lineno"> 3113</span>        <span class="comment">// the various ObservationMode settings return the anticipated results.</span></div>
<div class="line"><span class="lineno"> 3114</span>        QuantLib::ext::shared_ptr&lt;QuantLib::Observable&gt; obs = QuantLib::Settings::instance().evaluationDate();</div>
<div class="line"><span class="lineno"> 3115</span>        obs-&gt;notifyObservers();</div>
<div class="line"><span class="lineno"> 3116</span>    }</div>
<div class="line"><span class="lineno"> 3117</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_observation_mode_html_a46c8a310cf4c094f8c80e1cb8dc1f911a9d4a8f2dfe3c62f3ce3011035d28fb66"><div class="ttname"><a href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911a9d4a8f2dfe3c62f3ce3011035d28fb66">ore::analytics::ObservationMode::Mode::Unregister</a></div><div class="ttdeci">@ Unregister</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66e8c7b1c859c027ace5465e80d0cb24" name="a66e8c7b1c859c027ace5465e80d0cb24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66e8c7b1c859c027ace5465e80d0cb24">&#9670;&#160;</a></span>postUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void postUpdate </td>
          <td>(</td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>withFixings</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="elRef" href="../qle/class_observable.html">Observable</a> reset depending on selected mode, instrument updates. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#ad81bb9be8e09438c20c91a32a8423159">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03129">3129</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3129</span>                                                                  {</div>
<div class="line"><span class="lineno"> 3130</span>    <a class="code hl_enumeration" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911">ObservationMode::Mode</a> om = ObservationMode::instance().mode();</div>
<div class="line"><span class="lineno"> 3131</span> </div>
<div class="line"><span class="lineno"> 3132</span>    <span class="comment">// Observation Mode - key to update these before fixings are set</span></div>
<div class="line"><span class="lineno"> 3133</span>    <span class="keywordflow">if</span> (om == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911abcfaccebf745acfd5e75351095a5394a">ObservationMode::Mode::Disable</a>) {</div>
<div class="line"><span class="lineno"> 3134</span>        <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ab61dc3722ab70d2406698eb3191acc61">refresh</a>();</div>
<div class="line"><span class="lineno"> 3135</span>        ObservableSettings::instance().enableUpdates();</div>
<div class="line"><span class="lineno"> 3136</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (om == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911aa6c82656255dd03988eee0df651c1405">ObservationMode::Mode::Defer</a>) {</div>
<div class="line"><span class="lineno"> 3137</span>        ObservableSettings::instance().enableUpdates();</div>
<div class="line"><span class="lineno"> 3138</span>    }</div>
<div class="line"><span class="lineno"> 3139</span> </div>
<div class="line"><span class="lineno"> 3140</span>    <span class="comment">// Apply fixings as historical fixings. Must do this before we populate ASD</span></div>
<div class="line"><span class="lineno"> 3141</span>    <span class="keywordflow">if</span> (withFixings)</div>
<div class="line"><span class="lineno"> 3142</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a327eb9d6ae1ae728199147f68ba0909c">fixingManager_</a>-&gt;update(d);</div>
<div class="line"><span class="lineno"> 3143</span>}</div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_ab61dc3722ab70d2406698eb3191acc61"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#ab61dc3722ab70d2406698eb3191acc61">ore::data::MarketImpl::refresh</a></div><div class="ttdeci">void refresh(const string &amp;configuration=Market::defaultConfiguration) override</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af551fe030025884eddc38791c15952f4" name="af551fe030025884eddc38791c15952f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af551fe030025884eddc38791c15952f4">&#9670;&#160;</a></span>updateAsd()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void updateAsd </td>
          <td>(</td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update aggregation scenario data. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#a1fb4885d160348e4b6d3f88dc97d5d7c">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03145">3145</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3145</span>                                               {</div>
<div class="line"><span class="lineno"> 3146</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>) {</div>
<div class="line"><span class="lineno"> 3147</span>        <span class="comment">// add additional scenario data to the given container, if required</span></div>
<div class="line"><span class="lineno"> 3148</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;additionalScenarioDataIndices()) {</div>
<div class="line"><span class="lineno"> 3149</span>            QuantLib::ext::shared_ptr&lt;QuantLib::Index&gt; index;</div>
<div class="line"><span class="lineno"> 3150</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 3151</span>                index = *<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>(i);</div>
<div class="line"><span class="lineno"> 3152</span>            } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 3153</span>            }</div>
<div class="line"><span class="lineno"> 3154</span>            <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 3155</span>                index = *<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ac59684278372260fbf998460e3ddf949">swapIndex</a>(i);</div>
<div class="line"><span class="lineno"> 3156</span>            } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><span class="lineno"> 3157</span>            }</div>
<div class="line"><span class="lineno"> 3158</span>            QL_REQUIRE(index != <span class="keyword">nullptr</span>, <span class="stringliteral">&quot;ScenarioSimMarket::update() index &quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; not found in sim market&quot;</span>);</div>
<div class="line"><span class="lineno"> 3159</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> fb = QuantLib::ext::dynamic_pointer_cast&lt;FallbackIborIndex&gt;(index)) {</div>
<div class="line"><span class="lineno"> 3160</span>                <span class="comment">// proxy fallback ibor index by its rfr index&#39;s fixing</span></div>
<div class="line"><span class="lineno"> 3161</span>                index = fb-&gt;rfrIndex();</div>
<div class="line"><span class="lineno"> 3162</span>            }</div>
<div class="line"><span class="lineno"> 3163</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;set(index-&gt;fixing(index-&gt;fixingCalendar().adjust(d)), <a class="code hl_enumvalue" href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a095017fd1eb861c360ef720c79522ffb">AggregationScenarioDataType::IndexFixing</a>, i);</div>
<div class="line"><span class="lineno"> 3164</span>        }</div>
<div class="line"><span class="lineno"> 3165</span> </div>
<div class="line"><span class="lineno"> 3166</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;additionalScenarioDataCcys()) {</div>
<div class="line"><span class="lineno"> 3167</span>            <span class="keywordflow">if</span> (c != <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;baseCcy())</div>
<div class="line"><span class="lineno"> 3168</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;set(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#a0b6a2501015e2227c3f1a4f621c21ab4">fxSpot</a>(c + <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;baseCcy())-&gt;value(), <a class="code hl_enumvalue" href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a1865917ae0607c5cd6bda79dd0ca7fa3">AggregationScenarioDataType::FXSpot</a>, c);</div>
<div class="line"><span class="lineno"> 3169</span>        }</div>
<div class="line"><span class="lineno"> 3170</span> </div>
<div class="line"><span class="lineno"> 3171</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;additionalScenarioDataNumberOfCreditStates(); ++i) {</div>
<div class="line"><span class="lineno"> 3172</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca407bdb81313c0f751a06f6a6562bd3bc">RiskFactorKey::KeyType::CreditState</a>, std::to_string(i));</div>
<div class="line"><span class="lineno"> 3173</span>            QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a>-&gt;has(key), <span class="stringliteral">&quot;scenario does not have key &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno"> 3174</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;set(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a>-&gt;get(key), <a class="code hl_enumvalue" href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a407bdb81313c0f751a06f6a6562bd3bc">AggregationScenarioDataType::CreditState</a>, std::to_string(i));</div>
<div class="line"><span class="lineno"> 3175</span>        }</div>
<div class="line"><span class="lineno"> 3176</span> </div>
<div class="line"><span class="lineno"> 3177</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; n : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;additionalScenarioDataSurvivalWeights()) {</div>
<div class="line"><span class="lineno"> 3178</span>            RiskFactorKey key(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238ca55a1d75e1be44713e466c14ebaa876dd">RiskFactorKey::KeyType::SurvivalWeight</a>, n);</div>
<div class="line"><span class="lineno"> 3179</span>            QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a>-&gt;has(key), <span class="stringliteral">&quot;scenario does not have key &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno"> 3180</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;set(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a>-&gt;get(key), <a class="code hl_enumvalue" href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a55a1d75e1be44713e466c14ebaa876dd">AggregationScenarioDataType::SurvivalWeight</a>, n);</div>
<div class="line"><span class="lineno"> 3181</span>            RiskFactorKey rrKey(<a class="code hl_enumvalue" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238cab23cb6da65c5e4e9d93bf085112c0d49">RiskFactorKey::KeyType::RecoveryRate</a>, n);</div>
<div class="line"><span class="lineno"> 3182</span>            QL_REQUIRE(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a>-&gt;has(rrKey), <span class="stringliteral">&quot;scenario does not have key &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno"> 3183</span>            <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;set(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a>-&gt;get(rrKey), <a class="code hl_enumvalue" href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8ab23cb6da65c5e4e9d93bf085112c0d49">AggregationScenarioDataType::RecoveryRate</a>, n);</div>
<div class="line"><span class="lineno"> 3184</span>        }</div>
<div class="line"><span class="lineno"> 3185</span> </div>
<div class="line"><span class="lineno"> 3186</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;set(<a class="code hl_variable" href="classore_1_1analytics_1_1_sim_market.html#a48499ce399f638bd4b30e412c014461d">numeraire_</a>, <a class="code hl_enumvalue" href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a1ea18b5d9353d5a4aec9e4389adc8f4d">AggregationScenarioDataType::Numeraire</a>);</div>
<div class="line"><span class="lineno"> 3187</span> </div>
<div class="line"><span class="lineno"> 3188</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#afc0c946cb6a258c3c295f74a5b10cdcc">asd_</a>-&gt;next();</div>
<div class="line"><span class="lineno"> 3189</span>    }</div>
<div class="line"><span class="lineno"> 3190</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a41a3cb015d4569715fcf400ab2de2ddd"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">ore::analytics::ScenarioSimMarket::currentScenario_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; Scenario &gt; currentScenario_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00197">scenariosimmarket.hpp:197</a></div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a67a4daffa92198fec5c6701605bbcff8a095017fd1eb861c360ef720c79522ffb"><div class="ttname"><a href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a095017fd1eb861c360ef720c79522ffb">ore::analytics::AggregationScenarioDataType::IndexFixing</a></div><div class="ttdeci">@ IndexFixing</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a67a4daffa92198fec5c6701605bbcff8a1865917ae0607c5cd6bda79dd0ca7fa3"><div class="ttname"><a href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a1865917ae0607c5cd6bda79dd0ca7fa3">ore::analytics::AggregationScenarioDataType::FXSpot</a></div><div class="ttdeci">@ FXSpot</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a67a4daffa92198fec5c6701605bbcff8a1ea18b5d9353d5a4aec9e4389adc8f4d"><div class="ttname"><a href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a1ea18b5d9353d5a4aec9e4389adc8f4d">ore::analytics::AggregationScenarioDataType::Numeraire</a></div><div class="ttdeci">@ Numeraire</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a67a4daffa92198fec5c6701605bbcff8a407bdb81313c0f751a06f6a6562bd3bc"><div class="ttname"><a href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a407bdb81313c0f751a06f6a6562bd3bc">ore::analytics::AggregationScenarioDataType::CreditState</a></div><div class="ttdeci">@ CreditState</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a67a4daffa92198fec5c6701605bbcff8a55a1d75e1be44713e466c14ebaa876dd"><div class="ttname"><a href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8a55a1d75e1be44713e466c14ebaa876dd">ore::analytics::AggregationScenarioDataType::SurvivalWeight</a></div><div class="ttdeci">@ SurvivalWeight</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_a67a4daffa92198fec5c6701605bbcff8ab23cb6da65c5e4e9d93bf085112c0d49"><div class="ttname"><a href="namespaceore_1_1analytics.html#a67a4daffa92198fec5c6701605bbcff8ab23cb6da65c5e4e9d93bf085112c0d49">ore::analytics::AggregationScenarioDataType::RecoveryRate</a></div><div class="ttdeci">@ RecoveryRate</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebfcdbbd0fe4efbff10b180be50ca6bc" name="aebfcdbbd0fe4efbff10b180be50ca6bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebfcdbbd0fe4efbff10b180be50ca6bc">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void reset </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset sim market to initial state. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#a20dcbdfbd0ec77afc802522bb7e379c1">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l02951">2951</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2951</span>                              {</div>
<div class="line"><span class="lineno"> 2952</span>    <span class="keyword">auto</span> filterBackup = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>;</div>
<div class="line"><span class="lineno"> 2953</span>    <span class="comment">// no filter</span></div>
<div class="line"><span class="lineno"> 2954</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a> = QuantLib::ext::make_shared&lt;ScenarioFilter&gt;();</div>
<div class="line"><span class="lineno"> 2955</span>    <span class="comment">// reset eval date</span></div>
<div class="line"><span class="lineno"> 2956</span>    Settings::instance().evaluationDate() = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a>-&gt;asof();</div>
<div class="line"><span class="lineno"> 2957</span>    <span class="comment">// reset numeraire and label</span></div>
<div class="line"><span class="lineno"> 2958</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_sim_market.html#a48499ce399f638bd4b30e412c014461d">numeraire_</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a>-&gt;getNumeraire();</div>
<div class="line"><span class="lineno"> 2959</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_sim_market.html#a29c7a0e45859f37b148337debf0399c7">label_</a> = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a>-&gt;label();</div>
<div class="line"><span class="lineno"> 2960</span>    <span class="comment">// delete the sim data cache</span></div>
<div class="line"><span class="lineno"> 2961</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a>.clear();</div>
<div class="line"><span class="lineno"> 2962</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#aff642c824541d0d41f36ce46b7756809">cachedSimDataActive_</a>.clear();</div>
<div class="line"><span class="lineno"> 2963</span>    <span class="comment">// reset term structures</span></div>
<div class="line"><span class="lineno"> 2964</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a3d1470789fa6352a7a6d0127a15bf43a">applyScenario</a>(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a>);</div>
<div class="line"><span class="lineno"> 2965</span>    <span class="comment">// clear delta scenario keys</span></div>
<div class="line"><span class="lineno"> 2966</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a55687aaad8fa83a41d2c8a83846fbfbb">diffToBaseKeys_</a>.clear();</div>
<div class="line"><span class="lineno"> 2967</span>    <span class="comment">// see the comment in update() for why this is necessary...</span></div>
<div class="line"><span class="lineno"> 2968</span>    <span class="keywordflow">if</span> (ObservationMode::instance().mode() == <a class="code hl_enumvalue" href="classore_1_1analytics_1_1_observation_mode.html#a46c8a310cf4c094f8c80e1cb8dc1f911a9d4a8f2dfe3c62f3ce3011035d28fb66">ObservationMode::Mode::Unregister</a>) {</div>
<div class="line"><span class="lineno"> 2969</span>        QuantLib::ext::shared_ptr&lt;QuantLib::Observable&gt; obs = QuantLib::Settings::instance().evaluationDate();</div>
<div class="line"><span class="lineno"> 2970</span>        obs-&gt;notifyObservers();</div>
<div class="line"><span class="lineno"> 2971</span>    }</div>
<div class="line"><span class="lineno"> 2972</span>    <span class="comment">// reset fixing manager</span></div>
<div class="line"><span class="lineno"> 2973</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a327eb9d6ae1ae728199147f68ba0909c">fixingManager_</a>-&gt;reset();</div>
<div class="line"><span class="lineno"> 2974</span>    <span class="comment">// restore the filter</span></div>
<div class="line"><span class="lineno"> 2975</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a> = filterBackup;</div>
<div class="line"><span class="lineno"> 2976</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a4e0a3d6ee8e66a9f56640aefd9636502"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">ore::analytics::ScenarioSimMarket::cachedSimData_</a></div><div class="ttdeci">std::vector&lt; QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt; cachedSimData_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00176">scenariosimmarket.hpp:176</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a55687aaad8fa83a41d2c8a83846fbfbb"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a55687aaad8fa83a41d2c8a83846fbfbb">ore::analytics::ScenarioSimMarket::diffToBaseKeys_</a></div><div class="ttdeci">std::set&lt; ore::analytics::RiskFactorKey &gt; diffToBaseKeys_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00195">scenariosimmarket.hpp:195</a></div></div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_aff642c824541d0d41f36ce46b7756809"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#aff642c824541d0d41f36ce46b7756809">ore::analytics::ScenarioSimMarket::cachedSimDataActive_</a></div><div class="ttdeci">std::vector&lt; bool &gt; cachedSimDataActive_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00177">scenariosimmarket.hpp:177</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7b6372bd81c034a0552434322b39b6f5" name="a7b6372bd81c034a0552434322b39b6f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b6372bd81c034a0552434322b39b6f5">&#9670;&#160;</a></span>baseScenario()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; baseScenario </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p ><a class="el" href="classore_1_1analytics_1_1_scenario.html" title="Scenario Base Class.">Scenario</a> representing the initial state of the market. If useSpreadedTermStructures = false, this scenario contains absolute values for all risk factor keys. If useSpreadedTermStructures = true, this scenario contains spread values for all risk factor keys which support spreaded term structures and absolute values for the other risk factor keys. The spread values will typically be zero (e.g. for vol risk factors) or 1 (e.g. for rate curve risk factors, since we use discount factors there). </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00127">127</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  127</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e47535378dbfb78f160010cd90580a5" name="a8e47535378dbfb78f160010cd90580a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e47535378dbfb78f160010cd90580a5">&#9670;&#160;</a></span>baseScenarioAbsolute()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; baseScenarioAbsolute </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p ><a class="el" href="classore_1_1analytics_1_1_scenario.html" title="Scenario Base Class.">Scenario</a> representing the initial state of the market. This scenario contains absolute values for all risk factor types, no matter whether useSpreadedTermStructures is true or false. </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00131">131</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a65d3596672b1e758c866798baa9bee78">baseScenarioAbsolute_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae015beb42bffe5d7d3aea905a45bd673" name="ae015beb42bffe5d7d3aea905a45bd673"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae015beb42bffe5d7d3aea905a45bd673">&#9670;&#160;</a></span>useSpreadedTermStructures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> useSpreadedTermStructures </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Return true if this instance uses spreaded term structures </p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00134">134</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  134</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a53cfefe400aac2623306853c887ef20a">useSpreadedTermStructures_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab44a4a6e17e2c28d464cf9ed93fd53a6" name="ab44a4a6e17e2c28d464cf9ed93fd53a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab44a4a6e17e2c28d464cf9ed93fd53a6">&#9670;&#160;</a></span>fixingManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a> &gt; &amp; fixingManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the fixing manager. </p>

<p>Implements <a class="el" href="classore_1_1analytics_1_1_sim_market.html#a28fae5abb2d8e7d0b5d668ddbffa24d5">SimMarket</a>.</p>

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00137">137</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a327eb9d6ae1ae728199147f68ba0909c">fixingManager_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81628b0a72ab4ce23fe200e43afb64b4" name="a81628b0a72ab4ce23fe200e43afb64b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81628b0a72ab4ce23fe200e43afb64b4">&#9670;&#160;</a></span>isSimulated()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> isSimulated </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a> &amp;&#160;</td>
          <td class="paramname"><em>factor</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>is risk factor key simulated by this sim market instance? </p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03192">3192</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3192</span>                                                                            {</div>
<div class="line"><span class="lineno"> 3193</span>    <span class="keywordflow">return</span> std::find(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a0235f0e84cb47d21daf8793e66f0242f">nonSimulatedFactors_</a>.begin(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a0235f0e84cb47d21daf8793e66f0242f">nonSimulatedFactors_</a>.end(), factor) == <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a0235f0e84cb47d21daf8793e66f0242f">nonSimulatedFactors_</a>.end();</div>
<div class="line"><span class="lineno"> 3194</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a0235f0e84cb47d21daf8793e66f0242f"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a0235f0e84cb47d21daf8793e66f0242f">ore::analytics::ScenarioSimMarket::nonSimulatedFactors_</a></div><div class="ttdeci">std::set&lt; RiskFactorKey::KeyType &gt; nonSimulatedFactors_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00180">scenariosimmarket.hpp:180</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d1470789fa6352a7a6d0127a15bf43a" name="a3d1470789fa6352a7a6d0127a15bf43a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d1470789fa6352a7a6d0127a15bf43a">&#9670;&#160;</a></span>applyScenario()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void applyScenario </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>scenario</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l02978">2978</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2978</span>                                                                                     {</div>
<div class="line"><span class="lineno"> 2979</span> </div>
<div class="line"><span class="lineno"> 2980</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a41a3cb015d4569715fcf400ab2de2ddd">currentScenario_</a> = scenario;</div>
<div class="line"><span class="lineno"> 2981</span> </div>
<div class="line"><span class="lineno"> 2982</span>    <span class="comment">// 1 handle delta scenario</span></div>
<div class="line"><span class="lineno"> 2983</span> </div>
<div class="line"><span class="lineno"> 2984</span>    <span class="keyword">auto</span> deltaScenario = QuantLib::ext::dynamic_pointer_cast&lt;DeltaScenario&gt;(scenario);</div>
<div class="line"><span class="lineno"> 2985</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2986</span><span class="comment">    /*! our assumption is that either all or none of the scenarios we apply are </span></div>
<div class="line"><span class="lineno"> 2987</span><span class="comment">        delta scenarios or the base scenario */</span></div>
<div class="line"><span class="lineno"> 2988</span> </div>
<div class="line"><span class="lineno"> 2989</span>    <span class="keywordflow">if</span> (deltaScenario != <span class="keyword">nullptr</span>) {</div>
<div class="line"><span class="lineno"> 2990</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; key : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a55687aaad8fa83a41d2c8a83846fbfbb">diffToBaseKeys_</a>) {</div>
<div class="line"><span class="lineno"> 2991</span>            <span class="keyword">auto</span> it = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.find(key);</div>
<div class="line"><span class="lineno"> 2992</span>            <span class="keywordflow">if</span> (it != <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.end()) {</div>
<div class="line"><span class="lineno"> 2993</span>                it-&gt;second-&gt;setValue(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a5b99f8838062291f6201c9f819cd3da1">baseScenario_</a>-&gt;get(key));</div>
<div class="line"><span class="lineno"> 2994</span>            }</div>
<div class="line"><span class="lineno"> 2995</span>        }</div>
<div class="line"><span class="lineno"> 2996</span>        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a55687aaad8fa83a41d2c8a83846fbfbb">diffToBaseKeys_</a>.clear();</div>
<div class="line"><span class="lineno"> 2997</span>        <span class="keyword">auto</span> delta = deltaScenario-&gt;delta();</div>
<div class="line"><span class="lineno"> 2998</span>        <span class="keywordtype">bool</span> missingPoint = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2999</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; key : delta-&gt;keys()) {</div>
<div class="line"><span class="lineno"> 3000</span>            <span class="keyword">auto</span> it = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.find(key);</div>
<div class="line"><span class="lineno"> 3001</span>            <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.end()) {</div>
<div class="line"><span class="lineno"> 3002</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;simulation data point missing for key &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno"> 3003</span>                missingPoint = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3004</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3005</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>-&gt;allow(key)) {</div>
<div class="line"><span class="lineno"> 3006</span>                    it-&gt;second-&gt;setValue(delta-&gt;get(key));</div>
<div class="line"><span class="lineno"> 3007</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a55687aaad8fa83a41d2c8a83846fbfbb">diffToBaseKeys_</a>.insert(key);</div>
<div class="line"><span class="lineno"> 3008</span>                }</div>
<div class="line"><span class="lineno"> 3009</span>            }</div>
<div class="line"><span class="lineno"> 3010</span>        }</div>
<div class="line"><span class="lineno"> 3011</span>        QL_REQUIRE(!missingPoint, <span class="stringliteral">&quot;simulation data points missing from scenario, exit.&quot;</span>);</div>
<div class="line"><span class="lineno"> 3012</span> </div>
<div class="line"><span class="lineno"> 3013</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3014</span>    }</div>
<div class="line"><span class="lineno"> 3015</span> </div>
<div class="line"><span class="lineno"> 3016</span>    <span class="comment">// 2 apply scenario based on cached indices for simData_ for a SimpleScenario</span></div>
<div class="line"><span class="lineno"> 3017</span>    <span class="comment">//   the scenario&#39;s keysHash() is used to make sure consistent keys are used</span></div>
<div class="line"><span class="lineno"> 3018</span>    <span class="comment">//   if keysHash() is zero, this check is not effective (for backwards compatibility)</span></div>
<div class="line"><span class="lineno"> 3019</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ac8084e71c12327fddaa89613722b4624">cacheSimData_</a>) {</div>
<div class="line"><span class="lineno"> 3020</span>        <span class="keywordflow">if</span> (<span class="keyword">auto</span> s = QuantLib::ext::dynamic_pointer_cast&lt;SimpleScenario&gt;(scenario)) {</div>
<div class="line"><span class="lineno"> 3021</span> </div>
<div class="line"><span class="lineno"> 3022</span>            <span class="comment">// fill cache</span></div>
<div class="line"><span class="lineno"> 3023</span> </div>
<div class="line"><span class="lineno"> 3024</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a>.empty() || s-&gt;keysHash() != <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a634c17ea8a85013693d3b91344d9faf5">cachedSimDataKeysHash_</a>) {</div>
<div class="line"><span class="lineno"> 3025</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a>.clear();</div>
<div class="line"><span class="lineno"> 3026</span>                <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a634c17ea8a85013693d3b91344d9faf5">cachedSimDataKeysHash_</a> = s-&gt;keysHash();</div>
<div class="line"><span class="lineno"> 3027</span>                Size <a class="code hl_variableRef" href="../ored/ored_2marketdata_2todaysmarket_8cpp.html#a36d2d3ec8fc39969adfd76b5ac2cfcb0">count</a> = 0;</div>
<div class="line"><span class="lineno"> 3028</span>                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; key : s-&gt;keys()) {</div>
<div class="line"><span class="lineno"> 3029</span>                    <span class="keyword">auto</span> it = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.find(key);</div>
<div class="line"><span class="lineno"> 3030</span>                    <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.end()) {</div>
<div class="line"><span class="lineno"> 3031</span>                        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;simulation data point missing for key &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno"> 3032</span>                        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a>.push_back(QuantLib::ext::shared_ptr&lt;SimpleQuote&gt;());</div>
<div class="line"><span class="lineno"> 3033</span>                        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#aff642c824541d0d41f36ce46b7756809">cachedSimDataActive_</a>.push_back(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3034</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3035</span>                        ++<a class="code hl_variableRef" href="../ored/ored_2marketdata_2todaysmarket_8cpp.html#a36d2d3ec8fc39969adfd76b5ac2cfcb0">count</a>;</div>
<div class="line"><span class="lineno"> 3036</span>                        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a>.push_back(it-&gt;second);</div>
<div class="line"><span class="lineno"> 3037</span>                        <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#aff642c824541d0d41f36ce46b7756809">cachedSimDataActive_</a>.push_back(<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>-&gt;allow(key));</div>
<div class="line"><span class="lineno"> 3038</span>                    }</div>
<div class="line"><span class="lineno"> 3039</span>                }</div>
<div class="line"><span class="lineno"> 3040</span>                <span class="keywordflow">if</span> (count != <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.size() &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a7a035b0b5a2360c3ee4490089fee6523">allowPartialScenarios_</a>) {</div>
<div class="line"><span class="lineno"> 3041</span>                    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;mismatch between scenario and sim data size, &quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.size());</div>
<div class="line"><span class="lineno"> 3042</span>                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 3043</span>                        <span class="keywordflow">if</span> (!scenario-&gt;has(it.first))</div>
<div class="line"><span class="lineno"> 3044</span>                            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;Key &quot;</span> &lt;&lt; it.first &lt;&lt; <span class="stringliteral">&quot; missing in scenario&quot;</span>);</div>
<div class="line"><span class="lineno"> 3045</span>                    }</div>
<div class="line"><span class="lineno"> 3046</span>                    QL_FAIL(<span class="stringliteral">&quot;mismatch between scenario and sim data size, exit.&quot;</span>);</div>
<div class="line"><span class="lineno"> 3047</span>                }</div>
<div class="line"><span class="lineno"> 3048</span>            }</div>
<div class="line"><span class="lineno"> 3049</span> </div>
<div class="line"><span class="lineno"> 3050</span>            <span class="comment">// apply scenario data according to cached indices</span></div>
<div class="line"><span class="lineno"> 3051</span> </div>
<div class="line"><span class="lineno"> 3052</span>            Size i = 0;</div>
<div class="line"><span class="lineno"> 3053</span>            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; q : s-&gt;data()) {</div>
<div class="line"><span class="lineno"> 3054</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#aff642c824541d0d41f36ce46b7756809">cachedSimDataActive_</a>[i])</div>
<div class="line"><span class="lineno"> 3055</span>                    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a4e0a3d6ee8e66a9f56640aefd9636502">cachedSimData_</a>[i]-&gt;setValue(q);</div>
<div class="line"><span class="lineno"> 3056</span>                ++i;</div>
<div class="line"><span class="lineno"> 3057</span>            }</div>
<div class="line"><span class="lineno"> 3058</span> </div>
<div class="line"><span class="lineno"> 3059</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3060</span>        }</div>
<div class="line"><span class="lineno"> 3061</span>    }</div>
<div class="line"><span class="lineno"> 3062</span> </div>
<div class="line"><span class="lineno"> 3063</span>    <span class="comment">// 3 all other cases</span></div>
<div class="line"><span class="lineno"> 3064</span> </div>
<div class="line"><span class="lineno"> 3065</span>    <span class="keyword">const</span> vector&lt;RiskFactorKey&gt;&amp; keys = scenario-&gt;keys();</div>
<div class="line"><span class="lineno"> 3066</span> </div>
<div class="line"><span class="lineno"> 3067</span>    Size <a class="code hl_variableRef" href="../ored/ored_2marketdata_2todaysmarket_8cpp.html#a36d2d3ec8fc39969adfd76b5ac2cfcb0">count</a> = 0;</div>
<div class="line"><span class="lineno"> 3068</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; key : keys) {</div>
<div class="line"><span class="lineno"> 3069</span>        <span class="comment">// Loop through the scenario keys and check which keys are present in simData_,</span></div>
<div class="line"><span class="lineno"> 3070</span>        <span class="comment">// adding to the count when a match is identified</span></div>
<div class="line"><span class="lineno"> 3071</span>        <span class="comment">// Then check that the count=simData_.size - this ensures that simData_ is a valid</span></div>
<div class="line"><span class="lineno"> 3072</span>        <span class="comment">// subset of the scenario - fails is a member of simData is not present in the</span></div>
<div class="line"><span class="lineno"> 3073</span>        <span class="comment">// scenario</span></div>
<div class="line"><span class="lineno"> 3074</span>        <span class="keyword">auto</span> it = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.find(key);</div>
<div class="line"><span class="lineno"> 3075</span>        <span class="keywordflow">if</span> (it == <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.end()) {</div>
<div class="line"><span class="lineno"> 3076</span>            <a class="code hl_defineRef" href="../ored/log_8hpp.html#a9622ca943201e814041f051b7a10b3ea">WLOG</a>(<span class="stringliteral">&quot;simulation data point missing for key &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno"> 3077</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3078</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a2f193d3de7c1a94311d8c1ea52a889c7">filter_</a>-&gt;allow(key)) {</div>
<div class="line"><span class="lineno"> 3079</span>                it-&gt;second-&gt;setValue(scenario-&gt;get(key));</div>
<div class="line"><span class="lineno"> 3080</span>            }</div>
<div class="line"><span class="lineno"> 3081</span>            <a class="code hl_variableRef" href="../ored/ored_2marketdata_2todaysmarket_8cpp.html#a36d2d3ec8fc39969adfd76b5ac2cfcb0">count</a>++;</div>
<div class="line"><span class="lineno"> 3082</span>        }</div>
<div class="line"><span class="lineno"> 3083</span>    }</div>
<div class="line"><span class="lineno"> 3084</span> </div>
<div class="line"><span class="lineno"> 3085</span>    <span class="keywordflow">if</span> (count != <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.size() &amp;&amp; !<a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a7a035b0b5a2360c3ee4490089fee6523">allowPartialScenarios_</a>) {</div>
<div class="line"><span class="lineno"> 3086</span>        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;mismatch between scenario and sim data size, &quot;</span> &lt;&lt; count &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.size());</div>
<div class="line"><span class="lineno"> 3087</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>) {</div>
<div class="line"><span class="lineno"> 3088</span>            <span class="keywordflow">if</span> (!scenario-&gt;has(it.first))</div>
<div class="line"><span class="lineno"> 3089</span>                <a class="code hl_defineRef" href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a>(<span class="stringliteral">&quot;Key &quot;</span> &lt;&lt; it.first &lt;&lt; <span class="stringliteral">&quot; missing in scenario&quot;</span>);</div>
<div class="line"><span class="lineno"> 3090</span>        }</div>
<div class="line"><span class="lineno"> 3091</span>        QL_FAIL(<span class="stringliteral">&quot;mismatch between scenario and sim data size, exit.&quot;</span>);</div>
<div class="line"><span class="lineno"> 3092</span>    }</div>
<div class="line"><span class="lineno"> 3093</span>}</div>
<div class="ttc" id="aclassore_1_1analytics_1_1_scenario_sim_market_html_a634c17ea8a85013693d3b91344d9faf5"><div class="ttname"><a href="classore_1_1analytics_1_1_scenario_sim_market.html#a634c17ea8a85013693d3b91344d9faf5">ore::analytics::ScenarioSimMarket::cachedSimDataKeysHash_</a></div><div class="ttdeci">std::size_t cachedSimDataKeysHash_</div><div class="ttdef"><b>Definition:</b> <a href="scenariosimmarket_8hpp_source.html#l00178">scenariosimmarket.hpp:178</a></div></div>
<div class="ttc" id="alog_8hpp_html_a35cb05f674d9e764ca12cff351b064f2"><div class="ttname"><a href="../ored/log_8hpp.html#a35cb05f674d9e764ca12cff351b064f2">ALOG</a></div><div class="ttdeci">#define ALOG(text)</div></div>
<div class="ttc" id="aored_2marketdata_2todaysmarket_8cpp_html_a36d2d3ec8fc39969adfd76b5ac2cfcb0"><div class="ttname"><a href="../ored/ored_2marketdata_2todaysmarket_8cpp.html#a36d2d3ec8fc39969adfd76b5ac2cfcb0">count</a></div><div class="ttdeci">std::size_t count</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afd151e890d7a129bea4022a7a0d4dce3" name="afd151e890d7a129bea4022a7a0d4dce3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd151e890d7a129bea4022a7a0d4dce3">&#9670;&#160;</a></span>writeSimData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void writeSimData </td>
          <td>(</td>
          <td class="paramtype">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::ext::shared_ptr&lt; SimpleQuote &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>simDataTmp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::map&lt; <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>absoluteSimDataTmp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a>&#160;</td>
          <td class="paramname"><em>keyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; Real &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>coordinates</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00238">238</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  241</span>                                                                                    {</div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a076bfc216eaef4fe4e0667a433e1ad76">simData_</a>.insert(simDataTmp.begin(), simDataTmp.end());</div>
<div class="line"><span class="lineno">  243</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ad66079855d4dadc55e8f684e17bfce63">absoluteSimData_</a>.insert(absoluteSimDataTmp.begin(), absoluteSimDataTmp.end());</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#ab5b2289c143003c7964bfeb7e570c504">coordinatesData_</a>.insert(std::make_tuple(keyType, name, coordinates));</div>
<div class="line"><span class="lineno">  245</span>    simDataTmp.clear();</div>
<div class="line"><span class="lineno">  246</span>    absoluteSimDataTmp.clear();</div>
<div class="line"><span class="lineno">  247</span>}</div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_afd151e890d7a129bea4022a7a0d4dce3_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_afd151e890d7a129bea4022a7a0d4dce3_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_afd151e890d7a129bea4022a7a0d4dce3_icgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_afd151e890d7a129bea4022a7a0d4dce3_icgraph">
<area shape="rect" title=" " alt="" coords="341,5,440,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a9fb38a0edc39d7edcb571010c80ca002" title=" " alt="" coords="5,5,141,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a6cfed719476afdb574d21318aa9a1118" title=" " alt="" coords="189,31,293,56"/>
</map>
</div>

</div>
</div>
<a id="a6cfed719476afdb574d21318aa9a1118" name="a6cfed719476afdb574d21318aa9a1118"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfed719476afdb574d21318aa9a1118">&#9670;&#160;</a></span>addYieldCurve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void addYieldCurve </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">Market</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>initMarket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a>&#160;</td>
          <td class="paramname"><em>rf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; Period &gt; &amp;&#160;</td>
          <td class="paramname"><em>tenors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a> &amp;&#160;</td>
          <td class="paramname"><em>simDataWritten</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>simulate</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>spreaded</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00249">249</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  251</span>                                                                                          {</div>
<div class="line"><span class="lineno">  252</span>    Handle&lt;YieldTermStructure&gt; wrapper = (<a class="code hl_function" href="namespaceore_1_1analytics.html#af064e92bf12d8a7409563dfe1eff6760">riskFactorYieldCurve</a>(rf) == ore::data::YieldCurveType::Discount)</div>
<div class="line"><span class="lineno">  253</span>                                             ? initMarket-&gt;discountCurve(key, configuration)</div>
<div class="line"><span class="lineno">  254</span>                                             : initMarket-&gt;yieldCurve(<a class="code hl_function" href="namespaceore_1_1analytics.html#af064e92bf12d8a7409563dfe1eff6760">riskFactorYieldCurve</a>(rf), key, configuration);</div>
<div class="line"><span class="lineno">  255</span>    QL_REQUIRE(!wrapper.empty(), <span class="stringliteral">&quot;yield curve not provided for &quot;</span> &lt;&lt; key);</div>
<div class="line"><span class="lineno">  256</span>    QL_REQUIRE(tenors.front() &gt; 0 * Days, <span class="stringliteral">&quot;yield curve tenors must not include t=0&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span>    <span class="comment">// include today</span></div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    <span class="comment">// constructing yield curves</span></div>
<div class="line"><span class="lineno">  260</span>    DayCounter dc = wrapper-&gt;dayCounter();</div>
<div class="line"><span class="lineno">  261</span>    vector&lt;Time&gt; yieldCurveTimes(1, 0.0);                   <span class="comment">// include today</span></div>
<div class="line"><span class="lineno">  262</span>    vector&lt;Date&gt; yieldCurveDates(1, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>);</div>
<div class="line"><span class="lineno">  263</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; tenor : tenors) {</div>
<div class="line"><span class="lineno">  264</span>        yieldCurveTimes.push_back(dc.yearFraction(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a>, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + tenor));</div>
<div class="line"><span class="lineno">  265</span>        yieldCurveDates.push_back(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae647dad4005a503dc047518e84fb9a08">asof_</a> + tenor);</div>
<div class="line"><span class="lineno">  266</span>    }</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    vector&lt;Handle&lt;Quote&gt;&gt; quotes;</div>
<div class="line"><span class="lineno">  269</span>    QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(<span class="keyword">new</span> SimpleQuote(1.0));</div>
<div class="line"><span class="lineno">  270</span>    quotes.push_back(Handle&lt;Quote&gt;(q));</div>
<div class="line"><span class="lineno">  271</span>    vector&lt;Real&gt; discounts(yieldCurveTimes.size());</div>
<div class="line"><span class="lineno">  272</span>    std::map&lt;RiskFactorKey, QuantLib::ext::shared_ptr&lt;SimpleQuote&gt;&gt; simDataTmp;</div>
<div class="line"><span class="lineno">  273</span>    std::map&lt;RiskFactorKey, Real&gt; absoluteSimDataTmp;</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; yieldCurveTimes.size() - 1; i++) {</div>
<div class="line"><span class="lineno">  275</span>        Real val = wrapper-&gt;discount(yieldCurveDates[i + 1]);</div>
<div class="line"><span class="lineno">  276</span>        <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;ScenarioSimMarket yield curve &quot;</span> &lt;&lt; rf &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; key &lt;&lt; <span class="stringliteral">&quot; discount[&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;]=&quot;</span> &lt;&lt; val);</div>
<div class="line"><span class="lineno">  277</span>        QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; q(<span class="keyword">new</span> SimpleQuote(spreaded ? 1.0 : val));</div>
<div class="line"><span class="lineno">  278</span>        Handle&lt;Quote&gt; qh(q);</div>
<div class="line"><span class="lineno">  279</span>        quotes.push_back(qh);</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>        <span class="comment">// Check if the risk factor is simulated before adding it</span></div>
<div class="line"><span class="lineno">  282</span>        <span class="keywordflow">if</span> (simulate) {</div>
<div class="line"><span class="lineno">  283</span>            simDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(rf, key, i), std::forward_as_tuple(q));</div>
<div class="line"><span class="lineno">  284</span>            <span class="comment">// if generating spreaded scenarios, add the absolute value as well</span></div>
<div class="line"><span class="lineno">  285</span>            <span class="keywordflow">if</span> (spreaded) {</div>
<div class="line"><span class="lineno">  286</span>                absoluteSimDataTmp.emplace(std::piecewise_construct, std::forward_as_tuple(rf, key, i),</div>
<div class="line"><span class="lineno">  287</span>                                           std::forward_as_tuple(val));</div>
<div class="line"><span class="lineno">  288</span>            }</div>
<div class="line"><span class="lineno">  289</span>        }</div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>    <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3">writeSimData</a>(simDataTmp, absoluteSimDataTmp, rf, key,</div>
<div class="line"><span class="lineno">  293</span>                 {std::vector&lt;Real&gt;(std::next(yieldCurveTimes.begin(), 1), yieldCurveTimes.end())});</div>
<div class="line"><span class="lineno">  294</span>    simDataWritten = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    QuantLib::ext::shared_ptr&lt;YieldTermStructure&gt; <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">yieldCurve</a> =</div>
<div class="line"><span class="lineno">  297</span>        makeYieldCurve(key, spreaded, wrapper, yieldCurveTimes, quotes, dc, TARGET(), <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;interpolation(),</div>
<div class="line"><span class="lineno">  298</span>                       <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;extrapolation());</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    Handle&lt;YieldTermStructure&gt; ych(<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">yieldCurve</a>);</div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordflow">if</span> (wrapper-&gt;allowsExtrapolation())</div>
<div class="line"><span class="lineno">  302</span>        ych-&gt;enableExtrapolation();</div>
<div class="line"><span class="lineno">  303</span>    <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market_impl.html#a6c7ff8d8c31e2f85fbb37384bcac3290">yieldCurves_</a>.insert(make_pair(make_tuple(<a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>, <a class="code hl_function" href="namespaceore_1_1analytics.html#af064e92bf12d8a7409563dfe1eff6760">riskFactorYieldCurve</a>(rf), key), ych));</div>
<div class="line"><span class="lineno">  304</span>}</div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_a6c7ff8d8c31e2f85fbb37384bcac3290"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#a6c7ff8d8c31e2f85fbb37384bcac3290">ore::data::MarketImpl::yieldCurves_</a></div><div class="ttdeci">map&lt; tuple&lt; string, YieldCurveType, string &gt;, Handle&lt; YieldTermStructure &gt; &gt; yieldCurves_</div></div>
<div class="ttc" id="anamespaceore_1_1analytics_html_af064e92bf12d8a7409563dfe1eff6760"><div class="ttname"><a href="namespaceore_1_1analytics.html#af064e92bf12d8a7409563dfe1eff6760">ore::analytics::riskFactorYieldCurve</a></div><div class="ttdeci">ore::data::YieldCurveType riskFactorYieldCurve(const RiskFactorKey::KeyType rf)</div><div class="ttdef"><b>Definition:</b> <a href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l00164">scenariosimmarket.cpp:164</a></div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_cgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_cgraph">
<area shape="rect" title=" " alt="" coords="5,70,109,95"/>
<area shape="rect" href="namespaceore_1_1analytics.html#af064e92bf12d8a7409563dfe1eff6760" title=" " alt="" coords="157,5,324,45"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#afd151e890d7a129bea4022a7a0d4dce3" title=" " alt="" coords="191,70,290,95"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9" title=" " alt="" coords="168,120,313,160"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_icgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_a6cfed719476afdb574d21318aa9a1118_icgraph">
<area shape="rect" title=" " alt="" coords="189,5,293,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a9fb38a0edc39d7edcb571010c80ca002" title=" " alt="" coords="5,5,141,31"/>
</map>
</div>

</div>
</div>
<a id="a333c90f525cb31f0eaa29fed1593ba72" name="a333c90f525cb31f0eaa29fed1593ba72"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a333c90f525cb31f0eaa29fed1593ba72">&#9670;&#160;</a></span>getYieldCurve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt; YieldTermStructure &gt; getYieldCurve </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>yieldSpecId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="elRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html">ore::data::TodaysMarketParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>todaysMarketParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>configuration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="elRef" href="../ored/classore_1_1data_1_1_market.html">ore::data::Market</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>market</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Given a yield curve spec ID, <code>yieldSpecId</code>, return the corresponding yield term structure from the <code>market</code>. If <code>market</code> is <code>nullptr</code>, then the yield term structure is taken from this <a class="el" href="classore_1_1analytics_1_1_scenario_sim_market.html" title="Simulation Market updated with discrete scenarios.">ScenarioSimMarket</a> instance. </p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l03196">3196</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3199</span>                                                                                                               {</div>
<div class="line"><span class="lineno"> 3200</span> </div>
<div class="line"><span class="lineno"> 3201</span>    <span class="comment">// If yield spec ID is &quot;&quot;, return empty Handle</span></div>
<div class="line"><span class="lineno"> 3202</span>    <span class="keywordflow">if</span> (yieldSpecId.empty())</div>
<div class="line"><span class="lineno"> 3203</span>        <span class="keywordflow">return</span> Handle&lt;YieldTermStructure&gt;();</div>
<div class="line"><span class="lineno"> 3204</span> </div>
<div class="line"><span class="lineno"> 3205</span>    <span class="keywordflow">if</span> (todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a15146782240bf68d7923722c5371feb9">hasConfiguration</a>(configuration)) {</div>
<div class="line"><span class="lineno"> 3206</span>        <span class="comment">// Look for yield spec ID in index curves of todays market</span></div>
<div class="line"><span class="lineno"> 3207</span>        <span class="keywordflow">if</span> (todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a75a2c24a3dc2abcc22320092c9ffa2e8">hasMarketObject</a>(MarketObject::IndexCurve)) {</div>
<div class="line"><span class="lineno"> 3208</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; indexMapping : todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a451da96d7cc713be6c76c5b288cce4ca">mapping</a>(MarketObject::IndexCurve, configuration)) {</div>
<div class="line"><span class="lineno"> 3209</span>                <span class="keywordflow">if</span> (indexMapping.second == yieldSpecId) {</div>
<div class="line"><span class="lineno"> 3210</span>                    <span class="keywordflow">if</span> (market) {</div>
<div class="line"><span class="lineno"> 3211</span>                        <span class="keywordflow">return</span> market-&gt;iborIndex(indexMapping.first, configuration)-&gt;forwardingTermStructure();</div>
<div class="line"><span class="lineno"> 3212</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3213</span>                        <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#aea15232be6eb71feca2c59137631f732">iborIndex</a>(indexMapping.first, configuration)-&gt;forwardingTermStructure();</div>
<div class="line"><span class="lineno"> 3214</span>                    }</div>
<div class="line"><span class="lineno"> 3215</span>                }</div>
<div class="line"><span class="lineno"> 3216</span>            }</div>
<div class="line"><span class="lineno"> 3217</span>        }</div>
<div class="line"><span class="lineno"> 3218</span> </div>
<div class="line"><span class="lineno"> 3219</span>        <span class="comment">// Look for yield spec ID in yield curves of todays market</span></div>
<div class="line"><span class="lineno"> 3220</span>        <span class="keywordflow">if</span> (todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a75a2c24a3dc2abcc22320092c9ffa2e8">hasMarketObject</a>(MarketObject::YieldCurve)) {</div>
<div class="line"><span class="lineno"> 3221</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; yieldMapping : todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a451da96d7cc713be6c76c5b288cce4ca">mapping</a>(MarketObject::YieldCurve, configuration)) {</div>
<div class="line"><span class="lineno"> 3222</span>                <span class="keywordflow">if</span> (yieldMapping.second == yieldSpecId) {</div>
<div class="line"><span class="lineno"> 3223</span>                    <span class="keywordflow">if</span> (market) {</div>
<div class="line"><span class="lineno"> 3224</span>                        <span class="keywordflow">return</span> market-&gt;yieldCurve(yieldMapping.first, configuration);</div>
<div class="line"><span class="lineno"> 3225</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3226</span>                        <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#ae7d29fd30616cfe3c462d7d84eaf4ef9">yieldCurve</a>(yieldMapping.first, configuration);</div>
<div class="line"><span class="lineno"> 3227</span>                    }</div>
<div class="line"><span class="lineno"> 3228</span>                }</div>
<div class="line"><span class="lineno"> 3229</span>            }</div>
<div class="line"><span class="lineno"> 3230</span>        }</div>
<div class="line"><span class="lineno"> 3231</span> </div>
<div class="line"><span class="lineno"> 3232</span>        <span class="comment">// Look for yield spec ID in discount curves of todays market</span></div>
<div class="line"><span class="lineno"> 3233</span>        <span class="keywordflow">if</span> (todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a75a2c24a3dc2abcc22320092c9ffa2e8">hasMarketObject</a>(MarketObject::DiscountCurve)) {</div>
<div class="line"><span class="lineno"> 3234</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; discountMapping : todaysMarketParams.<a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a451da96d7cc713be6c76c5b288cce4ca">mapping</a>(MarketObject::DiscountCurve, configuration)) {</div>
<div class="line"><span class="lineno"> 3235</span>                <span class="keywordflow">if</span> (discountMapping.second == yieldSpecId) {</div>
<div class="line"><span class="lineno"> 3236</span>                    <span class="keywordflow">if</span> (market) {</div>
<div class="line"><span class="lineno"> 3237</span>                        <span class="keywordflow">return</span> market-&gt;discountCurve(discountMapping.first, configuration);</div>
<div class="line"><span class="lineno"> 3238</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3239</span>                        <span class="keywordflow">return</span> <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market.html#aff00023d0e25ad7c0bf29e8cc97f9e00">discountCurve</a>(discountMapping.first, configuration);</div>
<div class="line"><span class="lineno"> 3240</span>                    }</div>
<div class="line"><span class="lineno"> 3241</span>                }</div>
<div class="line"><span class="lineno"> 3242</span>            }</div>
<div class="line"><span class="lineno"> 3243</span>        }</div>
<div class="line"><span class="lineno"> 3244</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (configuration != <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>) {</div>
<div class="line"><span class="lineno"> 3245</span>        <span class="comment">// try to fall back on default configuration</span></div>
<div class="line"><span class="lineno"> 3246</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classore_1_1analytics_1_1_scenario_sim_market.html#a333c90f525cb31f0eaa29fed1593ba72">getYieldCurve</a>(yieldSpecId, todaysMarketParams, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><span class="lineno"> 3247</span>    }</div>
<div class="line"><span class="lineno"> 3248</span> </div>
<div class="line"><span class="lineno"> 3249</span>    <span class="comment">// If yield spec ID still has not been found, return empty Handle</span></div>
<div class="line"><span class="lineno"> 3250</span>    <span class="keywordflow">return</span> Handle&lt;YieldTermStructure&gt;();</div>
<div class="line"><span class="lineno"> 3251</span>}</div>
<div class="ttc" id="aclassore_1_1data_1_1_todays_market_parameters_html_a15146782240bf68d7923722c5371feb9"><div class="ttname"><a href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a15146782240bf68d7923722c5371feb9">ore::data::TodaysMarketParameters::hasConfiguration</a></div><div class="ttdeci">bool hasConfiguration(const string &amp;configuration) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_todays_market_parameters_html_a451da96d7cc713be6c76c5b288cce4ca"><div class="ttname"><a href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a451da96d7cc713be6c76c5b288cce4ca">ore::data::TodaysMarketParameters::mapping</a></div><div class="ttdeci">const map&lt; string, string &gt; &amp; mapping(const MarketObject o, const string &amp;configuration) const</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_todays_market_parameters_html_a75a2c24a3dc2abcc22320092c9ffa2e8"><div class="ttname"><a href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a75a2c24a3dc2abcc22320092c9ffa2e8">ore::data::TodaysMarketParameters::hasMarketObject</a></div><div class="ttdeci">bool hasMarketObject(const MarketObject &amp;o) const</div></div>
</div><!-- fragment --><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_cgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_cgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_cgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_cgraph">
<area shape="rect" title=" " alt="" coords="5,77,107,102"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a15146782240bf68d7923722c5371feb9" title=" " alt="" coords="155,5,385,45"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a75a2c24a3dc2abcc22320092c9ffa2e8" title=" " alt="" coords="155,69,385,109"/>
<area shape="rect" target="_parent" href="../ored/classore_1_1data_1_1_todays_market_parameters.html#a451da96d7cc713be6c76c5b288cce4ca" title=" " alt="" coords="155,133,385,173"/>
</map>
</div>
<div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_icgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_a333c90f525cb31f0eaa29fed1593ba72_icgraph">
<area shape="rect" title=" " alt="" coords="189,5,291,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a9fb38a0edc39d7edcb571010c80ca002" title=" " alt="" coords="5,5,141,31"/>
</map>
</div>

</div>
</div>
<a id="a301b6c1dfdbe2500cb0b6a499e0b5734" name="a301b6c1dfdbe2500cb0b6a499e0b5734"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a301b6c1dfdbe2500cb0b6a499e0b5734">&#9670;&#160;</a></span>addSwapIndexToSsm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> addSwapIndexToSsm </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>indexName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>continueOnError</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >add a single swap index to the market, return true if successful </p>

<p class="definition">Definition at line <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html#l02935">2935</a> of file <a class="el" href="orea_2scenario_2scenariosimmarket_8cpp_source.html">scenariosimmarket.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2935</span>                                                                                                {</div>
<div class="line"><span class="lineno"> 2936</span>    <span class="keyword">auto</span> dsc = <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;swapIndices().find(indexName);</div>
<div class="line"><span class="lineno"> 2937</span>    <span class="keywordflow">if</span> (dsc == <a class="code hl_variable" href="classore_1_1analytics_1_1_scenario_sim_market.html#a63c0747af118c1d41066cd31f6cd084d">parameters_</a>-&gt;swapIndices().end()) {</div>
<div class="line"><span class="lineno"> 2938</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2939</span>    }</div>
<div class="line"><span class="lineno"> 2940</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Adding swap index &quot;</span> &lt;&lt; indexName &lt;&lt; <span class="stringliteral">&quot; with discounting index &quot;</span> &lt;&lt; dsc-&gt;second);</div>
<div class="line"><span class="lineno"> 2941</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno"> 2942</span>        <a class="code hl_functionRef" href="../ored/classore_1_1data_1_1_market_impl.html#af731b404daf72d32a4986990c5190bcc">addSwapIndex</a>(indexName, dsc-&gt;second, <a class="code hl_variableRef" href="../ored/classore_1_1data_1_1_market.html#ab336651e3455fff1764bf576a5785bbd">Market::defaultConfiguration</a>);</div>
<div class="line"><span class="lineno"> 2943</span>    <a class="code hl_defineRef" href="../ored/log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;Adding swap index &quot;</span> &lt;&lt; indexName &lt;&lt; <span class="stringliteral">&quot; done.&quot;</span>);</div>
<div class="line"><span class="lineno"> 2944</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2945</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno"> 2946</span>        processException(continueOnError, e, indexName);</div>
<div class="line"><span class="lineno"> 2947</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2948</span>    }</div>
<div class="line"><span class="lineno"> 2949</span>}</div>
<div class="ttc" id="aclassore_1_1data_1_1_market_impl_html_af731b404daf72d32a4986990c5190bcc"><div class="ttname"><a href="../ored/classore_1_1data_1_1_market_impl.html#af731b404daf72d32a4986990c5190bcc">ore::data::MarketImpl::addSwapIndex</a></div><div class="ttdeci">void addSwapIndex(const string &amp;swapindex, const string &amp;discountIndex, const string &amp;configuration=Market::defaultConfiguration) const</div></div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="classore_1_1analytics_1_1_scenario_sim_market_a301b6c1dfdbe2500cb0b6a499e0b5734_icgraph.png" border="0" usemap="#aclassore_1_1analytics_1_1_scenario_sim_market_a301b6c1dfdbe2500cb0b6a499e0b5734_icgraph" alt=""/></div>
<map name="aclassore_1_1analytics_1_1_scenario_sim_market_a301b6c1dfdbe2500cb0b6a499e0b5734_icgraph" id="aclassore_1_1analytics_1_1_scenario_sim_market_a301b6c1dfdbe2500cb0b6a499e0b5734_icgraph">
<area shape="rect" title=" " alt="" coords="189,5,336,31"/>
<area shape="rect" href="classore_1_1analytics_1_1_scenario_sim_market.html#a9fb38a0edc39d7edcb571010c80ca002" title=" " alt="" coords="5,5,141,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a63c0747af118c1d41066cd31f6cd084d" name="a63c0747af118c1d41066cd31f6cd084d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63c0747af118c1d41066cd31f6cd084d">&#9670;&#160;</a></span>parameters_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario_sim_market_parameters.html">ScenarioSimMarketParameters</a>&gt; parameters_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00166">166</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a4f6ff7197821c6208621e218ac60c361" name="a4f6ff7197821c6208621e218ac60c361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f6ff7197821c6208621e218ac60c361">&#9670;&#160;</a></span>scenarioGenerator_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario_generator.html">ScenarioGenerator</a>&gt; scenarioGenerator_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00167">167</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="afc0c946cb6a258c3c295f74a5b10cdcc" name="afc0c946cb6a258c3c295f74a5b10cdcc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc0c946cb6a258c3c295f74a5b10cdcc">&#9670;&#160;</a></span>asd_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_aggregation_scenario_data.html">AggregationScenarioData</a>&gt; asd_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00168">168</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a327eb9d6ae1ae728199147f68ba0909c" name="a327eb9d6ae1ae728199147f68ba0909c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a327eb9d6ae1ae728199147f68ba0909c">&#9670;&#160;</a></span>fixingManager_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_fixing_manager.html">FixingManager</a>&gt; fixingManager_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00169">169</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a2f193d3de7c1a94311d8c1ea52a889c7" name="a2f193d3de7c1a94311d8c1ea52a889c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f193d3de7c1a94311d8c1ea52a889c7">&#9670;&#160;</a></span>filter_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario_filter.html">ScenarioFilter</a>&gt; filter_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00170">170</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a076bfc216eaef4fe4e0667a433e1ad76" name="a076bfc216eaef4fe4e0667a433e1ad76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a076bfc216eaef4fe4e0667a433e1ad76">&#9670;&#160;</a></span>simData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; &gt; simData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00172">172</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a5b99f8838062291f6201c9f819cd3da1" name="a5b99f8838062291f6201c9f819cd3da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b99f8838062291f6201c9f819cd3da1">&#9670;&#160;</a></span>baseScenario_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a>&gt; baseScenario_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00173">173</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a65d3596672b1e758c866798baa9bee78" name="a65d3596672b1e758c866798baa9bee78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65d3596672b1e758c866798baa9bee78">&#9670;&#160;</a></span>baseScenarioAbsolute_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a>&gt; baseScenarioAbsolute_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00174">174</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a4e0a3d6ee8e66a9f56640aefd9636502" name="a4e0a3d6ee8e66a9f56640aefd9636502"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e0a3d6ee8e66a9f56640aefd9636502">&#9670;&#160;</a></span>cachedSimData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;QuantLib::ext::shared_ptr&lt;SimpleQuote&gt; &gt; cachedSimData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00176">176</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="aff642c824541d0d41f36ce46b7756809" name="aff642c824541d0d41f36ce46b7756809"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff642c824541d0d41f36ce46b7756809">&#9670;&#160;</a></span>cachedSimDataActive_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classbool.html">bool</a>&gt; cachedSimDataActive_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00177">177</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a634c17ea8a85013693d3b91344d9faf5" name="a634c17ea8a85013693d3b91344d9faf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634c17ea8a85013693d3b91344d9faf5">&#9670;&#160;</a></span>cachedSimDataKeysHash_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t cachedSimDataKeysHash_ = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00178">178</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a0235f0e84cb47d21daf8793e66f0242f" name="a0235f0e84cb47d21daf8793e66f0242f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0235f0e84cb47d21daf8793e66f0242f">&#9670;&#160;</a></span>nonSimulatedFactors_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a>&gt; nonSimulatedFactors_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00180">180</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a53cfefe400aac2623306853c887ef20a" name="a53cfefe400aac2623306853c887ef20a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53cfefe400aac2623306853c887ef20a">&#9670;&#160;</a></span>useSpreadedTermStructures_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> useSpreadedTermStructures_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00184">184</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="ad66079855d4dadc55e8f684e17bfce63" name="ad66079855d4dadc55e8f684e17bfce63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad66079855d4dadc55e8f684e17bfce63">&#9670;&#160;</a></span>absoluteSimData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">RiskFactorKey</a>, Real&gt; absoluteSimData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00185">185</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="ab5b2289c143003c7964bfeb7e570c504" name="ab5b2289c143003c7964bfeb7e570c504"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b2289c143003c7964bfeb7e570c504">&#9670;&#160;</a></span>coordinatesData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;std::tuple&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html#aab0feaba617470cb4aa830dc5935238c">RiskFactorKey::KeyType</a>, std::string, std::vector&lt;std::vector&lt;Real&gt; &gt; &gt; &gt; coordinatesData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00188">188</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="ac8084e71c12327fddaa89613722b4624" name="ac8084e71c12327fddaa89613722b4624"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8084e71c12327fddaa89613722b4624">&#9670;&#160;</a></span>cacheSimData_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> cacheSimData_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00190">190</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a7a035b0b5a2360c3ee4490089fee6523" name="a7a035b0b5a2360c3ee4490089fee6523"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a035b0b5a2360c3ee4490089fee6523">&#9670;&#160;</a></span>allowPartialScenarios_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> allowPartialScenarios_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00191">191</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="ac9a5eb0d03fa8e820cf67d44e8c0b21a" name="ac9a5eb0d03fa8e820cf67d44e8c0b21a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9a5eb0d03fa8e820cf67d44e8c0b21a">&#9670;&#160;</a></span>iborFallbackConfig_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="elRef" href="../ored/classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a> iborFallbackConfig_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00192">192</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a55687aaad8fa83a41d2c8a83846fbfbb" name="a55687aaad8fa83a41d2c8a83846fbfbb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55687aaad8fa83a41d2c8a83846fbfbb">&#9670;&#160;</a></span>diffToBaseKeys_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;<a class="el" href="classore_1_1analytics_1_1_risk_factor_key.html">ore::analytics::RiskFactorKey</a>&gt; diffToBaseKeys_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00195">195</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="a41a3cb015d4569715fcf400ab2de2ddd" name="a41a3cb015d4569715fcf400ab2de2ddd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41a3cb015d4569715fcf400ab2de2ddd">&#9670;&#160;</a></span>currentScenario_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a>&gt; currentScenario_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00197">197</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
<a id="ab0e9fb72add803a7cca3013e13f70b37" name="ab0e9fb72add803a7cca3013e13f70b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0e9fb72add803a7cca3013e13f70b37">&#9670;&#160;</a></span>offsetScenario_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="classore_1_1analytics_1_1_scenario.html">Scenario</a>&gt; offsetScenario_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="scenariosimmarket_8hpp_source.html#l00198">198</a> of file <a class="el" href="scenariosimmarket_8hpp_source.html">scenariosimmarket.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
