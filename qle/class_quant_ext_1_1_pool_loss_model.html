<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>QuantExt: PoolLossModel&lt; CopulaPolicy &gt; Class Template Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantextextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-qle@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.12</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_quant_ext.html">QuantExt</a></li><li class="navelem"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html">PoolLossModel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_quant_ext_1_1_pool_loss_model-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">PoolLossModel&lt; CopulaPolicy &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="poollossmodel_8hpp_source.html">qle/models/poollossmodel.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for PoolLossModel&lt; CopulaPolicy &gt;:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_pool_loss_model__inherit__graph.png" border="0" usemap="#a_pool_loss_model_3_01_copula_policy_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="a_pool_loss_model_3_01_copula_policy_01_4_inherit__map" id="a_pool_loss_model_3_01_copula_policy_01_4_inherit__map">
<area shape="rect" title=" " alt="" coords="5,431,220,955"/>
<area shape="rect" href="class_quant_ext_1_1_default_loss_model.html" title=" " alt="" coords="29,93,196,383"/>
<area shape="rect" title=" " alt="" coords="67,5,158,45"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for PoolLossModel&lt; CopulaPolicy &gt;:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_pool_loss_model__coll__graph.png" border="0" usemap="#a_pool_loss_model_3_01_copula_policy_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="a_pool_loss_model_3_01_copula_policy_01_4_coll__map" id="a_pool_loss_model_3_01_copula_policy_01_4_coll__map">
<area shape="rect" title=" " alt="" coords="434,827,649,1057"/>
<area shape="rect" href="class_quant_ext_1_1_default_loss_model.html" title=" " alt="" coords="50,445,217,720"/>
<area shape="rect" title=" " alt="" coords="5,218,96,258"/>
<area shape="rect" title=" " alt="" coords="121,211,314,265"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="241,563,292,603"/>
<area shape="rect" title=" " alt="" coords="317,548,518,617"/>
<area shape="rect" title=" " alt="" coords="542,563,594,603"/>
<area shape="rect" title=" " alt="" coords="627,108,679,148"/>
<area shape="rect" title=" " alt="" coords="679,218,849,258"/>
<area shape="rect" title=" " alt="" coords="836,555,980,610"/>
<area shape="rect" title=" " alt="" coords="795,108,885,148"/>
<area shape="rect" title=" " alt="" coords="821,5,859,45"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5886b018fe0def2852207781a62c8565"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a5886b018fe0def2852207781a62c8565">PoolLossModel</a> (<a class="el" href="classbool.html">bool</a> homogeneous, const QuantLib::ext::shared_ptr&lt; <a class="el" href="class_quant_ext_1_1_extended_constant_loss_latent_model.html">ExtendedConstantLossLatentModel</a>&lt; CopulaPolicy &gt; &gt; &amp;copula, QuantLib::Size nBuckets, QuantLib::Real <a class="el" href="namespace_quant_ext.html#ac0bb3279caaa02e9f9dd6e85a687cba8">max</a>=5.0, QuantLib::Real <a class="el" href="namespace_quant_ext.html#a5ef74c22499422bb7492381ea999e5a3">min</a>=-5.0, QuantLib::Size nSteps=50, <a class="el" href="classbool.html">bool</a> useQuadrature=false, <a class="el" href="classbool.html">bool</a> useStochasticRecovery=false)</td></tr>
<tr class="separator:a5886b018fe0def2852207781a62c8565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67f87aca68c71033a60f08bc1fce6428"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a67f87aca68c71033a60f08bc1fce6428">expectedTrancheLoss</a> (const QuantLib::Date &amp;d, Real recoveryRate=Null&lt; Real &gt;()) const override</td></tr>
<tr class="separator:a67f87aca68c71033a60f08bc1fce6428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fc14ea3da36b0d461af73196522e746"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a7fc14ea3da36b0d461af73196522e746">percentile</a> (const QuantLib::Date &amp;d, QuantLib::Real percentile) const override</td></tr>
<tr class="separator:a7fc14ea3da36b0d461af73196522e746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a674fa8a73512d717e09140ed2529a0c9"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a674fa8a73512d717e09140ed2529a0c9">expectedShortfall</a> (const QuantLib::Date &amp;d, QuantLib::Probability <a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a7fc14ea3da36b0d461af73196522e746">percentile</a>) const override</td></tr>
<tr class="separator:a674fa8a73512d717e09140ed2529a0c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a477d6e3ddb39d3dd108d2f4f010f30b4"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a477d6e3ddb39d3dd108d2f4f010f30b4">correlation</a> () const override</td></tr>
<tr class="separator:a477d6e3ddb39d3dd108d2f4f010f30b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c93b708aa485eb67c2c3643a6a38448"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a0c93b708aa485eb67c2c3643a6a38448">marginalProbabilitiesVV</a> (Date d, Real recoveryRate=Null&lt; Real &gt;()) const</td></tr>
<tr class="separator:a0c93b708aa485eb67c2c3643a6a38448"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a50715ebc9623aef71836bc1158cd568c"><td class="memItemLeft" align="right" valign="top">QuantLib::Distribution&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a50715ebc9623aef71836bc1158cd568c">lossDistrib</a> (const QuantLib::Date &amp;d, Real recoveryRate=Null&lt; Real &gt;()) const</td></tr>
<tr class="separator:a50715ebc9623aef71836bc1158cd568c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedee63d387a0775a2e1639c6dc74899a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#aedee63d387a0775a2e1639c6dc74899a">updateLGDs</a> (Real recoveryRate=Null&lt; Real &gt;()) const</td></tr>
<tr class="separator:aedee63d387a0775a2e1639c6dc74899a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a551c6d133588ed8177b32c7dfae35e2b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a551c6d133588ed8177b32c7dfae35e2b">updateThresholds</a> (QuantLib::Date d, Real recoveryRate=Null&lt; Real &gt;()) const</td></tr>
<tr class="separator:a551c6d133588ed8177b32c7dfae35e2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a234a722674098ea7844ce6c9274c3c4e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a234a722674098ea7844ce6c9274c3c4e">updateCPRs</a> (std::vector&lt; QuantLib::Real &gt; factor, Real recoveryRate=Null&lt; Real &gt;()) const</td></tr>
<tr class="separator:a234a722674098ea7844ce6c9274c3c4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d52de916f52a01b5ed70715a069d22b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a9d52de916f52a01b5ed70715a069d22b">resetModel</a> () override</td></tr>
<tr class="memdesc:a9d52de916f52a01b5ed70715a069d22b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Concrete models do now any updates/inits they need on basket reset.  <a href="class_quant_ext_1_1_pool_loss_model.html#a9d52de916f52a01b5ed70715a069d22b">More...</a><br /></td></tr>
<tr class="separator:a9d52de916f52a01b5ed70715a069d22b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7725f9abb82621dea512a71b8b296455"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a7725f9abb82621dea512a71b8b296455">expectedTrancheLoss1</a> (const QuantLib::Date &amp;d, Distribution &amp;dist) const</td></tr>
<tr class="separator:a7725f9abb82621dea512a71b8b296455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54892f52f239cc5d03574c990cfd953e"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a54892f52f239cc5d03574c990cfd953e">expectedTrancheLoss2</a> (const QuantLib::Date &amp;d, const Array &amp;p, const Array &amp;A) const</td></tr>
<tr class="separator:a54892f52f239cc5d03574c990cfd953e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a79770d5f32e46682c253ef80bdfc3089"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a79770d5f32e46682c253ef80bdfc3089">homogeneous_</a></td></tr>
<tr class="separator:a79770d5f32e46682c253ef80bdfc3089"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cbb119824187d20661ec6bbbc89783f"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; <a class="el" href="class_quant_ext_1_1_extended_constant_loss_latent_model.html">ExtendedConstantLossLatentModel</a>&lt; CopulaPolicy &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a></td></tr>
<tr class="separator:a4cbb119824187d20661ec6bbbc89783f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8822243ef33624945d05cd9c0a28131b"><td class="memItemLeft" align="right" valign="top">QuantLib::Size&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a></td></tr>
<tr class="separator:a8822243ef33624945d05cd9c0a28131b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2117640b2ae0fb37cbcd0a772f3faed"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#ad2117640b2ae0fb37cbcd0a772f3faed">max_</a></td></tr>
<tr class="separator:ad2117640b2ae0fb37cbcd0a772f3faed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa22410dd68789741c7b7ccb92102d839"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#aa22410dd68789741c7b7ccb92102d839">min_</a></td></tr>
<tr class="separator:aa22410dd68789741c7b7ccb92102d839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2845f523a2505fda08950c27c4ec669"><td class="memItemLeft" align="right" valign="top">QuantLib::Size&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#ac2845f523a2505fda08950c27c4ec669">nSteps_</a></td></tr>
<tr class="separator:ac2845f523a2505fda08950c27c4ec669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae045e9d913072f2c975f9973baf55bb5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#ae045e9d913072f2c975f9973baf55bb5">useQuadrature_</a></td></tr>
<tr class="separator:ae045e9d913072f2c975f9973baf55bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc56c9fde286a537dd8549dfef28b316"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a></td></tr>
<tr class="separator:adc56c9fde286a537dd8549dfef28b316"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae58506946f0336b11a13b2ca8d34618c"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#ae58506946f0336b11a13b2ca8d34618c">delta_</a></td></tr>
<tr class="separator:ae58506946f0336b11a13b2ca8d34618c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4685e13deea1215c07aea25da562cc0f"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a4685e13deea1215c07aea25da562cc0f">attach_</a></td></tr>
<tr class="separator:a4685e13deea1215c07aea25da562cc0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba71445f54d3be201419433fbe74e5b4"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#aba71445f54d3be201419433fbe74e5b4">detach_</a></td></tr>
<tr class="separator:aba71445f54d3be201419433fbe74e5b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76a964fe80484e876801c542c2bf1af0"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a76a964fe80484e876801c542c2bf1af0">notional_</a></td></tr>
<tr class="separator:a76a964fe80484e876801c542c2bf1af0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee49d9c1705a50aa39e4dcca30dd217d"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a></td></tr>
<tr class="separator:aee49d9c1705a50aa39e4dcca30dd217d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a766a8ec9bc4218277c3952d6daa0f617"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a></td></tr>
<tr class="separator:a766a8ec9bc4218277c3952d6daa0f617"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df46222b996042c01d175461eddfd86"><td class="memItemLeft" align="right" valign="top">std::vector&lt; QuantLib::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a></td></tr>
<tr class="separator:a4df46222b996042c01d175461eddfd86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9616b020a89df7eaed6ef2721fd5951"><td class="memItemLeft" align="right" valign="top">std::vector&lt; QuantLib::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a></td></tr>
<tr class="separator:ac9616b020a89df7eaed6ef2721fd5951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b8ac802486508f92b8f6b48e3fa4dd2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a></td></tr>
<tr class="separator:a8b8ac802486508f92b8f6b48e3fa4dd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee358de80ce355a4192ec52fb01d8dee"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a></td></tr>
<tr class="separator:aee358de80ce355a4192ec52fb01d8dee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa33ee29d498e441e6c451b4cd0c3e37"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a></td></tr>
<tr class="separator:aaa33ee29d498e441e6c451b4cd0c3e37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02d8974b63a121ca2bd39a0f41728b17"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a></td></tr>
<tr class="separator:a02d8974b63a121ca2bd39a0f41728b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_class_quant_ext_1_1_default_loss_model"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_class_quant_ext_1_1_default_loss_model')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_quant_ext_1_1_default_loss_model.html">DefaultLossModel</a></td></tr>
<tr class="memitem:a95a02e1165c4aaa234dc10ce70f7feb7 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a95a02e1165c4aaa234dc10ce70f7feb7">DefaultLossModel</a> ()</td></tr>
<tr class="separator:a95a02e1165c4aaa234dc10ce70f7feb7 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f07bc19983c7cb1f36ef8bc4b4abf66 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a4f07bc19983c7cb1f36ef8bc4b4abf66">expectedTrancheLoss</a> (const Date &amp;d, Real recoveryRate=Null&lt; Real &gt;()) const</td></tr>
<tr class="separator:a4f07bc19983c7cb1f36ef8bc4b4abf66 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fcdbcad5b5c46da60b14ce39122774f inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Probability&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a1fcdbcad5b5c46da60b14ce39122774f">probOverLoss</a> (const Date &amp;d, Real lossFraction) const</td></tr>
<tr class="separator:a1fcdbcad5b5c46da60b14ce39122774f inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dbb5964035a7434b2e4edc638430577 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a9dbb5964035a7434b2e4edc638430577">percentile</a> (const Date &amp;d, Real percentile) const</td></tr>
<tr class="memdesc:a9dbb5964035a7434b2e4edc638430577 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Value at Risk given a default loss percentile.  <a href="class_quant_ext_1_1_default_loss_model.html#a9dbb5964035a7434b2e4edc638430577">More...</a><br /></td></tr>
<tr class="separator:a9dbb5964035a7434b2e4edc638430577 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a689cec5c18b5e5f144dab4fc5cd1280c inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a689cec5c18b5e5f144dab4fc5cd1280c">expectedShortfall</a> (const Date &amp;d, Real <a class="el" href="class_quant_ext_1_1_default_loss_model.html#a9dbb5964035a7434b2e4edc638430577">percentile</a>) const</td></tr>
<tr class="memdesc:a689cec5c18b5e5f144dab4fc5cd1280c inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expected shortfall given a default loss percentile.  <a href="class_quant_ext_1_1_default_loss_model.html#a689cec5c18b5e5f144dab4fc5cd1280c">More...</a><br /></td></tr>
<tr class="separator:a689cec5c18b5e5f144dab4fc5cd1280c inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfea01ef6f345a9ec68196fc8d30c5ee inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#adfea01ef6f345a9ec68196fc8d30c5ee">splitVaRLevel</a> (const Date &amp;d, Real loss) const</td></tr>
<tr class="memdesc:adfea01ef6f345a9ec68196fc8d30c5ee inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Associated VaR fraction to each counterparty.  <a href="class_quant_ext_1_1_default_loss_model.html#adfea01ef6f345a9ec68196fc8d30c5ee">More...</a><br /></td></tr>
<tr class="separator:adfea01ef6f345a9ec68196fc8d30c5ee inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae539fd376817fed6ccebf49692d051ff inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#ae539fd376817fed6ccebf49692d051ff">splitESFLevel</a> (const Date &amp;d, Real loss) const</td></tr>
<tr class="memdesc:ae539fd376817fed6ccebf49692d051ff inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Associated ESF fraction to each counterparty.  <a href="class_quant_ext_1_1_default_loss_model.html#ae539fd376817fed6ccebf49692d051ff">More...</a><br /></td></tr>
<tr class="separator:ae539fd376817fed6ccebf49692d051ff inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e0f142e75b7b5964b3b12328f03571a inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual std::map&lt; Real, Probability &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a3e0f142e75b7b5964b3b12328f03571a">lossDistribution</a> (const Date &amp;) const</td></tr>
<tr class="memdesc:a3e0f142e75b7b5964b3b12328f03571a inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Full loss distribution.  <a href="class_quant_ext_1_1_default_loss_model.html#a3e0f142e75b7b5964b3b12328f03571a">More...</a><br /></td></tr>
<tr class="separator:a3e0f142e75b7b5964b3b12328f03571a inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe2bdfc1ec60b66231f6f548ce090206 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#abe2bdfc1ec60b66231f6f548ce090206">densityTrancheLoss</a> (const Date &amp;d, Real lossFraction) const</td></tr>
<tr class="memdesc:abe2bdfc1ec60b66231f6f548ce090206 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Probability density of a given loss fraction of the basket notional.  <a href="class_quant_ext_1_1_default_loss_model.html#abe2bdfc1ec60b66231f6f548ce090206">More...</a><br /></td></tr>
<tr class="separator:abe2bdfc1ec60b66231f6f548ce090206 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55341b8668b8e6b76666cc20c9950c64 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual std::vector&lt; Probability &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a55341b8668b8e6b76666cc20c9950c64">probsBeingNthEvent</a> (Size n, const Date &amp;d) const</td></tr>
<tr class="separator:a55341b8668b8e6b76666cc20c9950c64 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bdf74219aced9c21262e8b0c0dbe306 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a0bdf74219aced9c21262e8b0c0dbe306">defaultCorrelation</a> (const Date &amp;d, Size iName, Size jName) const</td></tr>
<tr class="memdesc:a0bdf74219aced9c21262e8b0c0dbe306 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pearsons' default probability correlation.  <a href="class_quant_ext_1_1_default_loss_model.html#a0bdf74219aced9c21262e8b0c0dbe306">More...</a><br /></td></tr>
<tr class="separator:a0bdf74219aced9c21262e8b0c0dbe306 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc0cf14e9e70a964322a127b4916ea7f inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Probability&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#adc0cf14e9e70a964322a127b4916ea7f">probAtLeastNEvents</a> (Size n, const Date &amp;d) const</td></tr>
<tr class="separator:adc0cf14e9e70a964322a127b4916ea7f inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a424b4c46a2d345a8b92184ac7ebbf3 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">virtual Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a9a424b4c46a2d345a8b92184ac7ebbf3">expectedRecovery</a> (const Date &amp;, Size iName, const DefaultProbKey &amp;) const</td></tr>
<tr class="separator:a9a424b4c46a2d345a8b92184ac7ebbf3 inherit pro_methods_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_quant_ext_1_1_default_loss_model"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_quant_ext_1_1_default_loss_model')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_quant_ext_1_1_default_loss_model.html">DefaultLossModel</a></td></tr>
<tr class="memitem:a98e6b4ae89d76a194d522039cd8b5127 inherit pro_attribs_class_quant_ext_1_1_default_loss_model"><td class="memItemLeft" align="right" valign="top">RelinkableHandle&lt; <a class="el" href="class_quant_ext_1_1_basket.html">QuantExt::Basket</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a></td></tr>
<tr class="separator:a98e6b4ae89d76a194d522039cd8b5127 inherit pro_attribs_class_quant_ext_1_1_default_loss_model"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class CopulaPolicy&gt;<br />
class QuantExt::PoolLossModel&lt; CopulaPolicy &gt;</div><p >Default loss distribution convolution for finite homogeneous or non-homogeneous pool</p>

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00038">38</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5886b018fe0def2852207781a62c8565" name="a5886b018fe0def2852207781a62c8565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5886b018fe0def2852207781a62c8565">&#9670;&#160;</a></span>PoolLossModel()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_pool_loss_model.html">PoolLossModel</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>homogeneous</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; <a class="el" href="class_quant_ext_1_1_extended_constant_loss_latent_model.html">ExtendedConstantLossLatentModel</a>&lt; CopulaPolicy &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>copula</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Size&#160;</td>
          <td class="paramname"><em>nBuckets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>max</em> = <code>5.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>min</em> = <code>-5.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Size&#160;</td>
          <td class="paramname"><em>nSteps</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>useQuadrature</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>useStochasticRecovery</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00139">139</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span>    : <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a79770d5f32e46682c253ef80bdfc3089">homogeneous_</a>(homogeneous),</div>
<div class="line"><span class="lineno">  149</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>(copula),</div>
<div class="line"><span class="lineno">  150</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>(nBuckets),</div>
<div class="line"><span class="lineno">  151</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ad2117640b2ae0fb37cbcd0a772f3faed">max_</a>(max),</div>
<div class="line"><span class="lineno">  152</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aa22410dd68789741c7b7ccb92102d839">min_</a>(min),</div>
<div class="line"><span class="lineno">  153</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac2845f523a2505fda08950c27c4ec669">nSteps_</a>(nSteps),</div>
<div class="line"><span class="lineno">  154</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ae045e9d913072f2c975f9973baf55bb5">useQuadrature_</a>(useQuadrature),</div>
<div class="line"><span class="lineno">  155</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a>(useStochasticRecovery),</div>
<div class="line"><span class="lineno">  156</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ae58506946f0336b11a13b2ca8d34618c">delta_</a>((max - min) / nSteps),</div>
<div class="line"><span class="lineno">  157</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4685e13deea1215c07aea25da562cc0f">attach_</a>(0.0),</div>
<div class="line"><span class="lineno">  158</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aba71445f54d3be201419433fbe74e5b4">detach_</a>(0.0),</div>
<div class="line"><span class="lineno">  159</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a76a964fe80484e876801c542c2bf1af0">notional_</a>(0.0),</div>
<div class="line"><span class="lineno">  160</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>(0.0),</div>
<div class="line"><span class="lineno">  161</span>      <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>(0.0) {</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    QL_REQUIRE(copula-&gt;numFactors() == 1, <span class="stringliteral">&quot;Multifactor PoolLossModel not yet implemented.&quot;</span>);</div>
<div class="line"><span class="lineno">  164</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a4685e13deea1215c07aea25da562cc0f"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a4685e13deea1215c07aea25da562cc0f">QuantExt::PoolLossModel::attach_</a></div><div class="ttdeci">QuantLib::Real attach_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00072">poollossmodel.hpp:72</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a4cbb119824187d20661ec6bbbc89783f"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">QuantExt::PoolLossModel::copula_</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; ExtendedConstantLossLatentModel&lt; CopulaPolicy &gt; &gt; copula_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00063">poollossmodel.hpp:63</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a766a8ec9bc4218277c3952d6daa0f617"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">QuantExt::PoolLossModel::detachAmount_</a></div><div class="ttdeci">QuantLib::Real detachAmount_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00076">poollossmodel.hpp:76</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a76a964fe80484e876801c542c2bf1af0"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a76a964fe80484e876801c542c2bf1af0">QuantExt::PoolLossModel::notional_</a></div><div class="ttdeci">QuantLib::Real notional_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00074">poollossmodel.hpp:74</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a79770d5f32e46682c253ef80bdfc3089"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a79770d5f32e46682c253ef80bdfc3089">QuantExt::PoolLossModel::homogeneous_</a></div><div class="ttdeci">bool homogeneous_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00062">poollossmodel.hpp:62</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a8822243ef33624945d05cd9c0a28131b"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">QuantExt::PoolLossModel::nBuckets_</a></div><div class="ttdeci">QuantLib::Size nBuckets_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00064">poollossmodel.hpp:64</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_aa22410dd68789741c7b7ccb92102d839"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#aa22410dd68789741c7b7ccb92102d839">QuantExt::PoolLossModel::min_</a></div><div class="ttdeci">QuantLib::Real min_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00066">poollossmodel.hpp:66</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_aba71445f54d3be201419433fbe74e5b4"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#aba71445f54d3be201419433fbe74e5b4">QuantExt::PoolLossModel::detach_</a></div><div class="ttdeci">QuantLib::Real detach_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00073">poollossmodel.hpp:73</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_ac2845f523a2505fda08950c27c4ec669"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#ac2845f523a2505fda08950c27c4ec669">QuantExt::PoolLossModel::nSteps_</a></div><div class="ttdeci">QuantLib::Size nSteps_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00067">poollossmodel.hpp:67</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_ad2117640b2ae0fb37cbcd0a772f3faed"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#ad2117640b2ae0fb37cbcd0a772f3faed">QuantExt::PoolLossModel::max_</a></div><div class="ttdeci">QuantLib::Real max_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00065">poollossmodel.hpp:65</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_adc56c9fde286a537dd8549dfef28b316"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">QuantExt::PoolLossModel::useStochasticRecovery_</a></div><div class="ttdeci">bool useStochasticRecovery_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00069">poollossmodel.hpp:69</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_ae045e9d913072f2c975f9973baf55bb5"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#ae045e9d913072f2c975f9973baf55bb5">QuantExt::PoolLossModel::useQuadrature_</a></div><div class="ttdeci">bool useQuadrature_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00068">poollossmodel.hpp:68</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_ae58506946f0336b11a13b2ca8d34618c"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#ae58506946f0336b11a13b2ca8d34618c">QuantExt::PoolLossModel::delta_</a></div><div class="ttdeci">QuantLib::Real delta_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00071">poollossmodel.hpp:71</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_aee49d9c1705a50aa39e4dcca30dd217d"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">QuantExt::PoolLossModel::attachAmount_</a></div><div class="ttdeci">QuantLib::Real attachAmount_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00075">poollossmodel.hpp:75</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_pool_loss_model_a5886b018fe0def2852207781a62c8565_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_pool_loss_model_a5886b018fe0def2852207781a62c8565_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_pool_loss_model_a5886b018fe0def2852207781a62c8565_cgraph" id="aclass_quant_ext_1_1_pool_loss_model_a5886b018fe0def2852207781a62c8565_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,116,56"/>
<area shape="rect" href="namespace_quant_ext.html#ac0bb3279caaa02e9f9dd6e85a687cba8" title=" " alt="" coords="164,5,275,31"/>
<area shape="rect" href="namespace_quant_ext.html#a5ef74c22499422bb7492381ea999e5a3" title=" " alt="" coords="166,55,273,80"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a67f87aca68c71033a60f08bc1fce6428" name="a67f87aca68c71033a60f08bc1fce6428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67f87aca68c71033a60f08bc1fce6428">&#9670;&#160;</a></span>expectedTrancheLoss()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real expectedTrancheLoss </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>recoveryRate</em> = <code>Null&lt;Real&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00167">167</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  167</span>                                                                                                            {</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    QuantLib::Distribution dist = <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a50715ebc9623aef71836bc1158cd568c">lossDistrib</a>(d, recoveryRate);</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <span class="comment">// RL: dist.trancheExpectedValue() using x = dist.average(i)</span></div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// FIXME: some remaining inaccuracy in dist.cumulativeDensity(detachAmount_)</span></div>
<div class="line"><span class="lineno">  173</span>    QuantLib::Real expectedLoss = 0;</div>
<div class="line"><span class="lineno">  174</span>    dist.normalize();</div>
<div class="line"><span class="lineno">  175</span>    <span class="keywordflow">for</span> (QuantLib::Size i = 0; i &lt; dist.size(); i++) {</div>
<div class="line"><span class="lineno">  176</span>        <span class="comment">// Real x = dist.x(i) + dist.dx(i)/2; // in QL distribution.cpp</span></div>
<div class="line"><span class="lineno">  177</span>        QuantLib::Real x = dist.average(i);</div>
<div class="line"><span class="lineno">  178</span>        <span class="keywordflow">if</span> (x &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>)</div>
<div class="line"><span class="lineno">  179</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  180</span>        <span class="keywordflow">if</span> (x &gt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>)</div>
<div class="line"><span class="lineno">  181</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  182</span>        expectedLoss += (x - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>) * dist.dx(i) * dist.density(i);</div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span>    expectedLoss += (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a> - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>) * (1.0 - dist.cumulativeDensity(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>));</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">return</span> expectedLoss;</div>
<div class="line"><span class="lineno">  187</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a50715ebc9623aef71836bc1158cd568c"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a50715ebc9623aef71836bc1158cd568c">QuantExt::PoolLossModel::lossDistrib</a></div><div class="ttdeci">QuantLib::Distribution lossDistrib(const QuantLib::Date &amp;d, Real recoveryRate=Null&lt; Real &gt;()) const</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00404">poollossmodel.hpp:404</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7fc14ea3da36b0d461af73196522e746" name="a7fc14ea3da36b0d461af73196522e746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7fc14ea3da36b0d461af73196522e746">&#9670;&#160;</a></span>percentile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real percentile </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>percentile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00229">229</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  229</span>                                                                                                         {</div>
<div class="line"><span class="lineno">  230</span>    QuantLib::Real portfLoss = <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a50715ebc9623aef71836bc1158cd568c">lossDistrib</a>(d).confidenceLevel(<a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a7fc14ea3da36b0d461af73196522e746">percentile</a>);</div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">return</span> std::min(std::max(portfLoss - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>, 0.), <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a> - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>);</div>
<div class="line"><span class="lineno">  232</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a7fc14ea3da36b0d461af73196522e746"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a7fc14ea3da36b0d461af73196522e746">QuantExt::PoolLossModel::percentile</a></div><div class="ttdeci">QuantLib::Real percentile(const QuantLib::Date &amp;d, QuantLib::Real percentile) const override</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00229">poollossmodel.hpp:229</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a674fa8a73512d717e09140ed2529a0c9" name="a674fa8a73512d717e09140ed2529a0c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a674fa8a73512d717e09140ed2529a0c9">&#9670;&#160;</a></span>expectedShortfall()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real expectedShortfall </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Probability&#160;</td>
          <td class="paramname"><em>percentile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00235">235</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  236</span>                                                                 {</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    QuantLib::Distribution dist = <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a50715ebc9623aef71836bc1158cd568c">lossDistrib</a>(d);</div>
<div class="line"><span class="lineno">  239</span>    dist.tranche(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>, <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>);</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">return</span> dist.expectedShortfall(<a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a7fc14ea3da36b0d461af73196522e746">percentile</a>);</div>
<div class="line"><span class="lineno">  241</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a477d6e3ddb39d3dd108d2f4f010f30b4" name="a477d6e3ddb39d3dd108d2f4f010f30b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a477d6e3ddb39d3dd108d2f4f010f30b4">&#9670;&#160;</a></span>correlation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real correlation</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Return single correlation number for one factor models. If not implemented or not applicable, returns a <code>Null&lt;Real&gt;()</code>. </p>

<p>Reimplemented from <a class="el" href="class_quant_ext_1_1_default_loss_model.html#a69afd21b057feeba5d3691be9ea452de">DefaultLossModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00244">244</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  244</span>                                                            {</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    <span class="keyword">const</span> std::vector&lt;std::vector&lt;QuantLib::Real&gt; &gt;&amp; weights = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;factorWeights();</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="keywordflow">if</span> (weights.empty() || weights[0].size() != 1) {</div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">return</span> QuantLib::Null&lt;QuantLib::Real&gt;();</div>
<div class="line"><span class="lineno">  250</span>    }</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    QuantLib::Real res = weights[0][0];</div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordflow">for</span> (QuantLib::Size i = 1; i &lt; weights.size(); ++i) {</div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">if</span> (weights[i].size() != 1 || !close(res, weights[i][0])) {</div>
<div class="line"><span class="lineno">  255</span>            <span class="keywordflow">return</span> QuantLib::Null&lt;QuantLib::Real&gt;();</div>
<div class="line"><span class="lineno">  256</span>        }</div>
<div class="line"><span class="lineno">  257</span>    }</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>    <span class="keywordflow">return</span> res * res;</div>
<div class="line"><span class="lineno">  260</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c93b708aa485eb67c2c3643a6a38448" name="a0c93b708aa485eb67c2c3643a6a38448"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c93b708aa485eb67c2c3643a6a38448">&#9670;&#160;</a></span>marginalProbabilitiesVV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; Real &gt; &gt; marginalProbabilitiesVV </td>
          <td>(</td>
          <td class="paramtype">Date&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>recoveryRate</em> = <code>Null&lt;Real&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00334">334</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  334</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    std::vector&lt;QuantLib::Real&gt; prob = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingProbabilities(d);</div>
<div class="line"><span class="lineno">  337</span>    std::vector&lt;std::vector&lt;QuantLib::Real&gt;&gt; probVV(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(), std::vector&lt;Real&gt;());</div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a> || recoveryRate == Null&lt;Real&gt;()) {</div>
<div class="line"><span class="lineno">  339</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(); ++i)</div>
<div class="line"><span class="lineno">  340</span>            probVV[i].resize(1, prob[i]);</div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">return</span> probVV;</div>
<div class="line"><span class="lineno">  342</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  343</span>        QL_REQUIRE(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;recoveryProbabilities().size() == <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(),</div>
<div class="line"><span class="lineno">  344</span>                   <span class="stringliteral">&quot;number of rec rate probability vectors does not match number of notionals&quot;</span>); </div>
<div class="line"><span class="lineno">  345</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  346</span>            Real pd = prob[i];</div>
<div class="line"><span class="lineno">  347</span>            std::vector&lt;Real&gt; rrProbs = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;recoveryProbabilities()[i];</div>
<div class="line"><span class="lineno">  348</span>            probVV[i].resize(rrProbs.size(), 0.0);</div>
<div class="line"><span class="lineno">  349</span>            <span class="keywordflow">for</span> (Size j = 0; j &lt; rrProbs.size(); ++j)</div>
<div class="line"><span class="lineno">  350</span>                probVV[i][j] = pd * rrProbs[j];</div>
<div class="line"><span class="lineno">  351</span>        }</div>
<div class="line"><span class="lineno">  352</span>        <span class="keywordflow">return</span> probVV;</div>
<div class="line"><span class="lineno">  353</span>    }</div>
<div class="line"><span class="lineno">  354</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_default_loss_model_html_a98e6b4ae89d76a194d522039cd8b5127"><div class="ttname"><a href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">QuantExt::DefaultLossModel::basket_</a></div><div class="ttdeci">RelinkableHandle&lt; QuantExt::Basket &gt; basket_</div><div class="ttdef"><b>Definition:</b> <a href="defaultlossmodel_8hpp_source.html#l00059">defaultlossmodel.hpp:59</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a4df46222b996042c01d175461eddfd86"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">QuantExt::PoolLossModel::notionals_</a></div><div class="ttdeci">std::vector&lt; QuantLib::Real &gt; notionals_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00077">poollossmodel.hpp:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a50715ebc9623aef71836bc1158cd568c" name="a50715ebc9623aef71836bc1158cd568c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50715ebc9623aef71836bc1158cd568c">&#9670;&#160;</a></span>lossDistrib()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Distribution lossDistrib </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>recoveryRate</em> = <code>Null&lt;Real&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00404">404</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  404</span>                                                                                                            {</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordtype">bool</span> <a class="code hl_namespace" href="namespacecheck.html">check</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  407</span>    </div>
<div class="line"><span class="lineno">  408</span>    Real maximum = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>; </div>
<div class="line"><span class="lineno">  409</span>    Real minimum = 0.0;</div>
<div class="line"><span class="lineno">  410</span>    </div>
<div class="line"><span class="lineno">  411</span>    <span class="comment">// Update the LGD vector, could be moved to resetModel() if we can disregard the zeroRecovery flag</span></div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#aedee63d387a0775a2e1639c6dc74899a">updateLGDs</a>(recoveryRate);</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>    <span class="comment">// Update probabilities qij and thresholds cij, needs to stay here because date dependent</span></div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a551c6d133588ed8177b32c7dfae35e2b">updateThresholds</a>(d, recoveryRate);</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">// Init bucketing class</span></div>
<div class="line"><span class="lineno">  418</span>    HullWhiteBucketing hwb(minimum, maximum, <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>);</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">// Container for the final (unconditional) loss distribution up to date d.</span></div>
<div class="line"><span class="lineno">  421</span>    Array p(hwb.buckets()-1, 0.0), A(hwb.buckets()-1, 0.0);</div>
<div class="line"><span class="lineno">  422</span>    QuantLib::Distribution dist(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>, minimum, maximum);</div>
<div class="line"><span class="lineno">  423</span>    </div>
<div class="line"><span class="lineno">  424</span>    <span class="comment">// Use the relevant loss bucketing algorithm</span></div>
<div class="line"><span class="lineno">  425</span>    QuantLib::ext::shared_ptr&lt;QuantLib::LossDist&gt; bucketing;</div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a79770d5f32e46682c253ef80bdfc3089">homogeneous_</a>)</div>
<div class="line"><span class="lineno">  427</span>        bucketing = QuantLib::ext::make_shared&lt;QuantLib::LossDistHomogeneous&gt;(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>, maximum);</div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  429</span>        bucketing = QuantLib::ext::make_shared&lt;QuantLib::LossDistBucketing&gt;(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>, maximum);</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>    <span class="comment">// Is the ql bucketing used?</span></div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordtype">bool</span> useQlBucketing = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span>    <span class="comment">// Switch between quadrature integration and basic segment type scheme.</span></div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ae045e9d913072f2c975f9973baf55bb5">useQuadrature_</a> &amp;&amp; !<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a>) {</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>        <span class="comment">// FIXME: Ensure quadrature works with stochastic recovery</span></div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>        QuantLib::GaussHermiteIntegration Integrator(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac2845f523a2505fda08950c27c4ec669">nSteps_</a>);</div>
<div class="line"><span class="lineno">  440</span>        <span class="comment">// Marginal probabilities for each remaining entity in basket, P(\tau_i &lt; t).</span></div>
<div class="line"><span class="lineno">  441</span>        std::vector&lt;QuantLib::Real&gt; prob = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingProbabilities(d);</div>
<div class="line"><span class="lineno">  442</span>        LossModelConditionalDist&lt;CopulaPolicy&gt; lmcd(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>, bucketing, prob, <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a>);</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>        <span class="keywordflow">for</span> (QuantLib::Size j = 0; j &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>; j++) {</div>
<div class="line"><span class="lineno">  445</span>            std::function&lt;QuantLib::Real(QuantLib::Real)&gt; densityFunc = std::bind(</div>
<div class="line"><span class="lineno">  446</span>                &amp;<a class="code hl_function" href="class_quant_ext_1_1_loss_model_conditional_dist.html#ad4b89f57aeda449625210d118877efde">LossModelConditionalDist&lt;CopulaPolicy&gt;::conditionalDensity</a>, &amp;lmcd, std::placeholders::_1, j);</div>
<div class="line"><span class="lineno">  447</span>            std::function&lt;QuantLib::Real(QuantLib::Real)&gt; averageFunc = std::bind(</div>
<div class="line"><span class="lineno">  448</span>                &amp;<a class="code hl_function" href="class_quant_ext_1_1_loss_model_conditional_dist.html#adcc39add510ae19008cc4ecd2f670966">LossModelConditionalDist&lt;CopulaPolicy&gt;::conditionalAverage</a>, &amp;lmcd, std::placeholders::_1, j);</div>
<div class="line"><span class="lineno">  449</span>            dist.addDensity(j, Integrator(densityFunc));</div>
<div class="line"><span class="lineno">  450</span>            dist.addAverage(j, Integrator(averageFunc));</div>
<div class="line"><span class="lineno">  451</span>        }</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>        useQlBucketing = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>        std::vector&lt;QuantLib::Real&gt; factor{ <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aa22410dd68789741c7b7ccb92102d839">min_</a> + <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ae58506946f0336b11a13b2ca8d34618c">delta_</a> / 2.0 };      </div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">for</span> (QuantLib::Size k = 0; k &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac2845f523a2505fda08950c27c4ec669">nSteps_</a>; k++) {</div>
<div class="line"><span class="lineno">  460</span>            </div>
<div class="line"><span class="lineno">  461</span>            std::vector&lt;Real&gt; cpr = <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a234a722674098ea7844ce6c9274c3c4e">updateCPRs</a>(factor, recoveryRate);</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>            <span class="comment">// Loss distribution up to date d conditional on common factor M = m.</span></div>
<div class="line"><span class="lineno">  464</span>            Distribution conditionalDist;</div>
<div class="line"><span class="lineno">  465</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a>) {</div>
<div class="line"><span class="lineno">  466</span>                <span class="comment">// HW bucketing with multi-state extension for stochastic recovery</span></div>
<div class="line"><span class="lineno">  467</span>                <span class="comment">// With stochastic recovery the portfolios is in general not homogeneous any more, so that</span></div>
<div class="line"><span class="lineno">  468</span>                <span class="comment">// bucketing is the only choice. We could use this call in all cases (including deterministic</span></div>
<div class="line"><span class="lineno">  469</span>                <span class="comment">// recovery, homogeneous pool), but this can cause small regression errors (using bucketing</span></div>
<div class="line"><span class="lineno">  470</span>                <span class="comment">// instead of homogeneoius pool algorithm) and calculation time increase (QuantLib::LossDist&#39;s</span></div>
<div class="line"><span class="lineno">  471</span>                <span class="comment">// bucketing is faster).</span></div>
<div class="line"><span class="lineno">  472</span>                hwb.computeMultiState(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>.begin(), <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>.end(), <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a>.begin());                </div>
<div class="line"><span class="lineno">  473</span>            }</div>
<div class="line"><span class="lineno">  474</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a79770d5f32e46682c253ef80bdfc3089">homogeneous_</a>) {</div>
<div class="line"><span class="lineno">  475</span>                <span class="comment">// Original QuantLib::LossDist (homogeneous), works with deterministic recovery only.</span></div>
<div class="line"><span class="lineno">  476</span>                <span class="comment">// If possible we use the homogeneous algorithm in QuantLib::LossDist. This also avoids small</span></div>
<div class="line"><span class="lineno">  477</span>                <span class="comment">// regression errors from switching to any of the bucketing algorithms in the homogeneous case. </span></div>
<div class="line"><span class="lineno">  478</span>                conditionalDist = (*bucketing)(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a>, cpr);</div>
<div class="line"><span class="lineno">  479</span>                useQlBucketing = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  480</span>            }</div>
<div class="line"><span class="lineno">  481</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  482</span>                <span class="comment">// We could use hwb.computeMultiState here as well, yields the same result,</span></div>
<div class="line"><span class="lineno">  483</span>                <span class="comment">// but compute is slightly faster than computeMultiState.</span></div>
<div class="line"><span class="lineno">  484</span>                hwb.compute(cpr.begin(), cpr.end(), <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a>.begin());                </div>
<div class="line"><span class="lineno">  485</span>            }</div>
<div class="line"><span class="lineno">  486</span> </div>
<div class="line"><span class="lineno">  487</span>            <span class="comment">// Update final distribution with contribution from common factor M = m.</span></div>
<div class="line"><span class="lineno">  488</span>            Real densitydm = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ae58506946f0336b11a13b2ca8d34618c">delta_</a> * <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;density(factor);</div>
<div class="line"><span class="lineno">  489</span> </div>
<div class="line"><span class="lineno">  490</span>            <span class="keywordflow">if</span> (useQlBucketing) {</div>
<div class="line"><span class="lineno">  491</span>                <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>; j++) {</div>
<div class="line"><span class="lineno">  492</span>                    dist.addDensity(j, conditionalDist.density(j) * densitydm);</div>
<div class="line"><span class="lineno">  493</span>                    dist.addAverage(j, conditionalDist.average(j) * densitydm);</div>
<div class="line"><span class="lineno">  494</span>                }</div>
<div class="line"><span class="lineno">  495</span>            }</div>
<div class="line"><span class="lineno">  496</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  497</span>                <span class="comment">// Bucket 0 contains losses up to lowerBound, and bucket 1 from [lowerBound, lowerBound + dx),</span></div>
<div class="line"><span class="lineno">  498</span>                <span class="comment">// together both buckets contains (-inf, lowerBound + dx)</span></div>
<div class="line"><span class="lineno">  499</span>                <span class="comment">// Since we dont have any negative losses in a CDO its [0, dx)</span></div>
<div class="line"><span class="lineno">  500</span>                <span class="keywordtype">double</span> p0 = (hwb.probability()[0] + hwb.probability()[1]);</div>
<div class="line"><span class="lineno">  501</span>                <span class="keywordtype">double</span> A0 = 0;</div>
<div class="line"><span class="lineno">  502</span>                <span class="keywordflow">if</span> (!QuantLib::close_enough(p0, 0.0)) {</div>
<div class="line"><span class="lineno">  503</span>                    A0 = (hwb.averageLoss()[0] * hwb.probability()[0] + hwb.averageLoss()[1] * hwb.probability()[1]) / p0; </div>
<div class="line"><span class="lineno">  504</span>                }</div>
<div class="line"><span class="lineno">  505</span>                p[0] += p0 * densitydm;</div>
<div class="line"><span class="lineno">  506</span>                A[0] += A0 * densitydm;</div>
<div class="line"><span class="lineno">  507</span>                 </div>
<div class="line"><span class="lineno">  508</span>                <span class="keywordflow">for</span> (Size j = 2; j &lt; hwb.buckets(); j++) {</div>
<div class="line"><span class="lineno">  509</span>                    p[j-1] += hwb.probability()[j] * densitydm;</div>
<div class="line"><span class="lineno">  510</span>                    A[j-1] += hwb.averageLoss()[j] * densitydm;</div>
<div class="line"><span class="lineno">  511</span>                }</div>
<div class="line"><span class="lineno">  512</span>            }</div>
<div class="line"><span class="lineno">  513</span>            </div>
<div class="line"><span class="lineno">  514</span>            <span class="comment">// Move to next value of common factor in [min,max] region.</span></div>
<div class="line"><span class="lineno">  515</span>            factor[0] += <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ae58506946f0336b11a13b2ca8d34618c">delta_</a>;</div>
<div class="line"><span class="lineno">  516</span>        }</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">if</span> (!useQlBucketing) {</div>
<div class="line"><span class="lineno">  519</span>            <span class="comment">// Copy results to distribution, skip the right-most bucket (maximum, infty)</span></div>
<div class="line"><span class="lineno">  520</span>            <span class="keywordflow">for</span> (Size j = 0; j &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8822243ef33624945d05cd9c0a28131b">nBuckets_</a>; j++) {</div>
<div class="line"><span class="lineno">  521</span>                dist.addDensity(j, p[j] / dist.dx(j));</div>
<div class="line"><span class="lineno">  522</span>                dist.addAverage(j, A[j]);</div>
<div class="line"><span class="lineno">  523</span>            }</div>
<div class="line"><span class="lineno">  524</span>        }</div>
<div class="line"><span class="lineno">  525</span>    }</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">if</span> (<a class="code hl_namespace" href="namespacecheck.html">check</a> &amp;&amp; !useQlBucketing) {</div>
<div class="line"><span class="lineno">  528</span>        <span class="comment">// This checks the consistency between the Distribution object and the &quot;raw&quot; p and A vectors</span></div>
<div class="line"><span class="lineno">  529</span>        <span class="comment">// by way of expectedTrancheLoss calculations.</span></div>
<div class="line"><span class="lineno">  530</span>        <span class="comment">// Can be deactivated because of its performance impact.</span></div>
<div class="line"><span class="lineno">  531</span>        Real etl1 = <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a7725f9abb82621dea512a71b8b296455">expectedTrancheLoss1</a>(d, dist);</div>
<div class="line"><span class="lineno">  532</span>        Real etl2 = <a class="code hl_function" href="class_quant_ext_1_1_pool_loss_model.html#a54892f52f239cc5d03574c990cfd953e">expectedTrancheLoss2</a>(d, p, A);</div>
<div class="line"><span class="lineno">  533</span>        Real tiny = 1e-3;</div>
<div class="line"><span class="lineno">  534</span>        QL_REQUIRE(fabs((etl1 - etl2)/etl2) &lt; tiny, <span class="stringliteral">&quot;expected tranche loss failed, &quot;</span> &lt;&lt; etl1 &lt;&lt; <span class="stringliteral">&quot; vs &quot;</span> &lt;&lt; etl2);</div>
<div class="line"><span class="lineno">  535</span>    }</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordflow">return</span> dist;</div>
<div class="line"><span class="lineno">  538</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_loss_model_conditional_dist_html_ad4b89f57aeda449625210d118877efde"><div class="ttname"><a href="class_quant_ext_1_1_loss_model_conditional_dist.html#ad4b89f57aeda449625210d118877efde">QuantExt::LossModelConditionalDist::conditionalDensity</a></div><div class="ttdeci">QuantLib::Real conditionalDensity(QuantLib::Real factor, QuantLib::Size bucket)</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00555">poollossmodel.hpp:555</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_loss_model_conditional_dist_html_adcc39add510ae19008cc4ecd2f670966"><div class="ttname"><a href="class_quant_ext_1_1_loss_model_conditional_dist.html#adcc39add510ae19008cc4ecd2f670966">QuantExt::LossModelConditionalDist::conditionalAverage</a></div><div class="ttdeci">QuantLib::Real conditionalAverage(QuantLib::Real factor, QuantLib::Size bucket)</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00562">poollossmodel.hpp:562</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a02d8974b63a121ca2bd39a0f41728b17"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">QuantExt::PoolLossModel::cprVV_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt; cprVV_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00088">poollossmodel.hpp:88</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a234a722674098ea7844ce6c9274c3c4e"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a234a722674098ea7844ce6c9274c3c4e">QuantExt::PoolLossModel::updateCPRs</a></div><div class="ttdeci">std::vector&lt; Real &gt; updateCPRs(std::vector&lt; QuantLib::Real &gt; factor, Real recoveryRate=Null&lt; Real &gt;()) const</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00357">poollossmodel.hpp:357</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a54892f52f239cc5d03574c990cfd953e"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a54892f52f239cc5d03574c990cfd953e">QuantExt::PoolLossModel::expectedTrancheLoss2</a></div><div class="ttdeci">QuantLib::Real expectedTrancheLoss2(const QuantLib::Date &amp;d, const Array &amp;p, const Array &amp;A) const</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00210">poollossmodel.hpp:210</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a551c6d133588ed8177b32c7dfae35e2b"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a551c6d133588ed8177b32c7dfae35e2b">QuantExt::PoolLossModel::updateThresholds</a></div><div class="ttdeci">void updateThresholds(QuantLib::Date d, Real recoveryRate=Null&lt; Real &gt;()) const</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00296">poollossmodel.hpp:296</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a7725f9abb82621dea512a71b8b296455"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a7725f9abb82621dea512a71b8b296455">QuantExt::PoolLossModel::expectedTrancheLoss1</a></div><div class="ttdeci">QuantLib::Real expectedTrancheLoss1(const QuantLib::Date &amp;d, Distribution &amp;dist) const</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00190">poollossmodel.hpp:190</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_aaa33ee29d498e441e6c451b4cd0c3e37"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">QuantExt::PoolLossModel::lgdVV_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt; lgdVV_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00086">poollossmodel.hpp:86</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_ac9616b020a89df7eaed6ef2721fd5951"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">QuantExt::PoolLossModel::lgd_</a></div><div class="ttdeci">std::vector&lt; QuantLib::Real &gt; lgd_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00080">poollossmodel.hpp:80</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_aedee63d387a0775a2e1639c6dc74899a"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#aedee63d387a0775a2e1639c6dc74899a">QuantExt::PoolLossModel::updateLGDs</a></div><div class="ttdeci">void updateLGDs(Real recoveryRate=Null&lt; Real &gt;()) const</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00263">poollossmodel.hpp:263</a></div></div>
<div class="ttc" id="anamespacecheck_html"><div class="ttname"><a href="namespacecheck.html">check</a></div><div class="ttdef"><b>Definition:</b> <a href="dategeneration_8cpp_source.html#l00030">dategeneration.cpp:30</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_pool_loss_model_a50715ebc9623aef71836bc1158cd568c_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_pool_loss_model_a50715ebc9623aef71836bc1158cd568c_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_pool_loss_model_a50715ebc9623aef71836bc1158cd568c_cgraph" id="aclass_quant_ext_1_1_pool_loss_model_a50715ebc9623aef71836bc1158cd568c_cgraph">
<area shape="rect" title=" " alt="" coords="5,141,88,166"/>
<area shape="rect" href="class_quant_ext_1_1_hull_white_bucketing.html#aff639f1eeabcc750fb88749639e4189d" title=" " alt="" coords="136,5,335,45"/>
<area shape="rect" href="class_quant_ext_1_1_bucketing.html#a1bc2df135e29f8b79a702ced936ce875" title=" " alt="" coords="164,69,307,109"/>
<area shape="rect" href="class_quant_ext_1_1_hull_white_bucketing.html#ad9289bfd98ff9b20a6f2e9db97681b50" title=" " alt="" coords="136,197,335,237"/>
<area shape="rect" href="class_quant_ext_1_1_hull_white_bucketing.html#a367e9f47b06cae3b67ba1a6041173529" title=" " alt="" coords="136,133,335,173"/>
<area shape="rect" href="class_quant_ext_1_1_hull_white_bucketing.html#a4062c5abb68f57aaa4c9aaa08e89873f" title=" " alt="" coords="136,261,335,301"/>
<area shape="rect" href="class_quant_ext_1_1_hull_white_bucketing.html#a81a7caca012757a74606f92c230a0171" title=" " alt="" coords="383,133,581,173"/>
<area shape="rect" href="class_quant_ext_1_1_bucketing.html#ac2229047f51cc80dd63e9c64c61a9c3a" title=" " alt="" coords="629,197,772,237"/>
<area shape="rect" href="class_quant_ext_1_1_hull_white_bucketing.html#af3bacacf3497a3115c7d58560079e287" title=" " alt="" coords="383,197,581,237"/>
</map>
</div>

</div>
</div>
<a id="aedee63d387a0775a2e1639c6dc74899a" name="aedee63d387a0775a2e1639c6dc74899a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedee63d387a0775a2e1639c6dc74899a">&#9670;&#160;</a></span>updateLGDs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void updateLGDs </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>recoveryRate</em> = <code>Null&lt;Real&gt;()</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00263">263</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  263</span>                                                                    {</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment">// one LGD per entity, notional modified with deterministic recovery rate</span></div>
<div class="line"><span class="lineno">  266</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a> = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>;</div>
<div class="line"><span class="lineno">  267</span>    <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; recoveries = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;recoveries();</div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">for</span> (QuantLib::Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  269</span>        <span class="keywordflow">if</span> (recoveryRate != Null&lt;Real&gt;())</div>
<div class="line"><span class="lineno">  270</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a>[i] *= (1 - recoveryRate);</div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  272</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#ac9616b020a89df7eaed6ef2721fd5951">lgd_</a>[i] *= (1 - recoveries[i]);</div>
<div class="line"><span class="lineno">  273</span>    }</div>
<div class="line"><span class="lineno">  274</span>    </div>
<div class="line"><span class="lineno">  275</span>    <span class="comment">// Initialize the LGD matrix for stochastic recovery</span></div>
<div class="line"><span class="lineno">  276</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a>.clear();    </div>
<div class="line"><span class="lineno">  277</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a>.resize(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(), std::vector&lt;Real&gt;());</div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">if</span> (recoveryRate != Null&lt;Real&gt;())</div>
<div class="line"><span class="lineno">  280</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a>[i].push_back(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>[i] * (1.0 - recoveryRate));</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a>)</div>
<div class="line"><span class="lineno">  282</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a>[i].push_back(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>[i] * (1.0 - recoveries[i]));</div>
<div class="line"><span class="lineno">  283</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  284</span>            <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; rrGrid = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;recoveryRateGrids()[i];</div>
<div class="line"><span class="lineno">  285</span>            <span class="keywordflow">for</span> (Size j = 0; j &lt; rrGrid.size(); ++j) {                </div>
<div class="line"><span class="lineno">  286</span>                QL_REQUIRE(j == 0 || rrGrid[j] &lt;= rrGrid[j-1], <span class="stringliteral">&quot;recovery rates need to be sorted in decreasing order&quot;</span>);</div>
<div class="line"><span class="lineno">  287</span>                <span class="comment">// j == 0 corresponds to the lowest recovery or largest loss</span></div>
<div class="line"><span class="lineno">  288</span>                <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aaa33ee29d498e441e6c451b4cd0c3e37">lgdVV_</a>[i].push_back(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>[i] * (1.0 - rrGrid[j]));</div>
<div class="line"><span class="lineno">  289</span>            }</div>
<div class="line"><span class="lineno">  290</span>            <span class="comment">// std::cout &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  291</span>        }</div>
<div class="line"><span class="lineno">  292</span>    }</div>
<div class="line"><span class="lineno">  293</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a551c6d133588ed8177b32c7dfae35e2b" name="a551c6d133588ed8177b32c7dfae35e2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a551c6d133588ed8177b32c7dfae35e2b">&#9670;&#160;</a></span>updateThresholds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void updateThresholds </td>
          <td>(</td>
          <td class="paramtype">QuantLib::Date&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>recoveryRate</em> = <code>Null&lt;Real&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00296">296</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  296</span>                                                                                          {</div>
<div class="line"><span class="lineno">  297</span>    <span class="comment">// Initialize probability of default function Q and thresholds C according to spec</span></div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="comment">// Marginal probabilities of default for each remaining entity in basket</span></div>
<div class="line"><span class="lineno">  300</span>    std::vector&lt;QuantLib::Real&gt; prob = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingProbabilities(d);</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>.resize(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size());</div>
<div class="line"><span class="lineno">  303</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>.resize(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size());</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a> &amp;&amp; recoveryRate == Null&lt;Real&gt;()) {</div>
<div class="line"><span class="lineno">  306</span>        Real tiny = 1.0e-10;</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  308</span>            QL_REQUIRE(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;recoveryProbabilities().size() == <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(),</div>
<div class="line"><span class="lineno">  309</span>                       <span class="stringliteral">&quot;number of rec rate probability vectors does not match number of notionals&quot;</span>); </div>
<div class="line"><span class="lineno">  310</span>            std::vector&lt;Real&gt; rrProbs = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;recoveryProbabilities()[i];</div>
<div class="line"><span class="lineno">  311</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i] = std::vector&lt;Real&gt;(rrProbs.size() + 1, prob[i]);</div>
<div class="line"><span class="lineno">  312</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i] = std::vector&lt;Real&gt;(rrProbs.size() + 1, <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;inverseCumulativeY(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i][0], i));</div>
<div class="line"><span class="lineno">  313</span>            Real <a class="code hl_function" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">sum</a> = 0.0;</div>
<div class="line"><span class="lineno">  314</span>            <span class="keywordflow">for</span> (Size j = 0; j &lt; rrProbs.size(); ++j) {</div>
<div class="line"><span class="lineno">  315</span>                <a class="code hl_function" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">sum</a> += rrProbs[j];</div>
<div class="line"><span class="lineno">  316</span>                <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i][j+1] = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i][0] * (1.0 - <a class="code hl_function" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">sum</a>);</div>
<div class="line"><span class="lineno">  317</span>                <span class="keywordflow">if</span> (QuantLib::close_enough(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i][j+1], 0.0))</div>
<div class="line"><span class="lineno">  318</span>                    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][j+1] = QL_MIN_REAL;</div>
<div class="line"><span class="lineno">  319</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  320</span>                    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][j+1] = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;inverseCumulativeY(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i][j+1], i); </div>
<div class="line"><span class="lineno">  321</span>            }</div>
<div class="line"><span class="lineno">  322</span>            QL_REQUIRE(fabs(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i].back()) &lt; tiny, <span class="stringliteral">&quot;expected zero qij, but found &quot;</span> &lt;&lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i].back() &lt;&lt; <span class="stringliteral">&quot; for i=&quot;</span> &lt;&lt; i); </div>
<div class="line"><span class="lineno">  323</span>        }</div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  326</span>        <span class="keywordflow">for</span> (QuantLib::Size i = 0; i &lt; prob.size(); i++) {</div>
<div class="line"><span class="lineno">  327</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">q_</a>[i] = std::vector&lt;Real&gt;(1, prob[i]);</div>
<div class="line"><span class="lineno">  328</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i] = std::vector&lt;Real&gt;(1, <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;inverseCumulativeY(prob[i], i));</div>
<div class="line"><span class="lineno">  329</span>        }</div>
<div class="line"><span class="lineno">  330</span>    }</div>
<div class="line"><span class="lineno">  331</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_a8b8ac802486508f92b8f6b48e3fa4dd2"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#a8b8ac802486508f92b8f6b48e3fa4dd2">QuantExt::PoolLossModel::q_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt; q_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00082">poollossmodel.hpp:82</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_pool_loss_model_html_aee358de80ce355a4192ec52fb01d8dee"><div class="ttname"><a href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">QuantExt::PoolLossModel::c_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; QuantLib::Real &gt; &gt; c_</div><div class="ttdef"><b>Definition:</b> <a href="poollossmodel_8hpp_source.html#l00084">poollossmodel.hpp:84</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_adf33d0fce0bc35cfa69a565cfb5f6a25"><div class="ttname"><a href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">QuantExt::sum</a></div><div class="ttdeci">Real sum(const Cash &amp;c, const Cash &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="bondbasket_8cpp_source.html#l00107">bondbasket.cpp:107</a></div></div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_pool_loss_model_a551c6d133588ed8177b32c7dfae35e2b_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_pool_loss_model_a551c6d133588ed8177b32c7dfae35e2b_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_pool_loss_model_a551c6d133588ed8177b32c7dfae35e2b_cgraph" id="aclass_quant_ext_1_1_pool_loss_model_a551c6d133588ed8177b32c7dfae35e2b_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,129,31"/>
<area shape="rect" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25" title=" " alt="" coords="177,5,288,31"/>
</map>
</div>

</div>
</div>
<a id="a234a722674098ea7844ce6c9274c3c4e" name="a234a722674098ea7844ce6c9274c3c4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a234a722674098ea7844ce6c9274c3c4e">&#9670;&#160;</a></span>updateCPRs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; Real &gt; updateCPRs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; QuantLib::Real &gt;&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"><em>recoveryRate</em> = <code>Null&lt;Real&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00357">357</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  357</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  358</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>.clear();</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    Real tiny = 1.0e-10;</div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#adc56c9fde286a537dd8549dfef28b316">useStochasticRecovery_</a> &amp;&amp; recoveryRate == Null&lt;Real&gt;()) {</div>
<div class="line"><span class="lineno">  362</span>        <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>.resize(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(), std::vector&lt;Real&gt;());</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  364</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>[i].resize(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i].size() - 1, 0.0);</div>
<div class="line"><span class="lineno">  365</span>            Real pd = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;conditionalDefaultProbabilityInvP(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][0], i, factor);</div>
<div class="line"><span class="lineno">  366</span>            Real <a class="code hl_function" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">sum</a> = 0.0;</div>
<div class="line"><span class="lineno">  367</span>            <span class="keywordflow">for</span> (Size j = 1; j &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i].size(); ++j) {</div>
<div class="line"><span class="lineno">  368</span>                <span class="comment">// probability of recovery j conditional on default of i</span></div>
<div class="line"><span class="lineno">  369</span>                <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>[i][j-1] = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;conditionalDefaultProbabilityInvP(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][j-1], i, factor)</div>
<div class="line"><span class="lineno">  370</span>                    - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;conditionalDefaultProbabilityInvP(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][j], i, factor);</div>
<div class="line"><span class="lineno">  371</span>                <a class="code hl_function" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">sum</a> += <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>[i][j-1];</div>
<div class="line"><span class="lineno">  372</span>            }</div>
<div class="line"><span class="lineno">  373</span>            QL_REQUIRE(fabs(<a class="code hl_function" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25">sum</a> - pd) &lt; tiny, <span class="stringliteral">&quot;probability check failed for factor0 &quot;</span> &lt;&lt; factor[0]);</div>
<div class="line"><span class="lineno">  374</span>        }</div>
<div class="line"><span class="lineno">  375</span>    }</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>.resize(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a>.size(), std::vector&lt;Real&gt;(1, 0));</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>.size(); ++i) {</div>
<div class="line"><span class="lineno">  379</span>            <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a02d8974b63a121ca2bd39a0f41728b17">cprVV_</a>[i][0] = <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;conditionalDefaultProbabilityInvP(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][0], i, factor);</div>
<div class="line"><span class="lineno">  380</span>        }</div>
<div class="line"><span class="lineno">  381</span>    }</div>
<div class="line"><span class="lineno">  382</span>    </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">// Vector of default probabilities conditional on the common market factor M: P(\tau_i &lt; t | M = m).</span></div>
<div class="line"><span class="lineno">  384</span>    std::vector&lt;Real&gt; probs;</div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>.size(); i++)</div>
<div class="line"><span class="lineno">  386</span>        probs.push_back(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;conditionalDefaultProbabilityInvP(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee358de80ce355a4192ec52fb01d8dee">c_</a>[i][0], i, factor));</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">return</span> probs;</div>
<div class="line"><span class="lineno">  389</span>}</div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_pool_loss_model_a234a722674098ea7844ce6c9274c3c4e_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_pool_loss_model_a234a722674098ea7844ce6c9274c3c4e_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_pool_loss_model_a234a722674098ea7844ce6c9274c3c4e_cgraph" id="aclass_quant_ext_1_1_pool_loss_model_a234a722674098ea7844ce6c9274c3c4e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,100,31"/>
<area shape="rect" href="namespace_quant_ext.html#adf33d0fce0bc35cfa69a565cfb5f6a25" title=" " alt="" coords="148,5,259,31"/>
</map>
</div>

</div>
</div>
<a id="a9d52de916f52a01b5ed70715a069d22b" name="a9d52de916f52a01b5ed70715a069d22b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d52de916f52a01b5ed70715a069d22b">&#9670;&#160;</a></span>resetModel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void resetModel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Concrete models do now any updates/inits they need on basket reset. </p>

<p>Implements <a class="el" href="class_quant_ext_1_1_default_loss_model.html#a44ae97f46e6e0d8a7dcd9168e30240bc">DefaultLossModel</a>.</p>

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00392">392</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  392</span>                                             {</div>
<div class="line"><span class="lineno">  393</span>    <span class="comment">// need to be capped now since the limit amounts might be over the remaining notional (think amortizing)</span></div>
<div class="line"><span class="lineno">  394</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4685e13deea1215c07aea25da562cc0f">attach_</a> = std::min(<a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingAttachmentAmount() / <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingNotional(), 1.);</div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aba71445f54d3be201419433fbe74e5b4">detach_</a> = std::min(<a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingDetachmentAmount() / <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingNotional(), 1.);</div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a76a964fe80484e876801c542c2bf1af0">notional_</a> = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingNotional();</div>
<div class="line"><span class="lineno">  397</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4df46222b996042c01d175461eddfd86">notionals_</a> = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingNotionals();</div>
<div class="line"><span class="lineno">  398</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a> = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingAttachmentAmount();</div>
<div class="line"><span class="lineno">  399</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a> = <a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>-&gt;remainingDetachmentAmount();</div>
<div class="line"><span class="lineno">  400</span>    <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a4cbb119824187d20661ec6bbbc89783f">copula_</a>-&gt;resetBasket(<a class="code hl_variable" href="class_quant_ext_1_1_default_loss_model.html#a98e6b4ae89d76a194d522039cd8b5127">basket_</a>.currentLink());</div>
<div class="line"><span class="lineno">  401</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7725f9abb82621dea512a71b8b296455" name="a7725f9abb82621dea512a71b8b296455"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7725f9abb82621dea512a71b8b296455">&#9670;&#160;</a></span>expectedTrancheLoss1()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real expectedTrancheLoss1 </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Distribution &amp;&#160;</td>
          <td class="paramname"><em>dist</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00190">190</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  190</span>                                                                                                              {</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>    <span class="comment">// RL: dist.trancheExpectedValue() using x = dist.average(i)</span></div>
<div class="line"><span class="lineno">  193</span>    <span class="comment">// FIXME: some remaining inaccuracy in dist.cumulativeDensity(detachAmount_)</span></div>
<div class="line"><span class="lineno">  194</span>    QuantLib::Real expectedLoss = 0;</div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">for</span> (QuantLib::Size i = 0; i &lt; dist.size(); i++) {</div>
<div class="line"><span class="lineno">  196</span>        <span class="comment">// Real x = dist.x(i) + dist.dx(i)/2; // in QL distribution.cpp</span></div>
<div class="line"><span class="lineno">  197</span>        QuantLib::Real x = dist.average(i);</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">if</span> (x &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>)</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  200</span>        <span class="keywordflow">if</span> (x &gt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>)</div>
<div class="line"><span class="lineno">  201</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  202</span>        expectedLoss += (x - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>) * dist.dx(i) * dist.density(i);</div>
<div class="line"><span class="lineno">  203</span>    }</div>
<div class="line"><span class="lineno">  204</span>    expectedLoss += (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a> - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>) * (1.0 - dist.cumulativeDensity(<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>));</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">return</span> expectedLoss;</div>
<div class="line"><span class="lineno">  207</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a54892f52f239cc5d03574c990cfd953e" name="a54892f52f239cc5d03574c990cfd953e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54892f52f239cc5d03574c990cfd953e">&#9670;&#160;</a></span>expectedTrancheLoss2()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real expectedTrancheLoss2 </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Date &amp;&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array &amp;&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Array &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00210">210</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  210</span>                                                                                                                          {</div>
<div class="line"><span class="lineno">  211</span>    <span class="comment">// QL_REQUIRE(A.back() &gt; detachAmount_, &quot;A grid (max &quot; &lt;&lt; A.back() &lt;&lt; &quot;) does not cover the tranche with D &quot; &lt;&lt; detachAmount_);</span></div>
<div class="line"><span class="lineno">  212</span>    QuantLib::Real expectedLoss = 0;</div>
<div class="line"><span class="lineno">  213</span>    QuantLib::Real cumulative = 0.0;</div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">for</span> (QuantLib::Size i = 0; i &lt; p.size(); i++) {</div>
<div class="line"><span class="lineno">  215</span>        QuantLib::Real x = A[i];</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">if</span> (x &lt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>)</div>
<div class="line"><span class="lineno">  217</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  218</span>        <span class="keywordflow">if</span> (x &gt; <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a>)</div>
<div class="line"><span class="lineno">  219</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  220</span>        expectedLoss += (x - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>) * p[i];</div>
<div class="line"><span class="lineno">  221</span>        cumulative += p[i];</div>
<div class="line"><span class="lineno">  222</span>    }</div>
<div class="line"><span class="lineno">  223</span>    expectedLoss += (<a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#a766a8ec9bc4218277c3952d6daa0f617">detachAmount_</a> - <a class="code hl_variable" href="class_quant_ext_1_1_pool_loss_model.html#aee49d9c1705a50aa39e4dcca30dd217d">attachAmount_</a>) * (1.0 - cumulative);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">return</span> expectedLoss;</div>
<div class="line"><span class="lineno">  226</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a79770d5f32e46682c253ef80bdfc3089" name="a79770d5f32e46682c253ef80bdfc3089"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79770d5f32e46682c253ef80bdfc3089">&#9670;&#160;</a></span>homogeneous_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> homogeneous_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00062">62</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a4cbb119824187d20661ec6bbbc89783f" name="a4cbb119824187d20661ec6bbbc89783f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cbb119824187d20661ec6bbbc89783f">&#9670;&#160;</a></span>copula_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt;<a class="el" href="class_quant_ext_1_1_extended_constant_loss_latent_model.html">ExtendedConstantLossLatentModel</a>&lt;CopulaPolicy&gt; &gt; copula_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00063">63</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a8822243ef33624945d05cd9c0a28131b" name="a8822243ef33624945d05cd9c0a28131b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8822243ef33624945d05cd9c0a28131b">&#9670;&#160;</a></span>nBuckets_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Size nBuckets_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00064">64</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="ad2117640b2ae0fb37cbcd0a772f3faed" name="ad2117640b2ae0fb37cbcd0a772f3faed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2117640b2ae0fb37cbcd0a772f3faed">&#9670;&#160;</a></span>max_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real max_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00065">65</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="aa22410dd68789741c7b7ccb92102d839" name="aa22410dd68789741c7b7ccb92102d839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa22410dd68789741c7b7ccb92102d839">&#9670;&#160;</a></span>min_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real min_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00066">66</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="ac2845f523a2505fda08950c27c4ec669" name="ac2845f523a2505fda08950c27c4ec669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2845f523a2505fda08950c27c4ec669">&#9670;&#160;</a></span>nSteps_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Size nSteps_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00067">67</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="ae045e9d913072f2c975f9973baf55bb5" name="ae045e9d913072f2c975f9973baf55bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae045e9d913072f2c975f9973baf55bb5">&#9670;&#160;</a></span>useQuadrature_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> useQuadrature_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00068">68</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="adc56c9fde286a537dd8549dfef28b316" name="adc56c9fde286a537dd8549dfef28b316"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc56c9fde286a537dd8549dfef28b316">&#9670;&#160;</a></span>useStochasticRecovery_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> useStochasticRecovery_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00069">69</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="ae58506946f0336b11a13b2ca8d34618c" name="ae58506946f0336b11a13b2ca8d34618c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae58506946f0336b11a13b2ca8d34618c">&#9670;&#160;</a></span>delta_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real delta_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00071">71</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a4685e13deea1215c07aea25da562cc0f" name="a4685e13deea1215c07aea25da562cc0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4685e13deea1215c07aea25da562cc0f">&#9670;&#160;</a></span>attach_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real attach_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00072">72</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="aba71445f54d3be201419433fbe74e5b4" name="aba71445f54d3be201419433fbe74e5b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba71445f54d3be201419433fbe74e5b4">&#9670;&#160;</a></span>detach_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real detach_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00073">73</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a76a964fe80484e876801c542c2bf1af0" name="a76a964fe80484e876801c542c2bf1af0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76a964fe80484e876801c542c2bf1af0">&#9670;&#160;</a></span>notional_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real notional_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00074">74</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="aee49d9c1705a50aa39e4dcca30dd217d" name="aee49d9c1705a50aa39e4dcca30dd217d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee49d9c1705a50aa39e4dcca30dd217d">&#9670;&#160;</a></span>attachAmount_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real attachAmount_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00075">75</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a766a8ec9bc4218277c3952d6daa0f617" name="a766a8ec9bc4218277c3952d6daa0f617"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a766a8ec9bc4218277c3952d6daa0f617">&#9670;&#160;</a></span>detachAmount_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::Real detachAmount_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00076">76</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a4df46222b996042c01d175461eddfd86" name="a4df46222b996042c01d175461eddfd86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4df46222b996042c01d175461eddfd86">&#9670;&#160;</a></span>notionals_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;QuantLib::Real&gt; notionals_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00077">77</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="ac9616b020a89df7eaed6ef2721fd5951" name="ac9616b020a89df7eaed6ef2721fd5951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9616b020a89df7eaed6ef2721fd5951">&#9670;&#160;</a></span>lgd_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;QuantLib::Real&gt; lgd_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00080">80</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a8b8ac802486508f92b8f6b48e3fa4dd2" name="a8b8ac802486508f92b8f6b48e3fa4dd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b8ac802486508f92b8f6b48e3fa4dd2">&#9670;&#160;</a></span>q_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;QuantLib::Real&gt; &gt; q_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00082">82</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="aee358de80ce355a4192ec52fb01d8dee" name="aee358de80ce355a4192ec52fb01d8dee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee358de80ce355a4192ec52fb01d8dee">&#9670;&#160;</a></span>c_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;QuantLib::Real&gt; &gt; c_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00084">84</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="aaa33ee29d498e441e6c451b4cd0c3e37" name="aaa33ee29d498e441e6c451b4cd0c3e37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa33ee29d498e441e6c451b4cd0c3e37">&#9670;&#160;</a></span>lgdVV_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;QuantLib::Real&gt; &gt; lgdVV_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00086">86</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
<a id="a02d8974b63a121ca2bd39a0f41728b17" name="a02d8974b63a121ca2bd39a0f41728b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02d8974b63a121ca2bd39a0f41728b17">&#9670;&#160;</a></span>cprVV_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;QuantLib::Real&gt; &gt; cprVV_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="poollossmodel_8hpp_source.html#l00088">88</a> of file <a class="el" href="poollossmodel_8hpp_source.html">poollossmodel.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
