<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<title>QuantExt: DiscountingRiskyBondEngine Class Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantextextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="http://opensourcerisk.org">
       <img src="logo-qle@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Reference manual - version 1.7</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_quant_ext.html">QuantExt</a></li><li class="navelem"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html">DiscountingRiskyBondEngine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_quant_ext_1_1_discounting_risky_bond_engine-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DiscountingRiskyBondEngine Class Reference<div class="ingroups"><a class="el" href="group__engines.html">Pricing engines</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Discounting Risky Bond Engine.  
 <a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="discountingriskybondengine_8hpp_source.html">qle/pricingengines/discountingriskybondengine.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for DiscountingRiskyBondEngine:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine__inherit__graph.png" border="0" usemap="#a_discounting_risky_bond_engine_inherit__map" alt="Inheritance graph"/></div>
<map name="_discounting_risky_bond_engine_inherit__map" id="a_discounting_risky_bond_engine_inherit__map">
<area shape="rect" title="Discounting Risky Bond Engine." alt="" coords="5,131,219,384"/>
<area shape="rect" title=" " alt="" coords="82,5,142,83"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for DiscountingRiskyBondEngine:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine__coll__graph.png" border="0" usemap="#a_discounting_risky_bond_engine_coll__map" alt="Collaboration graph"/></div>
<map name="_discounting_risky_bond_engine_coll__map" id="a_discounting_risky_bond_engine_coll__map">
<area shape="rect" title="Discounting Risky Bond Engine." alt="" coords="251,175,465,355"/>
<area shape="rect" title=" " alt="" coords="5,13,65,90"/>
<area shape="rect" title=" " alt="" coords="90,13,149,90"/>
<area shape="rect" title=" " alt="" coords="195,13,310,90"/>
<area shape="rect" title=" " alt="" coords="350,13,547,90"/>
<area shape="rect" title=" " alt="" coords="572,5,747,97"/>
<area shape="rect" title=" " alt="" coords="771,13,892,90"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_quant_ext_1_1_discounting_risky_bond_engine_1_1_bond_n_p_v_calculation_results.html">BondNPVCalculationResults</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6a4ebc9daf97a8e099643292e5474d07"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6a4ebc9daf97a8e099643292e5474d07">DiscountingRiskyBondEngine</a> (const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a>, const Handle&lt; DefaultProbabilityTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aca3e50f26c15f1e0d744af684f43dbef">defaultCurve</a>, const Handle&lt; Quote &gt; &amp;<a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a14aa5972d60f869babbd6713af1ad6c1">recoveryRate</a>, const Handle&lt; Quote &gt; &amp;<a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a>, Period timestepPeriod, boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt; includeSettlementDateFlows=boost::none)</td></tr>
<tr class="separator:a6a4ebc9daf97a8e099643292e5474d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc849f94b4d0e7d2045628dea02cb2f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc849f94b4d0e7d2045628dea02cb2f0">DiscountingRiskyBondEngine</a> (const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a>, const Handle&lt; Quote &gt; &amp;<a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a>, Period timestepPeriod, boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt; includeSettlementDateFlows=boost::none)</td></tr>
<tr class="memdesc:acc849f94b4d0e7d2045628dea02cb2f0"><td class="mdescLeft">&#160;</td><td class="mdescRight">alternative constructor (does not require default curve or recovery rate)  <a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc849f94b4d0e7d2045628dea02cb2f0">More...</a><br /></td></tr>
<tr class="separator:acc849f94b4d0e7d2045628dea02cb2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61eb1a24e5329ccc296715a40dc3a19a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a61eb1a24e5329ccc296715a40dc3a19a">calculate</a> () const override</td></tr>
<tr class="separator:a61eb1a24e5329ccc296715a40dc3a19a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ddcf0f8e167ada5d282e83b31f6228b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_quant_ext_1_1_discounting_risky_bond_engine_1_1_bond_n_p_v_calculation_results.html">BondNPVCalculationResults</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6ddcf0f8e167ada5d282e83b31f6228b">calculateNpv</a> (const Date &amp;npvDate, const Date &amp;settlementDate, const Leg &amp;cashflows, boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt; includeSettlementDateFlows=boost::none, const Handle&lt; YieldTermStructure &gt; &amp;incomeCurve=Handle&lt; YieldTermStructure &gt;(), const <a class="el" href="classbool.html">bool</a> conditionalOnSurvival=true, const <a class="el" href="classbool.html">bool</a> additionalResults=true) const</td></tr>
<tr class="separator:a6ddcf0f8e167ada5d282e83b31f6228b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf8367f628c8d43c4c5854f7dc121663"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a> () const</td></tr>
<tr class="separator:aaf8367f628c8d43c4c5854f7dc121663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca3e50f26c15f1e0d744af684f43dbef"><td class="memItemLeft" align="right" valign="top">Handle&lt; DefaultProbabilityTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aca3e50f26c15f1e0d744af684f43dbef">defaultCurve</a> () const</td></tr>
<tr class="separator:aca3e50f26c15f1e0d744af684f43dbef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14aa5972d60f869babbd6713af1ad6c1"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a14aa5972d60f869babbd6713af1ad6c1">recoveryRate</a> () const</td></tr>
<tr class="separator:a14aa5972d60f869babbd6713af1ad6c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e6b1bd8b11e4bfce12dafb2e6c8081b"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a> () const</td></tr>
<tr class="separator:a6e6b1bd8b11e4bfce12dafb2e6c8081b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a188f6df4c42679c1c133919254e351c5"><td class="memItemLeft" align="right" valign="top">Handle&lt; YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a></td></tr>
<tr class="separator:a188f6df4c42679c1c133919254e351c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc213ca558c2cfd047dbced63bcab643"><td class="memItemLeft" align="right" valign="top">Handle&lt; DefaultProbabilityTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a></td></tr>
<tr class="separator:acc213ca558c2cfd047dbced63bcab643"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7ab2e6ca0ab7b7fdd155f4950b7b3d6"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a></td></tr>
<tr class="separator:af7ab2e6ca0ab7b7fdd155f4950b7b3d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9f2d5e2a13d8859dba622b489d87acf"><td class="memItemLeft" align="right" valign="top">Handle&lt; Quote &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a></td></tr>
<tr class="separator:aa9f2d5e2a13d8859dba622b489d87acf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98b1c0a79058e04946119ae151b09e52"><td class="memItemLeft" align="right" valign="top">Period&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a98b1c0a79058e04946119ae151b09e52">timestepPeriod_</a></td></tr>
<tr class="separator:a98b1c0a79058e04946119ae151b09e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c03bc11ff086bfab1c39eb1409e968a"><td class="memItemLeft" align="right" valign="top">boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a4c03bc11ff086bfab1c39eb1409e968a">includeSettlementDateFlows_</a></td></tr>
<tr class="separator:a4c03bc11ff086bfab1c39eb1409e968a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Discounting Risky Bond Engine. </p>
<p>WARNING: Only covers Vanilla coupon bonds (floating and fixed rate), and Zero Bonds (one cashflow, a redemption at maturity).</p>
<p>This class implements pricing of Risky Bonds by discounting the future nominal cash flows using the respective yield curves, and probability of survival. The nominal recovered in case of default is calculated as recovery rate times the integral of probability of default until maturity date. For coupon bonds the coupon periods are taken as the time step for integration, for a zero bond the time step period provided is used. </p>

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00051">51</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6a4ebc9daf97a8e099643292e5474d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a4ebc9daf97a8e099643292e5474d07">&#9670;&nbsp;</a></span>DiscountingRiskyBondEngine() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html">DiscountingRiskyBondEngine</a> </td>
          <td>(</td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>discountCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; DefaultProbabilityTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>defaultCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; Quote &gt; &amp;&#160;</td>
          <td class="paramname"><em>recoveryRate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; Quote &gt; &amp;&#160;</td>
          <td class="paramname"><em>securitySpread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Period&#160;</td>
          <td class="paramname"><em>timestepPeriod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt;&#160;</td>
          <td class="paramname"><em>includeSettlementDateFlows</em> = <code>boost::none</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8cpp_source.html#l00035">35</a> of file <a class="el" href="discountingriskybondengine_8cpp_source.html">discountingriskybondengine.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aca3e50f26c15f1e0d744af684f43dbef">defaultCurve</a>), <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a14aa5972d60f869babbd6713af1ad6c1">recoveryRate</a>), <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a>),</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a98b1c0a79058e04946119ae151b09e52">timestepPeriod_</a>(timestepPeriod), <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a4c03bc11ff086bfab1c39eb1409e968a">includeSettlementDateFlows_</a>(includeSettlementDateFlows) {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a> =</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>.empty()</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            ? <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            : Handle&lt;YieldTermStructure&gt;(boost::make_shared&lt;ZeroSpreadedTermStructure&gt;(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a>, <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a>));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    registerWith(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    registerWith(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    registerWith(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    registerWith(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_a6a4ebc9daf97a8e099643292e5474d07_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_a6a4ebc9daf97a8e099643292e5474d07_cgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_a6a4ebc9daf97a8e099643292e5474d07_cgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_a6a4ebc9daf97a8e099643292e5474d07_cgraph">
<area shape="rect" title=" " alt="" coords="5,31,199,57"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663" title=" " alt="" coords="250,5,353,32"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b" title=" " alt="" coords="247,56,356,83"/>
</map>
</div>

</div>
</div>
<a id="acc849f94b4d0e7d2045628dea02cb2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc849f94b4d0e7d2045628dea02cb2f0">&#9670;&nbsp;</a></span>DiscountingRiskyBondEngine() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_discounting_risky_bond_engine.html">DiscountingRiskyBondEngine</a> </td>
          <td>(</td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>discountCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; Quote &gt; &amp;&#160;</td>
          <td class="paramname"><em>securitySpread</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Period&#160;</td>
          <td class="paramname"><em>timestepPeriod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt;&#160;</td>
          <td class="paramname"><em>includeSettlementDateFlows</em> = <code>boost::none</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>alternative constructor (does not require default curve or recovery rate) </p>

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8cpp_source.html#l00052">52</a> of file <a class="el" href="discountingriskybondengine_8cpp_source.html">discountingriskybondengine.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a>), <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a98b1c0a79058e04946119ae151b09e52">timestepPeriod_</a>(timestepPeriod),</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a4c03bc11ff086bfab1c39eb1409e968a">includeSettlementDateFlows_</a>(includeSettlementDateFlows) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a> =</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>.empty()</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            ? <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            : Handle&lt;YieldTermStructure&gt;(boost::make_shared&lt;ZeroSpreadedTermStructure&gt;(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">discountCurve</a>, <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">securitySpread</a>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    registerWith(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    registerWith(<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;}</div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_acc849f94b4d0e7d2045628dea02cb2f0_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_acc849f94b4d0e7d2045628dea02cb2f0_cgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_acc849f94b4d0e7d2045628dea02cb2f0_cgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_acc849f94b4d0e7d2045628dea02cb2f0_cgraph">
<area shape="rect" title="alternative constructor (does not require default curve or recovery rate)" alt="" coords="5,31,199,57"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663" title=" " alt="" coords="250,5,353,32"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b" title=" " alt="" coords="247,56,356,83"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a61eb1a24e5329ccc296715a40dc3a19a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61eb1a24e5329ccc296715a40dc3a19a">&#9670;&nbsp;</a></span>calculate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void calculate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8cpp_source.html#l00065">65</a> of file <a class="el" href="discountingriskybondengine_8cpp_source.html">discountingriskybondengine.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                                                 {</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    QL_REQUIRE(!<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>.empty(), <span class="stringliteral">&quot;discounting term structure handle is empty&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.valuationDate = (*discountCurve_)-&gt;referenceDate();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// the npv as of today, excluding cashflows before the settlement date</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    DiscountingRiskyBondEngine::BondNPVCalculationResults npvResults = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6ddcf0f8e167ada5d282e83b31f6228b">calculateNpv</a>(</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.valuationDate, <a class="code" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.settlementDate, <a class="code" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.cashflows, <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a4c03bc11ff086bfab1c39eb1409e968a">includeSettlementDateFlows_</a>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// the results value is set to the npv as of today including the cashflows before settlement</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.value = npvResults.npv + npvResults.cashflowsBeforeSettlementValue;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// the settlement value is excluding cashflows before the settlement date and compounded to the settlement date</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.settlementValue = npvResults.npv * npvResults.compoundFactorSettlement;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// set a few more additional results</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;cashFlowResults&quot;</span>] = npvResults.cashflowResults;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;securitySpread&quot;</span>] = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>.empty() ? 0.0 : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>-&gt;value();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    Date maturity = CashFlows::maturityDate(<a class="code" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.cashflows);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">if</span> (maturity &gt; <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.valuationDate) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        Real t = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;timeFromReference(maturity);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;maturityTime&quot;</span>] = t;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;maturityDiscountFactor&quot;</span>] = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(t);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;maturitySurvivalProb&quot;</span>] =</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>.empty() ? 1.0 : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>-&gt;survivalProbability(t);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;recoveryRate&quot;</span>] = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>.empty() ? 0.0 : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>-&gt;value();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
</div><!-- fragment --><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_a61eb1a24e5329ccc296715a40dc3a19a_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_a61eb1a24e5329ccc296715a40dc3a19a_cgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_a61eb1a24e5329ccc296715a40dc3a19a_cgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_a61eb1a24e5329ccc296715a40dc3a19a_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,80,149"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6ddcf0f8e167ada5d282e83b31f6228b" title=" " alt="" coords="128,122,223,149"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="300,71,465,98"/>
<area shape="rect" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453" title=" " alt="" coords="271,122,495,149"/>
<area shape="rect" href="namespace_quant_ext.html#aab05fc09e27810d115c15f154b1f3e92" title=" " alt="" coords="287,173,478,215"/>
<area shape="rect" href="namespace_quant_ext.html#add3300ddd9893a167192eba16765ebd3" title=" " alt="" coords="543,13,763,39"/>
<area shape="rect" href="struct_quant_ext_1_1_random_variable.html#adaeda39d7b8cc716a40c4da65b00ba77" title=" " alt="" coords="563,64,743,105"/>
<area shape="rect" href="struct_quant_ext_1_1_filter.html#a01793e46383e06a07b036f52b3efec09" title=" " alt="" coords="583,130,723,157"/>
<area shape="rect" href="struct_quant_ext_1_1_random_variable.html#acce0ab2cacc475b2434f24c65c91685a" title=" " alt="" coords="563,181,743,223"/>
<area shape="rect" href="struct_quant_ext_1_1_random_variable.html#a769e6c6c6680ce0b532bc4efa48db44f" title=" " alt="" coords="811,5,991,47"/>
<area shape="rect" href="struct_quant_ext_1_1_filter.html#abba907f9ff1c67082fba469156a9b30a" title=" " alt="" coords="819,130,983,157"/>
<area shape="rect" href="struct_quant_ext_1_1_filter.html#acce0ab2cacc475b2434f24c65c91685a" title=" " alt="" coords="1039,130,1185,157"/>
</map>
</div>

</div>
</div>
<a id="a6ddcf0f8e167ada5d282e83b31f6228b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ddcf0f8e167ada5d282e83b31f6228b">&#9670;&nbsp;</a></span>calculateNpv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_quant_ext_1_1_discounting_risky_bond_engine_1_1_bond_n_p_v_calculation_results.html">DiscountingRiskyBondEngine::BondNPVCalculationResults</a> calculateNpv </td>
          <td>(</td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"><em>npvDate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"><em>settlementDate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Leg &amp;&#160;</td>
          <td class="paramname"><em>cashflows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">boost::optional&lt; <a class="el" href="classbool.html">bool</a> &gt;&#160;</td>
          <td class="paramname"><em>includeSettlementDateFlows</em> = <code>boost::none</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>incomeCurve</em> = <code>Handle&lt;YieldTermStructure&gt;()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>conditionalOnSurvival</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>additionalResults</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the npv, compoundFactorSettlement, cashflowsBeforeSettlementValue and the additional CashflowResults as of the npvDate including cashflows eligible w.r.t. the given settlement date</p><ul>
<li>If conditionalOnSurvival is set to true, the npv is computed conditional on the survival until the npvDate, otherwise the npv is including the default probability between today and the npvDate</li>
<li>If an incomeCurve is given, this is used to compound the npv from today to the npvDate, otherwise the curve built in the engine as discount curve + security Spread is used. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8cpp_source.html#l00097">97</a> of file <a class="el" href="discountingriskybondengine_8cpp_source.html">discountingriskybondengine.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                                                                                               {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keywordtype">bool</span> includeRefDateFlows =</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        includeSettlementDateFlows ? *<a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a4c03bc11ff086bfab1c39eb1409e968a">includeSettlementDateFlows_</a> : Settings::instance().includeReferenceDateEvents();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    Real npvValue = 0.0;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    DiscountingRiskyBondEngine::BondNPVCalculationResults calculationResults;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    calculationResults.cashflowsBeforeSettlementValue = 0.0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// handle case where we wish to price simply with benchmark curve and scalar security spread</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// i.e. credit curve term structure (and recovery) have not been specified</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// we set the default probability and recovery rate to zero in this instance (issuer credit worthiness already</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// captured within security spread)</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    boost::shared_ptr&lt;DefaultProbabilityTermStructure&gt; creditCurvePtr =</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>.empty()</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            ? boost::make_shared&lt;QuantLib::FlatHazardRate&gt;(<a class="code" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.valuationDate, 0.0, <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;dayCounter())</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>.currentLink();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    Rate recoveryVal = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>.empty() ? 0.0 : <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>-&gt;value();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// compounding factors for npv date</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    Real dfNpv = incomeCurve.empty() ? <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(npvDate) : incomeCurve-&gt;discount(npvDate);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    Real spNpv = conditionalOnSurvival ? creditCurvePtr-&gt;survivalProbability(npvDate) : 1.0;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="comment">// compound factors for settlement date</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    Real dfSettl =</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        incomeCurve.empty() ? <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(settlementDate) : incomeCurve-&gt;discount(settlementDate);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    Real spSettl = creditCurvePtr-&gt;survivalProbability(settlementDate);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span> (!conditionalOnSurvival)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        spSettl /= creditCurvePtr-&gt;survivalProbability(npvDate);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// effective compound factor to get settlement npv from npv date npv</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    calculationResults.compoundFactorSettlement = (dfNpv * spNpv) / (dfSettl * spSettl);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    Size numCoupons = 0;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">bool</span> hasLiveCashFlow = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">for</span> (Size i = 0; i &lt; cashflows.size(); i++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        boost::shared_ptr&lt;CashFlow&gt; cf = cashflows[i];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">if</span> (cf-&gt;hasOccurred(npvDate, includeRefDateFlows))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        hasLiveCashFlow = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        DiscountFactor df = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(cf-&gt;date()) / dfNpv;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="comment">// Coupon value is discounted future payment times the survival probability</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        Probability S = creditCurvePtr-&gt;survivalProbability(cf-&gt;date()) / spNpv;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        Real tmp = cf-&gt;amount() * S * df;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">if</span> (!cf-&gt;hasOccurred(settlementDate, includeRefDateFlows))</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            npvValue += tmp;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            calculationResults.cashflowsBeforeSettlementValue += tmp;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">/* The amount recovered in the case of default is the recoveryrate*Notional*Probability of</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">           Default; this is added to the NPV value. For coupon bonds the coupon periods are taken</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">           as the timesteps for integrating over the probability of default.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">        */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (additionalResults) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            CashFlowResults cfRes = <a class="code" href="namespace_quant_ext.html#aab05fc09e27810d115c15f154b1f3e92">populateCashFlowResultsFromCashflow</a>(cf);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            cfRes.discountFactor = S * df;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            cfRes.presentValue = cfRes.amount * cfRes.discountFactor;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            calculationResults.cashflowResults.push_back(cfRes);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        boost::shared_ptr&lt;Coupon&gt; coupon = boost::dynamic_pointer_cast&lt;Coupon&gt;(cf);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (coupon) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            numCoupons++;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            Date startDate = coupon-&gt;accrualStartDate();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            Date endDate = coupon-&gt;accrualEndDate();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            Date effectiveStartDate = (startDate &lt;= npvDate &amp;&amp; npvDate &lt;= endDate) ? npvDate : startDate;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            Date defaultDate = effectiveStartDate + (endDate - effectiveStartDate) / 2;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            Probability <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> = creditCurvePtr-&gt;defaultProbability(effectiveStartDate, endDate) / spNpv;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            Real expectedRecoveryAmount = coupon-&gt;nominal() * recoveryVal;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            DiscountFactor recoveryDiscountFactor = <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(defaultDate) / dfNpv;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordflow">if</span> (additionalResults &amp;&amp; !<a class="code" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(expectedRecoveryAmount * <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> * recoveryDiscountFactor, 0.0)) {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                <span class="comment">// Add a new flow for the expected recovery conditional on the default during</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                CashFlowResults recoveryResult;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                recoveryResult.amount = expectedRecoveryAmount;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                recoveryResult.payDate = defaultDate;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                recoveryResult.currency = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                recoveryResult.discountFactor = <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> * recoveryDiscountFactor;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                recoveryResult.presentValue = recoveryResult.discountFactor * recoveryResult.amount;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                recoveryResult.type = <span class="stringliteral">&quot;ExpectedRecovery&quot;</span>;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                calculationResults.cashflowResults.push_back(recoveryResult);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            npvValue += expectedRecoveryAmount * <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> * recoveryDiscountFactor;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// the ql instrument might not yet be expired and still have not anything to value if</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// the npvDate &gt; evaluation date</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">if</span> (!hasLiveCashFlow) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        calculationResults.npv = 0.0;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">return</span> calculationResults;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">if</span> (cashflows.size() &gt; 1 &amp;&amp; numCoupons == 0) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        QL_FAIL(<span class="stringliteral">&quot;DiscountingRiskyBondEngine does not support bonds with multiple cashflows but no coupons&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">/* If there are no coupon, as in a Zero Bond, we must integrate over the entire period from npv date to</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">       maturity. The timestepPeriod specified is used as provide the steps for the integration. This only applies</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">       to bonds with 1 cashflow, identified as a final redemption payment.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (cashflows.size() == 1) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        boost::shared_ptr&lt;Redemption&gt; redemption = boost::dynamic_pointer_cast&lt;Redemption&gt;(cashflows[0]);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">if</span> (redemption) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            Date startDate = npvDate;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="keywordflow">while</span> (startDate &lt; redemption-&gt;date()) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                Date stepDate = startDate + <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a98b1c0a79058e04946119ae151b09e52">timestepPeriod_</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                Date endDate = (stepDate &gt; redemption-&gt;date()) ? redemption-&gt;date() : stepDate;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                Date defaultDate = startDate + (endDate - startDate) / 2;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                Probability <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> = creditCurvePtr-&gt;defaultProbability(startDate, endDate) / spNpv;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                <span class="keywordflow">if</span> (additionalResults) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    CashFlowResults recoveryResult;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    recoveryResult.amount = redemption-&gt;amount() * recoveryVal;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    recoveryResult.payDate = defaultDate;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    recoveryResult.currency = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    recoveryResult.discountFactor = <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> * <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(defaultDate) / dfNpv;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    recoveryResult.presentValue = recoveryResult.discountFactor * recoveryResult.amount;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                    recoveryResult.type = <span class="stringliteral">&quot;ExpectedRecovery&quot;</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                    calculationResults.cashflowResults.push_back(recoveryResult);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                npvValue += redemption-&gt;amount() * recoveryVal * <a class="code" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">P</a> * <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>-&gt;discount(defaultDate) / dfNpv;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                startDate = stepDate;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    calculationResults.npv = npvValue;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">return</span> calculationResults;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;} <span class="comment">// namespace QuantExt</span></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_cgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_cgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_cgraph">
<area shape="rect" title=" " alt="" coords="5,122,100,149"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="177,71,343,98"/>
<area shape="rect" href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453" title=" " alt="" coords="148,122,372,149"/>
<area shape="rect" href="namespace_quant_ext.html#aab05fc09e27810d115c15f154b1f3e92" title=" " alt="" coords="165,173,355,215"/>
<area shape="rect" href="namespace_quant_ext.html#add3300ddd9893a167192eba16765ebd3" title=" " alt="" coords="420,13,640,39"/>
<area shape="rect" href="struct_quant_ext_1_1_random_variable.html#adaeda39d7b8cc716a40c4da65b00ba77" title=" " alt="" coords="440,64,620,105"/>
<area shape="rect" href="struct_quant_ext_1_1_filter.html#a01793e46383e06a07b036f52b3efec09" title=" " alt="" coords="460,130,600,157"/>
<area shape="rect" href="struct_quant_ext_1_1_random_variable.html#acce0ab2cacc475b2434f24c65c91685a" title=" " alt="" coords="440,181,620,223"/>
<area shape="rect" href="struct_quant_ext_1_1_random_variable.html#a769e6c6c6680ce0b532bc4efa48db44f" title=" " alt="" coords="688,5,868,47"/>
<area shape="rect" href="struct_quant_ext_1_1_filter.html#abba907f9ff1c67082fba469156a9b30a" title=" " alt="" coords="696,130,860,157"/>
<area shape="rect" href="struct_quant_ext_1_1_filter.html#acce0ab2cacc475b2434f24c65c91685a" title=" " alt="" coords="916,130,1063,157"/>
</map>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_icgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_icgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_a6ddcf0f8e167ada5d282e83b31f6228b_icgraph">
<area shape="rect" title=" " alt="" coords="128,5,223,32"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a61eb1a24e5329ccc296715a40dc3a19a" title=" " alt="" coords="5,5,80,32"/>
</map>
</div>

</div>
</div>
<a id="aaf8367f628c8d43c4c5854f7dc121663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf8367f628c8d43c4c5854f7dc121663">&#9670;&nbsp;</a></span>discountCurve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;YieldTermStructure&gt; discountCurve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00087">87</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">discountCurve_</a>; };</div>
</div><!-- fragment --><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_aaf8367f628c8d43c4c5854f7dc121663_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_aaf8367f628c8d43c4c5854f7dc121663_icgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_aaf8367f628c8d43c4c5854f7dc121663_icgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_aaf8367f628c8d43c4c5854f7dc121663_icgraph">
<area shape="rect" title=" " alt="" coords="247,5,349,32"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6a4ebc9daf97a8e099643292e5474d07" title=" " alt="" coords="5,5,199,32"/>
</map>
</div>

</div>
</div>
<a id="aca3e50f26c15f1e0d744af684f43dbef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca3e50f26c15f1e0d744af684f43dbef">&#9670;&nbsp;</a></span>defaultCurve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;DefaultProbabilityTermStructure&gt; defaultCurve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00088">88</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">defaultCurve_</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14aa5972d60f869babbd6713af1ad6c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14aa5972d60f869babbd6713af1ad6c1">&#9670;&nbsp;</a></span>recoveryRate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;Quote&gt; recoveryRate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00089">89</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">recoveryRate_</a>; };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e6b1bd8b11e4bfce12dafb2e6c8081b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e6b1bd8b11e4bfce12dafb2e6c8081b">&#9670;&nbsp;</a></span>securitySpread()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;Quote&gt; securitySpread </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00090">90</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">securitySpread_</a>; };</div>
</div><!-- fragment --><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_discounting_risky_bond_engine_a6e6b1bd8b11e4bfce12dafb2e6c8081b_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_discounting_risky_bond_engine_a6e6b1bd8b11e4bfce12dafb2e6c8081b_icgraph" alt=""/></div>
<map name="class_quant_ext_1_1_discounting_risky_bond_engine_a6e6b1bd8b11e4bfce12dafb2e6c8081b_icgraph" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_a6e6b1bd8b11e4bfce12dafb2e6c8081b_icgraph">
<area shape="rect" title=" " alt="" coords="247,5,356,32"/>
<area shape="rect" href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6a4ebc9daf97a8e099643292e5474d07" title=" " alt="" coords="5,5,199,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a188f6df4c42679c1c133919254e351c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a188f6df4c42679c1c133919254e351c5">&#9670;&nbsp;</a></span>discountCurve_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;YieldTermStructure&gt; discountCurve_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00093">93</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>

</div>
</div>
<a id="acc213ca558c2cfd047dbced63bcab643"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc213ca558c2cfd047dbced63bcab643">&#9670;&nbsp;</a></span>defaultCurve_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;DefaultProbabilityTermStructure&gt; defaultCurve_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00094">94</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>

</div>
</div>
<a id="af7ab2e6ca0ab7b7fdd155f4950b7b3d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">&#9670;&nbsp;</a></span>recoveryRate_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;Quote&gt; recoveryRate_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00095">95</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>

</div>
</div>
<a id="aa9f2d5e2a13d8859dba622b489d87acf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9f2d5e2a13d8859dba622b489d87acf">&#9670;&nbsp;</a></span>securitySpread_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Handle&lt;Quote&gt; securitySpread_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00096">96</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>

</div>
</div>
<a id="a98b1c0a79058e04946119ae151b09e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98b1c0a79058e04946119ae151b09e52">&#9670;&nbsp;</a></span>timestepPeriod_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Period timestepPeriod_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00097">97</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>

</div>
</div>
<a id="a4c03bc11ff086bfab1c39eb1409e968a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c03bc11ff086bfab1c39eb1409e968a">&#9670;&nbsp;</a></span>includeSettlementDateFlows_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::optional&lt;<a class="el" href="classbool.html">bool</a>&gt; includeSettlementDateFlows_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="discountingriskybondengine_8hpp_source.html#l00098">98</a> of file <a class="el" href="discountingriskybondengine_8hpp_source.html">discountingriskybondengine.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_a6ddcf0f8e167ada5d282e83b31f6228b"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6ddcf0f8e167ada5d282e83b31f6228b">QuantExt::DiscountingRiskyBondEngine::calculateNpv</a></div><div class="ttdeci">BondNPVCalculationResults calculateNpv(const Date &amp;npvDate, const Date &amp;settlementDate, const Leg &amp;cashflows, boost::optional&lt; bool &gt; includeSettlementDateFlows=boost::none, const Handle&lt; YieldTermStructure &gt; &amp;incomeCurve=Handle&lt; YieldTermStructure &gt;(), const bool conditionalOnSurvival=true, const bool additionalResults=true) const</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8cpp_source.html#l00097">discountingriskybondengine.cpp:97</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_acc213ca558c2cfd047dbced63bcab643"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#acc213ca558c2cfd047dbced63bcab643">QuantExt::DiscountingRiskyBondEngine::defaultCurve_</a></div><div class="ttdeci">Handle&lt; DefaultProbabilityTermStructure &gt; defaultCurve_</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00094">discountingriskybondengine.hpp:94</a></div></div>
<div class="ttc" id="atenorbasisswap_8cpp_html_a71b2ce0e52885aca4ce15e1d128b9f56"><div class="ttname"><a href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a></div><div class="ttdeci">Swap::arguments * arguments_</div><div class="ttdef"><b>Definition:</b> <a href="tenorbasisswap_8cpp_source.html#l00059">tenorbasisswap.cpp:59</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_a4c03bc11ff086bfab1c39eb1409e968a"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a4c03bc11ff086bfab1c39eb1409e968a">QuantExt::DiscountingRiskyBondEngine::includeSettlementDateFlows_</a></div><div class="ttdeci">boost::optional&lt; bool &gt; includeSettlementDateFlows_</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00098">discountingriskybondengine.hpp:98</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_af7ab2e6ca0ab7b7fdd155f4950b7b3d6"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#af7ab2e6ca0ab7b7fdd155f4950b7b3d6">QuantExt::DiscountingRiskyBondEngine::recoveryRate_</a></div><div class="ttdeci">Handle&lt; Quote &gt; recoveryRate_</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00095">discountingriskybondengine.hpp:95</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_a1cab4fb6a720eff245acb9f3a7a9e7c5"><div class="ttname"><a href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">QuantExt::close_enough</a></div><div class="ttdeci">Filter close_enough(const RandomVariable &amp;x, const RandomVariable &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="qle_2math_2randomvariable_8cpp_source.html#l00475">randomvariable.cpp:475</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_a6e6b1bd8b11e4bfce12dafb2e6c8081b"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a6e6b1bd8b11e4bfce12dafb2e6c8081b">QuantExt::DiscountingRiskyBondEngine::securitySpread</a></div><div class="ttdeci">Handle&lt; Quote &gt; securitySpread() const</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00090">discountingriskybondengine.hpp:90</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_a98b1c0a79058e04946119ae151b09e52"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a98b1c0a79058e04946119ae151b09e52">QuantExt::DiscountingRiskyBondEngine::timestepPeriod_</a></div><div class="ttdeci">Period timestepPeriod_</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00097">discountingriskybondengine.hpp:97</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_aa9f2d5e2a13d8859dba622b489d87acf"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aa9f2d5e2a13d8859dba622b489d87acf">QuantExt::DiscountingRiskyBondEngine::securitySpread_</a></div><div class="ttdeci">Handle&lt; Quote &gt; securitySpread_</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00096">discountingriskybondengine.hpp:96</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_aab05fc09e27810d115c15f154b1f3e92"><div class="ttname"><a href="namespace_quant_ext.html#aab05fc09e27810d115c15f154b1f3e92">QuantExt::populateCashFlowResultsFromCashflow</a></div><div class="ttdeci">CashFlowResults populateCashFlowResultsFromCashflow(const boost::shared_ptr&lt; QuantLib::CashFlow &gt; &amp;c, const QuantLib::Real multiplier, const QuantLib::Size legNo, const QuantLib::Currency &amp;currency)</div><div class="ttdef"><b>Definition:</b> <a href="cashflowresults_8cpp_source.html#l00059">cashflowresults.cpp:59</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_a188f6df4c42679c1c133919254e351c5"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a188f6df4c42679c1c133919254e351c5">QuantExt::DiscountingRiskyBondEngine::discountCurve_</a></div><div class="ttdeci">Handle&lt; YieldTermStructure &gt; discountCurve_</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00093">discountingriskybondengine.hpp:90</a></div></div>
<div class="ttc" id="agroup__crossassetmodel_html_ga2375a1d308678b4669e09d55a05ed453"><div class="ttname"><a href="group__crossassetmodel.html#ga2375a1d308678b4669e09d55a05ed453">QuantExt::CrossAssetAnalytics::P</a></div><div class="ttdeci">const P2_&lt; E1, E2 &gt; P(const E1 &amp;e1, const E2 &amp;e2)</div><div class="ttdef"><b>Definition:</b> <a href="crossassetanalyticsbase_8hpp_source.html#l00090">crossassetanalyticsbase.hpp:90</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_a14aa5972d60f869babbd6713af1ad6c1"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#a14aa5972d60f869babbd6713af1ad6c1">QuantExt::DiscountingRiskyBondEngine::recoveryRate</a></div><div class="ttdeci">Handle&lt; Quote &gt; recoveryRate() const</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00089">discountingriskybondengine.hpp:89</a></div></div>
<div class="ttc" id="acdsoption_8cpp_html_afeb3e8b4e6ab6604c185b2ea55bbc728"><div class="ttname"><a href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a></div><div class="ttdeci">const Instrument::results * results_</div><div class="ttdef"><b>Definition:</b> <a href="cdsoption_8cpp_source.html#l00081">cdsoption.cpp:81</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_aca3e50f26c15f1e0d744af684f43dbef"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aca3e50f26c15f1e0d744af684f43dbef">QuantExt::DiscountingRiskyBondEngine::defaultCurve</a></div><div class="ttdeci">Handle&lt; DefaultProbabilityTermStructure &gt; defaultCurve() const</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00088">discountingriskybondengine.hpp:88</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_discounting_risky_bond_engine_html_aaf8367f628c8d43c4c5854f7dc121663"><div class="ttname"><a href="class_quant_ext_1_1_discounting_risky_bond_engine.html#aaf8367f628c8d43c4c5854f7dc121663">QuantExt::DiscountingRiskyBondEngine::discountCurve</a></div><div class="ttdeci">Handle&lt; YieldTermStructure &gt; discountCurve() const</div><div class="ttdef"><b>Definition:</b> <a href="discountingriskybondengine_8hpp_source.html#l00087">discountingriskybondengine.hpp:87</a></div></div>
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.8.20
</small></address>
</body>
</html>
