<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>QuantExt: SwaptionVolCube2 Class Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantextextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-qle@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.12</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_quant_ext.html">QuantExt</a></li><li class="navelem"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html">SwaptionVolCube2</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_quant_ext_1_1_swaption_vol_cube2-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">SwaptionVolCube2 Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="swaptionvolcube2_8hpp_source.html">qle/termstructures/swaptionvolcube2.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for SwaptionVolCube2:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_swaption_vol_cube2__inherit__graph.png" border="0" usemap="#a_swaption_vol_cube2_inherit__map" alt="Inheritance graph"/></div>
<map name="a_swaption_vol_cube2_inherit__map" id="a_swaption_vol_cube2_inherit__map">
<area shape="rect" title=" " alt="" coords="5,93,171,280"/>
<area shape="rect" href="class_swaption_volatility_cube.html" title=" " alt="" coords="9,5,167,45"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for SwaptionVolCube2:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_swaption_vol_cube2__coll__graph.png" border="0" usemap="#a_swaption_vol_cube2_coll__map" alt="Collaboration graph"/></div>
<map name="a_swaption_vol_cube2_coll__map" id="a_swaption_vol_cube2_coll__map">
<area shape="rect" title=" " alt="" coords="201,343,358,471"/>
<area shape="rect" href="class_swaption_volatility_cube.html" title=" " alt="" coords="5,211,164,251"/>
<area shape="rect" href="classbool.html" title=" " alt="" coords="189,211,239,251"/>
<area shape="rect" title=" " alt="" coords="263,211,434,251"/>
<area shape="rect" title=" " alt="" coords="209,108,321,148"/>
<area shape="rect" title=" " alt="" coords="399,108,490,148"/>
<area shape="rect" title=" " alt="" coords="459,211,579,251"/>
<area shape="rect" title=" " alt="" coords="425,5,464,45"/>
<area shape="rect" title=" " alt="" coords="571,108,633,148"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5eeb39292a81cd21a7d374566ac2e820"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5eeb39292a81cd21a7d374566ac2e820">SwaptionVolCube2</a> (const Handle&lt; <a class="el" href="class_swaption_volatility_structure.html">SwaptionVolatilityStructure</a> &gt; &amp;atmVolStructure, const std::vector&lt; Period &gt; &amp;optionTenors, const std::vector&lt; Period &gt; &amp;swapTenors, const std::vector&lt; Spread &gt; &amp;strikeSpreads, const std::vector&lt; std::vector&lt; Handle&lt; Quote &gt; &gt; &gt; &amp;<a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a9265f490327d80ae6df16cf49d26490b">volSpreads</a>, const QuantLib::ext::shared_ptr&lt; SwapIndex &gt; &amp;swapIndexBase, const QuantLib::ext::shared_ptr&lt; SwapIndex &gt; &amp;shortSwapIndexBase, <a class="el" href="classbool.html">bool</a> vegaWeightedSmileFit, <a class="el" href="classbool.html">bool</a> flatExtrapolation, <a class="el" href="classbool.html">bool</a> volsAreSpreads=true)</td></tr>
<tr class="separator:a5eeb39292a81cd21a7d374566ac2e820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">LazyObject interface</div></td></tr>
<tr class="memitem:a1127cccc9668a02247dc139d27121708"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a1127cccc9668a02247dc139d27121708">performCalculations</a> () const override</td></tr>
<tr class="separator:a1127cccc9668a02247dc139d27121708"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader">SwaptionVolatilityCube inspectors</h2></td></tr>
<tr class="memitem:acabc78bb5f6569d9712ad94e8dd49f85"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#acabc78bb5f6569d9712ad94e8dd49f85">flatExtrapolation_</a></td></tr>
<tr class="separator:acabc78bb5f6569d9712ad94e8dd49f85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6db014ca0e4f2fcc78b880e28d96125b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a6db014ca0e4f2fcc78b880e28d96125b">volsAreSpreads_</a></td></tr>
<tr class="separator:a6db014ca0e4f2fcc78b880e28d96125b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a971d26f261c3df23e4ce69a1f8269"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Interpolation2D &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">volSpreadsInterpolator_</a></td></tr>
<tr class="separator:ac1a971d26f261c3df23e4ce69a1f8269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b32a996b6fe7b79ae3f3957031876c6"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Matrix &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">volSpreadsMatrix_</a></td></tr>
<tr class="separator:a5b32a996b6fe7b79ae3f3957031876c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9265f490327d80ae6df16cf49d26490b"><td class="memItemLeft" align="right" valign="top">const Matrix &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a9265f490327d80ae6df16cf49d26490b">volSpreads</a> (Size i) const</td></tr>
<tr class="separator:a9265f490327d80ae6df16cf49d26490b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f1517cd5d627dd3c5554dd38a541df4"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; SmileSection &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a4f1517cd5d627dd3c5554dd38a541df4">smileSectionImpl</a> (const Date &amp;optionDate, const Period &amp;swapTenor) const override</td></tr>
<tr class="separator:a4f1517cd5d627dd3c5554dd38a541df4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e39fc0103b73adbcd673bc486b6780e"><td class="memItemLeft" align="right" valign="top">QuantLib::ext::shared_ptr&lt; SmileSection &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html#a3e39fc0103b73adbcd673bc486b6780e">smileSectionImpl</a> (Time optionTime, Time swapLength) const override</td></tr>
<tr class="separator:a3e39fc0103b73adbcd673bc486b6780e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8hpp_source.html#l00050">50</a> of file <a class="el" href="swaptionvolcube2_8hpp_source.html">swaptionvolcube2.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a5eeb39292a81cd21a7d374566ac2e820" name="a5eeb39292a81cd21a7d374566ac2e820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5eeb39292a81cd21a7d374566ac2e820">&#9670;&#160;</a></span>SwaptionVolCube2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_swaption_vol_cube2.html">SwaptionVolCube2</a> </td>
          <td>(</td>
          <td class="paramtype">const Handle&lt; <a class="el" href="class_swaption_volatility_structure.html">SwaptionVolatilityStructure</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>atmVolStructure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Period &gt; &amp;&#160;</td>
          <td class="paramname"><em>optionTenors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Period &gt; &amp;&#160;</td>
          <td class="paramname"><em>swapTenors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; Spread &gt; &amp;&#160;</td>
          <td class="paramname"><em>strikeSpreads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; Handle&lt; Quote &gt; &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>volSpreads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; SwapIndex &gt; &amp;&#160;</td>
          <td class="paramname"><em>swapIndexBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::ext::shared_ptr&lt; SwapIndex &gt; &amp;&#160;</td>
          <td class="paramname"><em>shortSwapIndexBase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>vegaWeightedSmileFit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>flatExtrapolation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>volsAreSpreads</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >The swaption vol cube is made up of ordered swaption vol surface layers, each layer referring to a swap index of a given length (in years), all indexes belonging to the same family. In order to identify the family (and its market conventions) an index of whatever length from that family must be passed in as swapIndexBase.</p>
<p >Often for short swap length the swap index family is different, e.g. the EUR case: swap vs 6M Euribor is used for length&gt;1Y, while swap vs 3M Euribor is used for the 1Y length. The shortSwapIndexBase is used to identify this second family.</p>
<p >If flatExtrapolation is true the implied volatility is extrapolated flat in strike direction.</p>
<p >in case volsAreSpreads is false the given volSpreads are interpreted as absolute vols, in this case the volSpreads inspectors also return absolute vols </p>

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8cpp_source.html#l00050">50</a> of file <a class="el" href="swaptionvolcube2_8cpp_source.html">swaptionvolcube2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>    : <a class="code hl_class" href="class_swaption_volatility_cube.html">SwaptionVolatilityCube</a>(atmVolStructure, optionTenors, swapTenors, strikeSpreads, <a class="code hl_function" href="class_quant_ext_1_1_swaption_vol_cube2.html#a9265f490327d80ae6df16cf49d26490b">volSpreads</a>, swapIndexBase,</div>
<div class="line"><span class="lineno">   58</span>                             shortSwapIndexBase, vegaWeightedSmileFit),</div>
<div class="line"><span class="lineno">   59</span>      <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#acabc78bb5f6569d9712ad94e8dd49f85">flatExtrapolation_</a>(flatExtrapolation), <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a6db014ca0e4f2fcc78b880e28d96125b">volsAreSpreads_</a>(volsAreSpreads), <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">volSpreadsInterpolator_</a>(nStrikes_),</div>
<div class="line"><span class="lineno">   60</span>      <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">volSpreadsMatrix_</a>(nStrikes_, Matrix(optionTenors.size(), swapTenors.size(), 0.0)) {</div>
<div class="line"><span class="lineno">   61</span>    QL_REQUIRE(std::find(strikeSpreads_.begin(), strikeSpreads_.end(), 0.0) != strikeSpreads_.end(),</div>
<div class="line"><span class="lineno">   62</span>               <span class="stringliteral">&quot;SwaptionVolCube2: strikeSpreads must contain 0.0 for atm vols&quot;</span>);</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html_a5b32a996b6fe7b79ae3f3957031876c6"><div class="ttname"><a href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">QuantExt::SwaptionVolCube2::volSpreadsMatrix_</a></div><div class="ttdeci">std::vector&lt; Matrix &gt; volSpreadsMatrix_</div><div class="ttdef"><b>Definition:</b> <a href="swaptionvolcube2_8hpp_source.html#l00089">swaptionvolcube2.hpp:89</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html_a6db014ca0e4f2fcc78b880e28d96125b"><div class="ttname"><a href="class_quant_ext_1_1_swaption_vol_cube2.html#a6db014ca0e4f2fcc78b880e28d96125b">QuantExt::SwaptionVolCube2::volsAreSpreads_</a></div><div class="ttdeci">const bool volsAreSpreads_</div><div class="ttdef"><b>Definition:</b> <a href="swaptionvolcube2_8hpp_source.html#l00087">swaptionvolcube2.hpp:87</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html_a9265f490327d80ae6df16cf49d26490b"><div class="ttname"><a href="class_quant_ext_1_1_swaption_vol_cube2.html#a9265f490327d80ae6df16cf49d26490b">QuantExt::SwaptionVolCube2::volSpreads</a></div><div class="ttdeci">const Matrix &amp; volSpreads(Size i) const</div><div class="ttdef"><b>Definition:</b> <a href="swaptionvolcube2_8hpp_source.html#l00082">swaptionvolcube2.hpp:82</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html_ac1a971d26f261c3df23e4ce69a1f8269"><div class="ttname"><a href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">QuantExt::SwaptionVolCube2::volSpreadsInterpolator_</a></div><div class="ttdeci">std::vector&lt; Interpolation2D &gt; volSpreadsInterpolator_</div><div class="ttdef"><b>Definition:</b> <a href="swaptionvolcube2_8hpp_source.html#l00088">swaptionvolcube2.hpp:88</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html_acabc78bb5f6569d9712ad94e8dd49f85"><div class="ttname"><a href="class_quant_ext_1_1_swaption_vol_cube2.html#acabc78bb5f6569d9712ad94e8dd49f85">QuantExt::SwaptionVolCube2::flatExtrapolation_</a></div><div class="ttdeci">const bool flatExtrapolation_</div><div class="ttdef"><b>Definition:</b> <a href="swaptionvolcube2_8hpp_source.html#l00087">swaptionvolcube2.hpp:87</a></div></div>
<div class="ttc" id="aclass_swaption_volatility_cube_html"><div class="ttname"><a href="class_swaption_volatility_cube.html">SwaptionVolatilityCube</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1127cccc9668a02247dc139d27121708" name="a1127cccc9668a02247dc139d27121708"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1127cccc9668a02247dc139d27121708">&#9670;&#160;</a></span>performCalculations()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void performCalculations </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8cpp_source.html#l00065">65</a> of file <a class="el" href="swaptionvolcube2_8cpp_source.html">swaptionvolcube2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>                                                 {</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    SwaptionVolatilityCube::performCalculations();<span class="comment"></span></div>
<div class="line"><span class="lineno">   68</span><span class="comment">    //! set volSpreadsMatrix_ by volSpreads_ quotes</span></div>
<div class="line"><span class="lineno">   69</span><span class="comment"></span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; nStrikes_; i++)</div>
<div class="line"><span class="lineno">   70</span>        <span class="keywordflow">for</span> (Size j = 0; j &lt; nOptionTenors_; j++)</div>
<div class="line"><span class="lineno">   71</span>            <span class="keywordflow">for</span> (Size k = 0; k &lt; nSwapTenors_; k++) {</div>
<div class="line"><span class="lineno">   72</span>                <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">volSpreadsMatrix_</a>[i][j][k] = volSpreads_[j * nSwapTenors_ + k][i]-&gt;value();</div>
<div class="line"><span class="lineno">   73</span>            }<span class="comment"></span></div>
<div class="line"><span class="lineno">   74</span><span class="comment">    //! create volSpreadsInterpolator_</span></div>
<div class="line"><span class="lineno">   75</span><span class="comment"></span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; nStrikes_; i++) {</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#acabc78bb5f6569d9712ad94e8dd49f85">flatExtrapolation_</a>)</div>
<div class="line"><span class="lineno">   77</span>            <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">volSpreadsInterpolator_</a>[i] =</div>
<div class="line"><span class="lineno">   78</span>                BilinearInterpolation(swapLengths_.begin(), swapLengths_.end(), optionTimes_.begin(),</div>
<div class="line"><span class="lineno">   79</span>                                      optionTimes_.end(), <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">volSpreadsMatrix_</a>[i]);</div>
<div class="line"><span class="lineno">   80</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   81</span>            <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">volSpreadsInterpolator_</a>[i] = FlatExtrapolator2D(QuantLib::ext::make_shared&lt;BilinearInterpolation&gt;(</div>
<div class="line"><span class="lineno">   82</span>                swapLengths_.begin(), swapLengths_.end(), optionTimes_.begin(), optionTimes_.end(),</div>
<div class="line"><span class="lineno">   83</span>                <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">volSpreadsMatrix_</a>[i]));</div>
<div class="line"><span class="lineno">   84</span>        <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">volSpreadsInterpolator_</a>[i].enableExtrapolation();</div>
<div class="line"><span class="lineno">   85</span>    }</div>
<div class="line"><span class="lineno">   86</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9265f490327d80ae6df16cf49d26490b" name="a9265f490327d80ae6df16cf49d26490b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9265f490327d80ae6df16cf49d26490b">&#9670;&#160;</a></span>volSpreads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Matrix &amp; volSpreads </td>
          <td>(</td>
          <td class="paramtype">Size&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8hpp_source.html#l00082">82</a> of file <a class="el" href="swaptionvolcube2_8hpp_source.html">swaptionvolcube2.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   82</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a5b32a996b6fe7b79ae3f3957031876c6">volSpreadsMatrix_</a>[i]; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4f1517cd5d627dd3c5554dd38a541df4" name="a4f1517cd5d627dd3c5554dd38a541df4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f1517cd5d627dd3c5554dd38a541df4">&#9670;&#160;</a></span>smileSectionImpl() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt; SmileSection &gt; smileSectionImpl </td>
          <td>(</td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"><em>optionDate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Period &amp;&#160;</td>
          <td class="paramname"><em>swapTenor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8cpp_source.html#l00101">101</a> of file <a class="el" href="swaptionvolcube2_8cpp_source.html">swaptionvolcube2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  102</span>                                                                                                  {</div>
<div class="line"><span class="lineno">  103</span>    calculate();</div>
<div class="line"><span class="lineno">  104</span>    Rate atmForward = atmStrike(optionDate, swapTenor);</div>
<div class="line"><span class="lineno">  105</span>    Volatility referenceVol = <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#a6db014ca0e4f2fcc78b880e28d96125b">volsAreSpreads_</a> ? atmVol_-&gt;volatility(optionDate, swapTenor, atmForward) : 0.0;</div>
<div class="line"><span class="lineno">  106</span>    Time optionTime = std::max(1E-6, timeFromReference(optionDate));</div>
<div class="line"><span class="lineno">  107</span>    Real exerciseTimeSqrt = std::sqrt(optionTime);</div>
<div class="line"><span class="lineno">  108</span>    std::vector&lt;Real&gt; <a class="code hl_variable" href="test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>, stdDevs;</div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_variable" href="test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.reserve(nStrikes_);</div>
<div class="line"><span class="lineno">  110</span>    stdDevs.reserve(nStrikes_);</div>
<div class="line"><span class="lineno">  111</span>    Time length = swapLength(swapTenor);</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; nStrikes_; ++i) {</div>
<div class="line"><span class="lineno">  113</span>        <a class="code hl_variable" href="test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>.push_back(atmForward + strikeSpreads_[i]);</div>
<div class="line"><span class="lineno">  114</span>        stdDevs.push_back(exerciseTimeSqrt * (referenceVol + <a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#ac1a971d26f261c3df23e4ce69a1f8269">volSpreadsInterpolator_</a>[i](length, optionTime)));</div>
<div class="line"><span class="lineno">  115</span>    }</div>
<div class="line"><span class="lineno">  116</span>    Real shift = atmVol_-&gt;shift(optionTime, length);</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="class_quant_ext_1_1_swaption_vol_cube2.html#acabc78bb5f6569d9712ad94e8dd49f85">flatExtrapolation_</a>)</div>
<div class="line"><span class="lineno">  118</span>        <span class="keywordflow">return</span> QuantLib::ext::shared_ptr&lt;SmileSection&gt;(<span class="keyword">new</span> InterpolatedSmileSection&lt;Linear&gt;(</div>
<div class="line"><span class="lineno">  119</span>            optionTime, <a class="code hl_variable" href="test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>, stdDevs, atmForward, Linear(), Actual365Fixed(), volatilityType(), shift));</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">return</span> QuantLib::ext::shared_ptr&lt;SmileSection&gt;(<span class="keyword">new</span> InterpolatedSmileSection&lt;LinearFlat&gt;(</div>
<div class="line"><span class="lineno">  122</span>            optionTime, <a class="code hl_variable" href="test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a>, stdDevs, atmForward, LinearFlat(), Actual365Fixed(), volatilityType(), shift));</div>
<div class="line"><span class="lineno">  123</span>}</div>
<div class="ttc" id="atest_2analyticcashsettledeuropeanengine_8cpp_html_aa7b6f0cca80627aec257d302511d608c"><div class="ttname"><a href="test_2analyticcashsettledeuropeanengine_8cpp.html#aa7b6f0cca80627aec257d302511d608c">strikes</a></div><div class="ttdeci">vector&lt; Real &gt; strikes</div><div class="ttdef"><b>Definition:</b> <a href="test_2analyticcashsettledeuropeanengine_8cpp_source.html#l00146">analyticcashsettledeuropeanengine.cpp:146</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_swaption_vol_cube2_a4f1517cd5d627dd3c5554dd38a541df4_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_swaption_vol_cube2_a4f1517cd5d627dd3c5554dd38a541df4_icgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_swaption_vol_cube2_a4f1517cd5d627dd3c5554dd38a541df4_icgraph" id="aclass_quant_ext_1_1_swaption_vol_cube2_a4f1517cd5d627dd3c5554dd38a541df4_icgraph">
<area shape="rect" title=" " alt="" coords="175,5,296,31"/>
<area shape="rect" href="class_quant_ext_1_1_swaption_vol_cube2.html#a3e39fc0103b73adbcd673bc486b6780e" title=" " alt="" coords="5,5,127,31"/>
</map>
</div>

</div>
</div>
<a id="a3e39fc0103b73adbcd673bc486b6780e" name="a3e39fc0103b73adbcd673bc486b6780e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e39fc0103b73adbcd673bc486b6780e">&#9670;&#160;</a></span>smileSectionImpl() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QuantLib::ext::shared_ptr&lt; SmileSection &gt; smileSectionImpl </td>
          <td>(</td>
          <td class="paramtype">Time&#160;</td>
          <td class="paramname"><em>optionTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Time&#160;</td>
          <td class="paramname"><em>swapLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8cpp_source.html#l00088">88</a> of file <a class="el" href="swaptionvolcube2_8cpp_source.html">swaptionvolcube2.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span>                                                                                                             {</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>    calculate();</div>
<div class="line"><span class="lineno">   91</span>    Date optionDate = optionDateFromTime(optionTime);</div>
<div class="line"><span class="lineno">   92</span>    Rounding rounder(0);</div>
<div class="line"><span class="lineno">   93</span>    Period swapTenor(<span class="keyword">static_cast&lt;</span>Integer<span class="keyword">&gt;</span>(rounder(swapLength * 12.0)), Months);</div>
<div class="line"><span class="lineno">   94</span>    <span class="comment">// ensure that option date is valid fixing date</span></div>
<div class="line"><span class="lineno">   95</span>    optionDate = swapTenor &gt; shortSwapIndexBase_-&gt;tenor()</div>
<div class="line"><span class="lineno">   96</span>                     ? swapIndexBase_-&gt;fixingCalendar().adjust(optionDate, Following)</div>
<div class="line"><span class="lineno">   97</span>                     : shortSwapIndexBase_-&gt;fixingCalendar().adjust(optionDate, Following);</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="class_quant_ext_1_1_swaption_vol_cube2.html#a4f1517cd5d627dd3c5554dd38a541df4">smileSectionImpl</a>(optionDate, swapTenor);</div>
<div class="line"><span class="lineno">   99</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_swaption_vol_cube2_html_a4f1517cd5d627dd3c5554dd38a541df4"><div class="ttname"><a href="class_quant_ext_1_1_swaption_vol_cube2.html#a4f1517cd5d627dd3c5554dd38a541df4">QuantExt::SwaptionVolCube2::smileSectionImpl</a></div><div class="ttdeci">QuantLib::ext::shared_ptr&lt; SmileSection &gt; smileSectionImpl(const Date &amp;optionDate, const Period &amp;swapTenor) const override</div><div class="ttdef"><b>Definition:</b> <a href="swaptionvolcube2_8cpp_source.html#l00101">swaptionvolcube2.cpp:101</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_swaption_vol_cube2_a3e39fc0103b73adbcd673bc486b6780e_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_swaption_vol_cube2_a3e39fc0103b73adbcd673bc486b6780e_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_swaption_vol_cube2_a3e39fc0103b73adbcd673bc486b6780e_cgraph" id="aclass_quant_ext_1_1_swaption_vol_cube2_a3e39fc0103b73adbcd673bc486b6780e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,127,31"/>
<area shape="rect" href="class_quant_ext_1_1_swaption_vol_cube2.html#a4f1517cd5d627dd3c5554dd38a541df4" title=" " alt="" coords="175,5,296,31"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="acabc78bb5f6569d9712ad94e8dd49f85" name="acabc78bb5f6569d9712ad94e8dd49f85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acabc78bb5f6569d9712ad94e8dd49f85">&#9670;&#160;</a></span>flatExtrapolation_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classbool.html">bool</a> flatExtrapolation_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8hpp_source.html#l00087">87</a> of file <a class="el" href="swaptionvolcube2_8hpp_source.html">swaptionvolcube2.hpp</a>.</p>

</div>
</div>
<a id="a6db014ca0e4f2fcc78b880e28d96125b" name="a6db014ca0e4f2fcc78b880e28d96125b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6db014ca0e4f2fcc78b880e28d96125b">&#9670;&#160;</a></span>volsAreSpreads_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classbool.html">bool</a> volsAreSpreads_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8hpp_source.html#l00087">87</a> of file <a class="el" href="swaptionvolcube2_8hpp_source.html">swaptionvolcube2.hpp</a>.</p>

</div>
</div>
<a id="ac1a971d26f261c3df23e4ce69a1f8269" name="ac1a971d26f261c3df23e4ce69a1f8269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a971d26f261c3df23e4ce69a1f8269">&#9670;&#160;</a></span>volSpreadsInterpolator_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Interpolation2D&gt; volSpreadsInterpolator_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8hpp_source.html#l00088">88</a> of file <a class="el" href="swaptionvolcube2_8hpp_source.html">swaptionvolcube2.hpp</a>.</p>

</div>
</div>
<a id="a5b32a996b6fe7b79ae3f3957031876c6" name="a5b32a996b6fe7b79ae3f3957031876c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b32a996b6fe7b79ae3f3957031876c6">&#9670;&#160;</a></span>volSpreadsMatrix_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Matrix&gt; volSpreadsMatrix_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="swaptionvolcube2_8hpp_source.html#l00089">89</a> of file <a class="el" href="swaptionvolcube2_8hpp_source.html">swaptionvolcube2.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
