<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>QuantExt: BlackIndexCdsOptionEngine Class Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantextextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-qle@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.11</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_quant_ext.html">QuantExt</a></li><li class="navelem"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html">BlackIndexCdsOptionEngine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="class_quant_ext_1_1_black_index_cds_option_engine-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">BlackIndexCdsOptionEngine Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="blackindexcdsoptionengine_8hpp_source.html">qle/pricingengines/blackindexcdsoptionengine.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Inheritance diagram for BlackIndexCdsOptionEngine:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine__inherit__graph.png" border="0" usemap="#a_black_index_cds_option_engine_inherit__map" alt="Inheritance graph"/></div>
<map name="a_black_index_cds_option_engine_inherit__map" id="a_black_index_cds_option_engine_inherit__map">
<area shape="rect" title=" " alt="" coords="7,636,218,764"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html" title=" " alt="" coords="7,211,218,588"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_1_1engine.html" title="Base class for index CDS option engines." alt="" coords="81,123,145,163"/>
<area shape="rect" title=" " alt="" coords="5,5,220,75"/>
</map>
</div>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for BlackIndexCdsOptionEngine:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine__coll__graph.png" border="0" usemap="#a_black_index_cds_option_engine_coll__map" alt="Collaboration graph"/></div>
<map name="a_black_index_cds_option_engine_coll__map" id="a_black_index_cds_option_engine_coll__map">
<area shape="rect" title=" " alt="" coords="713,755,923,883"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html" title=" " alt="" coords="713,431,923,705"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_1_1engine.html" title="Base class for index CDS option engines." alt="" coords="162,284,226,324"/>
<area shape="rect" title=" " alt="" coords="5,108,220,177"/>
<area shape="rect" title=" " alt="" coords="333,269,527,339"/>
<area shape="rect" title=" " alt="" coords="245,115,423,170"/>
<area shape="rect" title=" " alt="" coords="518,123,609,163"/>
<area shape="rect" title=" " alt="" coords="646,284,817,324"/>
<area shape="rect" title=" " alt="" coords="544,5,583,45"/>
<area shape="rect" title=" " alt="" coords="796,123,848,163"/>
<area shape="rect" title=" " alt="" coords="992,277,1188,331"/>
<area shape="rect" title=" " alt="" coords="1212,277,1387,331"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac11052eed2d3f0b493df7af78a4c0894"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html#ac11052eed2d3f0b493df7af78a4c0894">IndexCdsOptionBaseEngine</a> (const QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &amp;probability, QuantLib::Real recovery, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ace3fd0ec998d47e6d88eb2683d8dbd5f">discountSwapCurrency</a>, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a9dc5efa2c9265495f0c6f9ece11d93b0">discountTradeCollateral</a>, const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a>)</td></tr>
<tr class="memdesc:ac11052eed2d3f0b493df7af78a4c0894"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor taking a default probability term structure bootstrapped from the index spreads.  <a href="class_quant_ext_1_1_black_index_cds_option_engine.html#ac11052eed2d3f0b493df7af78a4c0894">More...</a><br /></td></tr>
<tr class="separator:ac11052eed2d3f0b493df7af78a4c0894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e6a96c22ec00221b9b39d56ec77e54"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a26e6a96c22ec00221b9b39d56ec77e54">IndexCdsOptionBaseEngine</a> (const std::vector&lt; QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a2ee2cf6f45b62601f58a801fb4871c72">probabilities</a>, const std::vector&lt; QuantLib::Real &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a8cb6d635aaa6ddc74cf55cd07f139a27">recoveries</a>, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ace3fd0ec998d47e6d88eb2683d8dbd5f">discountSwapCurrency</a>, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a9dc5efa2c9265495f0c6f9ece11d93b0">discountTradeCollateral</a>, const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a>, QuantLib::Real indexRecovery=QuantLib::Null&lt; QuantLib::Real &gt;())</td></tr>
<tr class="separator:a26e6a96c22ec00221b9b39d56ec77e54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_class_quant_ext_1_1_index_cds_option_base_engine')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html">IndexCdsOptionBaseEngine</a></td></tr>
<tr class="memitem:ac11052eed2d3f0b493df7af78a4c0894 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ac11052eed2d3f0b493df7af78a4c0894">IndexCdsOptionBaseEngine</a> (const QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &amp;probability, QuantLib::Real recovery, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ace3fd0ec998d47e6d88eb2683d8dbd5f">discountSwapCurrency</a>, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a9dc5efa2c9265495f0c6f9ece11d93b0">discountTradeCollateral</a>, const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a>)</td></tr>
<tr class="memdesc:ac11052eed2d3f0b493df7af78a4c0894 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor taking a default probability term structure bootstrapped from the index spreads.  <a href="class_quant_ext_1_1_index_cds_option_base_engine.html#ac11052eed2d3f0b493df7af78a4c0894">More...</a><br /></td></tr>
<tr class="separator:ac11052eed2d3f0b493df7af78a4c0894 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26e6a96c22ec00221b9b39d56ec77e54 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a26e6a96c22ec00221b9b39d56ec77e54">IndexCdsOptionBaseEngine</a> (const std::vector&lt; QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a2ee2cf6f45b62601f58a801fb4871c72">probabilities</a>, const std::vector&lt; QuantLib::Real &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a8cb6d635aaa6ddc74cf55cd07f139a27">recoveries</a>, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ace3fd0ec998d47e6d88eb2683d8dbd5f">discountSwapCurrency</a>, const Handle&lt; YieldTermStructure &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a9dc5efa2c9265495f0c6f9ece11d93b0">discountTradeCollateral</a>, const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &amp;<a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a>, QuantLib::Real indexRecovery=QuantLib::Null&lt; QuantLib::Real &gt;())</td></tr>
<tr class="separator:a26e6a96c22ec00221b9b39d56ec77e54 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ee2cf6f45b62601f58a801fb4871c72 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a2ee2cf6f45b62601f58a801fb4871c72">probabilities</a> () const</td></tr>
<tr class="separator:a2ee2cf6f45b62601f58a801fb4871c72 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cb6d635aaa6ddc74cf55cd07f139a27 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; QuantLib::Real &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a8cb6d635aaa6ddc74cf55cd07f139a27">recoveries</a> () const</td></tr>
<tr class="separator:a8cb6d635aaa6ddc74cf55cd07f139a27 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace3fd0ec998d47e6d88eb2683d8dbd5f inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">const QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ace3fd0ec998d47e6d88eb2683d8dbd5f">discountSwapCurrency</a> () const</td></tr>
<tr class="separator:ace3fd0ec998d47e6d88eb2683d8dbd5f inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9dc5efa2c9265495f0c6f9ece11d93b0 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">const QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a9dc5efa2c9265495f0c6f9ece11d93b0">discountTradeCollateral</a> () const</td></tr>
<tr class="separator:a9dc5efa2c9265495f0c6f9ece11d93b0 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ba2fefe6922f36f0437aa52c5b0bd5 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a> () const</td></tr>
<tr class="separator:aa8ba2fefe6922f36f0437aa52c5b0bd5 inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61eb1a24e5329ccc296715a40dc3a19a inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a61eb1a24e5329ccc296715a40dc3a19a">calculate</a> () const override</td></tr>
<tr class="separator:a61eb1a24e5329ccc296715a40dc3a19a inherit pub_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-methods" name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a4bb88e3144128b098847d66e63dc58d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a4bb88e3144128b098847d66e63dc58d1">doCalc</a> () const override</td></tr>
<tr class="memdesc:a4bb88e3144128b098847d66e63dc58d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Engine specific calculation.  <a href="class_quant_ext_1_1_black_index_cds_option_engine.html#a4bb88e3144128b098847d66e63dc58d1">More...</a><br /></td></tr>
<tr class="separator:a4bb88e3144128b098847d66e63dc58d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27789616a6faf122fbbaae0f62a4b315"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a27789616a6faf122fbbaae0f62a4b315">spreadStrikeCalculate</a> (QuantLib::Real <a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a>) const</td></tr>
<tr class="separator:a27789616a6faf122fbbaae0f62a4b315"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae093c7cb964deff3b02ec1a91e5760e2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html#ae093c7cb964deff3b02ec1a91e5760e2">priceStrikeCalculate</a> (QuantLib::Real <a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a>) const</td></tr>
<tr class="separator:ae093c7cb964deff3b02ec1a91e5760e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9bdebebc4d62e557d3bae7c686dbfc"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_black_index_cds_option_engine.html#aab9bdebebc4d62e557d3bae7c686dbfc">forwardRiskyAnnuityStrike</a> () const</td></tr>
<tr class="separator:aab9bdebebc4d62e557d3bae7c686dbfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_class_quant_ext_1_1_index_cds_option_base_engine')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html">IndexCdsOptionBaseEngine</a></td></tr>
<tr class="memitem:ad0e4ac0e9fa2724cc56b137d2f0c3e25 inherit pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ad0e4ac0e9fa2724cc56b137d2f0c3e25">registerWithMarket</a> ()</td></tr>
<tr class="memdesc:ad0e4ac0e9fa2724cc56b137d2f0c3e25 inherit pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register with market data.  <a href="class_quant_ext_1_1_index_cds_option_base_engine.html#ad0e4ac0e9fa2724cc56b137d2f0c3e25">More...</a><br /></td></tr>
<tr class="separator:ad0e4ac0e9fa2724cc56b137d2f0c3e25 inherit pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63d06231ff26afe48c5e7b2fc22352b7 inherit pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a> () const</td></tr>
<tr class="memdesc:a63d06231ff26afe48c5e7b2fc22352b7 inherit pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the discounted value of the front end protection.  <a href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">More...</a><br /></td></tr>
<tr class="separator:a63d06231ff26afe48c5e7b2fc22352b7 inherit pro_methods_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html">IndexCdsOptionBaseEngine</a></td></tr>
<tr class="memitem:ae5a8ec3ed602230bebed0682f67716c0 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">std::vector&lt; QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ae5a8ec3ed602230bebed0682f67716c0">probabilities_</a></td></tr>
<tr class="memdesc:ae5a8ec3ed602230bebed0682f67716c0 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store inputs.  <a href="class_quant_ext_1_1_index_cds_option_base_engine.html#ae5a8ec3ed602230bebed0682f67716c0">More...</a><br /></td></tr>
<tr class="separator:ae5a8ec3ed602230bebed0682f67716c0 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a037eed50f7f5baeb7298b15ec0a98143 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">std::vector&lt; QuantLib::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a037eed50f7f5baeb7298b15ec0a98143">recoveries_</a></td></tr>
<tr class="separator:a037eed50f7f5baeb7298b15ec0a98143 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac544765f16a4ca1df403284762ba8b0 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a></td></tr>
<tr class="separator:aac544765f16a4ca1df403284762ba8b0 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5afe1ea7cea4cbeb6d9db105c04b2002 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a5afe1ea7cea4cbeb6d9db105c04b2002">discountTradeCollateral_</a></td></tr>
<tr class="separator:a5afe1ea7cea4cbeb6d9db105c04b2002 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0b5049883e81849c43a1e8b513ecdf5 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ab0b5049883e81849c43a1e8b513ecdf5">volatility_</a></td></tr>
<tr class="separator:ab0b5049883e81849c43a1e8b513ecdf5 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa769435bc2b8e0541fb19b1e4ba2cbe inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">QuantLib::Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aaa769435bc2b8e0541fb19b1e4ba2cbe">indexRecovery_</a></td></tr>
<tr class="memdesc:aaa769435bc2b8e0541fb19b1e4ba2cbe inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Assumed index recovery used in the flat strike spread curve calculation if provided.  <a href="class_quant_ext_1_1_index_cds_option_base_engine.html#aaa769435bc2b8e0541fb19b1e4ba2cbe">More...</a><br /></td></tr>
<tr class="separator:aaa769435bc2b8e0541fb19b1e4ba2cbe inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4df46222b996042c01d175461eddfd86 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memItemLeft" align="right" valign="top">std::vector&lt; QuantLib::Real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a4df46222b996042c01d175461eddfd86">notionals_</a></td></tr>
<tr class="memdesc:a4df46222b996042c01d175461eddfd86 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">Store the underlying index CDS notional(s) during calculation.  <a href="class_quant_ext_1_1_index_cds_option_base_engine.html#a4df46222b996042c01d175461eddfd86">More...</a><br /></td></tr>
<tr class="separator:a4df46222b996042c01d175461eddfd86 inherit pro_attribs_class_quant_ext_1_1_index_cds_option_base_engine"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Black index CDS option engine</p>
<p >Prices index CDS option instruments quoted in terms of strike spread or strike price. If the strike is in terms of spread, it is assumed that the volatility structure's strike dimension, if there is one, is in terms of spread also. This is the standard quotation convention for investment grade index families like CDX IG and ITraxx Europe. If the strike is in terms of price, it is assumed that the volatility structure's strike dimension, if there is one, is in terms of price also. This is the standard quotation convention for high yield index families like CDX HY and CDX EM.</p>
<p >The valuation of the index CDS options with strike price is a reasonably straightforward application of Black's formula. The approach is outlined for example in <em>Mark-to-market Credit Index Option Pricing and Credit Volatility Index, John Yang and Lukasz Dobrek, 23 June 2015, Section 1.1</em>. Here, we calculate the front end protection (FEP) adjusted forward price as opposed to deriving it from the market quotes of payer and receiver CDS options with the same strike.</p>
<p >The valuation of the index CDS options with strike spread follows the approach outlined in <em>Modelling Single-name and Multi-name Credit Derivatives, Dominic O'Kane, 2008, Section 11.7</em>. This is also the approach outlined in <em>Credit Index Option, <a class="el" href="class_quant_ext_1_1_i_c_e.html">ICE</a>, 2018</em>. </p>

<p class="definition">Definition at line <a class="el" href="blackindexcdsoptionengine_8hpp_source.html#l00048">48</a> of file <a class="el" href="blackindexcdsoptionengine_8hpp_source.html">blackindexcdsoptionengine.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a4bb88e3144128b098847d66e63dc58d1" name="a4bb88e3144128b098847d66e63dc58d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bb88e3144128b098847d66e63dc58d1">&#9670;&#160;</a></span>doCalc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void doCalc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">private</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Engine specific calculation. </p>

<p>Implements <a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a1011b26247cb305a3daeb9858ca26d68">IndexCdsOptionBaseEngine</a>.</p>

<p class="definition">Definition at line <a class="el" href="blackindexcdsoptionengine_8cpp_source.html#l00038">38</a> of file <a class="el" href="blackindexcdsoptionengine_8cpp_source.html">blackindexcdsoptionengine.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>                                             {</div>
<div class="line"><span class="lineno">   39</span>    <span class="comment">// Calculate option value depending on strike type.</span></div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.strikeType == <a class="code hl_enumvalue" href="class_quant_ext_1_1_cds_option.html#ae1a69d09c3886752e79d88e633a0cb51ab60a18a4849bff26d7f8d2b1670a97f6">CdsOption::Spread</a>)</div>
<div class="line"><span class="lineno">   41</span>        <a class="code hl_function" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a27789616a6faf122fbbaae0f62a4b315">spreadStrikeCalculate</a>(<a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a>());</div>
<div class="line"><span class="lineno">   42</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   43</span>        <a class="code hl_function" href="class_quant_ext_1_1_black_index_cds_option_engine.html#ae093c7cb964deff3b02ec1a91e5760e2">priceStrikeCalculate</a>(<a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a>());</div>
<div class="line"><span class="lineno">   44</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_black_index_cds_option_engine_html_a27789616a6faf122fbbaae0f62a4b315"><div class="ttname"><a href="class_quant_ext_1_1_black_index_cds_option_engine.html#a27789616a6faf122fbbaae0f62a4b315">QuantExt::BlackIndexCdsOptionEngine::spreadStrikeCalculate</a></div><div class="ttdeci">void spreadStrikeCalculate(QuantLib::Real fep) const</div><div class="ttdef"><b>Definition:</b> <a href="blackindexcdsoptionengine_8cpp_source.html#l00046">blackindexcdsoptionengine.cpp:46</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_black_index_cds_option_engine_html_ae093c7cb964deff3b02ec1a91e5760e2"><div class="ttname"><a href="class_quant_ext_1_1_black_index_cds_option_engine.html#ae093c7cb964deff3b02ec1a91e5760e2">QuantExt::BlackIndexCdsOptionEngine::priceStrikeCalculate</a></div><div class="ttdeci">void priceStrikeCalculate(QuantLib::Real fep) const</div><div class="ttdef"><b>Definition:</b> <a href="blackindexcdsoptionengine_8cpp_source.html#l00113">blackindexcdsoptionengine.cpp:113</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_cds_option_html_ae1a69d09c3886752e79d88e633a0cb51ab60a18a4849bff26d7f8d2b1670a97f6"><div class="ttname"><a href="class_quant_ext_1_1_cds_option.html#ae1a69d09c3886752e79d88e633a0cb51ab60a18a4849bff26d7f8d2b1670a97f6">QuantExt::CdsOption::Spread</a></div><div class="ttdeci">@ Spread</div><div class="ttdef"><b>Definition:</b> <a href="cdsoption_8hpp_source.html#l00073">cdsoption.hpp:73</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_index_cds_option_base_engine_html_a63d06231ff26afe48c5e7b2fc22352b7"><div class="ttname"><a href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">QuantExt::IndexCdsOptionBaseEngine::fep</a></div><div class="ttdeci">QuantLib::Real fep() const</div><div class="ttdoc">Calculate the discounted value of the front end protection.</div><div class="ttdef"><b>Definition:</b> <a href="indexcdsoptionbaseengine_8cpp_source.html#l00108">indexcdsoptionbaseengine.cpp:108</a></div></div>
<div class="ttc" id="atenorbasisswap_8cpp_html_a71b2ce0e52885aca4ce15e1d128b9f56"><div class="ttname"><a href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a></div><div class="ttdeci">Swap::arguments * arguments_</div><div class="ttdef"><b>Definition:</b> <a href="tenorbasisswap_8cpp_source.html#l00059">tenorbasisswap.cpp:59</a></div></div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine_a4bb88e3144128b098847d66e63dc58d1_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_black_index_cds_option_engine_a4bb88e3144128b098847d66e63dc58d1_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_black_index_cds_option_engine_a4bb88e3144128b098847d66e63dc58d1_cgraph" id="aclass_quant_ext_1_1_black_index_cds_option_engine_a4bb88e3144128b098847d66e63dc58d1_cgraph">
<area shape="rect" title="Engine specific calculation." alt="" coords="5,70,68,95"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7" title="Calculate the discounted value of the front end protection." alt="" coords="313,5,491,45"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#ae093c7cb964deff3b02ec1a91e5760e2" title=" " alt="" coords="121,70,260,95"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a27789616a6faf122fbbaae0f62a4b315" title=" " alt="" coords="116,119,265,145"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="319,70,485,95"/>
<area shape="rect" href="namespace_quant_ext.html#a5eedff657bd84ace641bab7e28ac9ed1" title=" " alt="" coords="321,119,483,145"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5" title=" " alt="" coords="313,169,491,209"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#aab9bdebebc4d62e557d3bae7c686dbfc" title=" " alt="" coords="315,234,489,259"/>
</map>
</div>

</div>
</div>
<a id="a27789616a6faf122fbbaae0f62a4b315" name="a27789616a6faf122fbbaae0f62a4b315"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27789616a6faf122fbbaae0f62a4b315">&#9670;&#160;</a></span>spreadStrikeCalculate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void spreadStrikeCalculate </td>
          <td>(</td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>fep</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="blackindexcdsoptionengine_8cpp_source.html#l00046">46</a> of file <a class="el" href="blackindexcdsoptionengine_8cpp_source.html">blackindexcdsoptionengine.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>                                                                    {</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <span class="keyword">const</span> Date&amp; exerciseDate = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.exercise-&gt;dates().front();</div>
<div class="line"><span class="lineno">   49</span>    Real exerciseTime = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ab0b5049883e81849c43a1e8b513ecdf5">volatility_</a>-&gt;timeFromReference(exerciseDate);</div>
<div class="line"><span class="lineno">   50</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cds = *<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.swap;</div>
<div class="line"><span class="lineno">   51</span>    <span class="keyword">const</span> Real&amp; strike = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.strike;</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;strikeSpread&quot;</span>] = strike;</div>
<div class="line"><span class="lineno">   53</span>    Real runningSpread = cds.runningSpread();</div>
<div class="line"><span class="lineno">   54</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;runningSpread&quot;</span>] = runningSpread;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    DiscountFactor discTradeCollToExercise = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a5afe1ea7cea4cbeb6d9db105c04b2002">discountTradeCollateral_</a>-&gt;discount(exerciseDate);</div>
<div class="line"><span class="lineno">   57</span>    DiscountFactor discSwapCurrToExercise = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a>-&gt;discount(exerciseDate);</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;discountToExerciseTradeCollateral&quot;</span>] = discTradeCollToExercise;</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;discountToExerciseSwapCurrency&quot;</span>] = discSwapCurrToExercise;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>    <span class="comment">// Calculate the risky annuity</span></div>
<div class="line"><span class="lineno">   62</span>    Real rpv01 = std::abs(cds.couponLegNPV() + cds.accrualRebateNPV()) / (cds.notional() * cds.runningSpread());</div>
<div class="line"><span class="lineno">   63</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;riskyAnnuity&quot;</span>] = rpv01;</div>
<div class="line"><span class="lineno">   64</span>    QL_REQUIRE(cds.notional() &gt; 0.0 || <a class="code hl_function" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(cds.notional(), 0.0),</div>
<div class="line"><span class="lineno">   65</span>               <span class="stringliteral">&quot;BlackIndexCdsOptionEngine: notional must not be negative (&quot;</span> &lt;&lt; cds.notional() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">   66</span>    QL_REQUIRE(rpv01 &gt; 0.0, <span class="stringliteral">&quot;BlackIndexCdsOptionEngine: risky annuity must be positive (couponLegNPV=&quot;</span></div>
<div class="line"><span class="lineno">   67</span>                                &lt;&lt; cds.couponLegNPV() &lt;&lt; <span class="stringliteral">&quot;, accrualRebateNPV=&quot;</span> &lt;&lt; cds.accrualRebateNPV()</div>
<div class="line"><span class="lineno">   68</span>                                &lt;&lt; <span class="stringliteral">&quot;, notional=&quot;</span> &lt;&lt; cds.notional() &lt;&lt; <span class="stringliteral">&quot;, runningSpread=&quot;</span> &lt;&lt; cds.runningSpread() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    Real fairSpread = cds.fairSpreadClean();</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;forwardSpread&quot;</span>] = fairSpread;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="comment">// FEP adjusted forward spread. F^{Adjusted} in O&#39;Kane 2008, Section 11.7. F&#39; in ICE paper (notation is poor).</span></div>
<div class="line"><span class="lineno">   74</span>    Real Fp = fairSpread + <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a> * (Settlement::Cash ? discSwapCurrToExercise : discTradeCollToExercise) / rpv01 /</div>
<div class="line"><span class="lineno">   75</span>                               discTradeCollToExercise / cds.notional();</div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;fepAdjustedForwardSpread&quot;</span>] = Fp;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    <span class="comment">// Adjusted strike spread. K&#39; in O&#39;Kane 2008, Section 11.7. K&#39; in ICE paper (notation is poor).</span></div>
<div class="line"><span class="lineno">   79</span>    Real Kp = <a class="code hl_function" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(strike, 0.0)</div>
<div class="line"><span class="lineno">   80</span>                  ? 0.0</div>
<div class="line"><span class="lineno">   81</span>                  : runningSpread + <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.tradeDateNtl / cds.notional() * <a class="code hl_function" href="class_quant_ext_1_1_black_index_cds_option_engine.html#aab9bdebebc4d62e557d3bae7c686dbfc">forwardRiskyAnnuityStrike</a>() *</div>
<div class="line"><span class="lineno">   82</span>                                        (strike - runningSpread) *</div>
<div class="line"><span class="lineno">   83</span>                                        (Settlement::Cash ? discSwapCurrToExercise : discTradeCollToExercise) / rpv01;</div>
<div class="line"><span class="lineno">   84</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;adjustedStrikeSpread&quot;</span>] = Kp;</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    <span class="comment">// Read the volatility from the volatility surface</span></div>
<div class="line"><span class="lineno">   87</span>    Real <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a> = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ab0b5049883e81849c43a1e8b513ecdf5">volatility_</a>-&gt;volatility(exerciseDate, <a class="code hl_function" href="namespace_quant_ext.html#a5eedff657bd84ace641bab7e28ac9ed1">QuantExt::periodToTime</a>(<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.indexTerm), strike,</div>
<div class="line"><span class="lineno">   88</span>                                              <a class="code hl_enumvalue" href="class_quant_ext_1_1_credit_vol_curve.html#a1d1cfd8ffb84e947f82999c682b666a7a180bc3b1c5619aaef40e803f49921012">CreditVolCurve::Type::Spread</a>);</div>
<div class="line"><span class="lineno">   89</span>    Real stdDev = <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a> * std::sqrt(exerciseTime);</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;volatility&quot;</span>] = <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a>;</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;standardDeviation&quot;</span>] = stdDev;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="comment">// Option type</span></div>
<div class="line"><span class="lineno">   94</span>    Option::Type callPut = cds.side() == Protection::Buyer ? Option::Call : Option::Put;</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;callPut&quot;</span>] = callPut == Option::Call ? string(<span class="stringliteral">&quot;Call&quot;</span>) : string(<span class="stringliteral">&quot;Put&quot;</span>);</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="comment">// NPV. Add the relevant notionals to the additional results also.</span></div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;valuationDateNotional&quot;</span>] = cds.notional();</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;tradeDateNotional&quot;</span>] = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.tradeDateNtl;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="comment">// Check the forward before plugging it into the black formula</span></div>
<div class="line"><span class="lineno">  102</span>    QL_REQUIRE(Fp &gt; 0.0 || <a class="code hl_function" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(stdDev, 0.0),</div>
<div class="line"><span class="lineno">  103</span>               <span class="stringliteral">&quot;BlackIndexCdsOptionEngine: FEP adjusted forward spread (&quot;</span></div>
<div class="line"><span class="lineno">  104</span>                   &lt;&lt; Fp &lt;&lt; <span class="stringliteral">&quot;) is not positive, can not calculate a reasonable option price&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span>    <span class="comment">// The strike spread might get negative through the adjustment above, but economically the strike is</span></div>
<div class="line"><span class="lineno">  106</span>    <span class="comment">// floored at 0.0, so we ensure this here. This lets us compute the black formula as well in all cases.</span></div>
<div class="line"><span class="lineno">  107</span>    Kp = std::max(Kp, 0.0);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.value = discTradeCollToExercise / (Settlement::Cash ? discSwapCurrToExercise : discTradeCollToExercise) *</div>
<div class="line"><span class="lineno">  110</span>                     rpv01 * cds.notional() * blackFormula(callPut, Kp, Fp, stdDev, 1.0);</div>
<div class="line"><span class="lineno">  111</span>}</div>
<div class="ttc" id="acdsoption_8cpp_html_afeb3e8b4e6ab6604c185b2ea55bbc728"><div class="ttname"><a href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a></div><div class="ttdeci">const Instrument::results * results_</div><div class="ttdef"><b>Definition:</b> <a href="cdsoption_8cpp_source.html#l00081">cdsoption.cpp:81</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_black_index_cds_option_engine_html_aab9bdebebc4d62e557d3bae7c686dbfc"><div class="ttname"><a href="class_quant_ext_1_1_black_index_cds_option_engine.html#aab9bdebebc4d62e557d3bae7c686dbfc">QuantExt::BlackIndexCdsOptionEngine::forwardRiskyAnnuityStrike</a></div><div class="ttdeci">QuantLib::Real forwardRiskyAnnuityStrike() const</div><div class="ttdef"><b>Definition:</b> <a href="blackindexcdsoptionengine_8cpp_source.html#l00172">blackindexcdsoptionengine.cpp:172</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_credit_vol_curve_html_a1d1cfd8ffb84e947f82999c682b666a7a180bc3b1c5619aaef40e803f49921012"><div class="ttname"><a href="class_quant_ext_1_1_credit_vol_curve.html#a1d1cfd8ffb84e947f82999c682b666a7a180bc3b1c5619aaef40e803f49921012">QuantExt::CreditVolCurve::Type::Spread</a></div><div class="ttdeci">@ Spread</div></div>
<div class="ttc" id="aclass_quant_ext_1_1_index_cds_option_base_engine_html_a5afe1ea7cea4cbeb6d9db105c04b2002"><div class="ttname"><a href="class_quant_ext_1_1_index_cds_option_base_engine.html#a5afe1ea7cea4cbeb6d9db105c04b2002">QuantExt::IndexCdsOptionBaseEngine::discountTradeCollateral_</a></div><div class="ttdeci">QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt; discountTradeCollateral_</div><div class="ttdef"><b>Definition:</b> <a href="indexcdsoptionbaseengine_8hpp_source.html#l00077">indexcdsoptionbaseengine.hpp:77</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_index_cds_option_base_engine_html_aa8ba2fefe6922f36f0437aa52c5b0bd5"><div class="ttname"><a href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">QuantExt::IndexCdsOptionBaseEngine::volatility</a></div><div class="ttdeci">const QuantLib::Handle&lt; QuantExt::CreditVolCurve &gt; volatility() const</div><div class="ttdef"><b>Definition:</b> <a href="indexcdsoptionbaseengine_8cpp_source.html#l00083">indexcdsoptionbaseengine.cpp:83</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_index_cds_option_base_engine_html_aac544765f16a4ca1df403284762ba8b0"><div class="ttname"><a href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">QuantExt::IndexCdsOptionBaseEngine::discountSwapCurrency_</a></div><div class="ttdeci">QuantLib::Handle&lt; QuantLib::YieldTermStructure &gt; discountSwapCurrency_</div><div class="ttdef"><b>Definition:</b> <a href="indexcdsoptionbaseengine_8hpp_source.html#l00076">indexcdsoptionbaseengine.hpp:76</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_index_cds_option_base_engine_html_ab0b5049883e81849c43a1e8b513ecdf5"><div class="ttname"><a href="class_quant_ext_1_1_index_cds_option_base_engine.html#ab0b5049883e81849c43a1e8b513ecdf5">QuantExt::IndexCdsOptionBaseEngine::volatility_</a></div><div class="ttdeci">QuantLib::Handle&lt; QuantExt::CreditVolCurve &gt; volatility_</div><div class="ttdef"><b>Definition:</b> <a href="indexcdsoptionbaseengine_8hpp_source.html#l00078">indexcdsoptionbaseengine.hpp:78</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_a1cab4fb6a720eff245acb9f3a7a9e7c5"><div class="ttname"><a href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">QuantExt::close_enough</a></div><div class="ttdeci">Filter close_enough(const RandomVariable &amp;x, const RandomVariable &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="qle_2math_2randomvariable_8cpp_source.html#l00817">randomvariable.cpp:817</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_a5eedff657bd84ace641bab7e28ac9ed1"><div class="ttname"><a href="namespace_quant_ext.html#a5eedff657bd84ace641bab7e28ac9ed1">QuantExt::periodToTime</a></div><div class="ttdeci">Real periodToTime(const Period &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="time_8cpp_source.html#l00037">time.cpp:37</a></div></div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_cgraph" id="aclass_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_cgraph">
<area shape="rect" title=" " alt="" coords="5,120,155,145"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="209,5,374,31"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7" title="Calculate the discounted value of the front end protection." alt="" coords="203,55,380,95"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#aab9bdebebc4d62e557d3bae7c686dbfc" title=" " alt="" coords="204,120,379,145"/>
<area shape="rect" href="namespace_quant_ext.html#a5eedff657bd84ace641bab7e28ac9ed1" title=" " alt="" coords="210,169,373,195"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5" title=" " alt="" coords="203,219,380,259"/>
</map>
</div>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_icgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_icgraph" id="aclass_quant_ext_1_1_black_index_cds_option_engine_a27789616a6faf122fbbaae0f62a4b315_icgraph">
<area shape="rect" title=" " alt="" coords="116,5,265,31"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a4bb88e3144128b098847d66e63dc58d1" title="Engine specific calculation." alt="" coords="5,5,68,31"/>
</map>
</div>

</div>
</div>
<a id="ae093c7cb964deff3b02ec1a91e5760e2" name="ae093c7cb964deff3b02ec1a91e5760e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae093c7cb964deff3b02ec1a91e5760e2">&#9670;&#160;</a></span>priceStrikeCalculate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void priceStrikeCalculate </td>
          <td>(</td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>fep</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="blackindexcdsoptionengine_8cpp_source.html#l00113">113</a> of file <a class="el" href="blackindexcdsoptionengine_8cpp_source.html">blackindexcdsoptionengine.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  113</span>                                                                   {</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="comment">// Underlying index CDS.</span></div>
<div class="line"><span class="lineno">  116</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cds = *<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.swap;</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    <span class="comment">// Add some additional entries to additional results.</span></div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;strikePrice&quot;</span>] = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.strike;</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keyword">const</span> Real&amp; tradeDateNtl = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.tradeDateNtl;</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;valuationDateNotional&quot;</span>] = cds.notional();</div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;tradeDateNotional&quot;</span>] = tradeDateNtl;</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    <span class="comment">// effective strike (strike is expressed w.r.t. trade date notional by market convention)</span></div>
<div class="line"><span class="lineno">  126</span>    Real effStrike = 1.0 - tradeDateNtl / cds.notional() * (1.0 - <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.strike);</div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;strikePriceDefaultAdjusted&quot;</span>] = effStrike;</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>    <span class="comment">// Discount factor to exercise</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="keyword">const</span> Date&amp; exerciseDate = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.exercise-&gt;dates().front();</div>
<div class="line"><span class="lineno">  131</span>    Real exerciseTime = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ab0b5049883e81849c43a1e8b513ecdf5">volatility_</a>-&gt;timeFromReference(exerciseDate);</div>
<div class="line"><span class="lineno">  132</span>    DiscountFactor discTradeCollToExercise = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a5afe1ea7cea4cbeb6d9db105c04b2002">discountTradeCollateral_</a>-&gt;discount(exerciseDate);</div>
<div class="line"><span class="lineno">  133</span>    DiscountFactor discSwapCurrToExercise = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a>-&gt;discount(exerciseDate);</div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;discountToExerciseTradeCollateral&quot;</span>] = discTradeCollToExercise;</div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;discountToExerciseSwapCurrency&quot;</span>] = discSwapCurrToExercise;</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="comment">// NPV from buyer&#39;s perspective gives upfront, as of valuation date, with correct sign.</span></div>
<div class="line"><span class="lineno">  138</span>    Real npv = cds.side() == Protection::Buyer ? cds.NPV() : -cds.NPV();</div>
<div class="line"><span class="lineno">  139</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;upfront&quot;</span>] =</div>
<div class="line"><span class="lineno">  140</span>        npv * (<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.settlementType == Settlement::Cash ? discTradeCollToExercise / discSwapCurrToExercise : 1.0);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    Real forwardPrice =</div>
<div class="line"><span class="lineno">  143</span>        1 - npv / cds.notional() / (Settlement::Cash ? discSwapCurrToExercise : discTradeCollToExercise);</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;forwardPrice&quot;</span>] = forwardPrice;</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// Front end protection adjusted forward price.</span></div>
<div class="line"><span class="lineno">  147</span>    Real Fp = forwardPrice - <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7">fep</a> / cds.notional() / discTradeCollToExercise;</div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;fepAdjustedForwardPrice&quot;</span>] = Fp;</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>    <span class="comment">// Read the volatility from the volatility surface</span></div>
<div class="line"><span class="lineno">  151</span>    Real <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a> = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#ab0b5049883e81849c43a1e8b513ecdf5">volatility_</a>-&gt;volatility(exerciseDate, <a class="code hl_function" href="namespace_quant_ext.html#a5eedff657bd84ace641bab7e28ac9ed1">QuantExt::periodToTime</a>(<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.indexTerm), effStrike,</div>
<div class="line"><span class="lineno">  152</span>                                              <a class="code hl_enumvalue" href="class_quant_ext_1_1_credit_vol_curve.html#a1d1cfd8ffb84e947f82999c682b666a7a3601146c4e948c32b6424d2c0a7f0118">CreditVolCurve::Type::Price</a>);</div>
<div class="line"><span class="lineno">  153</span>    Real stdDev = <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a> * std::sqrt(exerciseTime);</div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;volatility&quot;</span>] = <a class="code hl_function" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5">volatility</a>;</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;standardDeviation&quot;</span>] = stdDev;</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="comment">// If protection buyer, put on price.</span></div>
<div class="line"><span class="lineno">  158</span>    Option::Type cp = cds.side() == Protection::Buyer ? Option::Put : Option::Call;</div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;callPut&quot;</span>] = cp == Option::Put ? string(<span class="stringliteral">&quot;Put&quot;</span>) : string(<span class="stringliteral">&quot;Call&quot;</span>);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>    <span class="comment">// Check the inputs to the black formula before applying it</span></div>
<div class="line"><span class="lineno">  162</span>    QL_REQUIRE(Fp &gt; 0.0 || <a class="code hl_function" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(stdDev, 0.0),</div>
<div class="line"><span class="lineno">  163</span>               <span class="stringliteral">&quot;BlackIndexCdsOptionEngine: FEP adjusted forward price (&quot;</span></div>
<div class="line"><span class="lineno">  164</span>                   &lt;&lt; Fp &lt;&lt; <span class="stringliteral">&quot;) is not positive, can not calculate a reasonable option price&quot;</span>);</div>
<div class="line"><span class="lineno">  165</span>    QL_REQUIRE(effStrike &gt; 0 || <a class="code hl_function" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5">close_enough</a>(effStrike, 0.0),</div>
<div class="line"><span class="lineno">  166</span>               <span class="stringliteral">&quot;BlackIndexCdsOptionEngine: Effective Strike price (&quot;</span></div>
<div class="line"><span class="lineno">  167</span>                   &lt;&lt; effStrike &lt;&lt; <span class="stringliteral">&quot;) is not positive, can not calculate a reasonable option price&quot;</span>);</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.value = cds.notional() * blackFormula(cp, effStrike, Fp, stdDev, discTradeCollToExercise);</div>
<div class="line"><span class="lineno">  170</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_credit_vol_curve_html_a1d1cfd8ffb84e947f82999c682b666a7a3601146c4e948c32b6424d2c0a7f0118"><div class="ttname"><a href="class_quant_ext_1_1_credit_vol_curve.html#a1d1cfd8ffb84e947f82999c682b666a7a3601146c4e948c32b6424d2c0a7f0118">QuantExt::CreditVolCurve::Type::Price</a></div><div class="ttdeci">@ Price</div></div>
</div><!-- fragment --><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_cgraph.png" border="0" usemap="#aclass_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_cgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_cgraph" id="aclass_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_cgraph">
<area shape="rect" title=" " alt="" coords="5,92,144,117"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="198,5,363,31"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html#a63d06231ff26afe48c5e7b2fc22352b7" title="Calculate the discounted value of the front end protection." alt="" coords="192,55,369,95"/>
<area shape="rect" href="namespace_quant_ext.html#a5eedff657bd84ace641bab7e28ac9ed1" title=" " alt="" coords="199,120,362,145"/>
<area shape="rect" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aa8ba2fefe6922f36f0437aa52c5b0bd5" title=" " alt="" coords="192,170,369,210"/>
</map>
</div>
<div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_icgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_icgraph" id="aclass_quant_ext_1_1_black_index_cds_option_engine_ae093c7cb964deff3b02ec1a91e5760e2_icgraph">
<area shape="rect" title=" " alt="" coords="116,5,255,31"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a4bb88e3144128b098847d66e63dc58d1" title="Engine specific calculation." alt="" coords="5,5,68,31"/>
</map>
</div>

</div>
</div>
<a id="aab9bdebebc4d62e557d3bae7c686dbfc" name="aab9bdebebc4d62e557d3bae7c686dbfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9bdebebc4d62e557d3bae7c686dbfc">&#9670;&#160;</a></span>forwardRiskyAnnuityStrike()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real forwardRiskyAnnuityStrike </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="blackindexcdsoptionengine_8cpp_source.html#l00172">172</a> of file <a class="el" href="blackindexcdsoptionengine_8cpp_source.html">blackindexcdsoptionengine.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  172</span>                                                                {</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">// Underlying index CDS.</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cds = *<a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.swap;</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">// This method returns RPV01(0; t_e, T, K) / SP(t_e; K). This is the quantity in formula 11.9 of O&#39;Kane 2008.</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">// There is a slight modification in that we divide by the survival probability to t_E using the flat curve at</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="comment">// the strike spread that we create here.</span></div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    <span class="comment">// Standard index CDS schedule.</span></div>
<div class="line"><span class="lineno">  182</span>    Schedule schedule = MakeSchedule()</div>
<div class="line"><span class="lineno">  183</span>                            .from(cds.protectionStartDate())</div>
<div class="line"><span class="lineno">  184</span>                            .to(cds.maturity())</div>
<div class="line"><span class="lineno">  185</span>                            .withCalendar(WeekendsOnly())</div>
<div class="line"><span class="lineno">  186</span>                            .withFrequency(Quarterly)</div>
<div class="line"><span class="lineno">  187</span>                            .withConvention(Following)</div>
<div class="line"><span class="lineno">  188</span>                            .withTerminationDateConvention(Unadjusted)</div>
<div class="line"><span class="lineno">  189</span>                            .withRule(DateGeneration::CDS2015);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <span class="comment">// Derive hazard rate curve from a single forward starting CDS matching the characteristics of underlying index</span></div>
<div class="line"><span class="lineno">  192</span>    <span class="comment">// CDS with a running spread equal to the strike.</span></div>
<div class="line"><span class="lineno">  193</span>    <span class="keyword">const</span> Real&amp; strike = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.strike;</div>
<div class="line"><span class="lineno">  194</span>    Real accuracy = 1e-8;</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="keyword">auto</span> strikeCds = boost::make_shared&lt;CreditDefaultSwap&gt;(</div>
<div class="line"><span class="lineno">  197</span>        Protection::Buyer, 1 / accuracy, strike, schedule, Following, Actual360(), cds.settlesAccrual(),</div>
<div class="line"><span class="lineno">  198</span>        cds.protectionPaymentTime(), cds.protectionStartDate(), boost::shared_ptr&lt;Claim&gt;(), Actual360(<span class="keyword">true</span>),</div>
<div class="line"><span class="lineno">  199</span>        <span class="keyword">true</span>, cds.tradeDate(), cds.cashSettlementDays());</div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">// dummy engine</span></div>
<div class="line"><span class="lineno">  201</span>    strikeCds-&gt;setPricingEngine(boost::make_shared&lt;MidPointCdsEngine&gt;(</div>
<div class="line"><span class="lineno">  202</span>        Handle&lt;DefaultProbabilityTermStructure&gt;(</div>
<div class="line"><span class="lineno">  203</span>            boost::make_shared&lt;FlatHazardRate&gt;(0, NullCalendar(), 0.0, Actual365Fixed())),</div>
<div class="line"><span class="lineno">  204</span>        0.0, Handle&lt;YieldTermStructure&gt;(boost::make_shared&lt;FlatForward&gt;(0, NullCalendar(), 0.0, Actual365Fixed()))));</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    Real hazardRate;</div>
<div class="line"><span class="lineno">  207</span>    <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  208</span>        hazardRate =</div>
<div class="line"><span class="lineno">  209</span>            strikeCds-&gt;impliedHazardRate(0.0, <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a>, Actual365Fixed(), <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aaa769435bc2b8e0541fb19b1e4ba2cbe">indexRecovery_</a>, accuracy);</div>
<div class="line"><span class="lineno">  210</span>    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; e) {</div>
<div class="line"><span class="lineno">  211</span>        QL_FAIL(<span class="stringliteral">&quot;can not imply fair hazard rate for CDS at option strike &quot;</span></div>
<div class="line"><span class="lineno">  212</span>                &lt;&lt; strike &lt;&lt; <span class="stringliteral">&quot;. Is the strike correct? Exception: &quot;</span> &lt;&lt; e.what());</div>
<div class="line"><span class="lineno">  213</span>    }</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    Handle&lt;DefaultProbabilityTermStructure&gt; dph(</div>
<div class="line"><span class="lineno">  216</span>        boost::make_shared&lt;FlatHazardRate&gt;(<a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a>-&gt;referenceDate(), hazardRate, Actual365Fixed()));</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    <span class="comment">// Calculate the forward risky strike annuity.</span></div>
<div class="line"><span class="lineno">  219</span>    strikeCds-&gt;setPricingEngine(</div>
<div class="line"><span class="lineno">  220</span>        boost::make_shared&lt;QuantExt::MidPointCdsEngine&gt;(dph, <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aaa769435bc2b8e0541fb19b1e4ba2cbe">indexRecovery_</a>, <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a>));</div>
<div class="line"><span class="lineno">  221</span>    Real rpv01_K = std::abs(strikeCds-&gt;couponLegNPV() + strikeCds-&gt;accrualRebateNPV()) /</div>
<div class="line"><span class="lineno">  222</span>                   (strikeCds-&gt;notional() * strikeCds-&gt;runningSpread());</div>
<div class="line"><span class="lineno">  223</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;riskyAnnuityStrike&quot;</span>] = rpv01_K;</div>
<div class="line"><span class="lineno">  224</span>    QL_REQUIRE(rpv01_K &gt; 0.0, <span class="stringliteral">&quot;BlackIndexCdsOptionEngine: strike based risky annuity must be positive.&quot;</span>);</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">// Survival to exercise</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="keyword">const</span> Date&amp; exerciseDate = <a class="code hl_variable" href="tenorbasisswap_8cpp.html#a71b2ce0e52885aca4ce15e1d128b9f56">arguments_</a>.exercise-&gt;dates().front();</div>
<div class="line"><span class="lineno">  228</span>    Probability spToExercise = dph-&gt;survivalProbability(exerciseDate);</div>
<div class="line"><span class="lineno">  229</span>    Real discToExercise = <a class="code hl_variable" href="class_quant_ext_1_1_index_cds_option_base_engine.html#aac544765f16a4ca1df403284762ba8b0">discountSwapCurrency_</a>-&gt;discount(exerciseDate);</div>
<div class="line"><span class="lineno">  230</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;strikeBasedSurvivalToExercise&quot;</span>] = spToExercise;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    <span class="comment">// Forward risky annuity strike (divides out the survival probability and discount to exercise)</span></div>
<div class="line"><span class="lineno">  233</span>    Real rpv01_K_fwd = rpv01_K / spToExercise / discToExercise;</div>
<div class="line"><span class="lineno">  234</span>    <a class="code hl_variable" href="cdsoption_8cpp.html#afeb3e8b4e6ab6604c185b2ea55bbc728">results_</a>.additionalResults[<span class="stringliteral">&quot;forwardRiskyAnnuityStrike&quot;</span>] = rpv01_K_fwd;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">return</span> rpv01_K_fwd;</div>
<div class="line"><span class="lineno">  237</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_index_cds_option_base_engine_html_aaa769435bc2b8e0541fb19b1e4ba2cbe"><div class="ttname"><a href="class_quant_ext_1_1_index_cds_option_base_engine.html#aaa769435bc2b8e0541fb19b1e4ba2cbe">QuantExt::IndexCdsOptionBaseEngine::indexRecovery_</a></div><div class="ttdeci">QuantLib::Real indexRecovery_</div><div class="ttdoc">Assumed index recovery used in the flat strike spread curve calculation if provided.</div><div class="ttdef"><b>Definition:</b> <a href="indexcdsoptionbaseengine_8hpp_source.html#l00081">indexcdsoptionbaseengine.hpp:81</a></div></div>
</div><!-- fragment --><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_black_index_cds_option_engine_aab9bdebebc4d62e557d3bae7c686dbfc_icgraph.png" border="0" usemap="#aclass_quant_ext_1_1_black_index_cds_option_engine_aab9bdebebc4d62e557d3bae7c686dbfc_icgraph" alt=""/></div>
<map name="aclass_quant_ext_1_1_black_index_cds_option_engine_aab9bdebebc4d62e557d3bae7c686dbfc_icgraph" id="aclass_quant_ext_1_1_black_index_cds_option_engine_aab9bdebebc4d62e557d3bae7c686dbfc_icgraph">
<area shape="rect" title=" " alt="" coords="313,5,488,31"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a27789616a6faf122fbbaae0f62a4b315" title=" " alt="" coords="116,5,265,31"/>
<area shape="rect" href="class_quant_ext_1_1_black_index_cds_option_engine.html#a4bb88e3144128b098847d66e63dc58d1" title="Engine specific calculation." alt="" coords="5,5,68,31"/>
</map>
</div>

</div>
</div>
<a id="ac11052eed2d3f0b493df7af78a4c0894" name="ac11052eed2d3f0b493df7af78a4c0894"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac11052eed2d3f0b493df7af78a4c0894">&#9670;&#160;</a></span>IndexCdsOptionBaseEngine() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html">IndexCdsOptionBaseEngine</a> </td>
          <td>(</td>
          <td class="paramtype">const QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>probability</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>recovery</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>discountSwapCurrency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>discountTradeCollateral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>volatility</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor taking a default probability term structure bootstrapped from the index spreads. </p>

</div>
</div>
<a id="a26e6a96c22ec00221b9b39d56ec77e54" name="a26e6a96c22ec00221b9b39d56ec77e54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26e6a96c22ec00221b9b39d56ec77e54">&#9670;&#160;</a></span>IndexCdsOptionBaseEngine() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_index_cds_option_base_engine.html">IndexCdsOptionBaseEngine</a> </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; QuantLib::Handle&lt; QuantLib::DefaultProbabilityTermStructure &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>probabilities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; QuantLib::Real &gt; &amp;&#160;</td>
          <td class="paramname"><em>recoveries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>discountSwapCurrency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>discountTradeCollateral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const QuantLib::Handle&lt; <a class="el" href="class_quant_ext_1_1_credit_vol_curve.html">QuantExt::CreditVolCurve</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>volatility</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QuantLib::Real&#160;</td>
          <td class="paramname"><em>indexRecovery</em> = <code>QuantLib::Null&lt;QuantLib::Real&gt;()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Constructor taking a vector of default probability term structures bootstrapped from the index constituent spread curves and a vector of associated recovery rates. </p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
