<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>QuantExt: RepresentativeFxOptionMatcher Class Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantextextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-qle@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.11</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_quant_ext.html">QuantExt</a></li><li class="navelem"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html">RepresentativeFxOptionMatcher</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_quant_ext_1_1_representative_fx_option_matcher-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">RepresentativeFxOptionMatcher Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="representativefxoption_8hpp_source.html">qle/models/representativefxoption.hpp</a>&gt;</code></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for RepresentativeFxOptionMatcher:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="class_quant_ext_1_1_representative_fx_option_matcher__coll__graph.png" border="0" usemap="#a_representative_fx_option_matcher_coll__map" alt="Collaboration graph"/></div>
<map name="a_representative_fx_option_matcher_coll__map" id="a_representative_fx_option_matcher_coll__map">
<area shape="rect" title=" " alt="" coords="5,212,239,325"/>
<area shape="rect" title=" " alt="" coords="50,95,109,135"/>
<area shape="rect" title=" " alt="" coords="6,5,153,45"/>
<area shape="rect" title=" " alt="" coords="133,95,185,135"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3cd464ffde3ff4ce8a3cfb5088177886"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#a3cd464ffde3ff4ce8a3cfb5088177886">RepresentativeFxOptionMatcher</a> (const std::vector&lt; Leg &gt; &amp;underlying, const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;isPayer, const std::vector&lt; std::string &gt; &amp;currencies, const Date &amp;referenceDate, const std::string &amp;forCcy, const std::string &amp;domCcy, const Handle&lt; YieldTermStructure &gt; &amp;forCurve, const Handle&lt; YieldTermStructure &gt; &amp;domCurve, const Handle&lt; Quote &gt; &amp;fxSpot, const <a class="el" href="classbool.html">bool</a> includeRefDateFlows=false)</td></tr>
<tr class="separator:a3cd464ffde3ff4ce8a3cfb5088177886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd4aa0b57c3b5ac4d9ebf8d170711a84"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#abd4aa0b57c3b5ac4d9ebf8d170711a84">currency1</a> () const</td></tr>
<tr class="separator:abd4aa0b57c3b5ac4d9ebf8d170711a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5de5167b57b717996ba1b178e79a1257"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#a5de5167b57b717996ba1b178e79a1257">currency2</a> () const</td></tr>
<tr class="separator:a5de5167b57b717996ba1b178e79a1257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb16264d778801ee6446353a9246c8e"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#a7eb16264d778801ee6446353a9246c8e">amount1</a> () const</td></tr>
<tr class="separator:a7eb16264d778801ee6446353a9246c8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcf1cb3defe8b3b6e3adf8dc69e699fe"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#afcf1cb3defe8b3b6e3adf8dc69e699fe">amount2</a> () const</td></tr>
<tr class="separator:afcf1cb3defe8b3b6e3adf8dc69e699fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:adf4dbfa85640ed74625f2ec628bd665b"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#adf4dbfa85640ed74625f2ec628bd665b">ccy1_</a></td></tr>
<tr class="separator:adf4dbfa85640ed74625f2ec628bd665b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f62d535d80126e5072e9b9ca0470ef"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#ae5f62d535d80126e5072e9b9ca0470ef">ccy2_</a></td></tr>
<tr class="separator:ae5f62d535d80126e5072e9b9ca0470ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb5838cdeed909f773456c8e469b34f"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#a4eb5838cdeed909f773456c8e469b34f">amount1_</a></td></tr>
<tr class="separator:a4eb5838cdeed909f773456c8e469b34f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6f66d159240d0260bad0e38b4bdfb4"><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html#aad6f66d159240d0260bad0e38b4bdfb4">amount2_</a></td></tr>
<tr class="separator:aad6f66d159240d0260bad0e38b4bdfb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Given cashflows in two currencies and a reference date &gt;= today, find amounts in the two currencies to be paid on the reference date such that the NPV and FX Delta of the original cashflows and the original cashflows as seen from the reference date are equal.</p>
<p >The output amounts have a sign, i.e. they are received if positive and paid if negative. </p>

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00041">41</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3cd464ffde3ff4ce8a3cfb5088177886" name="a3cd464ffde3ff4ce8a3cfb5088177886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd464ffde3ff4ce8a3cfb5088177886">&#9670;&#160;</a></span>RepresentativeFxOptionMatcher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_quant_ext_1_1_representative_fx_option_matcher.html">RepresentativeFxOptionMatcher</a> </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Leg &gt; &amp;&#160;</td>
          <td class="paramname"><em>underlying</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>isPayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>currencies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Date &amp;&#160;</td>
          <td class="paramname"><em>referenceDate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>forCcy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>domCcy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>forCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; YieldTermStructure &gt; &amp;&#160;</td>
          <td class="paramname"><em>domCurve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Handle&lt; Quote &gt; &amp;&#160;</td>
          <td class="paramname"><em>fxSpot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>includeRefDateFlows</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8cpp_source.html#l00039">39</a> of file <a class="el" href="representativefxoption_8cpp_source.html">representativefxoption.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>                                    {</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    Date today = Settings::instance().evaluationDate();</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <span class="comment">// 1 check inputs</span></div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    QL_REQUIRE(referenceDate &gt;= today, <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: referenceDate (&quot;</span></div>
<div class="line"><span class="lineno">   50</span>                                           &lt;&lt; referenceDate &lt;&lt; <span class="stringliteral">&quot;) must be &lt; today (&quot;</span> &lt;&lt; today &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">   51</span>    QL_REQUIRE(isPayer.size() == underlying.size(), <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: isPayer (&quot;</span></div>
<div class="line"><span class="lineno">   52</span>                                                        &lt;&lt; isPayer.size() &lt;&lt; <span class="stringliteral">&quot;) does not match underlying (&quot;</span></div>
<div class="line"><span class="lineno">   53</span>                                                        &lt;&lt; underlying.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">   54</span>    QL_REQUIRE(currencies.size() == underlying.size(), <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: currencies (&quot;</span></div>
<div class="line"><span class="lineno">   55</span>                                                           &lt;&lt; currencies.size() &lt;&lt; <span class="stringliteral">&quot;) does not match underlying (&quot;</span></div>
<div class="line"><span class="lineno">   56</span>                                                           &lt;&lt; underlying.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="comment">// 2a  make a copy of the input fx spot that we can shift later</span></div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">auto</span> fxScenarioValue = boost::make_shared&lt;SimpleQuote&gt;(fxSpot-&gt;value());</div>
<div class="line"><span class="lineno">   61</span>    Handle&lt;Quote&gt; fxSpotScen(fxScenarioValue);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">// 2b create the inverse spot, this is convenient when we clone fx linked cashflows below</span></div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    <span class="keyword">auto</span> m = [](Real x) { <span class="keywordflow">return</span> 1.0 / x; };</div>
<div class="line"><span class="lineno">   66</span>    Handle&lt;Quote&gt; fxSpotScenInv(boost::make_shared&lt;DerivedQuote&lt;<span class="keyword">decltype</span>(m)&gt;&gt;(fxSpotScen, m));</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="comment">// 3 collect cashflows by their pay currencies and link them to the fx spot copy (if applicable)</span></div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    Leg forCfs, domCfs;</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; underlying.size(); ++i) {</div>
<div class="line"><span class="lineno">   73</span>        <span class="comment">// 3a check the pay ccy is one of the two currencies to be matched</span></div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>        QL_REQUIRE(currencies[i] == forCcy || currencies[i] == domCcy,</div>
<div class="line"><span class="lineno">   76</span>                   <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: currency at index &quot;</span></div>
<div class="line"><span class="lineno">   77</span>                       &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; currencies[i] &lt;&lt; <span class="stringliteral">&quot;) does not match forCcy (&quot;</span> &lt;&lt; forCcy &lt;&lt; <span class="stringliteral">&quot;) or domCcy (&quot;</span></div>
<div class="line"><span class="lineno">   78</span>                       &lt;&lt; domCcy &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; c : underlying[i]) {</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>            <span class="comment">// 3b skip cashflows with pay date on or</span></div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>            <span class="keywordflow">if</span> (c-&gt;date() &lt; referenceDate || (c-&gt;date() == referenceDate &amp;&amp; !includeRefDateFlows))</div>
<div class="line"><span class="lineno">   85</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>            <span class="comment">// 3b check for non-supported coupon types that are linked to fx</span></div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>            QL_REQUIRE(!boost::dynamic_pointer_cast&lt;IndexedCoupon&gt;(c),</div>
<div class="line"><span class="lineno">   90</span>                       <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: Indexed Coupons are not supported&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>            boost::shared_ptr&lt;CashFlow&gt; res;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>            <span class="keywordflow">if</span> (<span class="keyword">auto</span> fxlinked = boost::dynamic_pointer_cast&lt;FXLinked&gt;(c)) {</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>                <span class="comment">// 3c clone fx linked coupons and link them to our scenario fx spot quote</span></div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>                std::set&lt;std::string&gt; ccys = {fxlinked-&gt;fxIndex()-&gt;sourceCurrency().code(),</div>
<div class="line"><span class="lineno">   99</span>                                              fxlinked-&gt;fxIndex()-&gt;targetCurrency().code()};</div>
<div class="line"><span class="lineno">  100</span>                QL_REQUIRE((ccys == std::set&lt;std::string&gt;{forCcy, domCcy}),</div>
<div class="line"><span class="lineno">  101</span>                           <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: FXLinked coupon ccys &quot;</span></div>
<div class="line"><span class="lineno">  102</span>                               &lt;&lt; fxlinked-&gt;fxIndex()-&gt;sourceCurrency().code() &lt;&lt; <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno">  103</span>                               &lt;&lt; fxlinked-&gt;fxIndex()-&gt;targetCurrency().code()</div>
<div class="line"><span class="lineno">  104</span>                               &lt;&lt; <span class="stringliteral">&quot; do noth match currencies to be matched (&quot;</span> &lt;&lt; forCcy &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; domCcy &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>                res = boost::dynamic_pointer_cast&lt;CashFlow&gt;(fxlinked-&gt;clone(fxlinked-&gt;fxIndex()-&gt;clone(</div>
<div class="line"><span class="lineno">  107</span>                    fxlinked-&gt;fxIndex()-&gt;sourceCurrency().code() == forCcy ? fxSpotScen : fxSpotScenInv,</div>
<div class="line"><span class="lineno">  108</span>                    fxlinked-&gt;fxIndex()-&gt;sourceCurve(), fxlinked-&gt;fxIndex()-&gt;targetCurve())));</div>
<div class="line"><span class="lineno">  109</span>                QL_REQUIRE(res, <span class="stringliteral">&quot;RepresentativeFxOptionMatcher: internal error, cloned fx linked cashflow could not be &quot;</span></div>
<div class="line"><span class="lineno">  110</span>                                <span class="stringliteral">&quot;cast to CashFlow&quot;</span>);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>                <span class="comment">// 3d for all other coupons, just push a fixed cashflow with the amount</span></div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>                res = boost::make_shared&lt;SimpleCashFlow&gt;(c-&gt;amount(), c-&gt;date());</div>
<div class="line"><span class="lineno">  117</span>            }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>            <span class="comment">// 3e push the cashflow with the correct sign to the vector holding the flows in the its pay ccy</span></div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>            res = boost::make_shared&lt;ScaledCashFlow&gt;(isPayer[i] ? -1.0 : 1.0, res);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>            <span class="keywordflow">if</span> (currencies[i] == forCcy)</div>
<div class="line"><span class="lineno">  124</span>                forCfs.push_back(res);</div>
<div class="line"><span class="lineno">  125</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  126</span>                domCfs.push_back(res);</div>
<div class="line"><span class="lineno">  127</span>        }</div>
<div class="line"><span class="lineno">  128</span>    }</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">// 4a determine the NPV of the collected cashflows in dom ccy and as seen from the global evaluation date</span></div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>    Real npv =</div>
<div class="line"><span class="lineno">  133</span>        CashFlows::npv(forCfs, **forCurve, <span class="keyword">false</span>) * fxSpotScen-&gt;value() + CashFlows::npv(domCfs, **domCurve, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    <span class="comment">// 4b determine the FX Delta of the collected cashflows as seen from the global evaluation date</span></div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keyword">constexpr</span> Real relShift = 0.01;</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    Real baseFx = fxScenarioValue-&gt;value();</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    fxScenarioValue-&gt;setValue(baseFx * (1.0 + relShift));</div>
<div class="line"><span class="lineno">  142</span>    Real npv_up =</div>
<div class="line"><span class="lineno">  143</span>        CashFlows::npv(forCfs, **forCurve, <span class="keyword">false</span>) * fxSpotScen-&gt;value() + CashFlows::npv(domCfs, **domCurve, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    fxScenarioValue-&gt;setValue(baseFx * (1.0 - relShift));</div>
<div class="line"><span class="lineno">  146</span>    Real npv_down =</div>
<div class="line"><span class="lineno">  147</span>        CashFlows::npv(forCfs, **forCurve, <span class="keyword">false</span>) * fxSpotScen-&gt;value() + CashFlows::npv(domCfs, **domCurve, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    Real fxDelta = (npv_up - npv_down) / (2.0 * baseFx * relShift);</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    <span class="comment">// 4c determine the amounts in for and dom ccy matching the fx delta and the npv, as seen from the global evaluation</span></div>
<div class="line"><span class="lineno">  152</span>    <span class="comment">// date, then compound the resulting amounts to the reference date</span></div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#a4eb5838cdeed909f773456c8e469b34f">amount1_</a> = fxDelta / forCurve-&gt;discount(referenceDate);</div>
<div class="line"><span class="lineno">  155</span>    <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#aad6f66d159240d0260bad0e38b4bdfb4">amount2_</a> = (npv - fxDelta * baseFx) / domCurve-&gt;discount(referenceDate);</div>
<div class="line"><span class="lineno">  156</span>    <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#adf4dbfa85640ed74625f2ec628bd665b">ccy1_</a> = forCcy;</div>
<div class="line"><span class="lineno">  157</span>    <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#ae5f62d535d80126e5072e9b9ca0470ef">ccy2_</a> = domCcy;</div>
<div class="line"><span class="lineno">  158</span>}</div>
<div class="ttc" id="aclass_quant_ext_1_1_representative_fx_option_matcher_html_a4eb5838cdeed909f773456c8e469b34f"><div class="ttname"><a href="class_quant_ext_1_1_representative_fx_option_matcher.html#a4eb5838cdeed909f773456c8e469b34f">QuantExt::RepresentativeFxOptionMatcher::amount1_</a></div><div class="ttdeci">Real amount1_</div><div class="ttdef"><b>Definition:</b> <a href="representativefxoption_8hpp_source.html#l00058">representativefxoption.hpp:58</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_representative_fx_option_matcher_html_aad6f66d159240d0260bad0e38b4bdfb4"><div class="ttname"><a href="class_quant_ext_1_1_representative_fx_option_matcher.html#aad6f66d159240d0260bad0e38b4bdfb4">QuantExt::RepresentativeFxOptionMatcher::amount2_</a></div><div class="ttdeci">Real amount2_</div><div class="ttdef"><b>Definition:</b> <a href="representativefxoption_8hpp_source.html#l00058">representativefxoption.hpp:58</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_representative_fx_option_matcher_html_adf4dbfa85640ed74625f2ec628bd665b"><div class="ttname"><a href="class_quant_ext_1_1_representative_fx_option_matcher.html#adf4dbfa85640ed74625f2ec628bd665b">QuantExt::RepresentativeFxOptionMatcher::ccy1_</a></div><div class="ttdeci">std::string ccy1_</div><div class="ttdef"><b>Definition:</b> <a href="representativefxoption_8hpp_source.html#l00057">representativefxoption.hpp:57</a></div></div>
<div class="ttc" id="aclass_quant_ext_1_1_representative_fx_option_matcher_html_ae5f62d535d80126e5072e9b9ca0470ef"><div class="ttname"><a href="class_quant_ext_1_1_representative_fx_option_matcher.html#ae5f62d535d80126e5072e9b9ca0470ef">QuantExt::RepresentativeFxOptionMatcher::ccy2_</a></div><div class="ttdeci">std::string ccy2_</div><div class="ttdef"><b>Definition:</b> <a href="representativefxoption_8hpp_source.html#l00057">representativefxoption.hpp:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abd4aa0b57c3b5ac4d9ebf8d170711a84" name="abd4aa0b57c3b5ac4d9ebf8d170711a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd4aa0b57c3b5ac4d9ebf8d170711a84">&#9670;&#160;</a></span>currency1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string currency1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00051">51</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#adf4dbfa85640ed74625f2ec628bd665b">ccy1_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5de5167b57b717996ba1b178e79a1257" name="a5de5167b57b717996ba1b178e79a1257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5de5167b57b717996ba1b178e79a1257">&#9670;&#160;</a></span>currency2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string currency2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00052">52</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#ae5f62d535d80126e5072e9b9ca0470ef">ccy2_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7eb16264d778801ee6446353a9246c8e" name="a7eb16264d778801ee6446353a9246c8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb16264d778801ee6446353a9246c8e">&#9670;&#160;</a></span>amount1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real amount1 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00053">53</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#a4eb5838cdeed909f773456c8e469b34f">amount1_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afcf1cb3defe8b3b6e3adf8dc69e699fe" name="afcf1cb3defe8b3b6e3adf8dc69e699fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcf1cb3defe8b3b6e3adf8dc69e699fe">&#9670;&#160;</a></span>amount2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real amount2 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00054">54</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   54</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="class_quant_ext_1_1_representative_fx_option_matcher.html#aad6f66d159240d0260bad0e38b4bdfb4">amount2_</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="adf4dbfa85640ed74625f2ec628bd665b" name="adf4dbfa85640ed74625f2ec628bd665b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4dbfa85640ed74625f2ec628bd665b">&#9670;&#160;</a></span>ccy1_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ccy1_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00057">57</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>

</div>
</div>
<a id="ae5f62d535d80126e5072e9b9ca0470ef" name="ae5f62d535d80126e5072e9b9ca0470ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f62d535d80126e5072e9b9ca0470ef">&#9670;&#160;</a></span>ccy2_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string ccy2_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00057">57</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>

</div>
</div>
<a id="a4eb5838cdeed909f773456c8e469b34f" name="a4eb5838cdeed909f773456c8e469b34f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4eb5838cdeed909f773456c8e469b34f">&#9670;&#160;</a></span>amount1_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real amount1_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00058">58</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>

</div>
</div>
<a id="aad6f66d159240d0260bad0e38b4bdfb4" name="aad6f66d159240d0260bad0e38b4bdfb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6f66d159240d0260bad0e38b4bdfb4">&#9670;&#160;</a></span>amount2_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Real amount2_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="representativefxoption_8hpp_source.html#l00058">58</a> of file <a class="el" href="representativefxoption_8hpp_source.html">representativefxoption.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
