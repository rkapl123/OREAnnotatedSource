<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>QuantExt: test/deltagammavar.cpp File Reference</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="quantextextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-qle@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.11</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_13e138d54eb8818da29c3992edef070a.html">test</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">deltagammavar.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="toplevelfixture_8hpp_source.html">toplevelfixture.hpp</a>&quot;</code><br />
<code>#include &lt;boost/test/unit_test.hpp&gt;</code><br />
<code>#include &lt;<a class="el" href="deltagammavar_8hpp_source.html">qle/math/deltagammavar.hpp</a>&gt;</code><br />
<code>#include &lt;boost/make_shared.hpp&gt;</code><br />
<code>#include &lt;boost/math/distributions/chi_squared.hpp&gt;</code><br />
</div>
<p><a href="test_2deltagammavar_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a211c62f86bdf9d6b44c0b283464e5a2c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_2deltagammavar_8cpp.html#a211c62f86bdf9d6b44c0b283464e5a2c">BOOST_AUTO_TEST_CASE</a> (testDeltaGammaVar)</td></tr>
<tr class="separator:a211c62f86bdf9d6b44c0b283464e5a2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7aa37a2c9b7a0f119915ded5d6a10f62"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_2deltagammavar_8cpp.html#a7aa37a2c9b7a0f119915ded5d6a10f62">BOOST_AUTO_TEST_CASE</a> (testNegativeGamma)</td></tr>
<tr class="separator:a7aa37a2c9b7a0f119915ded5d6a10f62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c24bdfc8020479187354a3c3e3e1702"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_2deltagammavar_8cpp.html#a2c24bdfc8020479187354a3c3e3e1702">BOOST_AUTO_TEST_CASE</a> (testCase001)</td></tr>
<tr class="separator:a2c24bdfc8020479187354a3c3e3e1702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea9116c060103d8e6724b34a720f433"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_2deltagammavar_8cpp.html#a0ea9116c060103d8e6724b34a720f433">BOOST_AUTO_TEST_CASE</a> (testCase002)</td></tr>
<tr class="separator:a0ea9116c060103d8e6724b34a720f433"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d738a9d1404dac22fe8b3cdf6dba71b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="test_2deltagammavar_8cpp.html#a2d738a9d1404dac22fe8b3cdf6dba71b">BOOST_AUTO_TEST_CASE</a> (testCase003)</td></tr>
<tr class="separator:a2d738a9d1404dac22fe8b3cdf6dba71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a211c62f86bdf9d6b44c0b283464e5a2c" name="a211c62f86bdf9d6b44c0b283464e5a2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a211c62f86bdf9d6b44c0b283464e5a2c">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">testDeltaGammaVar&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2deltagammavar_8cpp_source.html#l00144">144</a> of file <a class="el" href="test_2deltagammavar_8cpp_source.html">deltagammavar.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  144</span>                                        {</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// TODO test Daniel&#39;s approx. explicitly (khat &lt; 1E-5)</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="comment">// TODO add more test cases (negative gammas, higher dimensions)</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    Size n = (Size)1E6;</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>    test(1, <span class="keyword">true</span>, <span class="keyword">false</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  152</span>    test(1, <span class="keyword">false</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  153</span>    test(1, <span class="keyword">true</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    test(2, <span class="keyword">true</span>, <span class="keyword">false</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  156</span>    test(2, <span class="keyword">false</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  157</span>    test(2, <span class="keyword">true</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>    test(10, <span class="keyword">true</span>, <span class="keyword">false</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  160</span>    test(10, <span class="keyword">false</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  161</span>    test(10, <span class="keyword">true</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="comment">// fewer paths here</span></div>
<div class="line"><span class="lineno">  164</span>    test(100, <span class="keyword">true</span>, <span class="keyword">false</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  165</span>    test(100, <span class="keyword">false</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  166</span>    test(100, <span class="keyword">true</span>, <span class="keyword">true</span>, 42, 42, n);</div>
<div class="line"><span class="lineno">  167</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aa37a2c9b7a0f119915ded5d6a10f62" name="a7aa37a2c9b7a0f119915ded5d6a10f62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa37a2c9b7a0f119915ded5d6a10f62">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">testNegativeGamma&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2deltagammavar_8cpp_source.html#l00169">169</a> of file <a class="el" href="test_2deltagammavar_8cpp_source.html">deltagammavar.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  169</span>                                        {</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Testing delta gamma var for pl = -u^2, u standard normal...&quot;</span>);</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="comment">// choose n=1, gamma=-10k, omega = 1, then the pl is -0.5*u^2 with</span></div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">// u standard normal, in other words  -2pl is chi-squared</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="comment">// distributed with one degree of freedom</span></div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    boost::math::chi_squared_distribution&lt;Real&gt; chisq(1.0);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    Real gamma = -10000.0;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    Array delta(1, 0.0);</div>
<div class="line"><span class="lineno">  182</span>    Matrix gamma_m(1, 1, gamma);</div>
<div class="line"><span class="lineno">  183</span>    Matrix omega(1, 1, 1.0);</div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>    Real p = 0.99;</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    Real var_mc = deltaGammaVarMc&lt;PseudoRandom&gt;(omega, delta, gamma_m, p, 1000000, 142);</div>
<div class="line"><span class="lineno">  188</span>    Real var_cf = <a class="code hl_function" href="namespace_quant_ext.html#a34635845fdf2fdc53cc58252620d02bf">deltaGammaVarCornishFisher</a>(omega, delta, gamma_m, p);</div>
<div class="line"><span class="lineno">  189</span>    Real var_sd = <a class="code hl_function" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9">deltaGammaVarSaddlepoint</a>(omega, delta, gamma_m, p);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    Real refVal = 0.5 * gamma * boost::math::quantile(chisq, 1.0 - p);</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;mc  = &quot;</span> &lt;&lt; var_mc);</div>
<div class="line"><span class="lineno">  194</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;cf  = &quot;</span> &lt;&lt; var_cf);</div>
<div class="line"><span class="lineno">  195</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;sd  = &quot;</span> &lt;&lt; var_sd);</div>
<div class="line"><span class="lineno">  196</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;ref = &quot;</span> &lt;&lt; refVal);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    <span class="comment">// the AS269 function in R (pacakge PDQutils) produces this</span></div>
<div class="line"><span class="lineno">  199</span>    BOOST_CHECK_SMALL(std::abs(-4707.882 - var_cf), 0.001);</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>    BOOST_CHECK_SMALL(std::abs(refVal - var_sd), 0.5);</div>
<div class="line"><span class="lineno">  202</span>    BOOST_CHECK_SMALL(std::abs(refVal - var_mc), 0.5);</div>
<div class="line"><span class="lineno">  203</span>}</div>
<div class="ttc" id="anamespace_quant_ext_html_a34635845fdf2fdc53cc58252620d02bf"><div class="ttname"><a href="namespace_quant_ext.html#a34635845fdf2fdc53cc58252620d02bf">QuantExt::deltaGammaVarCornishFisher</a></div><div class="ttdeci">Real deltaGammaVarCornishFisher(const Matrix &amp;omega, const Array &amp;delta, const Matrix &amp;gamma, const Real p, const CovarianceSalvage &amp;sal)</div><div class="ttdef"><b>Definition:</b> <a href="qle_2math_2deltagammavar_8cpp_source.html#l00328">deltagammavar.cpp:328</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_a942fd58eb03638593f92fa4f506b13d9"><div class="ttname"><a href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9">QuantExt::deltaGammaVarSaddlepoint</a></div><div class="ttdeci">Real deltaGammaVarSaddlepoint(const Matrix &amp;omega, const Array &amp;delta, const Matrix &amp;gamma, const Real p, const CovarianceSalvage &amp;sal)</div><div class="ttdef"><b>Definition:</b> <a href="qle_2math_2deltagammavar_8cpp_source.html#l00342">deltagammavar.cpp:342</a></div></div>
</div><!-- fragment --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="test_2deltagammavar_8cpp_a7aa37a2c9b7a0f119915ded5d6a10f62_cgraph.png" border="0" usemap="#atest_2deltagammavar_8cpp_a7aa37a2c9b7a0f119915ded5d6a10f62_cgraph" alt=""/></div>
<map name="atest_2deltagammavar_8cpp_a7aa37a2c9b7a0f119915ded5d6a10f62_cgraph" id="atest_2deltagammavar_8cpp_a7aa37a2c9b7a0f119915ded5d6a10f62_cgraph">
<area shape="rect" title=" " alt="" coords="5,68,196,94"/>
<area shape="rect" href="namespace_quant_ext.html#a34635845fdf2fdc53cc58252620d02bf" title=" " alt="" coords="539,30,761,70"/>
<area shape="rect" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9" title=" " alt="" coords="244,95,491,120"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a7432ce1e3128c5ea58c4f569625f70ce" title=" " alt="" coords="827,32,985,58"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="823,196,989,222"/>
<area shape="rect" href="struct_quant_ext_1_1_covariance_salvage.html#af59177b5032adfa7089a8d838489e785" title=" " alt="" coords="809,82,1003,122"/>
<area shape="rect" href="namespace_quant_ext.html#a72e392bf4a0f0d574c16b2af808a9af9" title="function that computes a delta VaR" alt="" coords="583,146,717,171"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a303a06bc7c7b6fafec4d4c15311882b3" title=" " alt="" coords="821,147,991,172"/>
</map>
</div>

</div>
</div>
<a id="a2c24bdfc8020479187354a3c3e3e1702" name="a2c24bdfc8020479187354a3c3e3e1702"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c24bdfc8020479187354a3c3e3e1702">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">testCase001&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2deltagammavar_8cpp_source.html#l00205">205</a> of file <a class="el" href="test_2deltagammavar_8cpp_source.html">deltagammavar.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  205</span>                                  {</div>
<div class="line"><span class="lineno">  206</span>    <span class="comment">// fails as of 05-Sep-2017, fixed with commit 71c736873</span></div>
<div class="line"><span class="lineno">  207</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Running regression test case 001...&quot;</span>);</div>
<div class="line"><span class="lineno">  208</span>    std::vector&lt;double&gt; d1{691.043, 8.62406, 9706.97, 0, 0};</div>
<div class="line"><span class="lineno">  209</span>    std::vector&lt;double&gt; d2 = {-13.9605, 0, 0, 0, 0, 0, -0.174223, 0, 0, 0, 0, 0, -196.1,</div>
<div class="line"><span class="lineno">  210</span>                              0,        0, 0, 0, 0, 0, 0,         0, 0, 0, 0, 0};</div>
<div class="line"><span class="lineno">  211</span>    std::vector&lt;double&gt; d3 = {96.3436,   -0.828459, -6.59142,  0.583848, -0.0639266, -0.828459, 97.7309,</div>
<div class="line"><span class="lineno">  212</span>                              12.4906,   -2.03511,  -0.504752, -6.59142, 12.4906,    95.12,     0.800706,</div>
<div class="line"><span class="lineno">  213</span>                              0.443861,  0.583848,  -2.03511,  0.800706, 2.71239,    0.288881,  -0.0639266,</div>
<div class="line"><span class="lineno">  214</span>                              -0.504752, 0.443861,  0.288881,  1.42701};</div>
<div class="line"><span class="lineno">  215</span>    Array delta(d1.begin(), d1.end());</div>
<div class="line"><span class="lineno">  216</span>    Matrix gamma(5, 5, d2.begin(), d2.end());</div>
<div class="line"><span class="lineno">  217</span>    Matrix omega(5, 5, d3.begin(), d3.end());</div>
<div class="line"><span class="lineno">  218</span>    Real var = <a class="code hl_function" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9">deltaGammaVarSaddlepoint</a>(omega, delta, gamma, 0.99);</div>
<div class="line"><span class="lineno">  219</span>    Real var_mc = deltaGammaVarMc&lt;PseudoRandom&gt;(omega, delta, gamma, 0.99, 1000000, 42);</div>
<div class="line"><span class="lineno">  220</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;sd = &quot;</span> &lt;&lt; var);</div>
<div class="line"><span class="lineno">  221</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;mc = &quot;</span> &lt;&lt; var_mc);</div>
<div class="line"><span class="lineno">  222</span>    BOOST_CHECK_CLOSE(var, var_mc, 0.5);</div>
<div class="line"><span class="lineno">  223</span>}</div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="test_2deltagammavar_8cpp_a2c24bdfc8020479187354a3c3e3e1702_cgraph.png" border="0" usemap="#atest_2deltagammavar_8cpp_a2c24bdfc8020479187354a3c3e3e1702_cgraph" alt=""/></div>
<map name="atest_2deltagammavar_8cpp_a2c24bdfc8020479187354a3c3e3e1702_cgraph" id="atest_2deltagammavar_8cpp_a2c24bdfc8020479187354a3c3e3e1702_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,196,105"/>
<area shape="rect" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9" title=" " alt="" coords="244,80,491,105"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a7432ce1e3128c5ea58c4f569625f70ce" title=" " alt="" coords="737,5,896,31"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="734,55,899,80"/>
<area shape="rect" href="namespace_quant_ext.html#a72e392bf4a0f0d574c16b2af808a9af9" title="function that computes a delta VaR" alt="" coords="539,105,672,131"/>
<area shape="rect" href="struct_quant_ext_1_1_covariance_salvage.html#af59177b5032adfa7089a8d838489e785" title=" " alt="" coords="720,154,913,194"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a303a06bc7c7b6fafec4d4c15311882b3" title=" " alt="" coords="731,104,902,129"/>
</map>
</div>

</div>
</div>
<a id="a0ea9116c060103d8e6724b34a720f433" name="a0ea9116c060103d8e6724b34a720f433"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ea9116c060103d8e6724b34a720f433">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">testCase002&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2deltagammavar_8cpp_source.html#l00225">225</a> of file <a class="el" href="test_2deltagammavar_8cpp_source.html">deltagammavar.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>                                  {</div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">// failed as of 05-Sep-2018</span></div>
<div class="line"><span class="lineno">  227</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Running regression test case 002...&quot;</span>);</div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">// similar setup to testNegativeGamma(), but with higher variance and positive gamma</span></div>
<div class="line"><span class="lineno">  230</span>    boost::math::chi_squared_distribution&lt;Real&gt; chisq(1.0);</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>    Array delta(1, 0.0);</div>
<div class="line"><span class="lineno">  233</span>    Matrix gamma(1, 1, 1.0);</div>
<div class="line"><span class="lineno">  234</span>    Matrix omega(1, 1, 1.0E6);</div>
<div class="line"><span class="lineno">  235</span>    Real p = 0.99;</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    Real var_sd = <a class="code hl_function" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9">deltaGammaVarSaddlepoint</a>(omega, delta, gamma, p);</div>
<div class="line"><span class="lineno">  238</span>    Real refVal = 0.5 * 1E6 * boost::math::quantile(chisq, p);</div>
<div class="line"><span class="lineno">  239</span>    Real var_mc = deltaGammaVarMc&lt;PseudoRandom&gt;(omega, delta, gamma, p, 1000000, 42);</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;sd  = &quot;</span> &lt;&lt; var_sd);</div>
<div class="line"><span class="lineno">  242</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;mc  = &quot;</span> &lt;&lt; var_mc);</div>
<div class="line"><span class="lineno">  243</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;ref = &quot;</span> &lt;&lt; refVal);</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    BOOST_CHECK_CLOSE(refVal, var_sd, 1.0);</div>
<div class="line"><span class="lineno">  246</span>}</div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="test_2deltagammavar_8cpp_a0ea9116c060103d8e6724b34a720f433_cgraph.png" border="0" usemap="#atest_2deltagammavar_8cpp_a0ea9116c060103d8e6724b34a720f433_cgraph" alt=""/></div>
<map name="atest_2deltagammavar_8cpp_a0ea9116c060103d8e6724b34a720f433_cgraph" id="atest_2deltagammavar_8cpp_a0ea9116c060103d8e6724b34a720f433_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,196,105"/>
<area shape="rect" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9" title=" " alt="" coords="244,80,491,105"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a7432ce1e3128c5ea58c4f569625f70ce" title=" " alt="" coords="737,5,896,31"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="734,55,899,80"/>
<area shape="rect" href="namespace_quant_ext.html#a72e392bf4a0f0d574c16b2af808a9af9" title="function that computes a delta VaR" alt="" coords="539,105,672,131"/>
<area shape="rect" href="struct_quant_ext_1_1_covariance_salvage.html#af59177b5032adfa7089a8d838489e785" title=" " alt="" coords="720,154,913,194"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a303a06bc7c7b6fafec4d4c15311882b3" title=" " alt="" coords="731,104,902,129"/>
</map>
</div>

</div>
</div>
<a id="a2d738a9d1404dac22fe8b3cdf6dba71b" name="a2d738a9d1404dac22fe8b3cdf6dba71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d738a9d1404dac22fe8b3cdf6dba71b">&#9670;&#160;</a></span>BOOST_AUTO_TEST_CASE() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOST_AUTO_TEST_CASE </td>
          <td>(</td>
          <td class="paramtype">testCase003&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="test_2deltagammavar_8cpp_source.html#l00248">248</a> of file <a class="el" href="test_2deltagammavar_8cpp_source.html">deltagammavar.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  248</span>                                  {</div>
<div class="line"><span class="lineno">  249</span>    <span class="comment">// failed in the Q3-BT 2018</span></div>
<div class="line"><span class="lineno">  250</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;Running regression test case 003...&quot;</span>);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    <span class="comment">// Salvaged covariance matrix</span></div>
<div class="line"><span class="lineno">  253</span>    vector&lt;Real&gt; data{</div>
<div class="line"><span class="lineno">  254</span>        11.357910440165, 0.301883284121,  1.690565094559,  0.028921366715,  1.445952963717,  2.683104461304,</div>
<div class="line"><span class="lineno">  255</span>        2.975281862097,  0.284778609491,  3.977509941411,  2.700492214606,  3.973616990595,  1.842042909216,</div>
<div class="line"><span class="lineno">  256</span>        4.507630684591,  2.188574976899,  1.839870252197,  1.653581957759,  0.301883284121,  1.545170636908,</div>
<div class="line"><span class="lineno">  257</span>        1.140841711137,  0.011046063984,  0.223680967726,  0.926416050189,  0.637660185458,  1.634591590508,</div>
<div class="line"><span class="lineno">  258</span>        0.328944419108,  -0.321306872147, 0.490226761216,  -0.228872084003, -0.466954542255, 0.908486575719,</div>
<div class="line"><span class="lineno">  259</span>        1.208420546045,  1.057641385035,  1.690565094559,  1.140841711137,  4.590122578368,  0.016138328046,</div>
<div class="line"><span class="lineno">  260</span>        1.681703229533,  2.722501254257,  2.941664204785,  4.088913570167,  0.753207493946,  0.750845717386,</div>
<div class="line"><span class="lineno">  261</span>        2.327852200648,  -0.083383166375, 0.791187240585,  3.432410532424,  4.576488134589,  4.484608491882,</div>
<div class="line"><span class="lineno">  262</span>        0.028921366715,  0.011046063984,  0.016138328046,  0.003321196784,  -0.002052702116, 0.015027345216,</div>
<div class="line"><span class="lineno">  263</span>        0.025225956444,  0.009488292952,  0.023036962659,  0.003752073385,  0.025786900243,  0.004902517590,</div>
<div class="line"><span class="lineno">  264</span>        0.017973354395,  0.013380695889,  0.016450708955,  0.015793906816,  1.445952963717,  0.223680967726,</div>
<div class="line"><span class="lineno">  265</span>        1.681703229533,  -0.002052702116, 5.051235107717,  1.504449552996,  1.411232675828,  -0.066709336186,</div>
<div class="line"><span class="lineno">  266</span>        0.740371793190,  0.922017945905,  1.423545223509,  0.592880234568,  1.318219401490,  1.512119827471,</div>
<div class="line"><span class="lineno">  267</span>        1.709049165903,  1.651695766740,  2.683104461304,  0.926416050189,  2.722501254257,  0.015027345216,</div>
<div class="line"><span class="lineno">  268</span>        1.504449552996,  5.896840384423,  2.736094553275,  2.318419864064,  2.683772279561,  0.869866043995,</div>
<div class="line"><span class="lineno">  269</span>        2.795123680474,  0.233284568353,  1.954971283941,  2.638478800353,  2.962854214006,  2.999498221322,</div>
<div class="line"><span class="lineno">  270</span>        2.975281862097,  0.637660185458,  2.941664204785,  0.025225956444,  1.411232675828,  2.736094553275,</div>
<div class="line"><span class="lineno">  271</span>        3.730376993077,  2.574152890379,  2.332889913708,  1.012628826625,  2.401055859072,  0.425908702537,</div>
<div class="line"><span class="lineno">  272</span>        2.104222769101,  2.846640151863,  3.254007639538,  3.174532782066,  0.284778609491,  1.634591590508,</div>
<div class="line"><span class="lineno">  273</span>        4.088913570167,  0.009488292952,  -0.066709336186, 2.318419864064,  2.574152890379,  8.346545067056,</div>
<div class="line"><span class="lineno">  274</span>        0.111146561779,  0.061442388170,  1.440123839301,  -0.532880568392, -0.363306461515, 3.164184153356,</div>
<div class="line"><span class="lineno">  275</span>        4.239774387395,  4.222873062980,  3.977509941411,  0.328944419108,  0.753207493946,  0.023036962659,</div>
<div class="line"><span class="lineno">  276</span>        0.740371793190,  2.683772279561,  2.332889913708,  0.111146561779,  7.816500777128,  1.306158501267,</div>
<div class="line"><span class="lineno">  277</span>        1.892772141649,  1.533232314993,  2.966214070512,  1.981467787886,  0.858479274405,  0.688098796909,</div>
<div class="line"><span class="lineno">  278</span>        2.700492214606,  -0.321306872147, 0.750845717386,  0.003752073385,  0.922017945905,  0.869866043995,</div>
<div class="line"><span class="lineno">  279</span>        1.012628826625,  0.061442388170,  1.306158501267,  3.255129750500,  1.447265157820,  1.646805443131,</div>
<div class="line"><span class="lineno">  280</span>        2.024131319493,  0.823110422895,  0.661139572160,  0.726470332699,  3.973616990595,  0.490226761216,</div>
<div class="line"><span class="lineno">  281</span>        2.327852200648,  0.025786900243,  1.423545223509,  2.795123680474,  2.401055859072,  1.440123839301,</div>
<div class="line"><span class="lineno">  282</span>        1.892772141649,  1.447265157820,  9.307941714908,  1.003272291798,  2.960270274699,  2.637484069448,</div>
<div class="line"><span class="lineno">  283</span>        2.395034154720,  2.407859255045,  1.842042909216,  -0.228872084003, -0.083383166375, 0.004902517590,</div>
<div class="line"><span class="lineno">  284</span>        0.592880234568,  0.233284568353,  0.425908702537,  -0.532880568392, 1.533232314993,  1.646805443131,</div>
<div class="line"><span class="lineno">  285</span>        1.003272291798,  2.715163222630,  1.397890009325,  0.370386734188,  -0.170205201951, -0.252456813317,</div>
<div class="line"><span class="lineno">  286</span>        4.507630684591,  -0.466954542255, 0.791187240585,  0.017973354395,  1.318219401490,  1.954971283941,</div>
<div class="line"><span class="lineno">  287</span>        2.104222769101,  -0.363306461515, 2.966214070512,  2.024131319493,  2.960270274699,  1.397890009325,</div>
<div class="line"><span class="lineno">  288</span>        12.145104529503, 1.291504589690,  0.751431588477,  0.731038259921,  2.188574976899,  0.908486575719,</div>
<div class="line"><span class="lineno">  289</span>        3.432410532424,  0.013380695889,  1.512119827471,  2.638478800353,  2.846640151863,  3.164184153356,</div>
<div class="line"><span class="lineno">  290</span>        1.981467787886,  0.823110422895,  2.637484069448,  0.370386734188,  1.291504589690,  3.304040607934,</div>
<div class="line"><span class="lineno">  291</span>        3.654236283615,  3.549318308813,  1.839870252197,  1.208420546045,  4.576488134589,  0.016450708955,</div>
<div class="line"><span class="lineno">  292</span>        1.709049165903,  2.962854214006,  3.254007639538,  4.239774387395,  0.858479274405,  0.661139572160,</div>
<div class="line"><span class="lineno">  293</span>        2.395034154720,  -0.170205201951, 0.751431588477,  3.654236283615,  5.109964090288,  4.959183419230,</div>
<div class="line"><span class="lineno">  294</span>        1.653581957759,  1.057641385035,  4.484608491882,  0.015793906816,  1.651695766740,  2.999498221322,</div>
<div class="line"><span class="lineno">  295</span>        3.174532782066,  4.222873062980,  0.688098796909,  0.726470332699,  2.407859255045,  -0.252456813317,</div>
<div class="line"><span class="lineno">  296</span>        0.731038259921,  3.549318308813,  4.959183419230,  5.024852085655};</div>
<div class="line"><span class="lineno">  297</span>    Matrix covar(16, 16, data.begin(), data.end());</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    <span class="comment">// Gamma matrix, all 0 except g[15,15] = -0.000000000262</span></div>
<div class="line"><span class="lineno">  300</span>    Matrix gamma(16, 16, 0.0);</div>
<div class="line"><span class="lineno">  301</span>    gamma[14][14] = -0.000000000262;</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="comment">// Delta array, all 0 except d[15] = -247189.692289613</span></div>
<div class="line"><span class="lineno">  304</span>    Array delta(16, 0.0);</div>
<div class="line"><span class="lineno">  305</span>    delta[14] = -247189.692289613;</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    <span class="comment">// Try the saddlepoint VAR</span></div>
<div class="line"><span class="lineno">  308</span>    Real p = 0.99;</div>
<div class="line"><span class="lineno">  309</span>    Real sdvar = <a class="code hl_function" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9">deltaGammaVarSaddlepoint</a>(covar, delta, gamma, p);</div>
<div class="line"><span class="lineno">  310</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;sdvar=&quot;</span> &lt;&lt; sdvar);</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>    <span class="comment">// Try the monte-carlo VAR</span></div>
<div class="line"><span class="lineno">  313</span>    Real mcvar = deltaGammaVarMc&lt;PseudoRandom&gt;(covar, delta, gamma, p, 1000000, 42);</div>
<div class="line"><span class="lineno">  314</span>    BOOST_TEST_MESSAGE(<span class="stringliteral">&quot;mcvar=&quot;</span> &lt;&lt; mcvar);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment">// Check saddlepoint and monte-carlo results are close</span></div>
<div class="line"><span class="lineno">  317</span>    BOOST_CHECK_CLOSE(sdvar, mcvar, 1.0);</div>
<div class="line"><span class="lineno">  318</span>}</div>
</div><!-- fragment --><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="test_2deltagammavar_8cpp_a2d738a9d1404dac22fe8b3cdf6dba71b_cgraph.png" border="0" usemap="#atest_2deltagammavar_8cpp_a2d738a9d1404dac22fe8b3cdf6dba71b_cgraph" alt=""/></div>
<map name="atest_2deltagammavar_8cpp_a2d738a9d1404dac22fe8b3cdf6dba71b_cgraph" id="atest_2deltagammavar_8cpp_a2d738a9d1404dac22fe8b3cdf6dba71b_cgraph">
<area shape="rect" title=" " alt="" coords="5,80,196,105"/>
<area shape="rect" href="namespace_quant_ext.html#a942fd58eb03638593f92fa4f506b13d9" title=" " alt="" coords="244,80,491,105"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a7432ce1e3128c5ea58c4f569625f70ce" title=" " alt="" coords="737,5,896,31"/>
<area shape="rect" href="namespace_quant_ext.html#a1cab4fb6a720eff245acb9f3a7a9e7c5" title=" " alt="" coords="734,55,899,80"/>
<area shape="rect" href="namespace_quant_ext.html#a72e392bf4a0f0d574c16b2af808a9af9" title="function that computes a delta VaR" alt="" coords="539,105,672,131"/>
<area shape="rect" href="struct_quant_ext_1_1_covariance_salvage.html#af59177b5032adfa7089a8d838489e785" title=" " alt="" coords="720,154,913,194"/>
<area shape="rect" href="namespace_quant_ext_1_1detail.html#a303a06bc7c7b6fafec4d4c15311882b3" title=" " alt="" coords="731,104,902,129"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
