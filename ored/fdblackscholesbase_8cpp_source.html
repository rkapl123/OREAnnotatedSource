<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>OREData: ored/scripting/models/fdblackscholesbase.cpp Source File</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="oredextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-data@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.11</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3e56cb31e3027d5bae8796cb64b50d07.html">ored</a></li><li class="navelem"><a class="el" href="dir_5ec8a1e1d14eaa47b1b0e648274be507.html">scripting</a></li><li class="navelem"><a class="el" href="dir_f42446cc52b32b57df5f03cb32d31df7.html">models</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">fdblackscholesbase.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="fdblackscholesbase_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> Copyright (C) 2020 Quaternion Risk Management Ltd</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"></span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> This file is part of ORE, a free-software/open-source library</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> for transparent pricing and risk analysis - http://opensourcerisk.org</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"></span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> ORE is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> under the terms of the Modified BSD License.  You should have received a</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> copy of the license along with this program.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> The license is also available online at &lt;http://opensourcerisk.org&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"></span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> This program is distributed on the basis that it will form a useful</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> contribution to risk analytics and model standardisation, but WITHOUT</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> FITNESS FOR A PARTICULAR PURPOSE. See the license for more details.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">*/</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="fdblackscholesbase_8hpp.html">ored/scripting/models/fdblackscholesbase.hpp</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;<a class="code" href="scripting_2utilities_8hpp.html">ored/scripting/utilities.hpp</a>&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;qle/methods/fdmblackscholesmesher.hpp&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;qle/methods/fdmblackscholesop.hpp&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="code" href="indexparser_8hpp.html">ored/utilities/indexparser.hpp</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="to__string_8hpp.html">ored/utilities/to_string.hpp</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;<a class="code" href="model_2utilities_8hpp.html">ored/model/utilities.hpp</a>&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../qle/averageonindexedcoupon_8hpp.html">qle/cashflows/averageonindexedcoupon.hpp</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../qle/averageonindexedcouponpricer_8hpp.html">qle/cashflows/averageonindexedcouponpricer.hpp</a>&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../qle/overnightindexedcoupon_8hpp.html">qle/cashflows/overnightindexedcoupon.hpp</a>&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;ql/math/comparison.hpp&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;ql/math/interpolations/cubicinterpolation.hpp&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;ql/methods/finitedifferences/meshers/fdmmeshercomposite.hpp&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;ql/quotes/simplequote.hpp&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceore.html">ore</a> {</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="keyword">namespace </span><a class="code hl_enumvalue" href="log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a> {</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_quant_lib.html">QuantLib</a>;</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_quant_ext.html">QuantExt</a>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#ac540ddcab07dfa37473fac7906684df2">   44</a></span><a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3b500081d709650730800cacebd0b34e">FdBlackScholesBase::FdBlackScholesBase</a>(<span class="keyword">const</span> Size stateGridPoints, <span class="keyword">const</span> std::string&amp; currency,</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>                                       <span class="keyword">const</span> Handle&lt;YieldTermStructure&gt;&amp; curve, <span class="keyword">const</span> std::string&amp; index,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>                                       <span class="keyword">const</span> std::string&amp; indexCurrency, <span class="keyword">const</span> Handle&lt;BlackScholesModelWrapper&gt;&amp; model,</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>                                       <span class="keyword">const</span> std::set&lt;Date&gt;&amp; simulationDates,</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>                                       <span class="keyword">const</span> <a class="code hl_class" href="classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a>&amp; iborFallbackConfig, <span class="keyword">const</span> std::string&amp; calibration,</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>                                       <span class="keyword">const</span> std::vector&lt;Real&gt;&amp; calibrationStrikes, <span class="keyword">const</span> Real mesherEpsilon,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>                                       <span class="keyword">const</span> Real mesherScaling, <span class="keyword">const</span> Real mesherConcentration,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>                                       <span class="keyword">const</span> Size mesherMaxConcentratingPoints, <span class="keyword">const</span> <span class="keywordtype">bool</span> staticMesher)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    : <a class="code hl_class" href="classore_1_1data_1_1_fd_black_scholes_base.html">FdBlackScholesBase</a>(stateGridPoints, {currency}, {curve}, {}, {}, {}, {index}, {indexCurrency}, {currency}, model,</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>                         {}, simulationDates, iborFallbackConfig, calibration, {{index, calibrationStrikes}},</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>                         mesherEpsilon, mesherScaling, mesherConcentration, mesherMaxConcentratingPoints,</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>                         staticMesher) {}</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3b500081d709650730800cacebd0b34e">   57</a></span><a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3b500081d709650730800cacebd0b34e">FdBlackScholesBase::FdBlackScholesBase</a>(</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="keyword">const</span> Size stateGridPoints, <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; currencies,</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <span class="keyword">const</span> std::vector&lt;Handle&lt;YieldTermStructure&gt;&gt;&amp; curves, <span class="keyword">const</span> std::vector&lt;Handle&lt;Quote&gt;&gt;&amp; fxSpots,</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <span class="keyword">const</span> std::vector&lt;std::pair&lt;std::string, boost::shared_ptr&lt;InterestRateIndex&gt;&gt;&gt;&amp; irIndices,</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="keyword">const</span> std::vector&lt;std::pair&lt;std::string, boost::shared_ptr&lt;ZeroInflationIndex&gt;&gt;&gt;&amp; infIndices,</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; indices, <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; indexCurrencies,</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keyword">const</span> std::set&lt;std::string&gt;&amp; payCcys, <span class="keyword">const</span> Handle&lt;BlackScholesModelWrapper&gt;&amp; model,</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keyword">const</span> std::map&lt;std::pair&lt;std::string, std::string&gt;, Handle&lt;QuantExt::CorrelationTermStructure&gt;&gt;&amp; correlations,</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="keyword">const</span> std::set&lt;Date&gt;&amp; simulationDates, <span class="keyword">const</span> <a class="code hl_class" href="classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a>&amp; iborFallbackConfig, <span class="keyword">const</span> std::string&amp; calibration,</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="keyword">const</span> std::map&lt;std::string, std::vector&lt;Real&gt;&gt;&amp; calibrationStrikes, <span class="keyword">const</span> Real mesherEpsilon,</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <span class="keyword">const</span> Real mesherScaling, <span class="keyword">const</span> Real mesherConcentration, <span class="keyword">const</span> Size mesherMaxConcentratingPoints,</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> staticMesher)</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    : <a class="code hl_class" href="classore_1_1data_1_1_model_impl.html">ModelImpl</a>(curves.at(0)-&gt;dayCounter(), stateGridPoints, currencies, irIndices, infIndices, indices,</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                indexCurrencies, simulationDates, iborFallbackConfig),</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>      curves_(curves), fxSpots_(fxSpots), payCcys_(payCcys), <a class="code hl_variable" href="computationgraphbuilder_8cpp.html#abffa9627834aae0799550c12a25a85e0">model_</a>(model), <a class="code hl_variable" href="blackscholescg_8cpp.html#aa842cc62b4fc38f8bf8f022be3504f03">correlations_</a>(correlations),</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>      calibration_(calibration), <a class="code hl_variable" href="blackscholescg_8cpp.html#a6839be55e1e90b11f6f9068fe0b20874">calibrationStrikes_</a>(calibrationStrikes), mesherEpsilon_(mesherEpsilon),</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>      mesherScaling_(mesherScaling), mesherConcentration_(mesherConcentration),</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>      mesherMaxConcentratingPoints_(mesherMaxConcentratingPoints), staticMesher_(staticMesher) {</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="comment">// check inputs</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    QL_REQUIRE(!<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>.empty(), <span class="stringliteral">&quot;model is empty&quot;</span>);</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    QL_REQUIRE(!<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.empty(), <span class="stringliteral">&quot;no curves given&quot;</span>);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size() == <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.size(), <span class="stringliteral">&quot;number of currencies (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size()</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>                                                                              &lt;&lt; <span class="stringliteral">&quot;) does not match number of curves (&quot;</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>                                                                              &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size() == <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.size() + 1,</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>               <span class="stringliteral">&quot;number of currencies (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size() &lt;&lt; <span class="stringliteral">&quot;) does not match number of fx spots (&quot;</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>                                        &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.size() &lt;&lt; <span class="stringliteral">&quot;) + 1&quot;</span>);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size() == <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().size(),</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>               <span class="stringliteral">&quot;mismatch of processes size (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().size() &lt;&lt; <span class="stringliteral">&quot;) and number of indices (&quot;</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                                              &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; c : payCcys) {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>        QL_REQUIRE(std::find(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), c) != <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(),</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                   <span class="stringliteral">&quot;pay ccy &#39;&quot;</span> &lt;&lt; c &lt;&lt; <span class="stringliteral">&quot;&#39; not found in currencies list.&quot;</span>);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <span class="comment">// register with observables</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; o : <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>)</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>        registerWith(o);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; o : <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#aeb5929f7ce6e2d52f420ca71b7caaae1">correlations_</a>)</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        registerWith(o.second);</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    registerWith(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>);</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="comment">// if we have one (or no) underlying, everything works as usual</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().size() &lt;= 1)</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span> </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="comment">// if we have one underlying + one FX index, we do a 1D PDE with a quanto adjustment under certain circumstances</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().size() == 2) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>        <span class="comment">// check whether we have exactly one pay ccy ...</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        <span class="keywordflow">if</span> (payCcys.size() == 1) {</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>            std::string payCcy = *payCcys.begin();</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>            <span class="comment">// ... and the second index is an FX index suitable to do a quanto adjustment</span></div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>            <span class="comment">// from the first index&#39;s currency to the pay ccy ...</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>            std::string mainIndexCcy = <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#ad2f62229897fdae7a8e793ee62e3d00c">indexCurrencies_</a>[0];</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[0].isFx()) {</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>                mainIndexCcy = <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[0].fx()-&gt;targetCurrency().code();</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>            }</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[1].isFx()) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>                std::string ccy1 = <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[1].fx()-&gt;sourceCurrency().code();</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>                std::string ccy2 = <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[1].fx()-&gt;targetCurrency().code();</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>                <span class="keywordflow">if</span> ((ccy1 == mainIndexCcy &amp;&amp; ccy2 == payCcy) || (ccy1 == payCcy &amp;&amp; ccy2 == mainIndexCcy)) {</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>                    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#afb85b7842dff64cac0a2b6cf29d47497">applyQuantoAdjustment_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>                    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a48e130e941c5e59cbd9d2fdd395b8a22">quantoSourceCcyIndex_</a> = std::distance(</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>                        currencies.begin(), std::find(currencies.begin(), currencies.end(), mainIndexCcy));</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>                    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a> =</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                        std::distance(currencies.begin(), std::find(currencies.begin(), currencies.end(), payCcy));</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af603e1ab8495900c2b3044d1cf40cd95">quantoCorrelationMultiplier_</a> = ccy2 == payCcy ? 1.0 : -1.0;</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                <a class="code hl_define" href="log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a>(<span class="stringliteral">&quot;FdBlackScholesBase model will be run for index &#39;&quot;</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>                     &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[0].<a class="code hl_variable" href="todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>() &lt;&lt; <span class="stringliteral">&quot;&#39; with a quanto-adjustment &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a48e130e941c5e59cbd9d2fdd395b8a22">quantoSourceCcyIndex_</a>]</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                     &lt;&lt; <span class="stringliteral">&quot; =&gt; &quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>] &lt;&lt; <span class="stringliteral">&quot; derived from index &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[1].<a class="code hl_variable" href="todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>()</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                     &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>            }</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        }</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    }</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span> </div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="comment">// otherwise we need more than one dimension, which we currently not support</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    QL_FAIL(<span class="stringliteral">&quot;FdBlackScholesBase: model does not support multi-dim fd schemes currently.&quot;</span>);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span> </div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>} <span class="comment">// FdBlackScholesBase ctor</span></div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span> </div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#afa6dbc82775f93a3bb6b225320c8e685">  148</a></span>Matrix <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#afa6dbc82775f93a3bb6b225320c8e685">FdBlackScholesBase::getCorrelation</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    Matrix correlation(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(), <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(), 0.0);</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(); ++i)</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>        correlation[i][i] = 1.0;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; c : <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#aeb5929f7ce6e2d52f420ca71b7caaae1">correlations_</a>) {</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>        <a class="code hl_class" href="classore_1_1data_1_1_index_info.html">IndexInfo</a> inf1(c.first.first), inf2(c.first.second);</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>        <span class="keyword">auto</span> ind1 = std::find(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.end(), inf1);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>        <span class="keyword">auto</span> ind2 = std::find(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.end(), inf2);</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>        <span class="keywordflow">if</span> (ind1 != <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.end() &amp;&amp; ind2 != <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.end()) {</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>            <span class="comment">// EQ, FX, COMM index</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>            Size i1 = std::distance(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.begin(), ind1);</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>            Size i2 = std::distance(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.begin(), ind2);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>            correlation[i1][i2] = correlation[i2][i1] = c.second-&gt;correlation(0.0); <span class="comment">// we assume a constant correlation!</span></div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>        }</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <a class="code hl_define" href="log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;FdBlackScholesBase correlation matrix:&quot;</span>);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    <a class="code hl_define" href="log_8hpp.html#a4cf6b52b5cb6fdd420eaad750cfc20cc">TLOGGERSTREAM</a>(correlation);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="keywordflow">return</span> correlation;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>}</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a5ce8b0af276b7c06ab424e688ae2d318">  168</a></span><span class="keyword">const</span> Date&amp; <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a5ce8b0af276b7c06ab424e688ae2d318">FdBlackScholesBase::referenceDate</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    calculate();</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3e22290961d6b56dce069c1c4fda6386">referenceDate_</a>;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>}</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a1127cccc9668a02247dc139d27121708">  173</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a1127cccc9668a02247dc139d27121708">FdBlackScholesBase::performCalculations</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span> </div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3e22290961d6b56dce069c1c4fda6386">referenceDate_</a> = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;referenceDate();</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="comment">// 0a set up time grid</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a9356ce4490b329fbfbad73fa28841898">effectiveSimulationDates_</a> = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;effectiveSimulationDates();</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    std::vector&lt;Real&gt; times;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; d : <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a9356ce4490b329fbfbad73fa28841898">effectiveSimulationDates_</a>) {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        times.push_back(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;timeFromReference(d));</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    }</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span> </div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a> = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;discretisationTimeGrid();</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>.resize(times.size());</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>.size(); ++i)</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>[i] = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>.index(times[i]);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="comment">// 0b nothing to do if we do not have any indices</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.empty())</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span> </div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <span class="comment">// 0c if we only have one effective sim date (today), we set the underlying values = spot</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a9356ce4490b329fbfbad73fa28841898">effectiveSimulationDates_</a>.size() == 1) {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>        <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">underlyingValues_</a> = <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0]-&gt;x0());</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    }</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="comment">// 1 set the calibration strikes</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    std::vector&lt;Real&gt; calibrationStrikes;</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af46e078a1433cbe2f4f1e6727eda5d6a">calibration_</a> == <span class="stringliteral">&quot;ATM&quot;</span>) {</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        calibrationStrikes.resize(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(), Null&lt;Real&gt;());</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af46e078a1433cbe2f4f1e6727eda5d6a">calibration_</a> == <span class="stringliteral">&quot;Deal&quot;</span>) {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(); ++i) {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>            <span class="keyword">auto</span> f = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab6f1d1f2c2702a5b1b5bb92d19e506c8">calibrationStrikes_</a>.find(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i].<a class="code hl_variable" href="todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>());</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>            <span class="keywordflow">if</span> (f != <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab6f1d1f2c2702a5b1b5bb92d19e506c8">calibrationStrikes_</a>.end() &amp;&amp; !f-&gt;second.empty()) {</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                calibrationStrikes.push_back(f-&gt;second[0]);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>                <a class="code hl_define" href="log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;calibration strike for index &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i] &lt;&lt; <span class="stringliteral">&quot;&#39; is &quot;</span> &lt;&lt; f-&gt;second[0]);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>                calibrationStrikes.push_back(Null&lt;Real&gt;());</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>                <a class="code hl_define" href="log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;calibration strike for index &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i] &lt;&lt; <span class="stringliteral">&quot;&#39; is ATMF&quot;</span>);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>            }</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        QL_FAIL(<span class="stringliteral">&quot;FdBlackScholes: calibration &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af46e078a1433cbe2f4f1e6727eda5d6a">calibration_</a> &lt;&lt; <span class="stringliteral">&quot;&#39; not supported, expected ATM, Deal&quot;</span>);</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>    }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="comment">// 1b set up the critical points for the mesher</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    std::vector&lt;std::vector&lt;boost::tuple&lt;Real, Real, bool&gt;&gt;&gt; cPoints;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(); ++i) {</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>        cPoints.push_back(std::vector&lt;boost::tuple&lt;Real, Real, bool&gt;&gt;());</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        <span class="keyword">auto</span> f = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab6f1d1f2c2702a5b1b5bb92d19e506c8">calibrationStrikes_</a>.find(<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i].<a class="code hl_variable" href="todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a>());</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>        <span class="keywordflow">if</span> (f != <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab6f1d1f2c2702a5b1b5bb92d19e506c8">calibrationStrikes_</a>.end()) {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>            <span class="keywordflow">for</span> (Size j = 0; j &lt; std::min(f-&gt;second.size(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ac13ca5824ce4947677f1b11557f49c53">mesherMaxConcentratingPoints_</a>); ++j) {</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>                cPoints.back().push_back(boost::make_tuple(std::log(f-&gt;second[j]), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a26af5aa9804e7dadbf6f641639e9c774">mesherConcentration_</a>, <span class="keyword">false</span>));</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>                <a class="code hl_define" href="log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a>(<span class="stringliteral">&quot;added critical point at strike &quot;</span> &lt;&lt; f-&gt;second[j] &lt;&lt; <span class="stringliteral">&quot; with concentration &quot;</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>                                                       &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a26af5aa9804e7dadbf6f641639e9c774">mesherConcentration_</a>);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>            }</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>        }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="comment">// 2 set up mesher if we do not have one already or if we want to rebuild it every time</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a6173a18083f066a89cbf39fe65ca3e69">mesher_</a> == <span class="keyword">nullptr</span> || !<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a25f2377e0f0cf5adedc662a54dd30dda">staticMesher_</a>) {</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>        <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a6173a18083f066a89cbf39fe65ca3e69">mesher_</a> = boost::make_shared&lt;FdmMesherComposite&gt;(boost::make_shared&lt;QuantExt::FdmBlackScholesMesher&gt;(</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>            <a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0], <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>.back(),</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>            calibrationStrikes[0] == Null&lt;Real&gt;()</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>                ? <a class="code hl_function" href="namespaceore_1_1data.html#a7a2f6f438823e3f124eac5bf1e228cef">atmForward</a>(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0]-&gt;x0(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0]-&gt;riskFreeRate(),</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>                             <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0]-&gt;dividendYield(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>.back())</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                : calibrationStrikes[0],</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            Null&lt;Real&gt;(), Null&lt;Real&gt;(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ad5735abf6dd33753da8d565f50f8c8e9">mesherEpsilon_</a>, <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a51ccdb31aed98dd6b2c64878a88412bf">mesherScaling_</a>, cPoints[0]));</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    }</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    <span class="comment">// 3 set up operator using atmf vol and without discounting, floor forward variances at zero</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    boost::shared_ptr&lt;QuantExt::FdmQuantoHelper&gt; quantoHelper;</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#afb85b7842dff64cac0a2b6cf29d47497">applyQuantoAdjustment_</a>) {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        Real quantoCorr = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af603e1ab8495900c2b3044d1cf40cd95">quantoCorrelationMultiplier_</a> * <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#afa6dbc82775f93a3bb6b225320c8e685">getCorrelation</a>()[0][1];</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        quantoHelper = boost::make_shared&lt;QuantExt::FdmQuantoHelper&gt;(</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            *<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>], *<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a48e130e941c5e59cbd9d2fdd395b8a22">quantoSourceCcyIndex_</a>],</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>            *<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[1]-&gt;blackVolatility(), quantoCorr, Null&lt;Real&gt;(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[1]-&gt;x0(), <span class="keyword">false</span>,</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>            <span class="keyword">true</span>);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a4aaba3adb9860f7e99d4b7e5de336b3c">operator_</a> =</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        boost::make_shared&lt;QuantExt::FdmBlackScholesOp&gt;(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a6173a18083f066a89cbf39fe65ca3e69">mesher_</a>, <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0], calibrationStrikes[0], <span class="keyword">false</span>,</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>                                                        -<span class="keyword">static_cast&lt;</span>Real<span class="keyword">&gt;</span>(Null&lt;Real&gt;()), 0, quantoHelper, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <span class="comment">// 4 set up bwd solver, hardcoded Douglas scheme (= CrankNicholson)</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#add3c97e2a55603c3648a5304f08a8fb5">solver_</a> = boost::make_shared&lt;FdmBackwardSolver&gt;(</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>        <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a4aaba3adb9860f7e99d4b7e5de336b3c">operator_</a>, std::vector&lt;boost::shared_ptr&lt;BoundaryCondition&lt;FdmLinearOp&gt;&gt;&gt;(), <span class="keyword">nullptr</span>, FdmSchemeDesc::Douglas());</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span> </div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="comment">// 5 fill random variable with underlying values, these are valid for all times</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    <span class="keyword">auto</span> locations = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a6173a18083f066a89cbf39fe65ca3e69">mesher_</a>-&gt;locations(0);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">underlyingValues_</a> = <a class="code hl_functionRef" href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">exp</a>(<a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(locations));</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="comment">// set additional results provided by this model</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; calibrationStrikes.size(); ++i) {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <a class="code hl_variable" href="classore_1_1data_1_1_model.html#a389467bfea77ee951d34ed713f00d333">additionalResults_</a>[<span class="stringliteral">&quot;FdBlackScholes.CalibrationStrike_&quot;</span> + <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i].name()] =</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>            (calibrationStrikes[i] == Null&lt;Real&gt;() ? <span class="stringliteral">&quot;ATMF&quot;</span> : std::to_string(calibrationStrikes[i]));</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    }</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>    <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size(); ++i) {</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        Size timeStep = 0;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; d : <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a9356ce4490b329fbfbad73fa28841898">effectiveSimulationDates_</a>) {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            Real t = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>[timeStep]];</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            Real forward = <a class="code hl_function" href="namespaceore_1_1data.html#a7a2f6f438823e3f124eac5bf1e228cef">atmForward</a>(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[i]-&gt;x0(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[i]-&gt;riskFreeRate(),</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>                                      <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[i]-&gt;dividendYield(), t);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>            <span class="keywordflow">if</span> (timeStep &gt; 0) {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>                Real volatility = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[i]-&gt;blackVolatility()-&gt;blackVol(</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>                    t, calibrationStrikes[i] == Null&lt;Real&gt;() ? forward : calibrationStrikes[i]);</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>                <a class="code hl_variable" href="classore_1_1data_1_1_model.html#a389467bfea77ee951d34ed713f00d333">additionalResults_</a>[<span class="stringliteral">&quot;FdBlackScholes.Volatility_&quot;</span> + <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i].name() + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(d)] =</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                    volatility;</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>            }</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>            <a class="code hl_variable" href="classore_1_1data_1_1_model.html#a389467bfea77ee951d34ed713f00d333">additionalResults_</a>[<span class="stringliteral">&quot;FdBlackScholes.Forward_&quot;</span> + <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[i].name() + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(d)] =</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>                forward;</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>            ++timeStep;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>        }</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>    }</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>}</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#ac2531b45af9259f8b3af891fac9f5d03">  302</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#ac2531b45af9259f8b3af891fac9f5d03">FdBlackScholesBase::getIndexValue</a>(<span class="keyword">const</span> Size indexNo, <span class="keyword">const</span> Date&amp; d, <span class="keyword">const</span> Date&amp; fwd)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    QL_REQUIRE(indexNo == 0, <span class="stringliteral">&quot;FdBlackScholesBase::getIndexValue(): indexNo (&quot;</span> &lt;&lt; indexNo &lt;&lt; <span class="stringliteral">&quot;) must be 0&quot;</span>);</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="comment">// determine the effective forward date (if applicable)</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    Date effFwd = fwd;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[indexNo].isComm()) {</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        <span class="keyword">const</span> Date&amp; expiry = <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[indexNo].comm(d)-&gt;expiryDate();</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        <span class="comment">// if a future is referenced we set the forward date effectively used below to the future&#39;s expiry date</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        <span class="keywordflow">if</span> (expiry != Date())</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>            effFwd = expiry;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>        <span class="comment">// if the future expiry is past the obsdate, we return the spot as of the obsdate, i.e. we</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        <span class="comment">// freeze the future value after its expiry, but keep it available for observation</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        <span class="comment">// TOOD should we throw an exception instead?</span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        effFwd = std::max(effFwd, d);</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    }</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    <span class="comment">// init the result with the underlying values themselves</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> res(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">underlyingValues_</a>);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span> </div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    <span class="comment">// compute forwarding factor and multiply the result by this factor</span></div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span> </div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    <span class="keywordflow">if</span> (effFwd != Null&lt;Date&gt;()) {</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        <span class="keyword">auto</span> p = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().at(indexNo);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>        res *= <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), p-&gt;dividendYield()-&gt;discount(effFwd) / p-&gt;dividendYield()-&gt;discount(d) /</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>                                          (p-&gt;riskFreeRate()-&gt;discount(effFwd) / p-&gt;riskFreeRate()-&gt;discount(d)));</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>    }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <span class="comment">// set the observation time in the result random variable</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    res.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a7715599b27d9f0c69d0abd43a2469dd2">setTime</a>(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;timeFromReference(d));</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="comment">// return the result</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>}</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a31ea941e2c5742d1de925abc758a422e">  340</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a31ea941e2c5742d1de925abc758a422e">FdBlackScholesBase::getIrIndexValue</a>(<span class="keyword">const</span> Size indexNo, <span class="keyword">const</span> Date&amp; d, <span class="keyword">const</span> Date&amp; fwd)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    Date effFixingDate = d;</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="keywordflow">if</span> (fwd != Null&lt;Date&gt;())</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>        effFixingDate = fwd;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <span class="comment">// ensure a valid fixing date</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    effFixingDate = <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.at(indexNo).second-&gt;fixingCalendar().adjust(effFixingDate);</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>    <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.at(indexNo).second-&gt;fixing(effFixingDate));</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>}</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a0e7b4b054beda325e75ce61b56405d20">  349</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a0e7b4b054beda325e75ce61b56405d20">FdBlackScholesBase::getInfIndexValue</a>(<span class="keyword">const</span> Size indexNo, <span class="keyword">const</span> Date&amp; d, <span class="keyword">const</span> Date&amp; fwd)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    Date effFixingDate = d;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="keywordflow">if</span> (fwd != Null&lt;Date&gt;())</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        effFixingDate = fwd;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>    <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#aebe584e14684cee39eecccd086ba1588">infIndices_</a>.at(indexNo).second-&gt;fixing(effFixingDate));</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>}</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#aef2fa78219e2206833d4d8f63bf20a70">  356</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#aef2fa78219e2206833d4d8f63bf20a70">FdBlackScholesBase::fwdCompAvg</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> isAvg, <span class="keyword">const</span> std::string&amp; indexInput, <span class="keyword">const</span> Date&amp; obsdate,</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                                              <span class="keyword">const</span> Date&amp; start, <span class="keyword">const</span> Date&amp; end, <span class="keyword">const</span> Real spread, <span class="keyword">const</span> Real gearing,</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                                              <span class="keyword">const</span> Integer lookback, <span class="keyword">const</span> Natural rateCutoff,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                                              <span class="keyword">const</span> Natural fixingDays, <span class="keyword">const</span> <span class="keywordtype">bool</span> includeSpread, <span class="keyword">const</span> Real cap,</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>                                              <span class="keyword">const</span> Real floor, <span class="keyword">const</span> <span class="keywordtype">bool</span> nakedOption,</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>                                              <span class="keyword">const</span> <span class="keywordtype">bool</span> localCapFloor)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    calculate();</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <a class="code hl_class" href="classore_1_1data_1_1_index_info.html">IndexInfo</a> indexInfo(indexInput);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="keyword">auto</span> index = boost::dynamic_pointer_cast&lt;OvernightIndex&gt;(indexInfo.<a class="code hl_function" href="classore_1_1data_1_1_index_info.html#a259a38e1e6b17084f72a0032c5615987">irIbor</a>());</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    QL_REQUIRE(index, <span class="stringliteral">&quot;BlackScholesBase::fwdCompAvg(): expected on index for &quot;</span> &lt;&lt; indexInput);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <span class="comment">// if we want to support cap / floors we need the OIS CF surface</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>    QL_REQUIRE(cap &gt; 999998.0 &amp;&amp; floor &lt; -999998.0,</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>               <span class="stringliteral">&quot;BlackScholesCGBase:fwdCompAvg(): cap (&quot;</span> &lt;&lt; cap &lt;&lt; <span class="stringliteral">&quot;) / floor (&quot;</span> &lt;&lt; floor &lt;&lt; <span class="stringliteral">&quot;) not supported&quot;</span>);</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    boost::shared_ptr&lt;QuantLib::FloatingRateCoupon&gt; coupon;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    boost::shared_ptr&lt;QuantLib::FloatingRateCouponPricer&gt; pricer;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="keywordflow">if</span> (isAvg) {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        coupon = boost::make_shared&lt;QuantExt::AverageONIndexedCoupon&gt;(</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            end, 1.0, start, end, index, gearing, spread, rateCutoff, DayCounter(), lookback * Days, fixingDays);</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        pricer = boost::make_shared&lt;AverageONIndexedCouponPricer&gt;();</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        coupon = boost::make_shared&lt;QuantExt::OvernightIndexedCoupon&gt;(</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            end, 1.0, start, end, index, gearing, spread, Date(), Date(), DayCounter(), <span class="keyword">false</span>, includeSpread,</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>            lookback * Days, rateCutoff, fixingDays);</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        pricer = boost::make_shared&lt;OvernightIndexedCouponPricer&gt;();</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>    }</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    coupon-&gt;setPricer(pricer);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), coupon-&gt;rate());</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>}</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#abb84774b08d6924094481e3ed5821a8d">  385</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#abb84774b08d6924094481e3ed5821a8d">FdBlackScholesBase::getDiscount</a>(<span class="keyword">const</span> Size idx, <span class="keyword">const</span> Date&amp; s, <span class="keyword">const</span> Date&amp; t)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(idx)-&gt;discount(t) / <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(idx)-&gt;discount(s));</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>}</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a698c2421ff0b896c0388b6d6477cd7b6">  389</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a698c2421ff0b896c0388b6d6477cd7b6">FdBlackScholesBase::getNumeraire</a>(<span class="keyword">const</span> Date&amp; s)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#afb85b7842dff64cac0a2b6cf29d47497">applyQuantoAdjustment_</a>)</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), 1.0 / <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(0)-&gt;discount(s));</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(<a class="code hl_function" href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">size</a>(), 1.0 / <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>)-&gt;discount(s));</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>}</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3430beef258b2f54144fc121011267e6">  396</a></span>Real <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a3430beef258b2f54144fc121011267e6">FdBlackScholesBase::getFxSpot</a>(<span class="keyword">const</span> Size idx)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.at(idx)-&gt;value(); }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a32a74f796461167901dcb7df1c74cbba">  398</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a32a74f796461167901dcb7df1c74cbba">FdBlackScholesBase::npv</a>(<span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>&amp; amount, <span class="keyword">const</span> Date&amp; obsdate, <span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_filter.html">Filter</a>&amp; <a class="code hl_variable" href="computationgraphbuilder_8cpp.html#abd640cc39af07965a8475be310893006">filter</a>,</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>                                       <span class="keyword">const</span> boost::optional&lt;long&gt;&amp; memSlot, <span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>&amp; addRegressor1,</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>                                       <span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>&amp; addRegressor2)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    QL_REQUIRE(!memSlot, <span class="stringliteral">&quot;FdBlackScholesBase::npv(): mem slot not allowed&quot;</span>);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    QL_REQUIRE(!<a class="code hl_variable" href="computationgraphbuilder_8cpp.html#abd640cc39af07965a8475be310893006">filter</a>.initialised(), <span class="stringliteral">&quot;FdBlackScholesBase::npv(). filter not allowed&quot;</span>);</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    QL_REQUIRE(!addRegressor1.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#adaeda39d7b8cc716a40c4da65b00ba77">initialised</a>(), <span class="stringliteral">&quot;FdBlackScholesBase::npv(). addRegressor1 not allowed&quot;</span>);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    QL_REQUIRE(!addRegressor2.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#adaeda39d7b8cc716a40c4da65b00ba77">initialised</a>(), <span class="stringliteral">&quot;FdBlackScholesBase::npv(). addRegressor2 not allowed&quot;</span>);</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    calculate();</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    Real t1 = amount.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a769e6c6c6680ce0b532bc4efa48db44f">time</a>();</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    Real t0 = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;timeFromReference(obsdate);</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <span class="comment">// handle case when amount is deterministic</span></div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span> </div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <span class="keywordflow">if</span> (amount.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a6e0fdc031c26ed1d1a956019d2cee4a1">deterministic</a>()) {</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> result(amount);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>        result.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a7715599b27d9f0c69d0abd43a2469dd2">setTime</a>(t0);</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>        <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    }</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span> </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="comment">// handle stochastic amount</span></div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span> </div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    QL_REQUIRE(t1 != Null&lt;Real&gt;(),</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>               <span class="stringliteral">&quot;FdBlackScholesBase::npv(): can not roll back amount wiithout time attached (to t0=&quot;</span> &lt;&lt; t0 &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    calculate();</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span> </div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="comment">// might throw if t0, t1 are not found in timeGrid_</span></div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span> </div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    Size ind1 = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>.index(t1);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    Size ind0 = <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>.index(t0);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span> </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <span class="comment">// check t0 &lt;= t1, i.e. ind0 &lt;= ind1</span></div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span> </div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    QL_REQUIRE(ind0 &lt;= ind1, <span class="stringliteral">&quot;FdBlackScholesBase::npv(): can not roll back from t1= &quot;</span></div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                                 &lt;&lt; t1 &lt;&lt; <span class="stringliteral">&quot; (index &quot;</span> &lt;&lt; ind1 &lt;&lt; <span class="stringliteral">&quot;) to t0= &quot;</span> &lt;&lt; t0 &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; ind0 &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span> </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="comment">// if t0 = t1, no rollback is necessary and we can return the input random variable</span></div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span> </div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="keywordflow">if</span> (ind0 == ind1)</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        <span class="keywordflow">return</span> amount;</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="comment">// if t0 &lt; t1, we roll back on the time grid</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    Array workingArray(amount.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#acce0ab2cacc475b2434f24c65c91685a">size</a>());</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    amount.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a9d395fe67d6ce574f9fe50c93d9ed697">copyToArray</a>(workingArray);</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span> </div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ind1) - 1; j &gt;= <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(ind0); --j) {</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#add3c97e2a55603c3648a5304f08a8fb5">solver_</a>-&gt;rollback(workingArray, <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>[j + 1], <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>[j], 1, 0);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    }</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="comment">// return the rolled back value</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <span class="keywordflow">return</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(workingArray, t0);</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>}</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a15aa444a844bc8f8670058816b9dcc0c">  455</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a15aa444a844bc8f8670058816b9dcc0c">FdBlackScholesBase::releaseMemory</a>() {}</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a1750263c28cbb6063301d48df87c0541">  457</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a1750263c28cbb6063301d48df87c0541">FdBlackScholesBase::getFutureBarrierProb</a>(<span class="keyword">const</span> std::string&amp; index, <span class="keyword">const</span> Date&amp; obsdate1,</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>                                                        <span class="keyword">const</span> Date&amp; obsdate2, <span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>&amp; barrier,</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>                                                        <span class="keyword">const</span> <span class="keywordtype">bool</span> above)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>    QL_FAIL(<span class="stringliteral">&quot;FdBlackScholesBase::getFutureBarrierProb(): not supported&quot;</span>);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>}</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a8462ba47ae7fbc571ced62f9fdc8a1b8">  463</a></span>Real <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a8462ba47ae7fbc571ced62f9fdc8a1b8">FdBlackScholesBase::extractT0Result</a>(<span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>&amp; <a class="code hl_variable" href="computationgraphbuilder_8cpp.html#a68c611e65dfff92886c4627c9fdde094">value</a>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    calculate();</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    <span class="comment">// roll back to today (if necessary)</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> r = <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a32a74f796461167901dcb7df1c74cbba">npv</a>(<a class="code hl_variable" href="computationgraphbuilder_8cpp.html#a68c611e65dfff92886c4627c9fdde094">value</a>, <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a5ce8b0af276b7c06ab424e688ae2d318">referenceDate</a>(), <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_filter.html">Filter</a>(), boost::none, <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>(), <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>());</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="comment">// if result is deterministic, return the value</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="keywordflow">if</span> (r.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a6e0fdc031c26ed1d1a956019d2cee4a1">deterministic</a>())</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="keywordflow">return</span> r.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a52b7b894964a2a061ce79c386c3e3e8f">at</a>(0);</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>    <span class="comment">// otherwise interpolate the result at the spot of the underlying process</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    Array x(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">underlyingValues_</a>.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#acce0ab2cacc475b2434f24c65c91685a">size</a>());</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>    Array y(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">underlyingValues_</a>.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#acce0ab2cacc475b2434f24c65c91685a">size</a>());</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">underlyingValues_</a>.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a9d395fe67d6ce574f9fe50c93d9ed697">copyToArray</a>(x);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    r.<a class="code hl_functionRef" href="../qle/struct_quant_ext_1_1_random_variable.html#a9d395fe67d6ce574f9fe50c93d9ed697">copyToArray</a>(y);</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    MonotonicCubicNaturalSpline interpolation(x.begin(), x.end(), y.begin());</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    interpolation.enableExtrapolation();</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>    <span class="keywordflow">return</span> interpolation(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes()[0]-&gt;x0());</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>}</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab648089ec0ba2f1040ed8da9885ec6a3">  487</a></span><a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a> <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#ab648089ec0ba2f1040ed8da9885ec6a3">FdBlackScholesBase::pay</a>(<span class="keyword">const</span> <a class="code hl_structRef" href="../qle/struct_quant_ext_1_1_random_variable.html">RandomVariable</a>&amp; amount, <span class="keyword">const</span> Date&amp; obsdate, <span class="keyword">const</span> Date&amp; paydate,</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                                       <span class="keyword">const</span> std::string&amp; currency)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>    calculate();</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#afb85b7842dff64cac0a2b6cf29d47497">applyQuantoAdjustment_</a>) {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        <span class="keyword">auto</span> res = <a class="code hl_function" href="classore_1_1data_1_1_model_impl.html#ab648089ec0ba2f1040ed8da9885ec6a3">ModelImpl::pay</a>(amount, obsdate, paydate, currency);</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        res.setTime(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;timeFromReference(obsdate));</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    }</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span> </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    QL_REQUIRE(currency == <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>],</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>               <span class="stringliteral">&quot;pay ccy is &#39;&quot;</span> &lt;&lt; currency &lt;&lt; <span class="stringliteral">&quot;&#39;, expected &#39;&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>]</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>                              &lt;&lt; <span class="stringliteral">&quot;&#39; in quanto-adjusted FDBlackScholesBase model&quot;</span>);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    Date effectiveDate = std::max(obsdate, <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a5ce8b0af276b7c06ab424e688ae2d318">referenceDate</a>());</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <span class="keyword">auto</span> res = amount * <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#abb84774b08d6924094481e3ed5821a8d">getDiscount</a>(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>, effectiveDate, paydate) / <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a698c2421ff0b896c0388b6d6477cd7b6">getNumeraire</a>(effectiveDate);</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    res.setTime(<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;timeFromReference(obsdate));</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>}</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_fd_black_scholes_base.html#a696f2bf443e378a556c135bfbef71be9">  509</a></span><span class="keyword">const</span> std::string&amp; <a class="code hl_function" href="classore_1_1data_1_1_fd_black_scholes_base.html#a696f2bf443e378a556c135bfbef71be9">FdBlackScholesBase::baseCcy</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#afb85b7842dff64cac0a2b6cf29d47497">applyQuantoAdjustment_</a>)</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        <span class="keywordflow">return</span> <a class="code hl_function" href="classore_1_1data_1_1_model_impl.html#a696f2bf443e378a556c135bfbef71be9">ModelImpl::baseCcy</a>();</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>[<a class="code hl_variable" href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">quantoTargetCcyIndex_</a>];</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>}</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span> </div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>} <span class="comment">// namespace data</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>} <span class="comment">// namespace ore</span></div>
<div class="ttc" id="aaverageonindexedcoupon_8hpp_html"><div class="ttname"><a href="../qle/averageonindexedcoupon_8hpp.html">averageonindexedcoupon.hpp</a></div></div>
<div class="ttc" id="aaverageonindexedcouponpricer_8hpp_html"><div class="ttname"><a href="../qle/averageonindexedcouponpricer_8hpp.html">averageonindexedcouponpricer.hpp</a></div></div>
<div class="ttc" id="ablackscholescg_8cpp_html_a6839be55e1e90b11f6f9068fe0b20874"><div class="ttname"><a href="blackscholescg_8cpp.html#a6839be55e1e90b11f6f9068fe0b20874">calibrationStrikes_</a></div><div class="ttdeci">const std::vector&lt; Real &gt; calibrationStrikes_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescg_8cpp_source.html#l00235">blackscholescg.cpp:235</a></div></div>
<div class="ttc" id="ablackscholescg_8cpp_html_aa842cc62b4fc38f8bf8f022be3504f03"><div class="ttname"><a href="blackscholescg_8cpp.html#aa842cc62b4fc38f8bf8f022be3504f03">correlations_</a></div><div class="ttdeci">const std::map&lt; std::pair&lt; std::string, std::string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; &amp; correlations_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescg_8cpp_source.html#l00228">blackscholescg.cpp:228</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html">ore::data::FdBlackScholesBase</a></div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00044">fdblackscholesbase.hpp:44</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a0e7b4b054beda325e75ce61b56405d20"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a0e7b4b054beda325e75ce61b56405d20">ore::data::FdBlackScholesBase::getInfIndexValue</a></div><div class="ttdeci">RandomVariable getInfIndexValue(const Size indexNo, const Date &amp;d, const Date &amp;fwd=Null&lt; Date &gt;()) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00349">fdblackscholesbase.cpp:349</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a1127cccc9668a02247dc139d27121708"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a1127cccc9668a02247dc139d27121708">ore::data::FdBlackScholesBase::performCalculations</a></div><div class="ttdeci">void performCalculations() const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00173">fdblackscholesbase.cpp:173</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a153ce589f634e2e684279bf7d272dcf8"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a153ce589f634e2e684279bf7d272dcf8">ore::data::FdBlackScholesBase::quantoTargetCcyIndex_</a></div><div class="ttdeci">Size quantoTargetCcyIndex_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00123">fdblackscholesbase.hpp:123</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a15aa444a844bc8f8670058816b9dcc0c"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a15aa444a844bc8f8670058816b9dcc0c">ore::data::FdBlackScholesBase::releaseMemory</a></div><div class="ttdeci">void releaseMemory() override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00455">fdblackscholesbase.cpp:455</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a1750263c28cbb6063301d48df87c0541"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a1750263c28cbb6063301d48df87c0541">ore::data::FdBlackScholesBase::getFutureBarrierProb</a></div><div class="ttdeci">RandomVariable getFutureBarrierProb(const std::string &amp;index, const Date &amp;obsdate1, const Date &amp;obsdate2, const RandomVariable &amp;barrier, const bool above) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00457">fdblackscholesbase.cpp:457</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a25f2377e0f0cf5adedc662a54dd30dda"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a25f2377e0f0cf5adedc662a54dd30dda">ore::data::FdBlackScholesBase::staticMesher_</a></div><div class="ttdeci">const bool staticMesher_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00119">fdblackscholesbase.hpp:119</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a26af5aa9804e7dadbf6f641639e9c774"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a26af5aa9804e7dadbf6f641639e9c774">ore::data::FdBlackScholesBase::mesherConcentration_</a></div><div class="ttdeci">const Real mesherConcentration_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00117">fdblackscholesbase.hpp:117</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a31ea941e2c5742d1de925abc758a422e"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a31ea941e2c5742d1de925abc758a422e">ore::data::FdBlackScholesBase::getIrIndexValue</a></div><div class="ttdeci">RandomVariable getIrIndexValue(const Size indexNo, const Date &amp;d, const Date &amp;fwd=Null&lt; Date &gt;()) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00340">fdblackscholesbase.cpp:340</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a32a74f796461167901dcb7df1c74cbba"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a32a74f796461167901dcb7df1c74cbba">ore::data::FdBlackScholesBase::npv</a></div><div class="ttdeci">RandomVariable npv(const RandomVariable &amp;amount, const Date &amp;obsdate, const Filter &amp;filter, const boost::optional&lt; long &gt; &amp;memSlot, const RandomVariable &amp;addRegressor1, const RandomVariable &amp;addRegressor2) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00398">fdblackscholesbase.cpp:398</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a3430beef258b2f54144fc121011267e6"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a3430beef258b2f54144fc121011267e6">ore::data::FdBlackScholesBase::getFxSpot</a></div><div class="ttdeci">Real getFxSpot(const Size idx) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00396">fdblackscholesbase.cpp:396</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a3b500081d709650730800cacebd0b34e"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a3b500081d709650730800cacebd0b34e">ore::data::FdBlackScholesBase::FdBlackScholesBase</a></div><div class="ttdeci">FdBlackScholesBase(const Size stateGridPoints, const std::vector&lt; std::string &gt; &amp;currencies, const std::vector&lt; Handle&lt; YieldTermStructure &gt; &gt; &amp;curves, const std::vector&lt; Handle&lt; Quote &gt; &gt; &amp;fxSpots, const std::vector&lt; std::pair&lt; std::string, boost::shared_ptr&lt; InterestRateIndex &gt; &gt; &gt; &amp;irIndices, const std::vector&lt; std::pair&lt; std::string, boost::shared_ptr&lt; ZeroInflationIndex &gt; &gt; &gt; &amp;infIndices, const std::vector&lt; std::string &gt; &amp;indices, const std::vector&lt; std::string &gt; &amp;indexCurrencies, const std::set&lt; std::string &gt; &amp;payCcys_, const Handle&lt; BlackScholesModelWrapper &gt; &amp;model, const std::map&lt; std::pair&lt; std::string, std::string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; &amp;correlations, const std::set&lt; Date &gt; &amp;simulationDates, const IborFallbackConfig &amp;iborFallbackConfig, const std::string &amp;calibration, const std::map&lt; std::string, std::vector&lt; Real &gt; &gt; &amp;calibrationStrikes={}, const Real mesherEpsilon=1E-4, const Real mesherScaling=1.5, const Real mesherConcentration=0.1, const Size mesherMaxConcentratingPoints=9999, const bool staticMesher=false)</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00057">fdblackscholesbase.cpp:57</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a3e22290961d6b56dce069c1c4fda6386"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a3e22290961d6b56dce069c1c4fda6386">ore::data::FdBlackScholesBase::referenceDate_</a></div><div class="ttdeci">Date referenceDate_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00128">fdblackscholesbase.hpp:128</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a48e130e941c5e59cbd9d2fdd395b8a22"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a48e130e941c5e59cbd9d2fdd395b8a22">ore::data::FdBlackScholesBase::quantoSourceCcyIndex_</a></div><div class="ttdeci">Size quantoSourceCcyIndex_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00123">fdblackscholesbase.hpp:123</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a4aaba3adb9860f7e99d4b7e5de336b3c"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a4aaba3adb9860f7e99d4b7e5de336b3c">ore::data::FdBlackScholesBase::operator_</a></div><div class="ttdeci">boost::shared_ptr&lt; FdmLinearOpComposite &gt; operator_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00133">fdblackscholesbase.hpp:133</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a51ccdb31aed98dd6b2c64878a88412bf"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a51ccdb31aed98dd6b2c64878a88412bf">ore::data::FdBlackScholesBase::mesherScaling_</a></div><div class="ttdeci">const Real mesherScaling_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00117">fdblackscholesbase.hpp:117</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a5ce8b0af276b7c06ab424e688ae2d318"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a5ce8b0af276b7c06ab424e688ae2d318">ore::data::FdBlackScholesBase::referenceDate</a></div><div class="ttdeci">const Date &amp; referenceDate() const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00168">fdblackscholesbase.cpp:168</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a6173a18083f066a89cbf39fe65ca3e69"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a6173a18083f066a89cbf39fe65ca3e69">ore::data::FdBlackScholesBase::mesher_</a></div><div class="ttdeci">boost::shared_ptr&lt; FdmMesher &gt; mesher_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00132">fdblackscholesbase.hpp:132</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a696f2bf443e378a556c135bfbef71be9"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a696f2bf443e378a556c135bfbef71be9">ore::data::FdBlackScholesBase::baseCcy</a></div><div class="ttdeci">const std::string &amp; baseCcy() const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00509">fdblackscholesbase.cpp:509</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a698c2421ff0b896c0388b6d6477cd7b6"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a698c2421ff0b896c0388b6d6477cd7b6">ore::data::FdBlackScholesBase::getNumeraire</a></div><div class="ttdeci">RandomVariable getNumeraire(const Date &amp;s) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00389">fdblackscholesbase.cpp:389</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a8462ba47ae7fbc571ced62f9fdc8a1b8"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a8462ba47ae7fbc571ced62f9fdc8a1b8">ore::data::FdBlackScholesBase::extractT0Result</a></div><div class="ttdeci">Real extractT0Result(const RandomVariable &amp;result) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00463">fdblackscholesbase.cpp:463</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a9356ce4490b329fbfbad73fa28841898"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a9356ce4490b329fbfbad73fa28841898">ore::data::FdBlackScholesBase::effectiveSimulationDates_</a></div><div class="ttdeci">std::set&lt; Date &gt; effectiveSimulationDates_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00129">fdblackscholesbase.hpp:129</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_a99054793188f592b261996aa407edc97"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#a99054793188f592b261996aa407edc97">ore::data::FdBlackScholesBase::underlyingValues_</a></div><div class="ttdeci">RandomVariable underlyingValues_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00135">fdblackscholesbase.hpp:135</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_aaf8a64586eb5db2781e2ba5c0597041f"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#aaf8a64586eb5db2781e2ba5c0597041f">ore::data::FdBlackScholesBase::fxSpots_</a></div><div class="ttdeci">const std::vector&lt; Handle&lt; Quote &gt; &gt; fxSpots_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00110">fdblackscholesbase.hpp:110</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_ab648089ec0ba2f1040ed8da9885ec6a3"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#ab648089ec0ba2f1040ed8da9885ec6a3">ore::data::FdBlackScholesBase::pay</a></div><div class="ttdeci">RandomVariable pay(const RandomVariable &amp;amount, const Date &amp;obsdate, const Date &amp;paydate, const std::string &amp;currency) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00487">fdblackscholesbase.cpp:487</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_ab695da1eaa09dc5436c91089c0888f59"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#ab695da1eaa09dc5436c91089c0888f59">ore::data::FdBlackScholesBase::model_</a></div><div class="ttdeci">const Handle&lt; BlackScholesModelWrapper &gt; model_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00112">fdblackscholesbase.hpp:112</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_ab6f1d1f2c2702a5b1b5bb92d19e506c8"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#ab6f1d1f2c2702a5b1b5bb92d19e506c8">ore::data::FdBlackScholesBase::calibrationStrikes_</a></div><div class="ttdeci">const std::map&lt; std::string, std::vector&lt; Real &gt; &gt; calibrationStrikes_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00116">fdblackscholesbase.hpp:116</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_abb84774b08d6924094481e3ed5821a8d"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#abb84774b08d6924094481e3ed5821a8d">ore::data::FdBlackScholesBase::getDiscount</a></div><div class="ttdeci">RandomVariable getDiscount(const Size idx, const Date &amp;s, const Date &amp;t) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00385">fdblackscholesbase.cpp:385</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_ac13ca5824ce4947677f1b11557f49c53"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#ac13ca5824ce4947677f1b11557f49c53">ore::data::FdBlackScholesBase::mesherMaxConcentratingPoints_</a></div><div class="ttdeci">const Size mesherMaxConcentratingPoints_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00118">fdblackscholesbase.hpp:118</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_ac2531b45af9259f8b3af891fac9f5d03"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#ac2531b45af9259f8b3af891fac9f5d03">ore::data::FdBlackScholesBase::getIndexValue</a></div><div class="ttdeci">RandomVariable getIndexValue(const Size indexNo, const Date &amp;d, const Date &amp;fwd=Null&lt; Date &gt;()) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00302">fdblackscholesbase.cpp:302</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_ad5735abf6dd33753da8d565f50f8c8e9"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#ad5735abf6dd33753da8d565f50f8c8e9">ore::data::FdBlackScholesBase::mesherEpsilon_</a></div><div class="ttdeci">const Real mesherEpsilon_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00117">fdblackscholesbase.hpp:117</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_add3c97e2a55603c3648a5304f08a8fb5"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#add3c97e2a55603c3648a5304f08a8fb5">ore::data::FdBlackScholesBase::solver_</a></div><div class="ttdeci">boost::shared_ptr&lt; FdmBackwardSolver &gt; solver_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00134">fdblackscholesbase.hpp:134</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_adda5ae6c670bdbb1857509a4aa20ec25"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#adda5ae6c670bdbb1857509a4aa20ec25">ore::data::FdBlackScholesBase::timeGrid_</a></div><div class="ttdeci">TimeGrid timeGrid_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00130">fdblackscholesbase.hpp:130</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_aeb5929f7ce6e2d52f420ca71b7caaae1"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#aeb5929f7ce6e2d52f420ca71b7caaae1">ore::data::FdBlackScholesBase::correlations_</a></div><div class="ttdeci">const std::map&lt; std::pair&lt; std::string, std::string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; correlations_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00113">fdblackscholesbase.hpp:113</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_aef2fa78219e2206833d4d8f63bf20a70"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#aef2fa78219e2206833d4d8f63bf20a70">ore::data::FdBlackScholesBase::fwdCompAvg</a></div><div class="ttdeci">RandomVariable fwdCompAvg(const bool isAvg, const std::string &amp;index, const Date &amp;obsdate, const Date &amp;start, const Date &amp;end, const Real spread, const Real gearing, const Integer lookback, const Natural rateCutoff, const Natural fixingDays, const bool includeSpread, const Real cap, const Real floor, const bool nakedOption, const bool localCapFloor) const override</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00356">fdblackscholesbase.cpp:356</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_af46e078a1433cbe2f4f1e6727eda5d6a"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#af46e078a1433cbe2f4f1e6727eda5d6a">ore::data::FdBlackScholesBase::calibration_</a></div><div class="ttdeci">const std::string calibration_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00115">fdblackscholesbase.hpp:115</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_af603e1ab8495900c2b3044d1cf40cd95"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#af603e1ab8495900c2b3044d1cf40cd95">ore::data::FdBlackScholesBase::quantoCorrelationMultiplier_</a></div><div class="ttdeci">Real quantoCorrelationMultiplier_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00124">fdblackscholesbase.hpp:124</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_af9092b7d1618dd9a9092dc9dae37ea75"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#af9092b7d1618dd9a9092dc9dae37ea75">ore::data::FdBlackScholesBase::curves_</a></div><div class="ttdeci">const std::vector&lt; Handle&lt; YieldTermStructure &gt; &gt; curves_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00109">fdblackscholesbase.hpp:109</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_af9be63a7f055dbb0ed0fc95090d92e87"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#af9be63a7f055dbb0ed0fc95090d92e87">ore::data::FdBlackScholesBase::positionInTimeGrid_</a></div><div class="ttdeci">std::vector&lt; Size &gt; positionInTimeGrid_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00131">fdblackscholesbase.hpp:131</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_afa6dbc82775f93a3bb6b225320c8e685"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#afa6dbc82775f93a3bb6b225320c8e685">ore::data::FdBlackScholesBase::getCorrelation</a></div><div class="ttdeci">Matrix getCorrelation() const</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8cpp_source.html#l00148">fdblackscholesbase.cpp:148</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_fd_black_scholes_base_html_afb85b7842dff64cac0a2b6cf29d47497"><div class="ttname"><a href="classore_1_1data_1_1_fd_black_scholes_base.html#afb85b7842dff64cac0a2b6cf29d47497">ore::data::FdBlackScholesBase::applyQuantoAdjustment_</a></div><div class="ttdeci">bool applyQuantoAdjustment_</div><div class="ttdef"><b>Definition:</b> <a href="fdblackscholesbase_8hpp_source.html#l00122">fdblackscholesbase.hpp:122</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_ibor_fallback_config_html"><div class="ttname"><a href="classore_1_1data_1_1_ibor_fallback_config.html">ore::data::IborFallbackConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="iborfallbackconfig_8hpp_source.html#l00031">iborfallbackconfig.hpp:31</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_index_info_html"><div class="ttname"><a href="classore_1_1data_1_1_index_info.html">ore::data::IndexInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="scripting_2utilities_8hpp_source.html#l00093">utilities.hpp:93</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_index_info_html_a259a38e1e6b17084f72a0032c5615987"><div class="ttname"><a href="classore_1_1data_1_1_index_info.html#a259a38e1e6b17084f72a0032c5615987">ore::data::IndexInfo::irIbor</a></div><div class="ttdeci">boost::shared_ptr&lt; IborIndex &gt; irIbor() const</div><div class="ttdef"><b>Definition:</b> <a href="scripting_2utilities_8hpp_source.html#l00115">utilities.hpp:115</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_html_a389467bfea77ee951d34ed713f00d333"><div class="ttname"><a href="classore_1_1data_1_1_model.html#a389467bfea77ee951d34ed713f00d333">ore::data::Model::additionalResults_</a></div><div class="ttdeci">std::map&lt; std::string, boost::any &gt; additionalResults_</div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00148">model.hpp:148</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_html_a9edcd102946c4e3bd0bcdba2fc64e397"><div class="ttname"><a href="classore_1_1data_1_1_model.html#a9edcd102946c4e3bd0bcdba2fc64e397">ore::data::Model::size</a></div><div class="ttdeci">virtual Size size() const</div><div class="ttdef"><b>Definition:</b> <a href="model_8hpp_source.html#l00069">model.hpp:69</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html">ore::data::ModelImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00044">modelimpl.hpp:44</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_a0e02d6070bafb36ab736bf5cbb4e70ce"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">ore::data::ModelImpl::irIndices_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; IndexInfo, boost::shared_ptr&lt; InterestRateIndex &gt; &gt; &gt; irIndices_</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00112">modelimpl.hpp:112</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_a14efd0665cded9d6785314f26306e91b"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#a14efd0665cded9d6785314f26306e91b">ore::data::ModelImpl::currencies_</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; currencies_</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00107">modelimpl.hpp:107</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_a696f2bf443e378a556c135bfbef71be9"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#a696f2bf443e378a556c135bfbef71be9">ore::data::ModelImpl::baseCcy</a></div><div class="ttdeci">const std::string &amp; baseCcy() const override</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00072">modelimpl.hpp:72</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_a7033255d9f10aca8436bdf488964db70"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#a7033255d9f10aca8436bdf488964db70">ore::data::ModelImpl::indices_</a></div><div class="ttdeci">std::vector&lt; IndexInfo &gt; indices_</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00114">modelimpl.hpp:114</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_ab648089ec0ba2f1040ed8da9885ec6a3"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#ab648089ec0ba2f1040ed8da9885ec6a3">ore::data::ModelImpl::pay</a></div><div class="ttdeci">RandomVariable pay(const RandomVariable &amp;amount, const Date &amp;obsdate, const Date &amp;paydate, const std::string &amp;currency) const override</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8cpp_source.html#l00101">modelimpl.cpp:101</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_ad2f62229897fdae7a8e793ee62e3d00c"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#ad2f62229897fdae7a8e793ee62e3d00c">ore::data::ModelImpl::indexCurrencies_</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; indexCurrencies_</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00108">modelimpl.hpp:108</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_impl_html_aebe584e14684cee39eecccd086ba1588"><div class="ttname"><a href="classore_1_1data_1_1_model_impl.html#aebe584e14684cee39eecccd086ba1588">ore::data::ModelImpl::infIndices_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; IndexInfo, boost::shared_ptr&lt; ZeroInflationIndex &gt; &gt; &gt; infIndices_</div><div class="ttdef"><b>Definition:</b> <a href="modelimpl_8hpp_source.html#l00113">modelimpl.hpp:113</a></div></div>
<div class="ttc" id="acomputationgraphbuilder_8cpp_html_a68c611e65dfff92886c4627c9fdde094"><div class="ttname"><a href="computationgraphbuilder_8cpp.html#a68c611e65dfff92886c4627c9fdde094">value</a></div><div class="ttdeci">SafeStack&lt; ValueType &gt; value</div><div class="ttdef"><b>Definition:</b> <a href="computationgraphbuilder_8cpp_source.html#l01475">computationgraphbuilder.cpp:1475</a></div></div>
<div class="ttc" id="acomputationgraphbuilder_8cpp_html_abd640cc39af07965a8475be310893006"><div class="ttname"><a href="computationgraphbuilder_8cpp.html#abd640cc39af07965a8475be310893006">filter</a></div><div class="ttdeci">SafeStack&lt; Filter &gt; filter</div><div class="ttdef"><b>Definition:</b> <a href="computationgraphbuilder_8cpp_source.html#l01474">computationgraphbuilder.cpp:1474</a></div></div>
<div class="ttc" id="acomputationgraphbuilder_8cpp_html_abffa9627834aae0799550c12a25a85e0"><div class="ttname"><a href="computationgraphbuilder_8cpp.html#abffa9627834aae0799550c12a25a85e0">model_</a></div><div class="ttdeci">const boost::shared_ptr&lt; ModelCG &gt; model_</div><div class="ttdef"><b>Definition:</b> <a href="computationgraphbuilder_8cpp_source.html#l01463">computationgraphbuilder.cpp:1463</a></div></div>
<div class="ttc" id="afdblackscholesbase_8hpp_html"><div class="ttname"><a href="fdblackscholesbase_8hpp.html">fdblackscholesbase.hpp</a></div><div class="ttdoc">black scholes fd model base class for n underlyings (fx, equity or commodity)</div></div>
<div class="ttc" id="aindexparser_8hpp_html"><div class="ttname"><a href="indexparser_8hpp.html">indexparser.hpp</a></div><div class="ttdoc">Map text representations to QuantLib/QuantExt types.</div></div>
<div class="ttc" id="alog_8hpp_html_a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b"><div class="ttname"><a href="log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a></div><div class="ttdeci">@ data</div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00077">log.hpp:77</a></div></div>
<div class="ttc" id="alog_8hpp_html_a34c7c8cde9b91d2eee82d7b9a0b66fd5"><div class="ttname"><a href="log_8hpp.html#a34c7c8cde9b91d2eee82d7b9a0b66fd5">DLOG</a></div><div class="ttdeci">#define DLOG(text)</div><div class="ttdoc">Logging Macro (Level = Debug)</div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00508">log.hpp:508</a></div></div>
<div class="ttc" id="alog_8hpp_html_a4cf6b52b5cb6fdd420eaad750cfc20cc"><div class="ttname"><a href="log_8hpp.html#a4cf6b52b5cb6fdd420eaad750cfc20cc">TLOGGERSTREAM</a></div><div class="ttdeci">#define TLOGGERSTREAM(text)</div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00587">log.hpp:587</a></div></div>
<div class="ttc" id="alog_8hpp_html_a99aeca53f904c71a68070e1f9d310232"><div class="ttname"><a href="log_8hpp.html#a99aeca53f904c71a68070e1f9d310232">TLOG</a></div><div class="ttdeci">#define TLOG(text)</div><div class="ttdoc">Logging Macro (Level = Data)</div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00510">log.hpp:510</a></div></div>
<div class="ttc" id="amodel_2utilities_8hpp_html"><div class="ttname"><a href="model_2utilities_8hpp.html">utilities.hpp</a></div><div class="ttdoc">Shared utilities for model building and calibration.</div></div>
<div class="ttc" id="anamespace_quant_ext_html"><div class="ttname"><a href="namespace_quant_ext.html">QuantExt</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html_a11171c842d01ffacc4ec522e398070a9"><div class="ttname"><a href="../qle/namespace_quant_ext.html#a11171c842d01ffacc4ec522e398070a9">QuantExt::exp</a></div><div class="ttdeci">RandomVariable exp(RandomVariable x)</div></div>
<div class="ttc" id="anamespace_quant_lib_html"><div class="ttname"><a href="namespace_quant_lib.html">QuantLib</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a7a2f6f438823e3f124eac5bf1e228cef"><div class="ttname"><a href="namespaceore_1_1data.html#a7a2f6f438823e3f124eac5bf1e228cef">ore::data::atmForward</a></div><div class="ttdeci">Real atmForward(const Real s0, const Handle&lt; YieldTermStructure &gt; &amp;r, const Handle&lt; YieldTermStructure &gt; &amp;q, const Real t)</div><div class="ttdoc">helper function that computes the atm forward</div><div class="ttdef"><b>Definition:</b> <a href="model_2utilities_8cpp_source.html#l00483">utilities.cpp:483</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a86651dfeb5c18ee891f7a4734d8cf455"><div class="ttname"><a href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a></div><div class="ttdeci">std::string to_string(const LocationInfo &amp;l)</div><div class="ttdef"><b>Definition:</b> <a href="ast_8cpp_source.html#l00028">ast.cpp:28</a></div></div>
<div class="ttc" id="anamespaceore_html"><div class="ttname"><a href="namespaceore.html">ore</a></div><div class="ttdoc">Serializable Credit Default Swap.</div><div class="ttdef"><b>Definition:</b> <a href="namespaces_8docs.html_source#l00023">namespaces.docs:23</a></div></div>
<div class="ttc" id="aovernightindexedcoupon_8hpp_html"><div class="ttname"><a href="../qle/overnightindexedcoupon_8hpp.html">overnightindexedcoupon.hpp</a></div></div>
<div class="ttc" id="ascripting_2utilities_8hpp_html"><div class="ttname"><a href="scripting_2utilities_8hpp.html">utilities.hpp</a></div><div class="ttdoc">some utility functions</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_filter_html"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_filter.html">QuantExt::Filter</a></div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html">QuantExt::RandomVariable</a></div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_a52b7b894964a2a061ce79c386c3e3e8f"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#a52b7b894964a2a061ce79c386c3e3e8f">QuantExt::RandomVariable::at</a></div><div class="ttdeci">Real at(const Size i) const</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_a6e0fdc031c26ed1d1a956019d2cee4a1"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#a6e0fdc031c26ed1d1a956019d2cee4a1">QuantExt::RandomVariable::deterministic</a></div><div class="ttdeci">bool deterministic() const</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_a769e6c6c6680ce0b532bc4efa48db44f"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#a769e6c6c6680ce0b532bc4efa48db44f">QuantExt::RandomVariable::time</a></div><div class="ttdeci">Real time() const</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_a7715599b27d9f0c69d0abd43a2469dd2"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#a7715599b27d9f0c69d0abd43a2469dd2">QuantExt::RandomVariable::setTime</a></div><div class="ttdeci">void setTime(const Real time)</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_a9d395fe67d6ce574f9fe50c93d9ed697"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#a9d395fe67d6ce574f9fe50c93d9ed697">QuantExt::RandomVariable::copyToArray</a></div><div class="ttdeci">void copyToArray(QuantLib::Array &amp;array) const</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_acce0ab2cacc475b2434f24c65c91685a"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#acce0ab2cacc475b2434f24c65c91685a">QuantExt::RandomVariable::size</a></div><div class="ttdeci">Size size() const</div></div>
<div class="ttc" id="astruct_quant_ext_1_1_random_variable_html_adaeda39d7b8cc716a40c4da65b00ba77"><div class="ttname"><a href="../qle/struct_quant_ext_1_1_random_variable.html#adaeda39d7b8cc716a40c4da65b00ba77">QuantExt::RandomVariable::initialised</a></div><div class="ttdeci">bool initialised() const</div></div>
<div class="ttc" id="ato__string_8hpp_html"><div class="ttname"><a href="to__string_8hpp.html">to_string.hpp</a></div><div class="ttdoc">string conversion utilities</div></div>
<div class="ttc" id="atodaysmarketparameters_8cpp_html_a8ccf841cb59e451791bcb2e1ac4f1edc"><div class="ttname"><a href="todaysmarketparameters_8cpp.html#a8ccf841cb59e451791bcb2e1ac4f1edc">name</a></div><div class="ttdeci">string name</div><div class="ttdef"><b>Definition:</b> <a href="todaysmarketparameters_8cpp_source.html#l00032">todaysmarketparameters.cpp:32</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
