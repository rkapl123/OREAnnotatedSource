<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<title>OREData: ored/scripting/models/blackscholescgbase.cpp Source File</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather+Sans|Open+Sans" rel="stylesheet">
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/png" href="favicon.png">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="oredextra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
   <div id="projectname"><a href="https://rkapl123.github.io/OREAnnotatedSource/">
       <img src="logo-data@2x.png" alt="Logo" width="150" height="68" style="float: left; padding: 15px;"/></a>
   <div id="projectbrief">Fully annotated reference manual - version 1.8.11</div>
   </div>
</div>
<!-- end header part --><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_3e56cb31e3027d5bae8796cb64b50d07.html">ored</a></li><li class="navelem"><a class="el" href="dir_5ec8a1e1d14eaa47b1b0e648274be507.html">scripting</a></li><li class="navelem"><a class="el" href="dir_f42446cc52b32b57df5f03cb32d31df7.html">models</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">blackscholescgbase.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="blackscholescgbase_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> Copyright (C) 2021 Quaternion Risk Management Ltd</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> All rights reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"></span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> This file is part of ORE, a free-software/open-source library</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> for transparent pricing and risk analysis - http://opensourcerisk.org</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"></span> </div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> ORE is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> under the terms of the Modified BSD License.  You should have received a</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> copy of the license along with this program.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> The license is also available online at &lt;http://opensourcerisk.org&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"></span> </div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> This program is distributed on the basis that it will form a useful</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> contribution to risk analytics and model standardisation, but WITHOUT</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> FITNESS FOR A PARTICULAR PURPOSE. See the license for more details.</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment">*/</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;<a class="code" href="blackscholescgbase_8hpp.html">ored/scripting/models/blackscholescgbase.hpp</a>&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;<a class="code" href="indexparser_8hpp.html">ored/utilities/indexparser.hpp</a>&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;<a class="code" href="to__string_8hpp.html">ored/utilities/to_string.hpp</a>&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../qle/averageonindexedcoupon_8hpp.html">qle/cashflows/averageonindexedcoupon.hpp</a>&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../qle/averageonindexedcouponpricer_8hpp.html">qle/cashflows/averageonindexedcouponpricer.hpp</a>&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="codeRef" href="../qle/overnightindexedcoupon_8hpp.html">qle/cashflows/overnightindexedcoupon.hpp</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;qle/math/randomvariablelsmbasissystem.hpp&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;qle/math/randomvariable_ops.hpp&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;ql/math/comparison.hpp&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;ql/math/matrixutilities/pseudosqrt.hpp&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;ql/quotes/simplequote.hpp&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span> </div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceore.html">ore</a> {</div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="keyword">namespace </span><a class="code hl_enumvalue" href="log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a> {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span> </div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_quant_lib.html">QuantLib</a>;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_quant_ext.html">QuantExt</a>;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span> </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3f1f700cd97605a29ad405208f3a54d7">   40</a></span><a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#afdaf753fc7c923e9ab6376165c088fbd">BlackScholesCGBase::BlackScholesCGBase</a>(<span class="keyword">const</span> Size paths, <span class="keyword">const</span> std::string&amp; currency,</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>                                       <span class="keyword">const</span> Handle&lt;YieldTermStructure&gt;&amp; curve, <span class="keyword">const</span> std::string&amp; index,</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>                                       <span class="keyword">const</span> std::string&amp; indexCurrency, <span class="keyword">const</span> Handle&lt;BlackScholesModelWrapper&gt;&amp; model,</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>                                       <span class="keyword">const</span> std::set&lt;Date&gt;&amp; simulationDates,</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>                                       <span class="keyword">const</span> <a class="code hl_class" href="classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a>&amp; iborFallbackConfig)</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    : <a class="code hl_class" href="classore_1_1data_1_1_black_scholes_c_g_base.html">BlackScholesCGBase</a>(paths, {currency}, {curve}, {}, {}, {}, {index}, {indexCurrency}, model, {}, simulationDates,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>                         iborFallbackConfig) {}</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#afdaf753fc7c923e9ab6376165c088fbd">   48</a></span><a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#afdaf753fc7c923e9ab6376165c088fbd">BlackScholesCGBase::BlackScholesCGBase</a>(</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keyword">const</span> Size paths, <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; currencies, <span class="keyword">const</span> std::vector&lt;Handle&lt;YieldTermStructure&gt;&gt;&amp; curves,</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="keyword">const</span> std::vector&lt;Handle&lt;Quote&gt;&gt;&amp; fxSpots,</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    <span class="keyword">const</span> std::vector&lt;std::pair&lt;std::string, boost::shared_ptr&lt;InterestRateIndex&gt;&gt;&gt;&amp; irIndices,</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    <span class="keyword">const</span> std::vector&lt;std::pair&lt;std::string, boost::shared_ptr&lt;ZeroInflationIndex&gt;&gt;&gt;&amp; infIndices,</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>    <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; indices, <span class="keyword">const</span> std::vector&lt;std::string&gt;&amp; indexCurrencies,</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keyword">const</span> Handle&lt;BlackScholesModelWrapper&gt;&amp; model,</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>    <span class="keyword">const</span> std::map&lt;std::pair&lt;std::string, std::string&gt;, Handle&lt;QuantExt::CorrelationTermStructure&gt;&gt;&amp; correlations,</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <span class="keyword">const</span> std::set&lt;Date&gt;&amp; simulationDates, <span class="keyword">const</span> <a class="code hl_class" href="classore_1_1data_1_1_ibor_fallback_config.html">IborFallbackConfig</a>&amp; iborFallbackConfig)</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    : <a class="code hl_class" href="classore_1_1data_1_1_model_c_g_impl.html">ModelCGImpl</a>(curves.at(0)-&gt;dayCounter(), paths, currencies, irIndices, infIndices, indices, indexCurrencies,</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>                  simulationDates, iborFallbackConfig),</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>      curves_(curves), fxSpots_(fxSpots), <a class="code hl_variable" href="computationgraphbuilder_8cpp.html#abffa9627834aae0799550c12a25a85e0">model_</a>(model), <a class="code hl_variable" href="blackscholescg_8cpp.html#aa842cc62b4fc38f8bf8f022be3504f03">correlations_</a>(correlations) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span> </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="comment">// check inputs</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    QL_REQUIRE(!<a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>.empty(), <span class="stringliteral">&quot;model is empty&quot;</span>);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    QL_REQUIRE(!<a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.empty(), <span class="stringliteral">&quot;no curves given&quot;</span>);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size() == <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.size(), <span class="stringliteral">&quot;number of currencies (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size()</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>                                                                              &lt;&lt; <span class="stringliteral">&quot;) does not match number of curves (&quot;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>                                                                              &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size() == <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.size() + 1,</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>               <span class="stringliteral">&quot;number of currencies (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.size() &lt;&lt; <span class="stringliteral">&quot;) does not match number of fx spots (&quot;</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>                                        &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.size() &lt;&lt; <span class="stringliteral">&quot;) + 1&quot;</span>);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size() == <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().size(),</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>               <span class="stringliteral">&quot;mismatch of processes size (&quot;</span> &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().size() &lt;&lt; <span class="stringliteral">&quot;) and number of indices (&quot;</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>                                              &lt;&lt; <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>.size() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    <span class="comment">// register with observables</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; o : <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>)</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>        registerWith(o);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; o : <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aeb5929f7ce6e2d52f420ca71b7caaae1">correlations_</a>)</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>        registerWith(o.second);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span> </div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    registerWith(<a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>);</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>} <span class="comment">// BlackScholesBase ctor</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a5ce8b0af276b7c06ab424e688ae2d318">   87</a></span><span class="keyword">const</span> Date&amp; <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a5ce8b0af276b7c06ab424e688ae2d318">BlackScholesCGBase::referenceDate</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    calculate();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3e22290961d6b56dce069c1c4fda6386">referenceDate_</a>;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>}</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span> </div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a1127cccc9668a02247dc139d27121708">   92</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a1127cccc9668a02247dc139d27121708">BlackScholesCGBase::performCalculations</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    <span class="comment">// needed for base class performCalculations()</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3e22290961d6b56dce069c1c4fda6386">referenceDate_</a> = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;referenceDate();</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span> </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="comment">// update cg version if necessary (eval date changed)</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span> </div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a1127cccc9668a02247dc139d27121708">ModelCGImpl::performCalculations</a>();</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span> </div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="comment">// if cg version has changed =&gt; update time grid related members and clear paths, so that they</span></div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="comment">// are populated in derived classes</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a3a0f80d541e893e1eaf8f982f62c9499">cgVersion</a>() != <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a23d5244d8ea131b9d4d82ea3ac415502">underlyingPathsCgVersion_</a>) {</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>        <span class="comment">// set up time grid</span></div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a9356ce4490b329fbfbad73fa28841898">effectiveSimulationDates_</a> = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;effectiveSimulationDates();</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>        std::vector&lt;Real&gt; times;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; d : <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a9356ce4490b329fbfbad73fa28841898">effectiveSimulationDates_</a>) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>            times.push_back(<a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.front()-&gt;timeFromReference(d));</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>        }</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a> = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;discretisationTimeGrid();</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>.resize(times.size());</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>        <span class="keywordflow">for</span> (Size i = 0; i &lt; <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>.size(); ++i)</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>            <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9be63a7f055dbb0ed0fc95090d92e87">positionInTimeGrid_</a>[i] = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#adda5ae6c670bdbb1857509a4aa20ec25">timeGrid_</a>.index(times[i]);</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span> </div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>        <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">underlyingPaths_</a>.clear();</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>        <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a23d5244d8ea131b9d4d82ea3ac415502">underlyingPathsCgVersion_</a> = <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a3a0f80d541e893e1eaf8f982f62c9499">cgVersion</a>();</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    }</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>}</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#acda3059c2cee3c6462c5083590438a40">  126</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#acda3059c2cee3c6462c5083590438a40">BlackScholesCGBase::getIndexValue</a>(<span class="keyword">const</span> Size indexNo, <span class="keyword">const</span> Date&amp; d, <span class="keyword">const</span> Date&amp; fwd)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    Date effFwd = fwd;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[indexNo].isComm()) {</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>        Date expiry = <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a7033255d9f10aca8436bdf488964db70">indices_</a>[indexNo].comm(d)-&gt;expiryDate();</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <span class="comment">// if a future is referenced we set the forward date effectively used below to the future&#39;s expiry date</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        <span class="keywordflow">if</span> (expiry != Date())</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>            effFwd = expiry;</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>        <span class="comment">// if the future expiry is past the obsdate, we return the spot as of the obsdate, i.e. we</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>        <span class="comment">// freeze the future value after its expiry, but keep it available for observation</span></div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>        <span class="comment">// TOOD should we throw an exception instead?</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>        effFwd = std::max(effFwd, d);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    }</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    QL_REQUIRE(<a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">underlyingPaths_</a>.find(d) != <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">underlyingPaths_</a>.end(), <span class="stringliteral">&quot;did not find path for &quot;</span> &lt;&lt; d);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="keyword">auto</span> res = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">underlyingPaths_</a>.at(d).at(indexNo);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="comment">// compute forwarding factor</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <span class="keywordflow">if</span> (effFwd != Null&lt;Date&gt;()) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>        <span class="keyword">auto</span> p = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">model_</a>-&gt;processes().at(indexNo);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>        std::string idf = std::to_string(indexNo) + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(effFwd);</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>        std::string idd = std::to_string(indexNo) + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(d);</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="stringliteral">&quot;__div_&quot;</span> + idd, [p, d]() { <span class="keywordflow">return</span> p-&gt;dividendYield()-&gt;<a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a44b8187e17888b27e1ff5c98a214a96b">discount</a>(d); });</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="stringliteral">&quot;__div_&quot;</span> + idf, [p, effFwd]() { <span class="keywordflow">return</span> p-&gt;dividendYield()-&gt;<a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a44b8187e17888b27e1ff5c98a214a96b">discount</a>(effFwd); });</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="stringliteral">&quot;__rfr_&quot;</span> + idd, [p, d]() { <span class="keywordflow">return</span> p-&gt;riskFreeRate()-&gt;<a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a44b8187e17888b27e1ff5c98a214a96b">discount</a>(d); });</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>        <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="stringliteral">&quot;__rfr_&quot;</span> + idf, [p, effFwd]() { <span class="keywordflow">return</span> p-&gt;riskFreeRate()-&gt;<a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a44b8187e17888b27e1ff5c98a214a96b">discount</a>(effFwd); });</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>        res = cg_mult(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, res,</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>                      cg_mult(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="stringliteral">&quot;__div_&quot;</span> + idf),</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>                              cg_div(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="stringliteral">&quot;__rfr_&quot;</span> + idd),</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>                                     cg_mult(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="stringliteral">&quot;__div_&quot;</span> + idd), cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="stringliteral">&quot;__rfr_&quot;</span> + idf)))));</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>}</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a9ac494d33de086073701a0e5df956443">  157</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a9ac494d33de086073701a0e5df956443">BlackScholesCGBase::getIrIndexValue</a>(<span class="keyword">const</span> Size indexNo, <span class="keyword">const</span> Date&amp; d, <span class="keyword">const</span> Date&amp; fwd)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    Date effFixingDate = d;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <span class="keywordflow">if</span> (fwd != Null&lt;Date&gt;())</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>        effFixingDate = fwd;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="comment">// ensure a valid fixing date</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    effFixingDate = <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.at(indexNo).second-&gt;fixingCalendar().adjust(effFixingDate);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="keyword">auto</span> index = <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.at(indexNo).second;</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    std::string <span class="keywordtype">id</span> = <span class="stringliteral">&quot;__irFix_&quot;</span> + index-&gt;name() + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(effFixingDate);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="keywordtype">id</span>, [index, effFixingDate]() { <span class="keywordflow">return</span> index-&gt;fixing(effFixingDate); });</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordflow">return</span> cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>}</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a55f8e61274bc54a570a51a5868067ffd">  169</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a55f8e61274bc54a570a51a5868067ffd">BlackScholesCGBase::getInfIndexValue</a>(<span class="keyword">const</span> Size indexNo, <span class="keyword">const</span> Date&amp; d, <span class="keyword">const</span> Date&amp; fwd)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>    Date effFixingDate = d;</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="keywordflow">if</span> (fwd != Null&lt;Date&gt;())</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>        effFixingDate = fwd;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    <span class="keyword">auto</span> index = <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#aebe584e14684cee39eecccd086ba1588">infIndices_</a>.at(indexNo).second;</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    std::string <span class="keywordtype">id</span> = <span class="stringliteral">&quot;__infFix_&quot;</span> + index-&gt;name() + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(effFixingDate);</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="keywordtype">id</span>, [index, effFixingDate]() { <span class="keywordflow">return</span> index-&gt;fixing(effFixingDate); });</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="keywordflow">return</span> cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>}</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span><span class="keyword">struct </span>comp {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    comp(<span class="keyword">const</span> std::string&amp; indexInput) : <a class="code hl_variable" href="blackscholes_8cpp.html#a8051603eb6af9788531ccaeb8d2ac103">indexInput_</a>(indexInput) {}</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keywordtype">bool</span> operator()(<span class="keyword">const</span> std::pair&lt;<a class="code hl_class" href="classore_1_1data_1_1_index_info.html">IndexInfo</a>, boost::shared_ptr&lt;T&gt;&gt;&amp; p)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        <span class="keywordflow">return</span> p.first.name() == <a class="code hl_variable" href="blackscholes_8cpp.html#a8051603eb6af9788531ccaeb8d2ac103">indexInput_</a>;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    }</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="blackscholescgbase_8cpp.html#a8051603eb6af9788531ccaeb8d2ac103">  185</a></span>    <span class="keyword">const</span> std::string <a class="code hl_variable" href="blackscholes_8cpp.html#a8051603eb6af9788531ccaeb8d2ac103">indexInput_</a>;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>};</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>} <span class="comment">// namespace</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span> </div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab416b70f2e10c069c2d27f932b3f7648">  189</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab416b70f2e10c069c2d27f932b3f7648">BlackScholesCGBase::fwdCompAvg</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> isAvg, <span class="keyword">const</span> std::string&amp; indexInput, <span class="keyword">const</span> Date&amp; obsdate,</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>                                           <span class="keyword">const</span> Date&amp; start, <span class="keyword">const</span> Date&amp; end, <span class="keyword">const</span> Real spread, <span class="keyword">const</span> Real gearing,</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>                                           <span class="keyword">const</span> Integer lookback, <span class="keyword">const</span> Natural rateCutoff, <span class="keyword">const</span> Natural fixingDays,</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>                                           <span class="keyword">const</span> <span class="keywordtype">bool</span> includeSpread, <span class="keyword">const</span> Real cap, <span class="keyword">const</span> Real floor,</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>                                           <span class="keyword">const</span> <span class="keywordtype">bool</span> nakedOption, <span class="keyword">const</span> <span class="keywordtype">bool</span> localCapFloor)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    calculate();</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <span class="keyword">auto</span> index = std::find_if(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.end(), comp(indexInput));</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    QL_REQUIRE(index != <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">irIndices_</a>.end(),</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>               <span class="stringliteral">&quot;BlackScholesCGBase::fwdCompAvg(): did not find ir index &quot;</span> &lt;&lt; indexInput &lt;&lt; <span class="stringliteral">&quot; - this is unexpected.&quot;</span>);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <span class="keyword">auto</span> on = boost::dynamic_pointer_cast&lt;OvernightIndex&gt;(index-&gt;second);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    QL_REQUIRE(on, <span class="stringliteral">&quot;BlackScholesCGBase::fwdCompAvg(): expected on index for &quot;</span> &lt;&lt; indexInput);</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="comment">// if we want to support cap / floors we need the OIS CF surface</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    QL_REQUIRE(cap &gt; 999998.0 &amp;&amp; floor &lt; -999998.0,</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>               <span class="stringliteral">&quot;BlackScholesCGBase:fwdCompAvg(): cap (&quot;</span> &lt;&lt; cap &lt;&lt; <span class="stringliteral">&quot;) / floor (&quot;</span> &lt;&lt; floor &lt;&lt; <span class="stringliteral">&quot;) not supported&quot;</span>);</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    boost::shared_ptr&lt;QuantLib::FloatingRateCoupon&gt; coupon;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    boost::shared_ptr&lt;QuantLib::FloatingRateCouponPricer&gt; pricer;</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordflow">if</span> (isAvg) {</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>        coupon = boost::make_shared&lt;QuantExt::AverageONIndexedCoupon&gt;(</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>            end, 1.0, start, end, on, gearing, spread, rateCutoff, on-&gt;dayCounter(), lookback * Days, fixingDays);</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>        pricer = boost::make_shared&lt;AverageONIndexedCouponPricer&gt;();</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>        coupon = boost::make_shared&lt;QuantExt::OvernightIndexedCoupon&gt;(end, 1.0, start, end, on, gearing, spread, Date(),</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>                                                                      Date(), on-&gt;dayCounter(), <span class="keyword">false</span>, includeSpread,</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>                                                                      lookback * Days, rateCutoff, fixingDays);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>        pricer = boost::make_shared&lt;OvernightIndexedCouponPricer&gt;();</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    coupon-&gt;setPricer(pricer);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    std::string <span class="keywordtype">id</span> = <span class="stringliteral">&quot;__fwdCompAvg_&quot;</span> + std::to_string(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>-&gt;size());</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="keywordtype">id</span>, [coupon]() { <span class="keywordflow">return</span> coupon-&gt;rate(); });</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordflow">return</span> cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>}</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#abf6f98b24020510a254ae590e6020d27">  221</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#abf6f98b24020510a254ae590e6020d27">BlackScholesCGBase::getDiscount</a>(<span class="keyword">const</span> Size idx, <span class="keyword">const</span> Date&amp; s, <span class="keyword">const</span> Date&amp; t)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    std::string ids = <span class="stringliteral">&quot;__curve_&quot;</span> + std::to_string(idx) + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(s);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    std::string idt = <span class="stringliteral">&quot;__curve_&quot;</span> + std::to_string(idx) + <span class="stringliteral">&quot;_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(t);</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <span class="keyword">auto</span> c = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(idx);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(ids, [c, s] { <span class="keywordflow">return</span> c-&gt;discount(s); });</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(idt, [c, t] { <span class="keywordflow">return</span> c-&gt;discount(t); });</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="keywordflow">return</span> cg_div(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, idt), cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, ids));</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>}</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3bdcb351127a8ae4dbe49a7f11db4c28">  230</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3bdcb351127a8ae4dbe49a7f11db4c28">BlackScholesCGBase::getNumeraire</a>(<span class="keyword">const</span> Date&amp; s)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    std::string <span class="keywordtype">id</span> = <span class="stringliteral">&quot;__curve_0_&quot;</span> + <a class="code hl_function" href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a>(s);</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>    <span class="keyword">auto</span> c = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(0);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="keywordtype">id</span>, [c, s] { <span class="keywordflow">return</span> c-&gt;discount(s); });</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keywordflow">return</span> cg_div(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, cg_const(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, 1.0), cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="keywordtype">id</span>));</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>}</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a44e59e69ea691ae536b898196d8d3121">  237</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a44e59e69ea691ae536b898196d8d3121">BlackScholesCGBase::getFxSpot</a>(<span class="keyword">const</span> Size idx)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    std::string <span class="keywordtype">id</span> = <span class="stringliteral">&quot;__fxspot_&quot;</span> + std::to_string(idx);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="keyword">auto</span> c = <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.at(idx);</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <a class="code hl_function" href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">addModelParameter</a>(<span class="keywordtype">id</span>, [c] { <span class="keywordflow">return</span> c-&gt;value(); });</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="keywordflow">return</span> cg_var(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, <span class="keywordtype">id</span>);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>}</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a4a459ace661a02a460eb7f186ce0ee55">  244</a></span>Real <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a4a459ace661a02a460eb7f186ce0ee55">BlackScholesCGBase::getDirectFxSpotT0</a>(<span class="keyword">const</span> std::string&amp; forCcy, <span class="keyword">const</span> std::string&amp; domCcy)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="keyword">auto</span> c1 = std::find(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), forCcy);</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="keyword">auto</span> c2 = std::find(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), domCcy);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    QL_REQUIRE(c1 != <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; forCcy &lt;&lt; <span class="stringliteral">&quot; not handled&quot;</span>);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    QL_REQUIRE(c2 != <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; domCcy &lt;&lt; <span class="stringliteral">&quot; not handled&quot;</span>);</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    Size cidx1 = std::distance(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), c1);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>    Size cidx2 = std::distance(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), c2);</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    Real fx = 1.0;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>    <span class="keywordflow">if</span> (cidx1 &gt; 0)</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        fx *= <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.at(cidx1 - 1)-&gt;value();</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="keywordflow">if</span> (cidx2 &gt; 0)</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        fx /= <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">fxSpots_</a>.at(cidx2 - 1)-&gt;value();</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keywordflow">return</span> fx;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>}</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a60e773d9f273c852f0db1397fcaf1761">  259</a></span>Real <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a60e773d9f273c852f0db1397fcaf1761">BlackScholesCGBase::getDirectDiscountT0</a>(<span class="keyword">const</span> Date&amp; paydate, <span class="keyword">const</span> std::string&amp; currency)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <span class="keyword">auto</span> c = std::find(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), currency);</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    QL_REQUIRE(c != <a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.end(), <span class="stringliteral">&quot;currency &quot;</span> &lt;&lt; currency &lt;&lt; <span class="stringliteral">&quot; not handled&quot;</span>);</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    Size cidx = std::distance(<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">currencies_</a>.begin(), c);</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">curves_</a>.at(cidx)-&gt;discount(paydate);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>}</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno"><a class="line" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a1bd61c1de42024a10bc407e0cc8fa597">  266</a></span>std::size_t <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a1bd61c1de42024a10bc407e0cc8fa597">BlackScholesCGBase::npv</a>(<span class="keyword">const</span> std::size_t amount, <span class="keyword">const</span> Date&amp; obsdate, <span class="keyword">const</span> std::size_t <a class="code hl_variable" href="computationgraphbuilder_8cpp.html#abd640cc39af07965a8475be310893006">filter</a>,</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                                    <span class="keyword">const</span> boost::optional&lt;long&gt;&amp; memSlot, <span class="keyword">const</span> std::size_t addRegressor1,</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                                    <span class="keyword">const</span> std::size_t addRegressor2)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    calculate();</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>    QL_REQUIRE(!memSlot, <span class="stringliteral">&quot;BlackScholesCGBase::npv() with memSlot not yet supported!&quot;</span>);</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span> </div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <span class="comment">// if obsdate is today, take a plain expectation</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="keywordflow">if</span> (obsdate == <a class="code hl_function" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a5ce8b0af276b7c06ab424e688ae2d318">referenceDate</a>()) {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        <span class="keywordflow">return</span> cg_conditionalExpectation(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, amount, {}, cg_const(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, 1.0));</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    }</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="comment">// build the state</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    std::vector&lt;std::size_t&gt; state;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">underlyingPaths_</a>.empty()) {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; r : <a class="code hl_variable" href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">underlyingPaths_</a>.at(obsdate))</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            state.push_back(r);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    }</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>    <span class="keywordflow">if</span> (addRegressor1 != ComputationGraph::nan)</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        state.push_back(addRegressor1);</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    <span class="keywordflow">if</span> (addRegressor2 != ComputationGraph::nan)</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>        state.push_back(addRegressor2);</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="comment">// if the state is empty, return the plain expectation (no conditioning)</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="keywordflow">if</span>(state.empty()) {</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>        <span class="keywordflow">return</span> cg_conditionalExpectation(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, amount, {}, cg_const(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, 1.0));</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    }</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="comment">// if a memSlot is given and coefficients are stored, we use them</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="comment">// TODO ...</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span> </div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="comment">// otherwise compute coefficients and store them if a memSlot is given</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="comment">// TODO ...</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="comment">// compute conditional expectation and return the result</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="keywordflow">return</span> cg_conditionalExpectation(*<a class="code hl_variable" href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">g_</a>, amount, state, <a class="code hl_variable" href="computationgraphbuilder_8cpp.html#abd640cc39af07965a8475be310893006">filter</a>);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>}</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>} <span class="comment">// namespace data</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>} <span class="comment">// namespace ore</span></div>
<div class="ttc" id="aaverageonindexedcoupon_8hpp_html"><div class="ttname"><a href="../qle/averageonindexedcoupon_8hpp.html">averageonindexedcoupon.hpp</a></div></div>
<div class="ttc" id="aaverageonindexedcouponpricer_8hpp_html"><div class="ttname"><a href="../qle/averageonindexedcouponpricer_8hpp.html">averageonindexedcouponpricer.hpp</a></div></div>
<div class="ttc" id="ablackscholes_8cpp_html_a8051603eb6af9788531ccaeb8d2ac103"><div class="ttname"><a href="blackscholes_8cpp.html#a8051603eb6af9788531ccaeb8d2ac103">indexInput_</a></div><div class="ttdeci">const std::string indexInput_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholes_8cpp_source.html#l00288">blackscholes.cpp:288</a></div></div>
<div class="ttc" id="ablackscholescg_8cpp_html_aa842cc62b4fc38f8bf8f022be3504f03"><div class="ttname"><a href="blackscholescg_8cpp.html#aa842cc62b4fc38f8bf8f022be3504f03">correlations_</a></div><div class="ttdeci">const std::map&lt; std::pair&lt; std::string, std::string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; &amp; correlations_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescg_8cpp_source.html#l00228">blackscholescg.cpp:228</a></div></div>
<div class="ttc" id="ablackscholescgbase_8hpp_html"><div class="ttname"><a href="blackscholescgbase_8hpp.html">blackscholescgbase.hpp</a></div><div class="ttdoc">black scholes model base class for n underlyings (fx, equity or commodity)</div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html">ore::data::BlackScholesCGBase</a></div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00040">blackscholescgbase.hpp:40</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a1127cccc9668a02247dc139d27121708"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a1127cccc9668a02247dc139d27121708">ore::data::BlackScholesCGBase::performCalculations</a></div><div class="ttdeci">void performCalculations() const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00092">blackscholescgbase.cpp:92</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a112f92bc9715b7cf5b0aa46de6e98803"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a112f92bc9715b7cf5b0aa46de6e98803">ore::data::BlackScholesCGBase::underlyingPaths_</a></div><div class="ttdeci">std::map&lt; Date, std::vector&lt; std::size_t &gt; &gt; underlyingPaths_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00107">blackscholescgbase.hpp:107</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a1bd61c1de42024a10bc407e0cc8fa597"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a1bd61c1de42024a10bc407e0cc8fa597">ore::data::BlackScholesCGBase::npv</a></div><div class="ttdeci">std::size_t npv(const std::size_t amount, const Date &amp;obsdate, const std::size_t filter, const boost::optional&lt; long &gt; &amp;memSlot, const std::size_t addRegressor1, const std::size_t addRegressor2) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00266">blackscholescgbase.cpp:266</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a23d5244d8ea131b9d4d82ea3ac415502"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a23d5244d8ea131b9d4d82ea3ac415502">ore::data::BlackScholesCGBase::underlyingPathsCgVersion_</a></div><div class="ttdeci">std::size_t underlyingPathsCgVersion_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00108">blackscholescgbase.hpp:108</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a3bdcb351127a8ae4dbe49a7f11db4c28"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3bdcb351127a8ae4dbe49a7f11db4c28">ore::data::BlackScholesCGBase::getNumeraire</a></div><div class="ttdeci">std::size_t getNumeraire(const Date &amp;s) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00230">blackscholescgbase.cpp:230</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a3e22290961d6b56dce069c1c4fda6386"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a3e22290961d6b56dce069c1c4fda6386">ore::data::BlackScholesCGBase::referenceDate_</a></div><div class="ttdeci">Date referenceDate_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00101">blackscholescgbase.hpp:101</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a44e59e69ea691ae536b898196d8d3121"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a44e59e69ea691ae536b898196d8d3121">ore::data::BlackScholesCGBase::getFxSpot</a></div><div class="ttdeci">std::size_t getFxSpot(const Size idx) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00237">blackscholescgbase.cpp:237</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a4a459ace661a02a460eb7f186ce0ee55"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a4a459ace661a02a460eb7f186ce0ee55">ore::data::BlackScholesCGBase::getDirectFxSpotT0</a></div><div class="ttdeci">Real getDirectFxSpotT0(const std::string &amp;forCcy, const std::string &amp;domCcy) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00244">blackscholescgbase.cpp:244</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a55f8e61274bc54a570a51a5868067ffd"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a55f8e61274bc54a570a51a5868067ffd">ore::data::BlackScholesCGBase::getInfIndexValue</a></div><div class="ttdeci">std::size_t getInfIndexValue(const Size indexNo, const Date &amp;d, const Date &amp;fwd=Null&lt; Date &gt;()) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00169">blackscholescgbase.cpp:169</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a5ce8b0af276b7c06ab424e688ae2d318"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a5ce8b0af276b7c06ab424e688ae2d318">ore::data::BlackScholesCGBase::referenceDate</a></div><div class="ttdeci">const Date &amp; referenceDate() const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00087">blackscholescgbase.cpp:87</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a60e773d9f273c852f0db1397fcaf1761"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a60e773d9f273c852f0db1397fcaf1761">ore::data::BlackScholesCGBase::getDirectDiscountT0</a></div><div class="ttdeci">Real getDirectDiscountT0(const Date &amp;paydate, const std::string &amp;currency) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00259">blackscholescgbase.cpp:259</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a9356ce4490b329fbfbad73fa28841898"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a9356ce4490b329fbfbad73fa28841898">ore::data::BlackScholesCGBase::effectiveSimulationDates_</a></div><div class="ttdeci">std::set&lt; Date &gt; effectiveSimulationDates_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00102">blackscholescgbase.hpp:102</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_a9ac494d33de086073701a0e5df956443"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#a9ac494d33de086073701a0e5df956443">ore::data::BlackScholesCGBase::getIrIndexValue</a></div><div class="ttdeci">std::size_t getIrIndexValue(const Size indexNo, const Date &amp;d, const Date &amp;fwd=Null&lt; Date &gt;()) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00157">blackscholescgbase.cpp:157</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_aaf8a64586eb5db2781e2ba5c0597041f"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#aaf8a64586eb5db2781e2ba5c0597041f">ore::data::BlackScholesCGBase::fxSpots_</a></div><div class="ttdeci">const std::vector&lt; Handle&lt; Quote &gt; &gt; fxSpots_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00095">blackscholescgbase.hpp:95</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_ab416b70f2e10c069c2d27f932b3f7648"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab416b70f2e10c069c2d27f932b3f7648">ore::data::BlackScholesCGBase::fwdCompAvg</a></div><div class="ttdeci">std::size_t fwdCompAvg(const bool isAvg, const std::string &amp;indexInput, const Date &amp;obsdate, const Date &amp;start, const Date &amp;end, const Real spread, const Real gearing, const Integer lookback, const Natural rateCutoff, const Natural fixingDays, const bool includeSpread, const Real cap, const Real floor, const bool nakedOption, const bool localCapFloor) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00189">blackscholescgbase.cpp:189</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_ab695da1eaa09dc5436c91089c0888f59"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#ab695da1eaa09dc5436c91089c0888f59">ore::data::BlackScholesCGBase::model_</a></div><div class="ttdeci">const Handle&lt; BlackScholesModelWrapper &gt; model_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00096">blackscholescgbase.hpp:96</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_abf6f98b24020510a254ae590e6020d27"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#abf6f98b24020510a254ae590e6020d27">ore::data::BlackScholesCGBase::getDiscount</a></div><div class="ttdeci">std::size_t getDiscount(const Size idx, const Date &amp;s, const Date &amp;t) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00221">blackscholescgbase.cpp:221</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_acda3059c2cee3c6462c5083590438a40"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#acda3059c2cee3c6462c5083590438a40">ore::data::BlackScholesCGBase::getIndexValue</a></div><div class="ttdeci">std::size_t getIndexValue(const Size indexNo, const Date &amp;d, const Date &amp;fwd=Null&lt; Date &gt;()) const override</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00126">blackscholescgbase.cpp:126</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_adda5ae6c670bdbb1857509a4aa20ec25"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#adda5ae6c670bdbb1857509a4aa20ec25">ore::data::BlackScholesCGBase::timeGrid_</a></div><div class="ttdeci">TimeGrid timeGrid_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00103">blackscholescgbase.hpp:103</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_aeb5929f7ce6e2d52f420ca71b7caaae1"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#aeb5929f7ce6e2d52f420ca71b7caaae1">ore::data::BlackScholesCGBase::correlations_</a></div><div class="ttdeci">const std::map&lt; std::pair&lt; std::string, std::string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; correlations_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00097">blackscholescgbase.hpp:97</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_af9092b7d1618dd9a9092dc9dae37ea75"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9092b7d1618dd9a9092dc9dae37ea75">ore::data::BlackScholesCGBase::curves_</a></div><div class="ttdeci">const std::vector&lt; Handle&lt; YieldTermStructure &gt; &gt; curves_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00094">blackscholescgbase.hpp:94</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_af9be63a7f055dbb0ed0fc95090d92e87"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#af9be63a7f055dbb0ed0fc95090d92e87">ore::data::BlackScholesCGBase::positionInTimeGrid_</a></div><div class="ttdeci">std::vector&lt; Size &gt; positionInTimeGrid_</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8hpp_source.html#l00104">blackscholescgbase.hpp:104</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_black_scholes_c_g_base_html_afdaf753fc7c923e9ab6376165c088fbd"><div class="ttname"><a href="classore_1_1data_1_1_black_scholes_c_g_base.html#afdaf753fc7c923e9ab6376165c088fbd">ore::data::BlackScholesCGBase::BlackScholesCGBase</a></div><div class="ttdeci">BlackScholesCGBase(const Size paths, const std::vector&lt; std::string &gt; &amp;currencies, const std::vector&lt; Handle&lt; YieldTermStructure &gt; &gt; &amp;curves, const std::vector&lt; Handle&lt; Quote &gt; &gt; &amp;fxSpots, const std::vector&lt; std::pair&lt; std::string, boost::shared_ptr&lt; InterestRateIndex &gt; &gt; &gt; &amp;irIndices, const std::vector&lt; std::pair&lt; std::string, boost::shared_ptr&lt; ZeroInflationIndex &gt; &gt; &gt; &amp;infIndices, const std::vector&lt; std::string &gt; &amp;indices, const std::vector&lt; std::string &gt; &amp;indexCurrencies, const Handle&lt; BlackScholesModelWrapper &gt; &amp;model, const std::map&lt; std::pair&lt; std::string, std::string &gt;, Handle&lt; QuantExt::CorrelationTermStructure &gt; &gt; &amp;correlations, const std::set&lt; Date &gt; &amp;simulationDates, const IborFallbackConfig &amp;iborFallbackConfig)</div><div class="ttdef"><b>Definition:</b> <a href="blackscholescgbase_8cpp_source.html#l00048">blackscholescgbase.cpp:48</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_ibor_fallback_config_html"><div class="ttname"><a href="classore_1_1data_1_1_ibor_fallback_config.html">ore::data::IborFallbackConfig</a></div><div class="ttdef"><b>Definition:</b> <a href="iborfallbackconfig_8hpp_source.html#l00031">iborfallbackconfig.hpp:31</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_index_info_html"><div class="ttname"><a href="classore_1_1data_1_1_index_info.html">ore::data::IndexInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="scripting_2utilities_8hpp_source.html#l00093">utilities.hpp:93</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_html_a67e07be09ac7a1142f4f4dc9277c5c55"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g.html#a67e07be09ac7a1142f4f4dc9277c5c55">ore::data::ModelCG::g_</a></div><div class="ttdeci">boost::shared_ptr&lt; QuantExt::ComputationGraph &gt; g_</div><div class="ttdef"><b>Definition:</b> <a href="modelcg_8hpp_source.html#l00143">modelcg.hpp:143</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html">ore::data::ModelCGImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8hpp_source.html#l00045">modelcgimpl.hpp:45</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a0e02d6070bafb36ab736bf5cbb4e70ce"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a0e02d6070bafb36ab736bf5cbb4e70ce">ore::data::ModelCGImpl::irIndices_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; IndexInfo, boost::shared_ptr&lt; InterestRateIndex &gt; &gt; &gt; irIndices_</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8hpp_source.html#l00119">modelcgimpl.hpp:119</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a1127cccc9668a02247dc139d27121708"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a1127cccc9668a02247dc139d27121708">ore::data::ModelCGImpl::performCalculations</a></div><div class="ttdeci">void performCalculations() const override</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8cpp_source.html#l00406">modelcgimpl.cpp:406</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a13825d1e1b0927412631fb4d7c976a5d"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a13825d1e1b0927412631fb4d7c976a5d">ore::data::ModelCGImpl::addModelParameter</a></div><div class="ttdeci">void addModelParameter(const std::string &amp;id, std::function&lt; double(void)&gt; f) const</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8cpp_source.html#l00435">modelcgimpl.cpp:435</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a14efd0665cded9d6785314f26306e91b"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a14efd0665cded9d6785314f26306e91b">ore::data::ModelCGImpl::currencies_</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; currencies_</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8hpp_source.html#l00114">modelcgimpl.hpp:114</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a3a0f80d541e893e1eaf8f982f62c9499"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a3a0f80d541e893e1eaf8f982f62c9499">ore::data::ModelCGImpl::cgVersion</a></div><div class="ttdeci">std::size_t cgVersion() const override</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8cpp_source.html#l00416">modelcgimpl.cpp:416</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a44b8187e17888b27e1ff5c98a214a96b"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a44b8187e17888b27e1ff5c98a214a96b">ore::data::ModelCGImpl::discount</a></div><div class="ttdeci">std::size_t discount(const Date &amp;obsdate, const Date &amp;paydate, const std::string &amp;currency) const override</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8cpp_source.html#l00139">modelcgimpl.cpp:139</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_a7033255d9f10aca8436bdf488964db70"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#a7033255d9f10aca8436bdf488964db70">ore::data::ModelCGImpl::indices_</a></div><div class="ttdeci">std::vector&lt; IndexInfo &gt; indices_</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8hpp_source.html#l00121">modelcgimpl.hpp:121</a></div></div>
<div class="ttc" id="aclassore_1_1data_1_1_model_c_g_impl_html_aebe584e14684cee39eecccd086ba1588"><div class="ttname"><a href="classore_1_1data_1_1_model_c_g_impl.html#aebe584e14684cee39eecccd086ba1588">ore::data::ModelCGImpl::infIndices_</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; IndexInfo, boost::shared_ptr&lt; ZeroInflationIndex &gt; &gt; &gt; infIndices_</div><div class="ttdef"><b>Definition:</b> <a href="modelcgimpl_8hpp_source.html#l00120">modelcgimpl.hpp:120</a></div></div>
<div class="ttc" id="acomputationgraphbuilder_8cpp_html_abd640cc39af07965a8475be310893006"><div class="ttname"><a href="computationgraphbuilder_8cpp.html#abd640cc39af07965a8475be310893006">filter</a></div><div class="ttdeci">SafeStack&lt; Filter &gt; filter</div><div class="ttdef"><b>Definition:</b> <a href="computationgraphbuilder_8cpp_source.html#l01474">computationgraphbuilder.cpp:1474</a></div></div>
<div class="ttc" id="acomputationgraphbuilder_8cpp_html_abffa9627834aae0799550c12a25a85e0"><div class="ttname"><a href="computationgraphbuilder_8cpp.html#abffa9627834aae0799550c12a25a85e0">model_</a></div><div class="ttdeci">const boost::shared_ptr&lt; ModelCG &gt; model_</div><div class="ttdef"><b>Definition:</b> <a href="computationgraphbuilder_8cpp_source.html#l01463">computationgraphbuilder.cpp:1463</a></div></div>
<div class="ttc" id="aindexparser_8hpp_html"><div class="ttname"><a href="indexparser_8hpp.html">indexparser.hpp</a></div><div class="ttdoc">Map text representations to QuantLib/QuantExt types.</div></div>
<div class="ttc" id="alog_8hpp_html_a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b"><div class="ttname"><a href="log_8hpp.html#a08cf33440c824c6fda734c566a726536a604ac82e88d7a367d4c2830411520c2b">data</a></div><div class="ttdeci">@ data</div><div class="ttdef"><b>Definition:</b> <a href="log_8hpp_source.html#l00077">log.hpp:77</a></div></div>
<div class="ttc" id="anamespace_quant_ext_html"><div class="ttname"><a href="namespace_quant_ext.html">QuantExt</a></div></div>
<div class="ttc" id="anamespace_quant_lib_html"><div class="ttname"><a href="namespace_quant_lib.html">QuantLib</a></div></div>
<div class="ttc" id="anamespaceore_1_1data_html_a86651dfeb5c18ee891f7a4734d8cf455"><div class="ttname"><a href="namespaceore_1_1data.html#a86651dfeb5c18ee891f7a4734d8cf455">ore::data::to_string</a></div><div class="ttdeci">std::string to_string(const LocationInfo &amp;l)</div><div class="ttdef"><b>Definition:</b> <a href="ast_8cpp_source.html#l00028">ast.cpp:28</a></div></div>
<div class="ttc" id="anamespaceore_html"><div class="ttname"><a href="namespaceore.html">ore</a></div><div class="ttdoc">Serializable Credit Default Swap.</div><div class="ttdef"><b>Definition:</b> <a href="namespaces_8docs.html_source#l00023">namespaces.docs:23</a></div></div>
<div class="ttc" id="aovernightindexedcoupon_8hpp_html"><div class="ttname"><a href="../qle/overnightindexedcoupon_8hpp.html">overnightindexedcoupon.hpp</a></div></div>
<div class="ttc" id="ato__string_8hpp_html"><div class="ttname"><a href="to__string_8hpp.html">to_string.hpp</a></div><div class="ttdoc">string conversion utilities</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by <a href="http://www.doxygen.org/index.html">Doxygen</a>
1.9.5
</small></address>
</body>
</html>
